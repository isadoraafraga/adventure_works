2021-05-26 22:32:35.215604 (MainThread): Running with dbt=0.19.1
2021-05-26 22:32:36.114512 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:32:36.116758 (MainThread): Tracking: tracking
2021-05-26 22:32:36.205353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98B843C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98B830D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98B830FC8>]}
2021-05-26 22:32:36.280629 (MainThread): Partial parsing not enabled
2021-05-26 22:32:36.284273 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:32:36.397300 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:32:36.413334 (MainThread): Parsing macros\etc.sql
2021-05-26 22:32:36.418806 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:32:36.433771 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:32:36.457895 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:32:36.465207 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:32:36.470508 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:32:36.491215 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:32:36.502274 (MainThread): Parsing macros\core.sql
2021-05-26 22:32:36.511258 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:32:36.602569 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:32:36.620526 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:32:36.624737 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:32:36.628561 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:32:36.633395 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:32:36.638385 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:32:36.641696 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:32:36.666964 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:32:36.696877 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:32:36.702594 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:32:36.716563 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:32:36.767208 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:32:36.864978 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:32:36.871934 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:32:36.917820 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:32:36.933768 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:32:36.945969 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:32:36.964132 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:32:36.974528 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:32:36.978521 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:32:36.983518 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:32:37.003557 (MainThread): Partial parsing not enabled
2021-05-26 22:32:37.055054 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-05-26 22:32:37.075003 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_order_details".
2021-05-26 22:32:37.094593 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98F2A8F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98F2A8F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98F2A8FC8>]}
2021-05-26 22:32:37.095613 (MainThread): Flushing usage events
2021-05-26 22:32:37.960344 (MainThread): Connection 'model.my_new_project.stg_order_details' was properly closed.
2021-05-26 22:32:37.960344 (MainThread): Encountered an error:
2021-05-26 22:32:37.961341 (MainThread): Compilation Error
  Error reading my_new_project: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |     # Sales 
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9
2021-05-26 22:32:37.982286 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 9
  ------------------------------
  6  |     tables:
  7  |     # Sales 
  8  |           - name: salesorderheader
  9  |         description: >
  10 |           One record per order. Includes cancelled and deleted orders.
  11 |         columns:
  12 |           - name: salesorderid
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |     # Sales 
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9

2021-05-26 22:33:58.033807 (MainThread): Running with dbt=0.19.1
2021-05-26 22:33:58.716348 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:33:58.717308 (MainThread): Tracking: tracking
2021-05-26 22:33:58.718344 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF2D2F7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF2E7A248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF2E7A088>]}
2021-05-26 22:33:58.738254 (MainThread): Partial parsing not enabled
2021-05-26 22:33:58.741267 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:33:58.784130 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:33:58.800087 (MainThread): Parsing macros\etc.sql
2021-05-26 22:33:58.805073 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:33:58.815047 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:33:58.856935 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:33:58.866949 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:33:58.872895 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:33:58.908800 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:33:58.923794 (MainThread): Parsing macros\core.sql
2021-05-26 22:33:58.938757 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:33:59.049422 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:33:59.077349 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:33:59.081336 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:33:59.087356 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:33:59.095338 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:33:59.102287 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:33:59.106312 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:33:59.140331 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:33:59.192207 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:33:59.196196 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:33:59.211170 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:33:59.255216 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:33:59.322828 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:33:59.326820 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:33:59.362728 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:33:59.376690 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:33:59.387697 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:33:59.400576 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:33:59.406253 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:33:59.410289 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:33:59.416247 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:33:59.432918 (MainThread): Partial parsing not enabled
2021-05-26 22:33:59.476589 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-05-26 22:33:59.495875 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_order_details".
2021-05-26 22:33:59.509842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF68D7E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF68D7E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBF68D7F48>]}
2021-05-26 22:33:59.509842 (MainThread): Flushing usage events
2021-05-26 22:34:00.765676 (MainThread): Connection 'model.my_new_project.stg_order_details' was properly closed.
2021-05-26 22:34:00.765676 (MainThread): Encountered an error:
2021-05-26 22:34:00.767639 (MainThread): Compilation Error
  Error reading my_new_project: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9
2021-05-26 22:34:00.790577 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 9
  ------------------------------
  6  |     tables:
  7  |  
  8  |           - name: salesorderheader
  9  |         description: >
  10 |           One record per order. Includes cancelled and deleted orders.
  11 |         columns:
  12 |           - name: salesorderid
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading my_new_project: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9

2021-05-26 22:35:30.128304 (MainThread): Running with dbt=0.19.1
2021-05-26 22:35:31.602466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:35:31.606456 (MainThread): Tracking: tracking
2021-05-26 22:35:31.607453 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B722AD99C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B722AE5C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B722AE5FC8>]}
2021-05-26 22:35:31.643934 (MainThread): Partial parsing not enabled
2021-05-26 22:35:31.649922 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:35:31.708760 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:35:31.727711 (MainThread): Parsing macros\etc.sql
2021-05-26 22:35:31.737684 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:35:31.755635 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:35:31.823383 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:35:31.840335 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:35:31.849315 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:35:31.892196 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:35:31.929616 (MainThread): Parsing macros\core.sql
2021-05-26 22:35:31.958541 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:35:32.180463 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:35:32.223348 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:35:32.226340 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:35:32.236314 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:35:32.244291 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:35:32.255264 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:35:32.260251 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:35:32.304133 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:35:32.341034 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:35:32.346510 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:35:32.363156 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:35:32.418639 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:35:32.493723 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:35:32.499712 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:35:32.543632 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:35:32.564539 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:35:32.582418 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:35:32.599369 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:35:32.607348 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:35:32.612334 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:35:32.617609 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:35:32.633589 (MainThread): Partial parsing not enabled
2021-05-26 22:35:32.686733 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:35:32.709672 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_order_details".
2021-05-26 22:35:32.727626 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B726587E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B726587E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B726587F08>]}
2021-05-26 22:35:32.728621 (MainThread): Flushing usage events
2021-05-26 22:35:34.137751 (MainThread): Connection 'model.adventure_works.stg_order_details' was properly closed.
2021-05-26 22:35:34.137751 (MainThread): Encountered an error:
2021-05-26 22:35:34.138947 (MainThread): Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9
2021-05-26 22:35:34.161894 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 9
  ------------------------------
  6  |     tables:
  7  |  
  8  |           - name: salesorderheader
  9  |         description: >
  10 |           One record per order. Includes cancelled and deleted orders.
  11 |         columns:
  12 |           - name: salesorderid
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: >
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9

2021-05-26 22:36:03.343875 (MainThread): Running with dbt=0.19.1
2021-05-26 22:36:04.004461 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:36:04.004461 (MainThread): Tracking: tracking
2021-05-26 22:36:04.005459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224EFD65E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224EFD66448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224EFD666C8>]}
2021-05-26 22:36:04.027417 (MainThread): Partial parsing not enabled
2021-05-26 22:36:04.030304 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:36:04.069687 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:36:04.083029 (MainThread): Parsing macros\etc.sql
2021-05-26 22:36:04.087784 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:36:04.097761 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:36:04.122744 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:36:04.128679 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:36:04.133436 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:36:04.152426 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:36:04.165390 (MainThread): Parsing macros\core.sql
2021-05-26 22:36:04.176327 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:36:04.269078 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:36:04.288026 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:36:04.290023 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:36:04.294012 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:36:04.298999 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:36:04.302988 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:36:04.305980 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:36:04.324408 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:36:04.353368 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:36:04.358081 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:36:04.372048 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:36:04.413938 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:36:04.479794 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:36:04.483786 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:36:04.521647 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:36:04.538604 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:36:04.551662 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:36:04.565411 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:36:04.571398 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:36:04.575852 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:36:04.580417 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:36:04.594393 (MainThread): Partial parsing not enabled
2021-05-26 22:36:04.637319 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:36:04.656231 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_order_details".
2021-05-26 22:36:04.668952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F38190C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F3819108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F38191C8>]}
2021-05-26 22:36:04.669953 (MainThread): Flushing usage events
2021-05-26 22:36:05.626392 (MainThread): Connection 'model.adventure_works.stg_order_details' was properly closed.
2021-05-26 22:36:05.626392 (MainThread): Encountered an error:
2021-05-26 22:36:05.628346 (MainThread): Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: 
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9
2021-05-26 22:36:05.662265 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 9
  ------------------------------
  6  |     tables:
  7  |  
  8  |           - name: salesorderheader
  9  |         description: 
  10 |           One record per order. Includes cancelled and deleted orders.
  11 |         columns:
  12 |           - name: salesorderid
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: 
    10 |           One record per order. Includes cancelled and deleted orders.
    11 |         columns:
    12 |           - name: salesorderid
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9

2021-05-26 22:37:18.178822 (MainThread): Running with dbt=0.19.1
2021-05-26 22:37:18.971348 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:37:18.972379 (MainThread): Tracking: tracking
2021-05-26 22:37:18.974374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DA536E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DA65B1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DA65B148>]}
2021-05-26 22:37:18.992430 (MainThread): Partial parsing not enabled
2021-05-26 22:37:18.996073 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:37:19.036001 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:37:19.048971 (MainThread): Parsing macros\etc.sql
2021-05-26 22:37:19.053555 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:37:19.062786 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:37:19.092711 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:37:19.098729 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:37:19.103680 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:37:19.123642 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:37:19.134920 (MainThread): Parsing macros\core.sql
2021-05-26 22:37:19.143355 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:37:19.230126 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:37:19.251723 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:37:19.254720 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:37:19.259488 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:37:19.263518 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:37:19.267507 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:37:19.270740 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:37:19.290022 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:37:19.321941 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:37:19.326059 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:37:19.339103 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:37:19.381290 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:37:19.447130 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:37:19.452238 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:37:19.487355 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:37:19.501383 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:37:19.515349 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:37:19.536790 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:37:19.542812 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:37:19.546768 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:37:19.550790 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:37:19.565754 (MainThread): Partial parsing not enabled
2021-05-26 22:37:19.612792 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:37:19.633771 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_order_details".
2021-05-26 22:37:19.646736 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DE109148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DE109188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8DE109248>]}
2021-05-26 22:37:19.646736 (MainThread): Flushing usage events
2021-05-26 22:37:21.026151 (MainThread): Connection 'model.adventure_works.stg_order_details' was properly closed.
2021-05-26 22:37:21.027046 (MainThread): Encountered an error:
2021-05-26 22:37:21.027046 (MainThread): Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: One record per order. Includes cancelled and deleted orders.
    10 |         columns:
    11 |           - name: salesorderid
    12 |             description: Primary key of the orders table
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9
2021-05-26 22:37:21.049949 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 9
  ------------------------------
  6  |     tables:
  7  |  
  8  |           - name: salesorderheader
  9  |         description: One record per order. Includes cancelled and deleted orders.
  10 |         columns:
  11 |           - name: salesorderid
  12 |             description: Primary key of the orders table
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 9, column 9

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading adventure_works: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables:
    7  |  
    8  |           - name: salesorderheader
    9  |         description: One record per order. Includes cancelled and deleted orders.
    10 |         columns:
    11 |           - name: salesorderid
    12 |             description: Primary key of the orders table
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 9, column 9

2021-05-26 22:39:57.056107 (MainThread): Running with dbt=0.19.1
2021-05-26 22:39:57.904483 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:39:57.906245 (MainThread): Tracking: tracking
2021-05-26 22:39:57.908245 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA05B5BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA05A3E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA0616488>]}
2021-05-26 22:39:57.928191 (MainThread): Partial parsing not enabled
2021-05-26 22:39:57.931183 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:39:57.976063 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:39:57.989028 (MainThread): Parsing macros\etc.sql
2021-05-26 22:39:57.994015 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:39:58.002991 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:39:58.038893 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:39:58.044877 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:39:58.050862 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:39:58.071807 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:39:58.084069 (MainThread): Parsing macros\core.sql
2021-05-26 22:39:58.092493 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:39:58.214953 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:39:58.235902 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:39:58.239180 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:39:58.243879 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:39:58.247875 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:39:58.251862 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:39:58.254855 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:39:58.278788 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:39:58.308712 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:39:58.312701 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:39:58.325664 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:39:58.382513 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:39:58.471275 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:39:58.476263 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:39:58.516482 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:39:58.534447 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:39:58.546418 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:39:58.565005 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:39:58.571990 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:39:58.575980 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:39:58.581965 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:39:58.597925 (MainThread): Partial parsing not enabled
2021-05-26 22:39:58.659179 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:39:58.685111 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_order_details".
2021-05-26 22:39:58.893862 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA416CC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA416CBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA416C908>]}
2021-05-26 22:39:58.893862 (MainThread): Flushing usage events
2021-05-26 22:39:59.970037 (MainThread): Connection 'model.adventure_works.stg_order_details' was properly closed.
2021-05-26 22:39:59.971033 (MainThread): Encountered an error:
2021-05-26 22:39:59.972031 (MainThread): Compilation Error in model stg_order_details (models\stg_order_details.sql)
  Model 'model.adventure_works.stg_order_details' (models\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-05-26 22:39:59.986003 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_order_details (models\stg_order_details.sql)
  Model 'model.adventure_works.stg_order_details' (models\stg_order_details.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-05-26 22:40:40.681239 (MainThread): Running with dbt=0.19.1
2021-05-26 22:40:41.364975 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:40:41.365975 (MainThread): Tracking: tracking
2021-05-26 22:40:41.366971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A68C9B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A71F5D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A71F5CC8>]}
2021-05-26 22:40:41.386218 (MainThread): Partial parsing not enabled
2021-05-26 22:40:41.389063 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:40:41.430954 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:40:41.444917 (MainThread): Parsing macros\etc.sql
2021-05-26 22:40:41.448907 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:40:41.460874 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:40:41.484810 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:40:41.495816 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:40:41.502766 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:40:41.522708 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:40:41.532683 (MainThread): Parsing macros\core.sql
2021-05-26 22:40:41.541524 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:40:41.627132 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:40:41.648897 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:40:41.651491 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:40:41.655503 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:40:41.660470 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:40:41.665957 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:40:41.668778 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:40:41.688545 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:40:41.718383 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:40:41.723373 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:40:41.735625 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:40:41.786455 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:40:41.852379 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:40:41.856949 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:40:41.892312 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:40:41.906543 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:40:41.917679 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:40:41.932318 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:40:41.938635 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:40:41.942627 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:40:41.946616 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:40:41.961204 (MainThread): Partial parsing not enabled
2021-05-26 22:40:42.010108 (MainThread): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:40:42.187998 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.adventure_works.example

2021-05-26 22:40:42.190869 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007afd44-96c3-4640-bf7d-0dc8cc7eac66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AADF5908>]}
2021-05-26 22:40:42.203833 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007afd44-96c3-4640-bf7d-0dc8cc7eac66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AAC84E08>]}
2021-05-26 22:40:42.204831 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-26 22:40:42.210844 (MainThread): 
2021-05-26 22:40:42.212813 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:40:42.218794 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-26 22:40:42.218794 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-26 22:40:43.852142 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_adventure_works".
2021-05-26 22:40:43.853147 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-26 22:40:43.869144 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 22:40:45.209833 (MainThread): 19:40:45 | Concurrency: 1 threads (target='dev')
2021-05-26 22:40:45.210657 (MainThread): 19:40:45 | 
2021-05-26 22:40:45.216647 (Thread-1): Began running node model.adventure_works.stg_orders
2021-05-26 22:40:45.216647 (Thread-1): 19:40:45 | 1 of 1 START view model adventure_works.stg_orders................... [RUN]
2021-05-26 22:40:45.217645 (Thread-1): Acquiring new bigquery connection "model.adventure_works.stg_orders".
2021-05-26 22:40:45.218642 (Thread-1): Compiling model.adventure_works.stg_orders
2021-05-26 22:40:45.230610 (Thread-1): Writing injected SQL for node "model.adventure_works.stg_orders"
2021-05-26 22:40:45.232602 (Thread-1): finished collecting timing info
2021-05-26 22:40:45.319404 (Thread-1): Writing runtime SQL for node "model.adventure_works.stg_orders"
2021-05-26 22:40:45.322362 (Thread-1): Opening a new connection, currently in state init
2021-05-26 22:40:45.330340 (Thread-1): On model.adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-26 22:40:47.917394 (Thread-1): finished collecting timing info
2021-05-26 22:40:47.917394 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007afd44-96c3-4640-bf7d-0dc8cc7eac66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AAC43C08>]}
2021-05-26 22:40:47.918390 (Thread-1): 19:40:47 | 1 of 1 OK created view model adventure_works.stg_orders.............. [OK in 2.70s]
2021-05-26 22:40:47.919352 (Thread-1): Finished running node model.adventure_works.stg_orders
2021-05-26 22:40:47.972531 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:40:47.972531 (MainThread): 19:40:47 | 
2021-05-26 22:40:47.973523 (MainThread): 19:40:47 | Finished running 1 view model in 5.76s.
2021-05-26 22:40:47.975520 (MainThread): Connection 'master' was properly closed.
2021-05-26 22:40:47.975520 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-26 22:40:47.975520 (MainThread): Connection 'list_desafio-indicium_adventure_works' was properly closed.
2021-05-26 22:40:47.977554 (MainThread): Connection 'model.adventure_works.stg_orders' was properly closed.
2021-05-26 22:40:47.979512 (MainThread): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62504), raddr=('142.250.218.202', 443)>
2021-05-26 22:40:47.980542 (MainThread): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62505), raddr=('142.250.218.234', 443)>
2021-05-26 22:40:47.991871 (MainThread): 
2021-05-26 22:40:47.991871 (MainThread): Completed successfully
2021-05-26 22:40:47.992873 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-26 22:40:47.994863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AAC526C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1A7251188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AAD456C8>]}
2021-05-26 22:40:47.995860 (MainThread): Flushing usage events
2021-05-26 22:43:33.779000 (MainThread): Running with dbt=0.19.1
2021-05-26 22:43:34.581536 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:43:34.581536 (MainThread): Tracking: tracking
2021-05-26 22:43:34.581536 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C51B0588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C52B5D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C52B5C88>]}
2021-05-26 22:43:34.612788 (MainThread): Partial parsing not enabled
2021-05-26 22:43:34.612788 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:43:34.644062 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:43:34.659682 (MainThread): Parsing macros\etc.sql
2021-05-26 22:43:34.659682 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:43:34.681813 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:43:34.697480 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:43:34.713096 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:43:34.713096 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:43:34.728719 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:43:34.744339 (MainThread): Parsing macros\core.sql
2021-05-26 22:43:34.759927 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:43:34.844650 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:43:34.860272 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:43:34.860272 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:43:34.860272 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:43:34.875896 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:43:34.875896 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:43:34.882439 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:43:34.903123 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:43:34.918745 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:43:34.934366 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:43:34.950028 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:43:34.982741 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:43:35.061397 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:43:35.065442 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:43:35.099794 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:43:35.114035 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:43:35.124642 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:43:35.138370 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:43:35.144394 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:43:35.148348 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:43:35.152372 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:43:35.165303 (MainThread): Partial parsing not enabled
2021-05-26 22:43:35.209766 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:43:35.383431 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-26 22:43:35.393123 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '707e8a6d-c491-404f-9d50-981598ba5f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8D8A248>]}
2021-05-26 22:43:35.413068 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '707e8a6d-c491-404f-9d50-981598ba5f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8E85C88>]}
2021-05-26 22:43:35.414069 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-26 22:43:35.418058 (MainThread): 
2021-05-26 22:43:35.421053 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:43:35.428028 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-26 22:43:35.428028 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-26 22:43:36.835984 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_adventure_works".
2021-05-26 22:43:36.835984 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-26 22:43:36.851606 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 22:43:37.712589 (MainThread): 19:43:37 | Concurrency: 1 threads (target='dev')
2021-05-26 22:43:37.712589 (MainThread): 19:43:37 | 
2021-05-26 22:43:37.722659 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-26 22:43:37.722659 (Thread-1): 19:43:37 | 1 of 1 START view model adventure_works.stg_orders................... [RUN]
2021-05-26 22:43:37.724654 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:43:37.724654 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-26 22:43:37.730966 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:43:37.730966 (Thread-1): finished collecting timing info
2021-05-26 22:43:37.843616 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:43:37.846264 (Thread-1): Opening a new connection, currently in state init
2021-05-26 22:43:37.853307 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-26 22:43:40.302928 (Thread-1): finished collecting timing info
2021-05-26 22:43:40.302928 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707e8a6d-c491-404f-9d50-981598ba5f76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8DF0508>]}
2021-05-26 22:43:40.302928 (Thread-1): 19:43:40 | 1 of 1 OK created view model adventure_works.stg_orders.............. [OK in 2.58s]
2021-05-26 22:43:40.302928 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-26 22:43:40.418856 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:43:40.418856 (MainThread): 19:43:40 | 
2021-05-26 22:43:40.418856 (MainThread): 19:43:40 | Finished running 1 view model in 5.00s.
2021-05-26 22:43:40.418856 (MainThread): Connection 'master' was properly closed.
2021-05-26 22:43:40.422906 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-26 22:43:40.422906 (MainThread): Connection 'list_desafio-indicium_adventure_works' was properly closed.
2021-05-26 22:43:40.422906 (MainThread): Connection 'model.dw_adventure_works.stg_orders' was properly closed.
2021-05-26 22:43:40.425902 (MainThread): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62550), raddr=('172.217.173.106', 443)>
2021-05-26 22:43:40.425902 (MainThread): unclosed <socket.socket fd=756, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62551), raddr=('142.250.218.234', 443)>
2021-05-26 22:43:40.441857 (MainThread): 
2021-05-26 22:43:40.442851 (MainThread): Completed successfully
2021-05-26 22:43:40.444870 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-26 22:43:40.446841 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C5330208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8D54948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8D91A48>]}
2021-05-26 22:43:40.446841 (MainThread): Flushing usage events
2021-05-26 22:47:33.086602 (MainThread): Running with dbt=0.19.1
2021-05-26 22:47:35.090200 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:47:35.091377 (MainThread): Tracking: tracking
2021-05-26 22:47:35.092172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFA97A0648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFA9890C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFA9890FC8>]}
2021-05-26 22:47:35.114520 (MainThread): Partial parsing not enabled
2021-05-26 22:47:35.118719 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:47:35.159168 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:47:35.172856 (MainThread): Parsing macros\etc.sql
2021-05-26 22:47:35.178646 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:47:35.188594 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:47:35.213530 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:47:35.219516 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:47:35.223506 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:47:35.243451 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:47:35.255878 (MainThread): Parsing macros\core.sql
2021-05-26 22:47:35.264362 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:47:35.339151 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:47:35.370431 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:47:35.370431 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:47:35.370431 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:47:35.386048 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:47:35.386048 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:47:35.386048 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:47:35.401672 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:47:35.437958 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:47:35.437958 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:47:35.453618 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:47:35.500444 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:47:35.569550 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:47:35.569550 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:47:35.616377 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:47:35.622884 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:47:35.638547 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:47:35.654131 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:47:35.654131 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:47:35.669758 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:47:35.669758 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:47:35.685415 (MainThread): Partial parsing not enabled
2021-05-26 22:47:35.738871 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:47:35.939009 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-26 22:47:35.939009 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72373b96-47e7-45f4-bd32-fa01d0728976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD3D1C08>]}
2021-05-26 22:47:35.966885 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72373b96-47e7-45f4-bd32-fa01d0728976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD3343C8>]}
2021-05-26 22:47:35.967883 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-26 22:47:35.970875 (MainThread): 
2021-05-26 22:47:35.971872 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:47:35.978855 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-26 22:47:35.979851 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-26 22:47:38.173157 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_desafio-indicium_dw_adventure_works".
2021-05-26 22:47:38.173157 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_desafio-indicium_dw_adventure_works".
2021-05-26 22:47:38.174212 (ThreadPoolExecutor-0_0): Creating schema "desafio-indicium.dw_adventure_works".
2021-05-26 22:47:38.174212 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-05-26 22:47:38.182562 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 22:47:39.733089 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-26 22:47:39.733089 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-26 22:47:39.741382 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 22:47:41.495000 (MainThread): 19:47:41 | Concurrency: 1 threads (target='dev')
2021-05-26 22:47:41.496023 (MainThread): 19:47:41 | 
2021-05-26 22:47:41.502016 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-26 22:47:41.503013 (Thread-1): 19:47:41 | 1 of 1 START view model dw_adventure_works.stg_orders................ [RUN]
2021-05-26 22:47:41.504007 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:47:41.505008 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-26 22:47:41.514978 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:47:41.516975 (Thread-1): finished collecting timing info
2021-05-26 22:47:41.613747 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:47:41.615513 (Thread-1): Opening a new connection, currently in state init
2021-05-26 22:47:41.626526 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-26 22:47:44.205566 (Thread-1): finished collecting timing info
2021-05-26 22:47:44.206530 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72373b96-47e7-45f4-bd32-fa01d0728976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD34BEC8>]}
2021-05-26 22:47:44.207527 (Thread-1): 19:47:44 | 1 of 1 OK created view model dw_adventure_works.stg_orders........... [OK in 2.70s]
2021-05-26 22:47:44.208524 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-26 22:47:44.277530 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:47:44.277530 (MainThread): 19:47:44 | 
2021-05-26 22:47:44.278564 (MainThread): 19:47:44 | Finished running 1 view model in 8.31s.
2021-05-26 22:47:44.279523 (MainThread): Connection 'master' was properly closed.
2021-05-26 22:47:44.279523 (MainThread): Connection 'create_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-26 22:47:44.280524 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-26 22:47:44.280524 (MainThread): Connection 'model.dw_adventure_works.stg_orders' was properly closed.
2021-05-26 22:47:44.281520 (MainThread): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62601), raddr=('142.250.79.202', 443)>
2021-05-26 22:47:44.282514 (MainThread): unclosed <socket.socket fd=1336, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62602), raddr=('172.217.173.74', 443)>
2021-05-26 22:47:44.297491 (MainThread): 
2021-05-26 22:47:44.298473 (MainThread): Completed successfully
2021-05-26 22:47:44.299470 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-26 22:47:44.301465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD34B9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD334988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFAD373888>]}
2021-05-26 22:47:44.302461 (MainThread): Flushing usage events
2021-05-26 22:56:42.794791 (MainThread): Running with dbt=0.19.1
2021-05-26 22:56:43.658973 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 22:56:43.658973 (MainThread): Tracking: tracking
2021-05-26 22:56:43.658973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB4603C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB4604D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB4603B08>]}
2021-05-26 22:56:43.682411 (MainThread): Partial parsing not enabled
2021-05-26 22:56:43.686586 (MainThread): Parsing macros\adapters.sql
2021-05-26 22:56:43.713501 (MainThread): Parsing macros\catalog.sql
2021-05-26 22:56:43.729122 (MainThread): Parsing macros\etc.sql
2021-05-26 22:56:43.745114 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 22:56:43.746242 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 22:56:43.777521 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 22:56:43.777521 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 22:56:43.777521 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 22:56:43.796690 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 22:56:43.812354 (MainThread): Parsing macros\core.sql
2021-05-26 22:56:43.827966 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 22:56:43.912566 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 22:56:43.928223 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 22:56:43.928223 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 22:56:43.943844 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 22:56:43.943844 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 22:56:43.943844 (MainThread): Parsing macros\etc\query.sql
2021-05-26 22:56:43.943844 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 22:56:43.975053 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 22:56:43.997249 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 22:56:43.997249 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 22:56:44.012910 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 22:56:44.059739 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 22:56:44.128843 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 22:56:44.128843 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 22:56:44.175675 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 22:56:44.193351 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 22:56:44.204308 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 22:56:44.214373 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 22:56:44.214373 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 22:56:44.214373 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 22:56:44.230036 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 22:56:44.245618 (MainThread): Partial parsing not enabled
2021-05-26 22:56:44.292518 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-26 22:56:44.313197 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:56:44.475962 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-26 22:56:44.475962 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d2d50d-4904-4326-ae5f-467a7320997a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB817D488>]}
2021-05-26 22:56:44.496801 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d2d50d-4904-4326-ae5f-467a7320997a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB811B0C8>]}
2021-05-26 22:56:44.497796 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-26 22:56:44.499796 (MainThread): 
2021-05-26 22:56:44.502786 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:56:44.508770 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-26 22:56:44.509767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-26 22:56:45.999701 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-26 22:56:45.999701 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-26 22:56:46.006267 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 22:56:46.911281 (MainThread): 19:56:46 | Concurrency: 1 threads (target='dev')
2021-05-26 22:56:46.911281 (MainThread): 19:56:46 | 
2021-05-26 22:56:46.928172 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-26 22:56:46.929169 (Thread-1): 19:56:46 | 1 of 2 START view model dw_adventure_works.stg_orderdetail........... [RUN]
2021-05-26 22:56:46.930169 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-26 22:56:46.930169 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-26 22:56:46.941137 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-26 22:56:46.944128 (Thread-1): finished collecting timing info
2021-05-26 22:56:47.024912 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-26 22:56:47.025994 (Thread-1): Opening a new connection, currently in state init
2021-05-26 22:56:47.038963 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-26 22:56:49.578109 (Thread-1): finished collecting timing info
2021-05-26 22:56:49.578109 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d2d50d-4904-4326-ae5f-467a7320997a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB7F31148>]}
2021-05-26 22:56:49.578109 (Thread-1): 19:56:49 | 1 of 2 OK created view model dw_adventure_works.stg_orderdetail...... [OK in 2.65s]
2021-05-26 22:56:49.578109 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-26 22:56:49.581738 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-26 22:56:49.581738 (Thread-1): 19:56:49 | 2 of 2 START view model dw_adventure_works.stg_orders................ [RUN]
2021-05-26 22:56:49.583734 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 22:56:49.583734 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-26 22:56:49.591727 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:56:49.592706 (Thread-1): finished collecting timing info
2021-05-26 22:56:49.597697 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 22:56:49.599688 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 22:56:49.614660 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-26 22:56:49.617640 (Thread-1): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62710), raddr=('216.58.202.170', 443)>
2021-05-26 22:56:49.618637 (Thread-1): unclosed <socket.socket fd=664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 62711), raddr=('142.250.218.234', 443)>
2021-05-26 22:56:51.902041 (Thread-1): finished collecting timing info
2021-05-26 22:56:51.902041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d2d50d-4904-4326-ae5f-467a7320997a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB8015508>]}
2021-05-26 22:56:51.917482 (Thread-1): 19:56:51 | 2 of 2 OK created view model dw_adventure_works.stg_orders........... [OK in 2.32s]
2021-05-26 22:56:51.917482 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-26 22:56:51.934083 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 22:56:51.935081 (MainThread): 19:56:51 | 
2021-05-26 22:56:51.936075 (MainThread): 19:56:51 | Finished running 2 view models in 7.43s.
2021-05-26 22:56:51.936075 (MainThread): Connection 'master' was properly closed.
2021-05-26 22:56:51.937076 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-26 22:56:51.937076 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-26 22:56:51.937076 (MainThread): Connection 'model.dw_adventure_works.stg_orders' was properly closed.
2021-05-26 22:56:51.955195 (MainThread): 
2021-05-26 22:56:51.956216 (MainThread): Completed successfully
2021-05-26 22:56:51.957213 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-05-26 22:56:51.958209 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB8065DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB8065F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDB801C488>]}
2021-05-26 22:56:51.959208 (MainThread): Flushing usage events
2021-05-26 23:36:37.892057 (MainThread): Running with dbt=0.19.1
2021-05-26 23:36:38.926904 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-26 23:36:38.926904 (MainThread): Tracking: tracking
2021-05-26 23:36:38.926904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C026F0508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C027F5D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C027F5CC8>]}
2021-05-26 23:36:38.958116 (MainThread): Partial parsing not enabled
2021-05-26 23:36:38.962123 (MainThread): Parsing macros\adapters.sql
2021-05-26 23:36:38.993373 (MainThread): Parsing macros\catalog.sql
2021-05-26 23:36:39.008996 (MainThread): Parsing macros\etc.sql
2021-05-26 23:36:39.040409 (MainThread): Parsing macros\materializations\copy.sql
2021-05-26 23:36:39.040409 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-26 23:36:39.078030 (MainThread): Parsing macros\materializations\seed.sql
2021-05-26 23:36:39.094208 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-26 23:36:39.094208 (MainThread): Parsing macros\materializations\table.sql
2021-05-26 23:36:39.124894 (MainThread): Parsing macros\materializations\view.sql
2021-05-26 23:36:39.140671 (MainThread): Parsing macros\core.sql
2021-05-26 23:36:39.156137 (MainThread): Parsing macros\adapters\common.sql
2021-05-26 23:36:39.240759 (MainThread): Parsing macros\etc\datetime.sql
2021-05-26 23:36:39.262925 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-26 23:36:39.262925 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-26 23:36:39.262925 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-26 23:36:39.262925 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-26 23:36:39.278554 (MainThread): Parsing macros\etc\query.sql
2021-05-26 23:36:39.278554 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-26 23:36:39.294177 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-26 23:36:39.325419 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-26 23:36:39.341039 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-26 23:36:39.356660 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-26 23:36:39.401458 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-26 23:36:39.463055 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-26 23:36:39.463055 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-26 23:36:39.512054 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-26 23:36:39.521329 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-26 23:36:39.536987 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-26 23:36:39.552611 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-26 23:36:39.552611 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-26 23:36:39.563160 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-26 23:36:39.563160 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-26 23:36:39.578826 (MainThread): Partial parsing not enabled
2021-05-26 23:36:39.625688 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-26 23:36:39.641311 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-26 23:36:39.641311 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-26 23:36:39.663476 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-26 23:36:39.663476 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-26 23:36:39.679137 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-26 23:36:39.679137 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 23:36:39.694788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-26 23:36:39.694788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-26 23:36:39.710384 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-26 23:36:39.710384 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-26 23:36:39.879442 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-26 23:36:39.897853 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0629F408>]}
2021-05-26 23:36:39.921789 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C06392E08>]}
2021-05-26 23:36:39.922789 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-26 23:36:39.929858 (MainThread): 
2021-05-26 23:36:39.931841 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 23:36:39.935831 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-26 23:36:39.935831 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-26 23:36:41.450690 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-26 23:36:41.450690 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-26 23:36:41.450690 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-26 23:36:42.880591 (MainThread): 20:36:42 | Concurrency: 1 threads (target='dev')
2021-05-26 23:36:42.880591 (MainThread): 20:36:42 | 
2021-05-26 23:36:42.896155 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-26 23:36:42.896155 (Thread-1): 20:36:42 | 1 of 11 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-26 23:36:42.896155 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-26 23:36:42.896155 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-26 23:36:42.911419 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-26 23:36:42.915363 (Thread-1): finished collecting timing info
2021-05-26 23:36:42.998139 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-26 23:36:43.000127 (Thread-1): Opening a new connection, currently in state init
2021-05-26 23:36:43.010338 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-26 23:36:46.080847 (Thread-1): finished collecting timing info
2021-05-26 23:36:46.080847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C06294188>]}
2021-05-26 23:36:46.080847 (Thread-1): 20:36:46 | 1 of 11 OK created view model dw_adventure_works.stg_address......... [OK in 3.18s]
2021-05-26 23:36:46.096474 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-26 23:36:46.097958 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-26 23:36:46.097958 (Thread-1): 20:36:46 | 2 of 11 START view model dw_adventure_works.stg_countryregion........ [RUN]
2021-05-26 23:36:46.098954 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-26 23:36:46.099949 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-26 23:36:46.100981 (Thread-1): unclosed <socket.socket fd=748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63229), raddr=('172.217.28.234', 443)>
2021-05-26 23:36:46.101982 (Thread-1): unclosed <socket.socket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63230), raddr=('142.250.218.234', 443)>
2021-05-26 23:36:46.108959 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-26 23:36:46.111931 (Thread-1): finished collecting timing info
2021-05-26 23:36:46.116907 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-26 23:36:46.119896 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:46.136851 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-26 23:36:48.489758 (Thread-1): finished collecting timing info
2021-05-26 23:36:48.489758 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C064F6388>]}
2021-05-26 23:36:48.505378 (Thread-1): 20:36:48 | 2 of 11 OK created view model dw_adventure_works.stg_countryregion... [OK in 2.39s]
2021-05-26 23:36:48.507946 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-26 23:36:48.511546 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-26 23:36:48.512543 (Thread-1): 20:36:48 | 3 of 11 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-26 23:36:48.515530 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-26 23:36:48.515530 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-26 23:36:48.524502 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-26 23:36:48.526497 (Thread-1): finished collecting timing info
2021-05-26 23:36:48.532479 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-26 23:36:48.533476 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:48.546443 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-26 23:36:48.809030 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63232), raddr=('142.250.218.234', 443)>
2021-05-26 23:36:48.809030 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63231), raddr=('172.217.28.234', 443)>
2021-05-26 23:36:51.013027 (Thread-1): finished collecting timing info
2021-05-26 23:36:51.013027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C06534E08>]}
2021-05-26 23:36:51.013027 (Thread-1): 20:36:51 | 3 of 11 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.50s]
2021-05-26 23:36:51.019545 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-26 23:36:51.024956 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-26 23:36:51.026949 (Thread-1): 20:36:51 | 4 of 11 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-26 23:36:51.028938 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-26 23:36:51.028938 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-26 23:36:51.084789 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63233), raddr=('172.217.28.234', 443)>
2021-05-26 23:36:51.085787 (Thread-1): unclosed <socket.socket fd=368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63234), raddr=('142.250.218.234', 443)>
2021-05-26 23:36:51.093786 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-26 23:36:51.095762 (Thread-1): finished collecting timing info
2021-05-26 23:36:51.099751 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-26 23:36:51.101746 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:51.112750 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-26 23:36:53.480042 (Thread-1): finished collecting timing info
2021-05-26 23:36:53.480042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05E74888>]}
2021-05-26 23:36:53.480042 (Thread-1): 20:36:53 | 4 of 11 OK created view model dw_adventure_works.stg_customer........ [OK in 2.45s]
2021-05-26 23:36:53.480042 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-26 23:36:53.486183 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-26 23:36:53.486183 (Thread-1): 20:36:53 | 5 of 11 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-26 23:36:53.488179 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-26 23:36:53.488179 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-26 23:36:53.493165 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-26 23:36:53.497154 (Thread-1): finished collecting timing info
2021-05-26 23:36:53.503138 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-26 23:36:53.505133 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:53.517099 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-26 23:36:55.889989 (Thread-1): finished collecting timing info
2021-05-26 23:36:55.889989 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C027ABE48>]}
2021-05-26 23:36:55.905133 (Thread-1): 20:36:55 | 5 of 11 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.40s]
2021-05-26 23:36:55.905133 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-26 23:36:55.907290 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-26 23:36:55.908321 (Thread-1): 20:36:55 | 6 of 11 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-26 23:36:55.909286 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-26 23:36:55.909286 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-26 23:36:55.916305 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-26 23:36:55.917453 (Thread-1): finished collecting timing info
2021-05-26 23:36:55.922445 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-26 23:36:55.924441 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:55.938411 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-26 23:36:58.281306 (Thread-1): finished collecting timing info
2021-05-26 23:36:58.281306 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C06267788>]}
2021-05-26 23:36:58.281306 (Thread-1): 20:36:58 | 6 of 11 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.37s]
2021-05-26 23:36:58.296879 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-26 23:36:58.298358 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-26 23:36:58.299365 (Thread-1): 20:36:58 | 7 of 11 START view model dw_adventure_works.stg_orders............... [RUN]
2021-05-26 23:36:58.301347 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-26 23:36:58.301347 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-26 23:36:58.309327 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 23:36:58.311319 (Thread-1): finished collecting timing info
2021-05-26 23:36:58.316306 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-26 23:36:58.319298 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:36:58.331265 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-26 23:37:00.678458 (Thread-1): finished collecting timing info
2021-05-26 23:37:00.678458 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C027DA648>]}
2021-05-26 23:37:00.678458 (Thread-1): 20:37:00 | 7 of 11 OK created view model dw_adventure_works.stg_orders.......... [OK in 2.38s]
2021-05-26 23:37:00.678458 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-26 23:37:00.693379 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-26 23:37:00.694375 (Thread-1): 20:37:00 | 8 of 11 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-26 23:37:00.695371 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-26 23:37:00.696370 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-26 23:37:00.698364 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63241), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:00.698364 (Thread-1): unclosed <socket.socket fd=760, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63242), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:00.706381 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-26 23:37:00.710332 (Thread-1): finished collecting timing info
2021-05-26 23:37:00.716317 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-26 23:37:00.718311 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:37:00.733270 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-26 23:37:02.619174 (Thread-1): finished collecting timing info
2021-05-26 23:37:02.619174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C06416288>]}
2021-05-26 23:37:02.619174 (Thread-1): 20:37:02 | 8 of 11 OK created view model dw_adventure_works.stg_person.......... [OK in 1.92s]
2021-05-26 23:37:02.634316 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-26 23:37:02.634837 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-26 23:37:02.634837 (Thread-1): 20:37:02 | 9 of 11 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-26 23:37:02.636834 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-26 23:37:02.636834 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-26 23:37:02.643843 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-26 23:37:02.645808 (Thread-1): finished collecting timing info
2021-05-26 23:37:02.647802 (Thread-1): unclosed <socket.socket fd=772, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63235), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:02.647802 (Thread-1): unclosed <socket.socket fd=368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63236), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:02.648800 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63237), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:02.648800 (Thread-1): unclosed <socket.socket fd=1348, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63238), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:02.649801 (Thread-1): unclosed <socket.socket fd=1380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63240), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:02.649801 (Thread-1): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63239), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:02.652791 (Thread-1): unclosed <socket.socket fd=736, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63244), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:02.653788 (Thread-1): unclosed <socket.socket fd=1412, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63243), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:02.658774 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-26 23:37:02.661765 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:37:02.672771 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-26 23:37:04.952248 (Thread-1): finished collecting timing info
2021-05-26 23:37:04.952248 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07610F08>]}
2021-05-26 23:37:04.952248 (Thread-1): 20:37:04 | 9 of 11 OK created view model dw_adventure_works.stg_product......... [OK in 2.32s]
2021-05-26 23:37:04.968725 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-26 23:37:04.968725 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-26 23:37:04.973026 (Thread-1): 20:37:04 | 10 of 11 START view model dw_adventure_works.stg_salesreason......... [RUN]
2021-05-26 23:37:04.974025 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-26 23:37:04.975059 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-26 23:37:04.978833 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-26 23:37:04.978833 (Thread-1): finished collecting timing info
2021-05-26 23:37:04.978833 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-26 23:37:04.978833 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:37:05.000021 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-26 23:37:07.359477 (Thread-1): finished collecting timing info
2021-05-26 23:37:07.374627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0764FE88>]}
2021-05-26 23:37:07.374627 (Thread-1): 20:37:07 | 10 of 11 OK created view model dw_adventure_works.stg_salesreason.... [OK in 2.40s]
2021-05-26 23:37:07.374627 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-26 23:37:07.381696 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-26 23:37:07.383689 (Thread-1): 20:37:07 | 11 of 11 START view model dw_adventure_works.stg_stateprovince....... [RUN]
2021-05-26 23:37:07.385683 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-26 23:37:07.386683 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-26 23:37:07.388712 (Thread-1): unclosed <socket.socket fd=1448, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63247), raddr=('172.217.28.234', 443)>
2021-05-26 23:37:07.389673 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63248), raddr=('142.250.218.234', 443)>
2021-05-26 23:37:07.395692 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-26 23:37:07.396688 (Thread-1): finished collecting timing info
2021-05-26 23:37:07.401640 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-26 23:37:07.402635 (Thread-1): Opening a new connection, currently in state closed
2021-05-26 23:37:07.416601 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-26 23:37:09.775590 (Thread-1): finished collecting timing info
2021-05-26 23:37:09.777584 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3495afaf-b79f-4437-82fa-1eaa176b59dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07625088>]}
2021-05-26 23:37:09.778583 (Thread-1): 20:37:09 | 11 of 11 OK created view model dw_adventure_works.stg_stateprovince.. [OK in 2.39s]
2021-05-26 23:37:09.780576 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-26 23:37:09.803139 (MainThread): Acquiring new bigquery connection "master".
2021-05-26 23:37:09.803139 (MainThread): 20:37:09 | 
2021-05-26 23:37:09.804133 (MainThread): 20:37:09 | Finished running 11 view models in 29.87s.
2021-05-26 23:37:09.808137 (MainThread): Connection 'master' was properly closed.
2021-05-26 23:37:09.809118 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-26 23:37:09.809118 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-26 23:37:09.809118 (MainThread): Connection 'model.dw_adventure_works.stg_stateprovince' was properly closed.
2021-05-26 23:37:09.820088 (MainThread): 
2021-05-26 23:37:09.821127 (MainThread): Completed successfully
2021-05-26 23:37:09.825091 (MainThread): 
Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
2021-05-26 23:37:09.827069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05E74D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05E74B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C05EFAE08>]}
2021-05-26 23:37:09.827069 (MainThread): Flushing usage events
2021-05-29 13:10:33.659794 (MainThread): Running with dbt=0.19.1
2021-05-29 13:10:35.710622 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:10:35.713615 (MainThread): Tracking: tracking
2021-05-29 13:10:35.714611 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173884E1748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173884F6E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173884F3108>]}
2021-05-29 13:10:35.737550 (MainThread): Partial parsing not enabled
2021-05-29 13:10:35.741539 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:10:35.788074 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:10:35.801014 (MainThread): Parsing macros\etc.sql
2021-05-29 13:10:35.806824 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:10:35.817451 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:10:35.843592 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:10:35.853445 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:10:35.859282 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:10:35.887233 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:10:35.929341 (MainThread): Parsing macros\core.sql
2021-05-29 13:10:35.957980 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:10:36.100118 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:10:36.131113 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:10:36.135099 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:10:36.142658 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:10:36.150474 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:10:36.156455 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:10:36.160625 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:10:36.190542 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:10:36.228449 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:10:36.244115 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:10:36.270043 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:10:36.367776 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:10:36.527951 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:10:36.536083 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:10:36.596628 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:10:36.619694 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:10:36.640410 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:10:36.663856 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:10:36.674819 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:10:36.683992 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:10:36.692277 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:10:36.713607 (MainThread): Partial parsing not enabled
2021-05-29 13:10:36.780673 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:10:36.802613 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:10:36.811590 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:10:36.820565 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:10:36.831536 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:10:36.850485 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:10:36.862133 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:10:36.875561 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:10:36.887928 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:10:36.899468 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:10:36.911437 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:10:36.922447 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_adress".
2021-05-29 13:10:36.935735 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:10:36.945140 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:10:36.958823 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:10:36.975778 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:10:36.987826 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 13:10:37.361485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738BF54488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738BF54A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001738C093108>]}
2021-05-29 13:10:37.362482 (MainThread): Flushing usage events
2021-05-29 13:10:38.409848 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 13:10:38.410841 (MainThread): Encountered an error:
2021-05-29 13:10:38.412004 (MainThread): Compilation Error in model dim_adress (models\marts\dim_adress.sql)
  Model 'model.dw_adventure_works.dim_adress' (models\marts\dim_adress.sql) depends on a node named 'stg_adress' which was not found
2021-05-29 13:10:38.443758 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model dim_adress (models\marts\dim_adress.sql)
  Model 'model.dw_adventure_works.dim_adress' (models\marts\dim_adress.sql) depends on a node named 'stg_adress' which was not found

2021-05-29 13:11:20.063954 (MainThread): Running with dbt=0.19.1
2021-05-29 13:11:21.259519 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:11:21.265213 (MainThread): Tracking: tracking
2021-05-29 13:11:21.267632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE7E8B6DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE023B0E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE023B0D88>]}
2021-05-29 13:11:21.294571 (MainThread): Partial parsing not enabled
2021-05-29 13:11:21.299798 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:11:21.354615 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:11:21.371568 (MainThread): Parsing macros\etc.sql
2021-05-29 13:11:21.378045 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:11:21.391158 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:11:21.424177 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:11:21.433084 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:11:21.439365 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:11:21.470189 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:11:21.485225 (MainThread): Parsing macros\core.sql
2021-05-29 13:11:21.497148 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:11:21.625845 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:11:21.649788 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:11:21.654734 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:11:21.659718 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:11:21.665702 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:11:21.670688 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:11:21.673680 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:11:21.694625 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:11:21.724515 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:11:21.729150 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:11:21.744347 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:11:21.790816 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:11:21.862905 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:11:21.866893 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:11:21.919015 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:11:21.933963 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:11:21.947028 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:11:21.962043 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:11:21.968325 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:11:21.972113 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:11:21.976542 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:11:21.995610 (MainThread): Partial parsing not enabled
2021-05-29 13:11:22.055306 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:11:22.081391 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:11:22.091366 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:11:22.101958 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:11:22.112811 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:11:22.122587 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:11:22.133993 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:11:22.144724 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:11:22.156196 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:11:22.168167 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:11:22.178672 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:11:22.189677 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:11:22.199354 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:11:22.210330 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:11:22.221295 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:11:22.231509 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:11:22.241997 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 13:11:22.619429 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE027C5DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE027C5E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE026EFEC8>]}
2021-05-29 13:11:22.619429 (MainThread): Flushing usage events
2021-05-29 13:11:23.445011 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 13:11:23.445011 (MainThread): Encountered an error:
2021-05-29 13:11:23.447005 (MainThread): Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.dw_adventure_works.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_customers' which was not found
2021-05-29 13:11:23.474934 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.dw_adventure_works.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_customers' which was not found

2021-05-29 13:11:45.641044 (MainThread): Running with dbt=0.19.1
2021-05-29 13:11:46.797515 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:11:46.798513 (MainThread): Tracking: tracking
2021-05-29 13:11:46.799514 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001152CB20548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001152EC7D888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001152CC25C88>]}
2021-05-29 13:11:46.826831 (MainThread): Partial parsing not enabled
2021-05-29 13:11:46.830665 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:11:46.889941 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:11:46.906901 (MainThread): Parsing macros\etc.sql
2021-05-29 13:11:46.913001 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:11:46.924627 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:11:46.966103 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:11:46.974240 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:11:46.979706 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:11:47.005708 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:11:47.019686 (MainThread): Parsing macros\core.sql
2021-05-29 13:11:47.030582 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:11:47.147292 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:11:47.171414 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:11:47.174619 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:11:47.179610 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:11:47.185844 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:11:47.191013 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:11:47.194536 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:11:47.218984 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:11:47.257992 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:11:47.263894 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:11:47.281603 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:11:47.337402 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:11:47.425319 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:11:47.430933 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:11:47.481525 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:11:47.500387 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:11:47.516506 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:11:47.534302 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:11:47.542302 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:11:47.547297 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:11:47.553262 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:11:47.573227 (MainThread): Partial parsing not enabled
2021-05-29 13:11:47.639270 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:11:47.667229 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:11:47.677165 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:11:47.686789 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:11:47.699048 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:11:47.709628 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:11:47.718303 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:11:47.728462 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:11:47.738181 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:11:47.749506 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:11:47.760427 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:11:47.770713 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:11:47.781325 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:11:47.790300 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:11:47.805687 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:11:47.815624 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:11:47.825630 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 13:11:48.245148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115308E1788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115306CD948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000115307FEE08>]}
2021-05-29 13:11:48.245148 (MainThread): Flushing usage events
2021-05-29 13:11:50.132884 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 13:11:50.133883 (MainThread): Encountered an error:
2021-05-29 13:11:50.135880 (MainThread): Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.dw_adventure_works.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_customers' which was not found
2021-05-29 13:11:50.161749 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 388, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 758, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 742, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 487, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 566, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model fact_order_details (models\marts\fact_order_details.sql)
  Model 'model.dw_adventure_works.fact_order_details' (models\marts\fact_order_details.sql) depends on a node named 'dim_customers' which was not found

2021-05-29 13:13:16.749014 (MainThread): Running with dbt=0.19.1
2021-05-29 13:13:17.726079 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:13:17.727127 (MainThread): Tracking: tracking
2021-05-29 13:13:17.728195 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D693FA6E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D692052EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D692052E08>]}
2021-05-29 13:13:17.764447 (MainThread): Partial parsing not enabled
2021-05-29 13:13:17.771413 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:13:17.835254 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:13:17.852434 (MainThread): Parsing macros\etc.sql
2021-05-29 13:13:17.858057 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:13:17.870459 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:13:17.907477 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:13:17.916761 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:13:17.922022 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:13:17.955813 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:13:17.971705 (MainThread): Parsing macros\core.sql
2021-05-29 13:13:17.984858 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:13:18.117577 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:13:18.144562 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:13:18.148553 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:13:18.154718 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:13:18.160527 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:13:18.168513 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:13:18.171504 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:13:18.200436 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:13:18.246869 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:13:18.253195 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:13:18.274065 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:13:18.330830 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:13:18.429877 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:13:18.436816 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:13:18.483849 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:13:18.503069 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:13:18.518151 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:13:18.536054 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:13:18.543487 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:13:18.548511 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:13:18.554716 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:13:18.573708 (MainThread): Partial parsing not enabled
2021-05-29 13:13:18.644401 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:13:18.667340 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:13:18.675313 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:13:18.682295 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:13:18.690658 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:13:18.698637 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:13:18.706070 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:13:18.714048 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:13:18.722135 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:13:18.731141 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:13:18.739120 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:13:18.747099 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:13:18.755052 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:13:18.765052 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:13:18.772997 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:13:18.781009 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:13:19.071338 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:13:19.079195 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695D27F88>]}
2021-05-29 13:13:19.110960 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695D4E888>]}
2021-05-29 13:13:19.112965 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:13:19.119974 (MainThread): 
2021-05-29 13:13:19.121934 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:13:19.135895 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:13:19.136645 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:13:20.857075 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:13:20.858076 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:13:20.884040 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:13:22.383007 (MainThread): 10:13:22 | Concurrency: 1 threads (target='dev')
2021-05-29 13:13:22.385886 (MainThread): 10:13:22 | 
2021-05-29 13:13:22.407940 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 13:13:22.409934 (Thread-1): 10:13:22 | 1 of 16 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 13:13:22.413927 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:13:22.415920 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 13:13:22.456054 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:13:22.469133 (Thread-1): finished collecting timing info
2021-05-29 13:13:22.632997 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:13:22.636289 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:13:22.648864 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 13:13:25.792063 (Thread-1): finished collecting timing info
2021-05-29 13:13:25.794047 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D693FAEB88>]}
2021-05-29 13:13:25.796042 (Thread-1): 10:13:25 | 1 of 16 OK created view model dw_adventure_works.stg_person.......... [OK in 3.38s]
2021-05-29 13:13:25.799988 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 13:13:25.802054 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 13:13:25.805969 (Thread-1): 10:13:25 | 2 of 16 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 13:13:25.810956 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:13:25.812958 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 13:13:25.846277 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:13:25.852889 (Thread-1): finished collecting timing info
2021-05-29 13:13:25.881773 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:13:25.889748 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:25.926658 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 13:13:27.826443 (Thread-1): finished collecting timing info
2021-05-29 13:13:27.828437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D69209FA48>]}
2021-05-29 13:13:27.830431 (Thread-1): 10:13:27 | 2 of 16 OK created view model dw_adventure_works.stg_address......... [OK in 2.02s]
2021-05-29 13:13:27.835374 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 13:13:27.836555 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:13:27.840465 (Thread-1): 10:13:27 | 3 of 16 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 13:13:27.845570 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:13:27.846354 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 13:13:27.850339 (Thread-1): unclosed <socket.socket fd=380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60261), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:27.853324 (Thread-1): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60262), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:27.882360 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:13:27.891334 (Thread-1): finished collecting timing info
2021-05-29 13:13:27.918264 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:13:27.926266 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:27.978631 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 13:13:29.977830 (Thread-1): finished collecting timing info
2021-05-29 13:13:29.981819 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695BFF708>]}
2021-05-29 13:13:29.984813 (Thread-1): 10:13:29 | 3 of 16 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.14s]
2021-05-29 13:13:29.989898 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:13:29.991789 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 13:13:29.994784 (Thread-1): 10:13:29 | 4 of 16 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 13:13:30.000029 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:13:30.000770 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 13:13:30.039666 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:13:30.046761 (Thread-1): finished collecting timing info
2021-05-29 13:13:30.090857 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:13:30.102823 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:30.122331 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 13:13:30.349890 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60259), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:30.350889 (Thread-1): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60260), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:30.360860 (Thread-1): unclosed <socket.socket fd=380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60264), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:30.362857 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60263), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:32.635240 (Thread-1): finished collecting timing info
2021-05-29 13:13:32.637235 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695ABEC08>]}
2021-05-29 13:13:32.640229 (Thread-1): 10:13:32 | 4 of 16 OK created view model dw_adventure_works.stg_customer........ [OK in 2.64s]
2021-05-29 13:13:32.644216 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 13:13:32.646212 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 13:13:32.650200 (Thread-1): 10:13:32 | 5 of 16 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 13:13:32.655190 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:13:32.656184 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 13:13:32.687104 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:13:32.693229 (Thread-1): finished collecting timing info
2021-05-29 13:13:32.721010 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:13:32.728990 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:32.768886 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 13:13:35.285962 (Thread-1): finished collecting timing info
2021-05-29 13:13:35.287958 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695B37408>]}
2021-05-29 13:13:35.289952 (Thread-1): 10:13:35 | 5 of 16 OK created view model dw_adventure_works.stg_product......... [OK in 2.63s]
2021-05-29 13:13:35.294937 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 13:13:35.296594 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:13:35.300491 (Thread-1): 10:13:35 | 6 of 16 START view model dw_adventure_works.stg_countryregion........ [RUN]
2021-05-29 13:13:35.304480 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:13:35.305479 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 13:13:35.310466 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60267), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:35.312460 (Thread-1): unclosed <socket.socket fd=872, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60268), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:35.337391 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:13:35.343373 (Thread-1): finished collecting timing info
2021-05-29 13:13:35.389263 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:13:35.396610 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:35.436519 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 13:13:38.051612 (Thread-1): finished collecting timing info
2021-05-29 13:13:38.053597 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695CFD448>]}
2021-05-29 13:13:38.055593 (Thread-1): 10:13:38 | 6 of 16 OK created view model dw_adventure_works.stg_countryregion... [OK in 2.75s]
2021-05-29 13:13:38.060582 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:13:38.062576 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:13:38.065739 (Thread-1): 10:13:38 | 7 of 16 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 13:13:38.069565 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:13:38.071559 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 13:13:38.095498 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:13:38.100695 (Thread-1): finished collecting timing info
2021-05-29 13:13:38.122415 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:13:38.134714 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:38.177311 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 13:13:40.024829 (Thread-1): finished collecting timing info
2021-05-29 13:13:40.026823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695B50A88>]}
2021-05-29 13:13:40.028819 (Thread-1): 10:13:40 | 7 of 16 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 1.96s]
2021-05-29 13:13:40.032804 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:13:40.035210 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:13:40.037842 (Thread-1): 10:13:40 | 8 of 16 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 13:13:40.041794 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:13:40.042816 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:13:40.074696 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:13:40.081674 (Thread-1): finished collecting timing info
2021-05-29 13:13:40.102628 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:13:40.109608 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:40.178414 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 13:13:42.867334 (Thread-1): finished collecting timing info
2021-05-29 13:13:42.870336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695CF10C8>]}
2021-05-29 13:13:42.872330 (Thread-1): 10:13:42 | 8 of 16 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.83s]
2021-05-29 13:13:42.876497 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:13:42.878409 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 13:13:42.881307 (Thread-1): 10:13:42 | 9 of 16 START view model dw_adventure_works.stg_orders............... [RUN]
2021-05-29 13:13:42.885288 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:13:42.887088 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 13:13:42.912771 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:13:42.919193 (Thread-1): finished collecting timing info
2021-05-29 13:13:42.944309 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:13:42.952347 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:42.991141 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 13:13:45.532354 (Thread-1): finished collecting timing info
2021-05-29 13:13:45.534350 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695C6E488>]}
2021-05-29 13:13:45.537344 (Thread-1): 10:13:45 | 9 of 16 OK created view model dw_adventure_works.stg_orders.......... [OK in 2.65s]
2021-05-29 13:13:45.541287 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 13:13:45.543285 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:13:45.545281 (Thread-1): 10:13:45 | 10 of 16 START view model dw_adventure_works.stg_salesreason......... [RUN]
2021-05-29 13:13:45.550270 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:13:45.551267 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 13:13:45.597747 (Thread-1): unclosed <socket.socket fd=724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60269), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:45.598739 (Thread-1): unclosed <socket.socket fd=640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60270), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:45.603685 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60271), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:45.607675 (Thread-1): unclosed <socket.socket fd=1360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60272), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:45.610664 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60273), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:45.615651 (Thread-1): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60274), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:45.618658 (Thread-1): unclosed <socket.socket fd=1368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60275), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:45.620636 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60276), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:45.635599 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:13:45.640125 (Thread-1): finished collecting timing info
2021-05-29 13:13:45.659123 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:13:45.665055 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:45.696207 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 13:13:47.696509 (Thread-1): finished collecting timing info
2021-05-29 13:13:47.699502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695C99FC8>]}
2021-05-29 13:13:47.700499 (Thread-1): 10:13:47 | 10 of 16 OK created view model dw_adventure_works.stg_salesreason.... [OK in 2.15s]
2021-05-29 13:13:47.705775 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:13:47.707403 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:13:47.710344 (Thread-1): 10:13:47 | 11 of 16 START view model dw_adventure_works.stg_stateprovince....... [RUN]
2021-05-29 13:13:47.714289 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:13:47.716284 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 13:13:47.722268 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60278), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:47.726262 (Thread-1): unclosed <socket.socket fd=1368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60279), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:47.747200 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:13:47.752190 (Thread-1): finished collecting timing info
2021-05-29 13:13:47.787097 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:13:47.798073 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:47.831974 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 13:13:49.671836 (Thread-1): finished collecting timing info
2021-05-29 13:13:49.674827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695CA4A48>]}
2021-05-29 13:13:49.677819 (Thread-1): 10:13:49 | 11 of 16 OK created view model dw_adventure_works.stg_stateprovince.. [OK in 1.96s]
2021-05-29 13:13:49.682809 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:13:49.683883 (Thread-1): Began running node model.dw_adventure_works.dim_person
2021-05-29 13:13:49.685887 (Thread-1): 10:13:49 | 12 of 16 START view model dw_adventure_works.dim_person.............. [RUN]
2021-05-29 13:13:49.692322 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:13:49.693868 (Thread-1): Compiling model.dw_adventure_works.dim_person
2021-05-29 13:13:49.697856 (Thread-1): unclosed <socket.socket fd=1196, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60281), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:49.699854 (Thread-1): unclosed <socket.socket fd=704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60282), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:49.729771 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:13:49.752712 (Thread-1): finished collecting timing info
2021-05-29 13:13:49.782629 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:13:49.791740 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:49.823574 (Thread-1): On model.dw_adventure_works.dim_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_person`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion
        from `desafio-indicium`.`dw_adventure_works`.`stg_person`
    )

    , transformed as (
        select
        row_number() over (order by businessentityid) as person_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:13:52.390548 (Thread-1): finished collecting timing info
2021-05-29 13:13:52.393542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695BBDFC8>]}
2021-05-29 13:13:52.395536 (Thread-1): 10:13:52 | 12 of 16 OK created view model dw_adventure_works.dim_person......... [OK in 2.70s]
2021-05-29 13:13:52.399673 (Thread-1): Finished running node model.dw_adventure_works.dim_person
2021-05-29 13:13:52.401530 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:13:52.404512 (Thread-1): 10:13:52 | 13 of 16 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 13:13:52.408504 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:13:52.410495 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:13:52.432077 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:13:52.438420 (Thread-1): finished collecting timing info
2021-05-29 13:13:52.462357 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:13:52.472335 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:52.515535 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as adress_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:13:54.443716 (Thread-1): finished collecting timing info
2021-05-29 13:13:54.445710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695BD9608>]}
2021-05-29 13:13:54.447706 (Thread-1): 10:13:54 | 13 of 16 OK created view model dw_adventure_works.dim_address........ [OK in 2.04s]
2021-05-29 13:13:54.452759 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:13:54.453852 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:13:54.457188 (Thread-1): 10:13:54 | 14 of 16 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 13:13:54.461735 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:13:54.462961 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 13:13:54.487666 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:13:54.495645 (Thread-1): finished collecting timing info
2021-05-29 13:13:54.522571 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:13:54.528556 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:54.586024 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:13:56.797138 (Thread-1): finished collecting timing info
2021-05-29 13:13:56.800130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695AF11C8>]}
2021-05-29 13:13:56.802129 (Thread-1): 10:13:56 | 14 of 16 OK created view model dw_adventure_works.dim_creditcard..... [OK in 2.34s]
2021-05-29 13:13:56.807106 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:13:56.808794 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 13:13:56.811093 (Thread-1): 10:13:56 | 15 of 16 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 13:13:56.815079 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:13:56.816272 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 13:13:56.845999 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:13:56.860960 (Thread-1): finished collecting timing info
2021-05-29 13:13:56.888895 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:13:56.898859 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:13:56.964683 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.costumerid=person.businessentityid
    )

    select * from transformed;


2021-05-29 13:13:56.996598 (Thread-1): unclosed <socket.socket fd=1472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60283), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:56.997597 (Thread-1): unclosed <socket.socket fd=1492, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60284), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:56.998600 (Thread-1): unclosed <socket.socket fd=1524, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60285), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:57.000591 (Thread-1): unclosed <socket.socket fd=1540, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60286), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:57.001592 (Thread-1): unclosed <socket.socket fd=1568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60287), raddr=('142.250.79.202', 443)>
2021-05-29 13:13:57.002589 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60288), raddr=('216.58.202.138', 443)>
2021-05-29 13:13:58.899936 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/51462a90-44d5-422a-acad-2e24b2ee1fb7?maxResults=0&location=US&prettyPrint=false: Name costumerid not found inside customer at [55:38]')
2021-05-29 13:14:00.779716 (Thread-1): finished collecting timing info
2021-05-29 13:14:00.781760 (Thread-1): Database Error in model dim_customer (models\marts\dim_customer.sql)
  Name costumerid not found inside customer at [55:38]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/9964aa81-2423-4b79-ae6c-6b567a2eb14e?maxResults=0&location=US&prettyPrint=false: Name costumerid not found inside customer at [55:38]

(job ID: 9964aa81-2423-4b79-ae6c-6b567a2eb14e)

                                                               -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
   5:  OPTIONS()
   6:  as with
   7:    person as (
   8:            select
   9:                /*Primary Key*/
  10:                businessentityid
  11:
  12:               /*Other Columns*/
  13:                , title
  14:                , suffix
  15:                , rowguid
  16:                , persontype
  17:                , namestyle
  18:                , modifieddate
  19:                , middlename
  20:                , lastname
  21:                , firstname
  22:                , emailpromotion
  23:            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
  24:        )
  25:
  26:    , customer as (
  27:        select
  28:          /*Primary Key*/
  29:            customerid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , storeid
  34:            , personid
  35:
  36:           /*Other Columns*/
  37:            , rowguid
  38:            , modifieddate
  39:        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  40:    )
  41:
  42:    , transformed as (
  43:        select
  44:        row_number() over (order by customerid) as customer_sk
  45:        , customer.customerid
  46:        , customer.territoryid
  47:        , customer.storeid
  48:        , customer.personid
  49:        , customer.rowguid
  50:        , customer.modifieddate
  51:        , person.middlename
  52:        , person.lastname
  53:        , person.firstname
  54:        from customer
  55:        left join person on customer.costumerid=person.businessentityid
  56:    )
  57:
  58:    select * from transformed;
  59:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customer (models\marts\dim_customer.sql)
  Name costumerid not found inside customer at [55:38]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
2021-05-29 13:14:00.844126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6959BFCC8>]}
2021-05-29 13:14:00.845124 (Thread-1): 10:14:00 | 15 of 16 ERROR creating view model dw_adventure_works.dim_customer... [ERROR in 4.03s]
2021-05-29 13:14:00.850043 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 13:14:00.851891 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 13:14:00.854895 (Thread-1): 10:14:00 | 16 of 16 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 13:14:00.858876 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:14:00.860869 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 13:14:00.889903 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:14:00.896020 (Thread-1): finished collecting timing info
2021-05-29 13:14:00.924037 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:14:00.929501 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:14:00.970401 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:14:03.472116 (Thread-1): finished collecting timing info
2021-05-29 13:14:03.474112 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6779bd0b-4a64-4a92-a3ea-3fd8cda87e82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D696E3D808>]}
2021-05-29 13:14:03.476106 (Thread-1): 10:14:03 | 16 of 16 OK created view model dw_adventure_works.dim_product........ [OK in 2.62s]
2021-05-29 13:14:03.481047 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 13:14:03.553863 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:14:03.557889 (MainThread): 10:14:03 | 
2021-05-29 13:14:03.560977 (MainThread): 10:14:03 | Finished running 16 view models in 44.44s.
2021-05-29 13:14:03.563882 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:14:03.564828 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:14:03.565824 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:14:03.565824 (MainThread): Connection 'model.dw_adventure_works.dim_product' was properly closed.
2021-05-29 13:14:03.649182 (MainThread): 
2021-05-29 13:14:03.654200 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:14:03.668525 (MainThread): 
2021-05-29 13:14:03.675111 (MainThread): Database Error in model dim_customer (models\marts\dim_customer.sql)
2021-05-29 13:14:03.679101 (MainThread):   Name costumerid not found inside customer at [55:38]
2021-05-29 13:14:03.682091 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
2021-05-29 13:14:03.691068 (MainThread): 
Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
2021-05-29 13:14:03.695058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695A09A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D695A09E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D69204A808>]}
2021-05-29 13:14:03.697052 (MainThread): Flushing usage events
2021-05-29 13:15:27.220943 (MainThread): Running with dbt=0.19.1
2021-05-29 13:15:28.060850 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:15:28.061847 (MainThread): Tracking: tracking
2021-05-29 13:15:28.062845 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDCB2988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDCB5FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDCB5E48>]}
2021-05-29 13:15:28.081901 (MainThread): Partial parsing not enabled
2021-05-29 13:15:28.085274 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:15:28.126047 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:15:28.138573 (MainThread): Parsing macros\etc.sql
2021-05-29 13:15:28.143751 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:15:28.154761 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:15:28.184328 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:15:28.191786 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:15:28.196868 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:15:28.222449 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:15:28.236421 (MainThread): Parsing macros\core.sql
2021-05-29 13:15:28.247289 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:15:28.366974 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:15:28.391726 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:15:28.394728 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:15:28.399980 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:15:28.406152 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:15:28.411144 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:15:28.414881 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:15:28.440170 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:15:28.478233 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:15:28.484895 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:15:28.502761 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:15:28.560607 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:15:28.651828 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:15:28.659829 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:15:28.711521 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:15:28.732375 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:15:28.750388 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:15:28.774426 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:15:28.783466 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:15:28.791363 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:15:28.800444 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:15:28.824457 (MainThread): Partial parsing not enabled
2021-05-29 13:15:28.901492 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:15:28.934404 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:15:28.946918 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:15:28.959951 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:15:28.972958 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:15:28.985896 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:15:28.996855 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:15:29.009621 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:15:29.021787 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:15:29.034788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:15:29.047330 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:15:29.059294 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:15:29.071299 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:15:29.082234 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:15:29.094202 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:15:29.104169 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:15:29.422698 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:15:29.430638 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F19D8F88>]}
2021-05-29 13:15:29.453689 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F17D5FC8>]}
2021-05-29 13:15:29.454238 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:15:29.461251 (MainThread): 
2021-05-29 13:15:29.462253 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:15:29.467239 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:15:29.467239 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:15:31.205695 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:15:31.206707 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:15:31.229636 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:15:32.065865 (MainThread): 10:15:32 | Concurrency: 1 threads (target='dev')
2021-05-29 13:15:32.067857 (MainThread): 10:15:32 | 
2021-05-29 13:15:32.088803 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 13:15:32.091798 (Thread-1): 10:15:32 | 1 of 16 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 13:15:32.095787 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:15:32.097780 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 13:15:32.113737 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:15:32.119718 (Thread-1): finished collecting timing info
2021-05-29 13:15:32.315196 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:15:32.320192 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:15:32.346172 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 13:15:35.628681 (Thread-1): finished collecting timing info
2021-05-29 13:15:35.631624 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDCE4EC8>]}
2021-05-29 13:15:35.632672 (Thread-1): 10:15:35 | 1 of 16 OK created view model dw_adventure_works.stg_person.......... [OK in 3.54s]
2021-05-29 13:15:35.637623 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 13:15:35.638609 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 13:15:35.641652 (Thread-1): 10:15:35 | 2 of 16 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 13:15:35.645597 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:15:35.646583 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 13:15:35.668577 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:15:35.672567 (Thread-1): finished collecting timing info
2021-05-29 13:15:35.685534 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:15:35.689484 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:35.720386 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 13:15:38.113219 (Thread-1): finished collecting timing info
2021-05-29 13:15:38.116211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F0FF9208>]}
2021-05-29 13:15:38.118257 (Thread-1): 10:15:38 | 2 of 16 OK created view model dw_adventure_works.stg_address......... [OK in 2.47s]
2021-05-29 13:15:38.122196 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 13:15:38.124192 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:15:38.128184 (Thread-1): 10:15:38 | 3 of 16 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 13:15:38.132175 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:15:38.133172 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 13:15:38.138160 (Thread-1): unclosed <socket.socket fd=1224, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60311), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:38.140151 (Thread-1): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60312), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:38.162140 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:15:38.167076 (Thread-1): finished collecting timing info
2021-05-29 13:15:38.188030 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:15:38.195013 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:38.238886 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 13:15:40.919352 (Thread-1): finished collecting timing info
2021-05-29 13:15:40.920350 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDC98408>]}
2021-05-29 13:15:40.920350 (Thread-1): 10:15:40 | 3 of 16 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.79s]
2021-05-29 13:15:40.922458 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:15:40.923386 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 13:15:40.924340 (Thread-1): 10:15:40 | 4 of 16 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 13:15:40.926334 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:15:40.926334 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 13:15:40.932322 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:15:40.934312 (Thread-1): finished collecting timing info
2021-05-29 13:15:40.940297 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:15:40.942291 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:40.955255 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 13:15:41.128197 (Thread-1): unclosed <socket.socket fd=896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60309), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:41.128364 (Thread-1): unclosed <socket.socket fd=844, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60310), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:41.133185 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60314), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:41.133185 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60313), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:43.158387 (Thread-1): finished collecting timing info
2021-05-29 13:15:43.159439 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F179DC08>]}
2021-05-29 13:15:43.159439 (Thread-1): 10:15:43 | 4 of 16 OK created view model dw_adventure_works.stg_customer........ [OK in 2.23s]
2021-05-29 13:15:43.169782 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 13:15:43.171666 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 13:15:43.175654 (Thread-1): 10:15:43 | 5 of 16 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 13:15:43.179681 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:15:43.179681 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 13:15:43.188625 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:15:43.191190 (Thread-1): finished collecting timing info
2021-05-29 13:15:43.196690 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:15:43.198682 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:43.213671 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 13:15:45.742613 (Thread-1): finished collecting timing info
2021-05-29 13:15:45.745377 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDD3C4C8>]}
2021-05-29 13:15:45.747373 (Thread-1): 10:15:45 | 5 of 16 OK created view model dw_adventure_works.stg_product......... [OK in 2.57s]
2021-05-29 13:15:45.752800 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 13:15:45.753930 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:15:45.758780 (Thread-1): 10:15:45 | 6 of 16 START view model dw_adventure_works.stg_countryregion........ [RUN]
2021-05-29 13:15:45.763253 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:15:45.763782 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 13:15:45.767761 (Thread-1): unclosed <socket.socket fd=432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60317), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:45.769752 (Thread-1): unclosed <socket.socket fd=436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60318), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:45.796572 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:15:45.802551 (Thread-1): finished collecting timing info
2021-05-29 13:15:45.834464 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:15:45.841445 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:45.878404 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 13:15:48.503645 (Thread-1): finished collecting timing info
2021-05-29 13:15:48.505640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1788688>]}
2021-05-29 13:15:48.506638 (Thread-1): 10:15:48 | 6 of 16 OK created view model dw_adventure_works.stg_countryregion... [OK in 2.74s]
2021-05-29 13:15:48.509627 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:15:48.509627 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:15:48.511623 (Thread-1): 10:15:48 | 7 of 16 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 13:15:48.512622 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:15:48.513620 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 13:15:48.524588 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:15:48.526585 (Thread-1): finished collecting timing info
2021-05-29 13:15:48.537554 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:15:48.539779 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:48.554512 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 13:15:50.553849 (Thread-1): finished collecting timing info
2021-05-29 13:15:50.556843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3EDD72B48>]}
2021-05-29 13:15:50.558839 (Thread-1): 10:15:50 | 7 of 16 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.04s]
2021-05-29 13:15:50.562818 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:15:50.564814 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:15:50.567805 (Thread-1): 10:15:50 | 8 of 16 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 13:15:50.571795 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:15:50.572793 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:15:50.598721 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:15:50.604707 (Thread-1): finished collecting timing info
2021-05-29 13:15:50.632726 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:15:50.637623 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:50.675623 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 13:15:52.807152 (Thread-1): finished collecting timing info
2021-05-29 13:15:52.808149 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F179DC08>]}
2021-05-29 13:15:52.809148 (Thread-1): 10:15:52 | 8 of 16 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.24s]
2021-05-29 13:15:52.811187 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:15:52.812140 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 13:15:52.813139 (Thread-1): 10:15:52 | 9 of 16 START view model dw_adventure_works.stg_orders............... [RUN]
2021-05-29 13:15:52.816693 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:15:52.818688 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 13:15:52.825670 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:15:52.827665 (Thread-1): finished collecting timing info
2021-05-29 13:15:52.835643 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:15:52.838634 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:52.851600 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 13:15:55.471127 (Thread-1): finished collecting timing info
2021-05-29 13:15:55.473123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F18D8A88>]}
2021-05-29 13:15:55.475119 (Thread-1): 10:15:55 | 9 of 16 OK created view model dw_adventure_works.stg_orders.......... [OK in 2.66s]
2021-05-29 13:15:55.480101 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 13:15:55.482091 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:15:55.485130 (Thread-1): 10:15:55 | 10 of 16 START view model dw_adventure_works.stg_salesreason......... [RUN]
2021-05-29 13:15:55.490067 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:15:55.491067 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 13:15:55.525972 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60319), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:55.528966 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60320), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:55.530958 (Thread-1): unclosed <socket.socket fd=1320, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60321), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:55.532956 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60322), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:55.535947 (Thread-1): unclosed <socket.socket fd=1364, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60323), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:55.539937 (Thread-1): unclosed <socket.socket fd=1400, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60324), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:55.541941 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60325), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:55.545099 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60326), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:55.560928 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:15:55.566866 (Thread-1): finished collecting timing info
2021-05-29 13:15:55.583828 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:15:55.587856 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:55.626706 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 13:15:58.448612 (Thread-1): finished collecting timing info
2021-05-29 13:15:58.453603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F18A6548>]}
2021-05-29 13:15:58.455789 (Thread-1): 10:15:58 | 10 of 16 OK created view model dw_adventure_works.stg_salesreason.... [OK in 2.97s]
2021-05-29 13:15:58.467562 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:15:58.469556 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:15:58.473542 (Thread-1): 10:15:58 | 11 of 16 START view model dw_adventure_works.stg_stateprovince....... [RUN]
2021-05-29 13:15:58.478532 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:15:58.480529 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 13:15:58.488506 (Thread-1): unclosed <socket.socket fd=864, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60327), raddr=('172.217.29.10', 443)>
2021-05-29 13:15:58.491506 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60328), raddr=('216.58.202.138', 443)>
2021-05-29 13:15:58.517427 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:15:58.523099 (Thread-1): finished collecting timing info
2021-05-29 13:15:58.559323 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:15:58.562455 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:15:58.586240 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 13:16:00.472167 (Thread-1): finished collecting timing info
2021-05-29 13:16:00.475162 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F192C1C8>]}
2021-05-29 13:16:00.477158 (Thread-1): 10:16:00 | 11 of 16 OK created view model dw_adventure_works.stg_stateprovince.. [OK in 2.00s]
2021-05-29 13:16:00.482144 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:16:00.484139 (Thread-1): Began running node model.dw_adventure_works.dim_person
2021-05-29 13:16:00.486133 (Thread-1): 10:16:00 | 12 of 16 START view model dw_adventure_works.dim_person.............. [RUN]
2021-05-29 13:16:00.492117 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:16:00.493115 (Thread-1): Compiling model.dw_adventure_works.dim_person
2021-05-29 13:16:00.499105 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60329), raddr=('172.217.29.10', 443)>
2021-05-29 13:16:00.502093 (Thread-1): unclosed <socket.socket fd=1456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60330), raddr=('216.58.202.138', 443)>
2021-05-29 13:16:00.536997 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:16:00.544168 (Thread-1): finished collecting timing info
2021-05-29 13:16:00.583026 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:16:00.591344 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:16:00.622982 (Thread-1): On model.dw_adventure_works.dim_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_person`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion
        from `desafio-indicium`.`dw_adventure_works`.`stg_person`
    )

    , transformed as (
        select
        row_number() over (order by businessentityid) as person_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:16:03.355197 (Thread-1): finished collecting timing info
2021-05-29 13:16:03.358187 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1889548>]}
2021-05-29 13:16:03.360182 (Thread-1): 10:16:03 | 12 of 16 OK created view model dw_adventure_works.dim_person......... [OK in 2.87s]
2021-05-29 13:16:03.365171 (Thread-1): Finished running node model.dw_adventure_works.dim_person
2021-05-29 13:16:03.366168 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:16:03.370160 (Thread-1): 10:16:03 | 13 of 16 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 13:16:03.374146 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:16:03.375315 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:16:03.402075 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:16:03.407061 (Thread-1): finished collecting timing info
2021-05-29 13:16:03.430334 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:16:03.435981 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:16:03.477869 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as adress_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:16:06.222730 (Thread-1): finished collecting timing info
2021-05-29 13:16:06.224735 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F16C4B48>]}
2021-05-29 13:16:06.227725 (Thread-1): 10:16:06 | 13 of 16 OK created view model dw_adventure_works.dim_address........ [OK in 2.85s]
2021-05-29 13:16:06.232711 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:16:06.233930 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:16:06.235706 (Thread-1): 10:16:06 | 14 of 16 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 13:16:06.239732 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:16:06.240734 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 13:16:06.263749 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:16:06.269143 (Thread-1): finished collecting timing info
2021-05-29 13:16:06.303855 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:16:06.309625 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:16:06.401539 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:16:08.987063 (Thread-1): finished collecting timing info
2021-05-29 13:16:08.989057 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F170C9C8>]}
2021-05-29 13:16:08.991053 (Thread-1): 10:16:08 | 14 of 16 OK created view model dw_adventure_works.dim_creditcard..... [OK in 2.75s]
2021-05-29 13:16:08.996992 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:16:09.000980 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 13:16:09.003635 (Thread-1): 10:16:09 | 15 of 16 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 13:16:09.008505 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:16:09.009483 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 13:16:09.020922 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:16:09.021921 (Thread-1): finished collecting timing info
2021-05-29 13:16:09.026904 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:16:09.030910 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:16:09.044856 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customer.customerid) as customer.customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid=person.businessentityid
    )

    select * from transformed;


2021-05-29 13:16:09.054831 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60331), raddr=('172.217.29.10', 443)>
2021-05-29 13:16:09.054831 (Thread-1): unclosed <socket.socket fd=1460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60332), raddr=('216.58.202.138', 443)>
2021-05-29 13:16:09.055830 (Thread-1): unclosed <socket.socket fd=1524, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60333), raddr=('172.217.29.10', 443)>
2021-05-29 13:16:09.055830 (Thread-1): unclosed <socket.socket fd=1536, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60334), raddr=('216.58.202.138', 443)>
2021-05-29 13:16:09.055830 (Thread-1): unclosed <socket.socket fd=1544, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60336), raddr=('172.217.29.10', 443)>
2021-05-29 13:16:09.056827 (Thread-1): unclosed <socket.socket fd=1592, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60337), raddr=('216.58.202.138', 443)>
2021-05-29 13:16:10.511822 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/b2d90e7d-edae-4660-b9fa-ebecb4c50be7?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [44:69]')
2021-05-29 13:16:11.490106 (Thread-1): finished collecting timing info
2021-05-29 13:16:11.492049 (Thread-1): Database Error in model dim_customer (models\marts\dim_customer.sql)
  Syntax error: Expected ")" but got "." at [44:69]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/01b628e3-0192-48e4-8d25-eff5de57fc3c?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [44:69]

(job ID: 01b628e3-0192-48e4-8d25-eff5de57fc3c)

                                                               -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
   5:  OPTIONS()
   6:  as with
   7:    person as (
   8:            select
   9:                /*Primary Key*/
  10:                businessentityid
  11:
  12:               /*Other Columns*/
  13:                , title
  14:                , suffix
  15:                , rowguid
  16:                , persontype
  17:                , namestyle
  18:                , modifieddate
  19:                , middlename
  20:                , lastname
  21:                , firstname
  22:                , emailpromotion
  23:            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
  24:        )
  25:
  26:    , customer as (
  27:        select
  28:          /*Primary Key*/
  29:            customerid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , storeid
  34:            , personid
  35:
  36:           /*Other Columns*/
  37:            , rowguid
  38:            , modifieddate
  39:        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  40:    )
  41:
  42:    , transformed as (
  43:        select
  44:        row_number() over (order by customer.customerid) as customer.customer_sk
  45:        , customer.customerid
  46:        , customer.territoryid
  47:        , customer.storeid
  48:        , customer.personid
  49:        , customer.rowguid
  50:        , customer.modifieddate
  51:        , person.middlename
  52:        , person.lastname
  53:        , person.firstname
  54:        from customer
  55:        left join person on customer.customerid=person.businessentityid
  56:    )
  57:
  58:    select * from transformed;
  59:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customer (models\marts\dim_customer.sql)
  Syntax error: Expected ")" but got "." at [44:69]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
2021-05-29 13:16:11.550369 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F167D488>]}
2021-05-29 13:16:11.552363 (Thread-1): 10:16:11 | 15 of 16 ERROR creating view model dw_adventure_works.dim_customer... [ERROR in 2.54s]
2021-05-29 13:16:11.557304 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 13:16:11.559294 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 13:16:11.563304 (Thread-1): 10:16:11 | 16 of 16 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 13:16:11.567836 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:16:11.568278 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 13:16:11.594207 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:16:11.602184 (Thread-1): finished collecting timing info
2021-05-29 13:16:11.634099 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:16:11.638134 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:16:11.675999 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:16:14.145279 (Thread-1): finished collecting timing info
2021-05-29 13:16:14.148272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68b2d982-459d-46cf-b352-8494ba0fe617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1686448>]}
2021-05-29 13:16:14.149270 (Thread-1): 10:16:14 | 16 of 16 OK created view model dw_adventure_works.dim_product........ [OK in 2.58s]
2021-05-29 13:16:14.154380 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 13:16:14.238249 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:16:14.240245 (MainThread): 10:16:14 | 
2021-05-29 13:16:14.242191 (MainThread): 10:16:14 | Finished running 16 view models in 44.78s.
2021-05-29 13:16:14.246726 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:16:14.248754 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:16:14.249721 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:16:14.250878 (MainThread): Connection 'model.dw_adventure_works.dim_product' was properly closed.
2021-05-29 13:16:14.334492 (MainThread): 
2021-05-29 13:16:14.336499 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:16:14.342474 (MainThread): 
2021-05-29 13:16:14.349477 (MainThread): Database Error in model dim_customer (models\marts\dim_customer.sql)
2021-05-29 13:16:14.356433 (MainThread):   Syntax error: Expected ")" but got "." at [44:69]
2021-05-29 13:16:14.365412 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_customer.sql
2021-05-29 13:16:14.368412 (MainThread): 
Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
2021-05-29 13:16:14.379394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1764908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1764A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F1683808>]}
2021-05-29 13:16:14.381379 (MainThread): Flushing usage events
2021-05-29 13:23:42.295467 (MainThread): Running with dbt=0.19.1
2021-05-29 13:23:43.720143 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:23:43.724028 (MainThread): Tracking: tracking
2021-05-29 13:23:43.726024 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59772F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F597757C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59775AC8>]}
2021-05-29 13:23:43.761471 (MainThread): Partial parsing not enabled
2021-05-29 13:23:43.768583 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:23:43.838383 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:23:43.857550 (MainThread): Parsing macros\etc.sql
2021-05-29 13:23:43.863352 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:23:43.876165 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:23:43.911993 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:23:43.922883 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:23:43.928939 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:23:43.984757 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:23:44.033063 (MainThread): Parsing macros\core.sql
2021-05-29 13:23:44.065081 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:23:44.351004 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:23:44.380192 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:23:44.383109 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:23:44.387041 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:23:44.394819 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:23:44.398959 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:23:44.403794 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:23:44.430723 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:23:44.470715 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:23:44.477596 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:23:44.499540 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:23:44.573430 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:23:44.736535 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:23:44.744513 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:23:44.817334 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:23:44.837104 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:23:44.851981 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:23:44.873925 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:23:44.884093 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:23:44.890771 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:23:44.897620 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:23:44.920869 (MainThread): Partial parsing not enabled
2021-05-29 13:23:45.059946 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:23:45.131070 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:23:45.162022 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:23:45.188916 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:23:45.215848 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:23:45.262002 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:23:45.289925 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:23:45.302891 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:23:45.312937 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:23:45.324836 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:23:45.333948 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:23:45.346309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:23:45.360419 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:23:45.372506 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:23:45.389462 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:23:45.401335 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:23:45.807081 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:23:45.816055 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D3FD388>]}
2021-05-29 13:23:45.847259 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D205508>]}
2021-05-29 13:23:45.848259 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:23:45.853284 (MainThread): 
2021-05-29 13:23:45.855242 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:23:45.863257 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:23:45.863257 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:23:47.790048 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:23:47.790720 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:23:47.826616 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:23:48.831995 (MainThread): 10:23:48 | Concurrency: 1 threads (target='dev')
2021-05-29 13:23:48.839825 (MainThread): 10:23:48 | 
2021-05-29 13:23:48.893141 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 13:23:48.896009 (Thread-1): 10:23:48 | 1 of 16 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 13:23:48.899897 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:23:48.900895 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 13:23:48.914861 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:23:48.921360 (Thread-1): finished collecting timing info
2021-05-29 13:23:49.022946 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 13:23:49.029702 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:23:49.044115 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 13:23:51.632707 (Thread-1): finished collecting timing info
2021-05-29 13:23:51.634742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F597DA588>]}
2021-05-29 13:23:51.636693 (Thread-1): 10:23:51 | 1 of 16 OK created view model dw_adventure_works.stg_person.......... [OK in 2.74s]
2021-05-29 13:23:51.639687 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 13:23:51.640684 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 13:23:51.642770 (Thread-1): 10:23:51 | 2 of 16 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 13:23:51.645673 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:23:51.645673 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 13:23:51.663169 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:23:51.668538 (Thread-1): finished collecting timing info
2021-05-29 13:23:51.682113 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 13:23:51.686105 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:23:51.701061 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 13:23:54.529807 (Thread-1): finished collecting timing info
2021-05-29 13:23:54.531803 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59752E88>]}
2021-05-29 13:23:54.533797 (Thread-1): 10:23:54 | 2 of 16 OK created view model dw_adventure_works.stg_address......... [OK in 2.89s]
2021-05-29 13:23:54.540964 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 13:23:54.541778 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:23:54.545778 (Thread-1): 10:23:54 | 3 of 16 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 13:23:54.550755 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:23:54.551757 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 13:23:54.561726 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60456), raddr=('172.217.173.106', 443)>
2021-05-29 13:23:54.564718 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60457), raddr=('142.250.79.202', 443)>
2021-05-29 13:23:54.589650 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:23:54.593639 (Thread-1): finished collecting timing info
2021-05-29 13:23:54.611588 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 13:23:54.627546 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:23:54.651590 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 13:23:57.161285 (Thread-1): finished collecting timing info
2021-05-29 13:23:57.164276 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59746AC8>]}
2021-05-29 13:23:57.166272 (Thread-1): 10:23:57 | 3 of 16 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.61s]
2021-05-29 13:23:57.171210 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 13:23:57.172223 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 13:23:57.175200 (Thread-1): 10:23:57 | 4 of 16 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 13:23:57.179202 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:23:57.180235 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 13:23:57.198147 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:23:57.203538 (Thread-1): finished collecting timing info
2021-05-29 13:23:57.217507 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 13:23:57.222450 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:23:57.256405 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 13:23:57.521178 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60454), raddr=('172.217.173.106', 443)>
2021-05-29 13:23:57.522174 (Thread-1): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60455), raddr=('142.250.79.202', 443)>
2021-05-29 13:23:57.531155 (Thread-1): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60459), raddr=('142.250.79.202', 443)>
2021-05-29 13:23:57.532151 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60458), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:00.011254 (Thread-1): finished collecting timing info
2021-05-29 13:24:00.015185 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D1EAE88>]}
2021-05-29 13:24:00.019171 (Thread-1): 10:24:00 | 4 of 16 OK created view model dw_adventure_works.stg_customer........ [OK in 2.84s]
2021-05-29 13:24:00.025161 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 13:24:00.026156 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 13:24:00.029392 (Thread-1): 10:24:00 | 5 of 16 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 13:24:00.034132 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:24:00.035130 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 13:24:00.067047 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:24:00.081659 (Thread-1): finished collecting timing info
2021-05-29 13:24:00.103006 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 13:24:00.109034 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:00.148299 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 13:24:02.270160 (Thread-1): finished collecting timing info
2021-05-29 13:24:02.272154 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59746A88>]}
2021-05-29 13:24:02.274149 (Thread-1): 10:24:02 | 5 of 16 OK created view model dw_adventure_works.stg_product......... [OK in 2.24s]
2021-05-29 13:24:02.278140 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 13:24:02.280131 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:24:02.283127 (Thread-1): 10:24:02 | 6 of 16 START view model dw_adventure_works.stg_countryregion........ [RUN]
2021-05-29 13:24:02.288108 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:24:02.290106 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 13:24:02.293562 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60462), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:02.295556 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60463), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:02.310577 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:24:02.361146 (Thread-1): finished collecting timing info
2021-05-29 13:24:02.378995 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 13:24:02.470234 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:02.511129 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 13:24:05.347873 (Thread-1): finished collecting timing info
2021-05-29 13:24:05.350806 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D209D88>]}
2021-05-29 13:24:05.353808 (Thread-1): 10:24:05 | 6 of 16 OK created view model dw_adventure_works.stg_countryregion... [OK in 3.06s]
2021-05-29 13:24:05.358785 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 13:24:05.359799 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:24:05.361788 (Thread-1): 10:24:05 | 7 of 16 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 13:24:05.365768 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:24:05.367763 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 13:24:05.381727 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:24:05.387775 (Thread-1): finished collecting timing info
2021-05-29 13:24:05.400411 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 13:24:05.404902 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:05.449282 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 13:24:07.946252 (Thread-1): finished collecting timing info
2021-05-29 13:24:07.949245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D361A08>]}
2021-05-29 13:24:07.951240 (Thread-1): 10:24:07 | 7 of 16 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.58s]
2021-05-29 13:24:07.955510 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 13:24:07.957240 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:24:07.959219 (Thread-1): 10:24:07 | 8 of 16 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 13:24:07.963209 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:24:07.965211 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:24:07.981205 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:24:07.987450 (Thread-1): finished collecting timing info
2021-05-29 13:24:08.007774 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 13:24:08.017217 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:08.053121 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 13:24:10.445390 (Thread-1): finished collecting timing info
2021-05-29 13:24:10.446415 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D209C48>]}
2021-05-29 13:24:10.447465 (Thread-1): 10:24:10 | 8 of 16 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.48s]
2021-05-29 13:24:10.450307 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 13:24:10.450307 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 13:24:10.452302 (Thread-1): 10:24:10 | 9 of 16 START view model dw_adventure_works.stg_orders............... [RUN]
2021-05-29 13:24:10.453299 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:24:10.453299 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 13:24:10.460629 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:24:10.462275 (Thread-1): finished collecting timing info
2021-05-29 13:24:10.469260 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 13:24:10.472250 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:10.507620 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 13:24:13.331229 (Thread-1): finished collecting timing info
2021-05-29 13:24:13.335160 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D2E6D08>]}
2021-05-29 13:24:13.337155 (Thread-1): 10:24:13 | 9 of 16 OK created view model dw_adventure_works.stg_orders.......... [OK in 2.88s]
2021-05-29 13:24:13.343140 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 13:24:13.344138 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:24:13.346133 (Thread-1): 10:24:13 | 10 of 16 START view model dw_adventure_works.stg_salesreason......... [RUN]
2021-05-29 13:24:13.350179 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:24:13.351117 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 13:24:13.380100 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60464), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:13.381097 (Thread-1): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60465), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:13.382094 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60466), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:13.384088 (Thread-1): unclosed <socket.socket fd=1340, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60467), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:13.385034 (Thread-1): unclosed <socket.socket fd=1380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60468), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:13.387081 (Thread-1): unclosed <socket.socket fd=1392, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60469), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:13.388016 (Thread-1): unclosed <socket.socket fd=1424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60470), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:13.389017 (Thread-1): unclosed <socket.socket fd=1432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60471), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:13.396995 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:24:13.403345 (Thread-1): finished collecting timing info
2021-05-29 13:24:13.417320 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 13:24:13.424647 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:13.467305 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 13:24:15.976382 (Thread-1): finished collecting timing info
2021-05-29 13:24:15.980789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D2D51C8>]}
2021-05-29 13:24:15.986551 (Thread-1): 10:24:15 | 10 of 16 OK created view model dw_adventure_works.stg_salesreason.... [OK in 2.63s]
2021-05-29 13:24:15.992429 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 13:24:15.994337 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:24:15.997544 (Thread-1): 10:24:15 | 11 of 16 START view model dw_adventure_works.stg_stateprovince....... [RUN]
2021-05-29 13:24:16.003311 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:24:16.004306 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 13:24:16.007298 (Thread-1): unclosed <socket.socket fd=1480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60472), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:16.008416 (Thread-1): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60473), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:16.019265 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:24:16.021258 (Thread-1): finished collecting timing info
2021-05-29 13:24:16.028432 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 13:24:16.032229 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:16.044341 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 13:24:18.764591 (Thread-1): finished collecting timing info
2021-05-29 13:24:18.766659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D2D5188>]}
2021-05-29 13:24:18.768653 (Thread-1): 10:24:18 | 11 of 16 OK created view model dw_adventure_works.stg_stateprovince.. [OK in 2.76s]
2021-05-29 13:24:18.773585 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 13:24:18.774577 (Thread-1): Began running node model.dw_adventure_works.dim_person
2021-05-29 13:24:18.777631 (Thread-1): 10:24:18 | 12 of 16 START view model dw_adventure_works.dim_person.............. [RUN]
2021-05-29 13:24:18.781565 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_person".
2021-05-29 13:24:18.782556 (Thread-1): Compiling model.dw_adventure_works.dim_person
2021-05-29 13:24:18.788257 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60475), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:18.789301 (Thread-1): unclosed <socket.socket fd=1436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60476), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:18.807202 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:24:18.816861 (Thread-1): finished collecting timing info
2021-05-29 13:24:18.833392 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_person"
2021-05-29 13:24:18.842385 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:18.891039 (Thread-1): On model.dw_adventure_works.dim_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_person`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion
        from `desafio-indicium`.`dw_adventure_works`.`stg_person`
    )

    , transformed as (
        select
        row_number() over (order by businessentityid) as person_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:24:21.459823 (Thread-1): finished collecting timing info
2021-05-29 13:24:21.461816 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D134BC8>]}
2021-05-29 13:24:21.465025 (Thread-1): 10:24:21 | 12 of 16 OK created view model dw_adventure_works.dim_person......... [OK in 2.68s]
2021-05-29 13:24:21.476613 (Thread-1): Finished running node model.dw_adventure_works.dim_person
2021-05-29 13:24:21.477611 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:24:21.487845 (Thread-1): 10:24:21 | 13 of 16 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 13:24:21.500943 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:24:21.501927 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:24:21.539815 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:24:21.559055 (Thread-1): finished collecting timing info
2021-05-29 13:24:21.584315 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:24:21.593683 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:21.639747 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as adress_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:24:24.318977 (Thread-1): finished collecting timing info
2021-05-29 13:24:24.321786 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D10BF48>]}
2021-05-29 13:24:24.324773 (Thread-1): 10:24:24 | 13 of 16 OK created view model dw_adventure_works.dim_address........ [OK in 2.83s]
2021-05-29 13:24:24.328850 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:24:24.329846 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:24:24.332701 (Thread-1): 10:24:24 | 14 of 16 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 13:24:24.335759 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:24:24.336667 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 13:24:24.350528 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:24:24.356034 (Thread-1): finished collecting timing info
2021-05-29 13:24:24.370994 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 13:24:24.405306 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:24.465829 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:24:27.543350 (Thread-1): finished collecting timing info
2021-05-29 13:24:27.544344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D11D3C8>]}
2021-05-29 13:24:27.545346 (Thread-1): 10:24:27 | 14 of 16 OK created view model dw_adventure_works.dim_creditcard..... [OK in 3.21s]
2021-05-29 13:24:27.546304 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 13:24:27.547429 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 13:24:27.547429 (Thread-1): 10:24:27 | 15 of 16 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 13:24:27.549297 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:24:27.549366 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 13:24:27.556278 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:24:27.558274 (Thread-1): finished collecting timing info
2021-05-29 13:24:27.568244 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 13:24:27.571246 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:27.581610 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed;


2021-05-29 13:24:27.592218 (Thread-1): unclosed <socket.socket fd=1516, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60478), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:27.593219 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60480), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:27.593219 (Thread-1): unclosed <socket.socket fd=1436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60483), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:27.593219 (Thread-1): unclosed <socket.socket fd=1328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60484), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:27.594212 (Thread-1): unclosed <socket.socket fd=1568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60486), raddr=('172.217.173.106', 443)>
2021-05-29 13:24:27.594212 (Thread-1): unclosed <socket.socket fd=1576, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60487), raddr=('142.250.79.202', 443)>
2021-05-29 13:24:30.222049 (Thread-1): finished collecting timing info
2021-05-29 13:24:30.223047 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D0AFF08>]}
2021-05-29 13:24:30.223653 (Thread-1): 10:24:30 | 15 of 16 OK created view model dw_adventure_works.dim_customer....... [OK in 2.67s]
2021-05-29 13:24:30.225040 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 13:24:30.225756 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 13:24:30.226148 (Thread-1): 10:24:30 | 16 of 16 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 13:24:30.227035 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:24:30.227035 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 13:24:30.234016 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:24:30.236012 (Thread-1): finished collecting timing info
2021-05-29 13:24:30.241995 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 13:24:30.243989 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 13:24:30.255554 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 13:24:32.813349 (Thread-1): finished collecting timing info
2021-05-29 13:24:32.815343 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b902c87-2dfa-4dc3-afbd-bb4572c796f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D2C2A48>]}
2021-05-29 13:24:32.817339 (Thread-1): 10:24:32 | 16 of 16 OK created view model dw_adventure_works.dim_product........ [OK in 2.59s]
2021-05-29 13:24:32.822315 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 13:24:32.838277 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:24:32.846251 (MainThread): 10:24:32 | 
2021-05-29 13:24:32.854230 (MainThread): 10:24:32 | Finished running 16 view models in 46.99s.
2021-05-29 13:24:32.857226 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:24:32.859219 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:24:32.860650 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:24:32.866223 (MainThread): Connection 'model.dw_adventure_works.dim_product' was properly closed.
2021-05-29 13:24:32.966118 (MainThread): 
2021-05-29 13:24:32.969158 (MainThread): Completed successfully
2021-05-29 13:24:32.973908 (MainThread): 
Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
2021-05-29 13:24:32.976906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D090908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D090048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5D0AFFC8>]}
2021-05-29 13:24:32.977899 (MainThread): Flushing usage events
2021-05-29 13:32:30.472340 (MainThread): Running with dbt=0.19.1
2021-05-29 13:32:31.928914 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_adress'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:32:31.931207 (MainThread): Tracking: tracking
2021-05-29 13:32:31.933200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194BB5A108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194BB64E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194BB64D88>]}
2021-05-29 13:32:31.961855 (MainThread): Partial parsing not enabled
2021-05-29 13:32:31.967389 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:32:32.019260 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:32:32.032939 (MainThread): Parsing macros\etc.sql
2021-05-29 13:32:32.038007 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:32:32.050973 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:32:32.085049 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:32:32.092128 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:32:32.097122 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:32:32.129111 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:32:32.149742 (MainThread): Parsing macros\core.sql
2021-05-29 13:32:32.163493 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:32:32.265228 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:32:32.290455 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:32:32.293997 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:32:32.299705 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:32:32.305894 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:32:32.311267 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:32:32.315003 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:32:32.343207 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:32:32.383020 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:32:32.390200 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:32:32.417779 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:32:32.481855 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:32:32.556106 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:32:32.561675 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:32:32.607480 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:32:32.626552 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:32:32.641772 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:32:32.659034 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:32:32.668915 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:32:32.673686 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:32:32.680975 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:32:32.698682 (MainThread): Partial parsing not enabled
2021-05-29 13:32:32.763772 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:32:32.794168 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:32:32.804842 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:32:32.813818 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:32:32.825013 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:32:32.835080 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:32:32.847465 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:32:32.860434 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:32:32.877387 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:32:32.895357 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:32:32.912292 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:32:32.926255 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:32:32.938260 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:32:32.947993 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:32:32.960617 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:32:33.290846 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:32:33.296797 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf6bdbd1-26f6-469e-bd1b-ea6c39a75d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194F654088>]}
2021-05-29 13:32:33.342524 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf6bdbd1-26f6-469e-bd1b-ea6c39a75d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194F5FE608>]}
2021-05-29 13:32:33.343531 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:32:33.344528 (MainThread): The selector 'dim_adress' does not match any nodes and will be ignored
2021-05-29 13:32:33.347520 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-29 13:32:33.348599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194F5FEC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194F5FEE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002194F5FE508>]}
2021-05-29 13:32:33.349517 (MainThread): Flushing usage events
2021-05-29 13:32:35.182405 (MainThread): Connection 'model.dw_adventure_works.dim_product' was properly closed.
2021-05-29 13:32:56.256792 (MainThread): Running with dbt=0.19.1
2021-05-29 13:32:57.378227 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_address'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:32:57.380222 (MainThread): Tracking: tracking
2021-05-29 13:32:57.381219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD259D688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD25A5A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD25A5D88>]}
2021-05-29 13:32:57.407351 (MainThread): Partial parsing not enabled
2021-05-29 13:32:57.410342 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:32:57.479159 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:32:57.494118 (MainThread): Parsing macros\etc.sql
2021-05-29 13:32:57.500103 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:32:57.511073 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:32:57.567921 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:32:57.578892 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:32:57.586871 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:32:57.623905 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:32:57.641857 (MainThread): Parsing macros\core.sql
2021-05-29 13:32:57.656817 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:32:57.792518 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:32:57.817468 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:32:57.820441 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:32:57.825430 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:32:57.832420 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:32:57.839390 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:32:57.843379 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:32:57.872385 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:32:57.912211 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:32:57.919192 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:32:57.939178 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:32:58.009290 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:32:58.112555 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:32:58.117543 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:32:58.176132 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:32:58.203061 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:32:58.225999 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:32:58.259908 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:32:58.272600 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:32:58.281581 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:32:58.290556 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:32:58.317646 (MainThread): Partial parsing not enabled
2021-05-29 13:32:58.417797 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:32:58.456857 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:32:58.467664 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:32:58.481770 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:32:58.494612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:32:58.510569 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:32:58.526527 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:32:58.543482 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:32:58.558671 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:32:58.574531 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:32:58.590490 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:32:58.606610 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:32:58.626392 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:32:58.644346 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:32:58.665289 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:32:59.342985 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:32:59.357055 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '294189ac-654b-436f-89a1-1eda77ad32be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD60D9848>]}
2021-05-29 13:32:59.390034 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '294189ac-654b-436f-89a1-1eda77ad32be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD6012948>]}
2021-05-29 13:32:59.391038 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:32:59.396906 (MainThread): 
2021-05-29 13:32:59.403627 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:32:59.406619 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:32:59.407532 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:33:00.376169 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:33:00.376169 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:33:00.390132 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:33:01.788122 (MainThread): 10:33:01 | Concurrency: 1 threads (target='dev')
2021-05-29 13:33:01.792111 (MainThread): 10:33:01 | 
2021-05-29 13:33:01.817368 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:33:01.817532 (Thread-1): 10:33:01 | 1 of 1 START view model dw_adventure_works.dim_address............... [RUN]
2021-05-29 13:33:01.819525 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:33:01.820715 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:33:01.842549 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:33:01.847450 (Thread-1): finished collecting timing info
2021-05-29 13:33:02.375757 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:33:02.385940 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:33:02.404412 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name as state
            , stateprovince.countryregioncode as country
        from adress
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 13:33:04.764726 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/5b39ab61-fae1-4a24-8c5c-1271ac69ea7a?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address" at [47:13]')
2021-05-29 13:33:06.617864 (Thread-1): finished collecting timing info
2021-05-29 13:33:06.619565 (Thread-1): Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/60e89069-5163-45a6-bc84-059d8b769a71?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address" at [47:13]

(job ID: 60e89069-5163-45a6-bc84-059d8b769a71)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
   5:  OPTIONS()
   6:  as with
   7:    address as (
   8:        select
   9:            /*Primary Key*/
  10:            addressid
  11:
  12:            /*Foreign Keys*/
  13:            , stateprovinceid
  14:
  15:           /*Other Columns*/
  16:            , spatiallocation
  17:            , rowguid
  18:            , postalcode
  19:            , modifieddate
  20:            , city
  21:            , addressline2
  22:            , addressline1
  23:        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
  24:    )
  25:
  26:    ,    stateprovince as (
  27:        select
  28:             /*Primary Key*/
  29:            stateprovinceid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , countryregioncode
  34:
  35:           /*Other Columns*/
  36:            , stateprovincecode
  37:            , rowguid
  38:            , name
  39:            , modifieddate
  40:            , isonlystateprovinceflag
  41:        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  42:    )
  43:
  44:    , transformed as (
  45:        select
  46:        row_number() over (order by addressid) as address_sk
  47:            address.addressid
  48:            , address.stateprovinceid
  49:            , address.spatiallocation
  50:            , address.rowguid
  51:            , address.postalcode
  52:            , address.modifieddate
  53:            , address.city
  54:            , address.addressline2
  55:            , address.addressline1
  56:            , stateprovince.name as state
  57:            , stateprovince.countryregioncode as country
  58:        from adress
  59:        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
  60:    )
  61:    select * from transformed;
  62:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:33:06.674088 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '294189ac-654b-436f-89a1-1eda77ad32be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD255CA48>]}
2021-05-29 13:33:06.676126 (Thread-1): 10:33:06 | 1 of 1 ERROR creating view model dw_adventure_works.dim_address...... [ERROR in 4.86s]
2021-05-29 13:33:06.679073 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:33:06.778854 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:33:06.780854 (MainThread): 10:33:06 | 
2021-05-29 13:33:06.783884 (MainThread): 10:33:06 | Finished running 1 view model in 7.38s.
2021-05-29 13:33:06.786877 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:33:06.790351 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:33:06.790867 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:33:06.791867 (MainThread): Connection 'model.dw_adventure_works.dim_address' was properly closed.
2021-05-29 13:33:06.902094 (MainThread): 
2021-05-29 13:33:06.903095 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:33:06.905089 (MainThread): 
2021-05-29 13:33:06.907177 (MainThread): Database Error in model dim_address (models\marts\dim_address.sql)
2021-05-29 13:33:06.909079 (MainThread):   Syntax error: Expected ")" but got identifier "address" at [47:13]
2021-05-29 13:33:06.914150 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:33:06.916146 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:33:06.918141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD600F088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD2578988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD25673C8>]}
2021-05-29 13:33:06.919138 (MainThread): Flushing usage events
2021-05-29 13:33:52.701786 (MainThread): Running with dbt=0.19.1
2021-05-29 13:33:53.605769 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_address'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:33:53.606768 (MainThread): Tracking: tracking
2021-05-29 13:33:53.607765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C55AE5E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C55AE2348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C55AEB088>]}
2021-05-29 13:33:53.634889 (MainThread): Partial parsing not enabled
2021-05-29 13:33:53.637880 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:33:53.697546 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:33:53.714901 (MainThread): Parsing macros\etc.sql
2021-05-29 13:33:53.721479 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:33:53.733454 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:33:53.770791 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:33:53.778813 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:33:53.784117 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:33:53.809358 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:33:53.823581 (MainThread): Parsing macros\core.sql
2021-05-29 13:33:53.833513 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:33:53.937278 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:33:53.960332 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:33:53.962745 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:33:53.966790 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:33:53.971782 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:33:53.975471 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:33:53.978088 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:33:53.998213 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:33:54.035070 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:33:54.040117 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:33:54.058279 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:33:54.117667 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:33:54.204360 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:33:54.209722 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:33:54.248579 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:33:54.262712 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:33:54.273065 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:33:54.287673 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:33:54.294593 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:33:54.298545 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:33:54.303313 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:33:54.321107 (MainThread): Partial parsing not enabled
2021-05-29 13:33:54.380985 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:33:54.405654 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:33:54.416359 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:33:54.428364 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:33:54.439183 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:33:54.448324 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:33:54.459597 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:33:54.468991 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:33:54.479001 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:33:54.491368 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:33:54.500264 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:33:54.514212 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:33:54.525110 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:33:54.535085 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:33:54.547886 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:33:54.802754 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:33:54.807826 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0803c930-ab3a-474d-b805-62ba72904d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C596A5148>]}
2021-05-29 13:33:54.830899 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0803c930-ab3a-474d-b805-62ba72904d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C595A9648>]}
2021-05-29 13:33:54.831762 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:33:54.838207 (MainThread): 
2021-05-29 13:33:54.838834 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:33:54.840739 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:33:54.841736 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:33:56.188554 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:33:56.190553 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:33:56.213532 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:33:57.695291 (MainThread): 10:33:57 | Concurrency: 1 threads (target='dev')
2021-05-29 13:33:57.697385 (MainThread): 10:33:57 | 
2021-05-29 13:33:57.716293 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:33:57.719228 (Thread-1): 10:33:57 | 1 of 1 START view model dw_adventure_works.dim_address............... [RUN]
2021-05-29 13:33:57.723363 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:33:57.724221 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:33:57.776977 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:33:57.782953 (Thread-1): finished collecting timing info
2021-05-29 13:33:57.993420 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:33:57.994405 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:33:58.003357 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name as state
            , stateprovince.countryregioncode as country
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 13:33:59.903699 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/3ab6c76f-c14b-4af7-91ad-d0ec69ac24ce?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address" at [47:13]')
2021-05-29 13:34:00.959609 (Thread-1): finished collecting timing info
2021-05-29 13:34:00.961612 (Thread-1): Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/909766bd-09a4-4728-838e-6aae33d74299?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address" at [47:13]

(job ID: 909766bd-09a4-4728-838e-6aae33d74299)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
   5:  OPTIONS()
   6:  as with
   7:    address as (
   8:        select
   9:            /*Primary Key*/
  10:            addressid
  11:
  12:            /*Foreign Keys*/
  13:            , stateprovinceid
  14:
  15:           /*Other Columns*/
  16:            , spatiallocation
  17:            , rowguid
  18:            , postalcode
  19:            , modifieddate
  20:            , city
  21:            , addressline2
  22:            , addressline1
  23:        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
  24:    )
  25:
  26:    ,    stateprovince as (
  27:        select
  28:             /*Primary Key*/
  29:            stateprovinceid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , countryregioncode
  34:
  35:           /*Other Columns*/
  36:            , stateprovincecode
  37:            , rowguid
  38:            , name
  39:            , modifieddate
  40:            , isonlystateprovinceflag
  41:        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  42:    )
  43:
  44:    , transformed as (
  45:        select
  46:        row_number() over (order by addressid) as address_sk
  47:            address.addressid
  48:            , address.stateprovinceid
  49:            , address.spatiallocation
  50:            , address.rowguid
  51:            , address.postalcode
  52:            , address.modifieddate
  53:            , address.city
  54:            , address.addressline2
  55:            , address.addressline1
  56:            , stateprovince.name as state
  57:            , stateprovince.countryregioncode as country
  58:        from address
  59:        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
  60:    )
  61:    select * from transformed;
  62:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:34:01.008986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0803c930-ab3a-474d-b805-62ba72904d7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C59592A88>]}
2021-05-29 13:34:01.010983 (Thread-1): 10:34:01 | 1 of 1 ERROR creating view model dw_adventure_works.dim_address...... [ERROR in 3.29s]
2021-05-29 13:34:01.016971 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:34:01.068829 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:34:01.073828 (MainThread): 10:34:01 | 
2021-05-29 13:34:01.077934 (MainThread): 10:34:01 | Finished running 1 view model in 6.23s.
2021-05-29 13:34:01.080728 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:34:01.085745 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:34:01.088739 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:34:01.090692 (MainThread): Connection 'model.dw_adventure_works.dim_address' was properly closed.
2021-05-29 13:34:01.160505 (MainThread): 
2021-05-29 13:34:01.162501 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:34:01.175472 (MainThread): 
2021-05-29 13:34:01.179290 (MainThread): Database Error in model dim_address (models\marts\dim_address.sql)
2021-05-29 13:34:01.193607 (MainThread):   Syntax error: Expected ")" but got identifier "address" at [47:13]
2021-05-29 13:34:01.197591 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:34:01.203578 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:34:01.207563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C58FD6788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C58FD6748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C595D6F08>]}
2021-05-29 13:34:01.209560 (MainThread): Flushing usage events
2021-05-29 13:36:17.749231 (MainThread): Running with dbt=0.19.1
2021-05-29 13:36:18.848506 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_address'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:36:18.849503 (MainThread): Tracking: tracking
2021-05-29 13:36:18.851500 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F6784608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F6784CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F6779148>]}
2021-05-29 13:36:18.872591 (MainThread): Partial parsing not enabled
2021-05-29 13:36:18.876315 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:36:18.929204 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:36:18.946163 (MainThread): Parsing macros\etc.sql
2021-05-29 13:36:18.952492 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:36:18.967334 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:36:19.001753 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:36:19.010752 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:36:19.017337 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:36:19.053388 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:36:19.080091 (MainThread): Parsing macros\core.sql
2021-05-29 13:36:19.098267 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:36:19.196005 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:36:19.217946 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:36:19.220987 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:36:19.226027 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:36:19.231153 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:36:19.235530 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:36:19.238379 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:36:19.256884 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:36:19.294883 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:36:19.301071 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:36:19.320022 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:36:19.380043 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:36:19.460571 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:36:19.465563 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:36:19.501466 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:36:19.517424 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:36:19.532383 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:36:19.548343 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:36:19.554958 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:36:19.559497 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:36:19.565223 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:36:19.583715 (MainThread): Partial parsing not enabled
2021-05-29 13:36:19.660547 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:36:19.688623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:36:19.700403 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:36:19.712372 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:36:19.730325 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:36:19.747281 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:36:19.762275 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:36:19.780225 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:36:19.793160 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:36:19.812437 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:36:19.824502 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:36:19.844430 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:36:19.859325 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:36:19.871461 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:36:19.884606 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:36:20.118825 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:36:20.122439 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2371e733-f937-477c-a3df-bfae6b421723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA327908>]}
2021-05-29 13:36:20.147588 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2371e733-f937-477c-a3df-bfae6b421723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA275548>]}
2021-05-29 13:36:20.148371 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:36:20.154352 (MainThread): 
2021-05-29 13:36:20.154880 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:36:20.160337 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:36:20.160337 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:36:21.775325 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:36:21.776911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:36:21.807236 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:36:23.303815 (MainThread): 10:36:23 | Concurrency: 1 threads (target='dev')
2021-05-29 13:36:23.306849 (MainThread): 10:36:23 | 
2021-05-29 13:36:23.325921 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:36:23.327816 (Thread-1): 10:36:23 | 1 of 1 START view model dw_adventure_works.dim_address............... [RUN]
2021-05-29 13:36:23.331713 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:36:23.331807 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:36:23.378675 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:36:23.383670 (Thread-1): finished collecting timing info
2021-05-29 13:36:23.749978 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:36:23.752936 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:36:23.770922 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address1 as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            address1.addressid
            , address1.stateprovinceid
            , address1.spatiallocation
            , address1.rowguid
            , address1.postalcode
            , address1.modifieddate
            , address1.city
            , address1.addressline2
            , address1.addressline1
            , stateprovince.name as state
            , stateprovince.countryregioncode as country
        from address1
        left join stateprovince on address1.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 13:36:26.390423 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/84eab17e-a152-47c8-851b-1ba2764c3e91?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address1" at [47:13]')
2021-05-29 13:36:27.903203 (Thread-1): finished collecting timing info
2021-05-29 13:36:27.906149 (Thread-1): Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address1" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/da23a415-1904-4a38-ba61-32ad947b94ad?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address1" at [47:13]

(job ID: da23a415-1904-4a38-ba61-32ad947b94ad)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
   5:  OPTIONS()
   6:  as with
   7:    address1 as (
   8:        select
   9:            /*Primary Key*/
  10:            addressid
  11:
  12:            /*Foreign Keys*/
  13:            , stateprovinceid
  14:
  15:           /*Other Columns*/
  16:            , spatiallocation
  17:            , rowguid
  18:            , postalcode
  19:            , modifieddate
  20:            , city
  21:            , addressline2
  22:            , addressline1
  23:        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
  24:    )
  25:
  26:    ,    stateprovince as (
  27:        select
  28:             /*Primary Key*/
  29:            stateprovinceid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , countryregioncode
  34:
  35:           /*Other Columns*/
  36:            , stateprovincecode
  37:            , rowguid
  38:            , name
  39:            , modifieddate
  40:            , isonlystateprovinceflag
  41:        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  42:    )
  43:
  44:    , transformed as (
  45:        select
  46:        row_number() over (order by addressid) as address_sk
  47:            address1.addressid
  48:            , address1.stateprovinceid
  49:            , address1.spatiallocation
  50:            , address1.rowguid
  51:            , address1.postalcode
  52:            , address1.modifieddate
  53:            , address1.city
  54:            , address1.addressline2
  55:            , address1.addressline1
  56:            , stateprovince.name as state
  57:            , stateprovince.countryregioncode as country
  58:        from address1
  59:        left join stateprovince on address1.stateprovinceid = stateprovince.stateprovinceid
  60:    )
  61:    select * from transformed;
  62:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address1" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:36:27.979606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2371e733-f937-477c-a3df-bfae6b421723', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F9E8AE88>]}
2021-05-29 13:36:27.981600 (Thread-1): 10:36:27 | 1 of 1 ERROR creating view model dw_adventure_works.dim_address...... [ERROR in 4.65s]
2021-05-29 13:36:27.986545 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:36:28.068952 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:36:28.076433 (MainThread): 10:36:28 | 
2021-05-29 13:36:28.082911 (MainThread): 10:36:28 | Finished running 1 view model in 7.92s.
2021-05-29 13:36:28.092884 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:36:28.093886 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:36:28.094881 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:36:28.095882 (MainThread): Connection 'model.dw_adventure_works.dim_address' was properly closed.
2021-05-29 13:36:28.150044 (MainThread): 
2021-05-29 13:36:28.150044 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:36:28.152028 (MainThread): 
2021-05-29 13:36:28.153025 (MainThread): Database Error in model dim_address (models\marts\dim_address.sql)
2021-05-29 13:36:28.159326 (MainThread):   Syntax error: Expected ")" but got identifier "address1" at [47:13]
2021-05-29 13:36:28.162001 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:36:28.163997 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:36:28.165038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241F6745508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA39AC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241FA22BB48>]}
2021-05-29 13:36:28.165990 (MainThread): Flushing usage events
2021-05-29 13:38:25.205487 (MainThread): Running with dbt=0.19.1
2021-05-29 13:38:26.079428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_address'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:38:26.080426 (MainThread): Tracking: tracking
2021-05-29 13:38:26.081425 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A5F9F7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A60A5E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A60A3F48>]}
2021-05-29 13:38:26.106224 (MainThread): Partial parsing not enabled
2021-05-29 13:38:26.110214 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:38:26.155297 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:38:26.169264 (MainThread): Parsing macros\etc.sql
2021-05-29 13:38:26.174248 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:38:26.183672 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:38:26.212254 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:38:26.218473 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:38:26.223000 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:38:26.253387 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:38:26.264356 (MainThread): Parsing macros\core.sql
2021-05-29 13:38:26.277323 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:38:26.370176 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:38:26.389135 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:38:26.392175 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:38:26.397161 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:38:26.402148 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:38:26.405140 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:38:26.408132 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:38:26.429076 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:38:26.465733 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:38:26.470440 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:38:26.483926 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:38:26.531533 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:38:26.630743 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:38:26.635722 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:38:26.671760 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:38:26.686169 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:38:26.696317 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:38:26.716012 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:38:26.724984 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:38:26.730970 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:38:26.737486 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:38:26.757329 (MainThread): Partial parsing not enabled
2021-05-29 13:38:26.822925 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:38:26.845864 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:38:26.855192 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:38:26.862650 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:38:26.870788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:38:26.879160 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:38:26.887820 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:38:26.896860 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:38:26.906783 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:38:26.919751 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:38:26.929373 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:38:26.940130 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:38:26.952098 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:38:26.960693 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:38:26.971255 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:38:27.231363 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:38:27.237347 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d447087-dea3-48e0-b80a-fe745df5b055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A9C55908>]}
2021-05-29 13:38:27.275246 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d447087-dea3-48e0-b80a-fe745df5b055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A9B35888>]}
2021-05-29 13:38:27.275766 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:38:27.281518 (MainThread): 
2021-05-29 13:38:27.283515 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:38:27.286501 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:38:27.287050 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:38:28.950687 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:38:28.952685 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:38:28.980560 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:38:30.484269 (MainThread): 10:38:30 | Concurrency: 1 threads (target='dev')
2021-05-29 13:38:30.486841 (MainThread): 10:38:30 | 
2021-05-29 13:38:30.505225 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:38:30.507195 (Thread-1): 10:38:30 | 1 of 1 START view model dw_adventure_works.dim_address............... [RUN]
2021-05-29 13:38:30.512191 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:38:30.513861 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:38:30.555068 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:38:30.561054 (Thread-1): finished collecting timing info
2021-05-29 13:38:30.766959 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:38:30.767957 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:38:30.775934 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address1 as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            address1.addressid
            , address1.stateprovinceid
            , address1.spatiallocation
            , address1.rowguid
            , address1.postalcode
            , address1.modifieddate
            , address1.city
            , address1.addressline2
            , address1.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address1
        left join stateprovince on address1.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 13:38:33.413713 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/efb11a81-64aa-4603-b13a-89e27f59aa17?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address1" at [47:13]')
2021-05-29 13:38:35.695682 (Thread-1): finished collecting timing info
2021-05-29 13:38:35.697677 (Thread-1): Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address1" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/7cd43bf5-b539-49f4-8736-04330c18a6d8?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got identifier "address1" at [47:13]

(job ID: 7cd43bf5-b539-49f4-8736-04330c18a6d8)

                                                               -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
   5:  OPTIONS()
   6:  as with
   7:    address1 as (
   8:        select
   9:            /*Primary Key*/
  10:            addressid
  11:
  12:            /*Foreign Keys*/
  13:            , stateprovinceid
  14:
  15:           /*Other Columns*/
  16:            , spatiallocation
  17:            , rowguid
  18:            , postalcode
  19:            , modifieddate
  20:            , city
  21:            , addressline2
  22:            , addressline1
  23:        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
  24:    )
  25:
  26:    ,    stateprovince as (
  27:        select
  28:             /*Primary Key*/
  29:            stateprovinceid
  30:
  31:            /*Foreign Keys*/
  32:            , territoryid
  33:            , countryregioncode
  34:
  35:           /*Other Columns*/
  36:            , stateprovincecode
  37:            , rowguid
  38:            , name
  39:            , modifieddate
  40:            , isonlystateprovinceflag
  41:        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  42:    )
  43:
  44:    , transformed as (
  45:        select
  46:        row_number() over (order by addressid) as address_sk
  47:            address1.addressid
  48:            , address1.stateprovinceid
  49:            , address1.spatiallocation
  50:            , address1.rowguid
  51:            , address1.postalcode
  52:            , address1.modifieddate
  53:            , address1.city
  54:            , address1.addressline2
  55:            , address1.addressline1
  56:            , stateprovince.name
  57:            , stateprovince.countryregioncode
  58:        from address1
  59:        left join stateprovince on address1.stateprovinceid = stateprovince.stateprovinceid
  60:    )
  61:    select * from transformed;
  62:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_address (models\marts\dim_address.sql)
  Syntax error: Expected ")" but got identifier "address1" at [47:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:38:35.744358 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d447087-dea3-48e0-b80a-fe745df5b055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A96E0B48>]}
2021-05-29 13:38:35.747391 (Thread-1): 10:38:35 | 1 of 1 ERROR creating view model dw_adventure_works.dim_address...... [ERROR in 5.23s]
2021-05-29 13:38:35.754326 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:38:35.849109 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:38:35.851143 (MainThread): 10:38:35 | 
2021-05-29 13:38:35.854330 (MainThread): 10:38:35 | Finished running 1 view model in 8.57s.
2021-05-29 13:38:35.857079 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:38:35.858077 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:38:35.858077 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:38:35.860071 (MainThread): Connection 'model.dw_adventure_works.dim_address' was properly closed.
2021-05-29 13:38:35.938657 (MainThread): 
2021-05-29 13:38:35.941653 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:38:35.952625 (MainThread): 
2021-05-29 13:38:35.960615 (MainThread): Database Error in model dim_address (models\marts\dim_address.sql)
2021-05-29 13:38:35.971573 (MainThread):   Syntax error: Expected ")" but got identifier "address1" at [47:13]
2021-05-29 13:38:35.974564 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_address.sql
2021-05-29 13:38:35.980551 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:38:35.990524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A6067F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A9BAC708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220A9724E48>]}
2021-05-29 13:38:35.992526 (MainThread): Flushing usage events
2021-05-29 13:41:32.762226 (MainThread): Running with dbt=0.19.1
2021-05-29 13:41:33.643731 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_address'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:41:33.645691 (MainThread): Tracking: tracking
2021-05-29 13:41:33.646724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017314172C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017314175D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017314175F88>]}
2021-05-29 13:41:33.671727 (MainThread): Partial parsing not enabled
2021-05-29 13:41:33.675904 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:41:33.727026 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:41:33.744989 (MainThread): Parsing macros\etc.sql
2021-05-29 13:41:33.751966 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:41:33.764657 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:41:33.796622 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:41:33.804559 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:41:33.810540 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:41:33.843489 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:41:33.859544 (MainThread): Parsing macros\core.sql
2021-05-29 13:41:33.872162 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:41:33.998223 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:41:34.019433 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:41:34.021920 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:41:34.026811 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:41:34.033784 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:41:34.037668 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:41:34.040663 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:41:34.071226 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:41:34.126311 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:41:34.135016 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:41:34.163939 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:41:34.284404 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:41:34.363534 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:41:34.367956 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:41:34.416769 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:41:34.435718 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:41:34.450697 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:41:34.468826 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:41:34.474755 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:41:34.481081 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:41:34.486083 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:41:34.501908 (MainThread): Partial parsing not enabled
2021-05-29 13:41:34.607595 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:41:34.967178 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:41:35.040177 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:41:35.096048 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:41:35.141643 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:41:35.177579 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:41:35.223564 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:41:35.254253 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:41:35.300682 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:41:35.336315 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:41:35.368794 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:41:35.409901 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:41:35.452054 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:41:35.485945 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:41:35.520711 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:41:36.444267 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:41:36.473383 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd22c888c-dd20-400f-b406-375d23132036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017317D2E308>]}
2021-05-29 13:41:36.540721 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd22c888c-dd20-400f-b406-375d23132036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017317C61508>]}
2021-05-29 13:41:36.542716 (MainThread): Found 15 models, 10 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:41:36.555228 (MainThread): 
2021-05-29 13:41:36.558889 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:41:36.567164 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:41:36.567164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:41:38.335293 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:41:38.338280 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:41:38.362433 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:41:39.144714 (MainThread): 10:41:39 | Concurrency: 1 threads (target='dev')
2021-05-29 13:41:39.150699 (MainThread): 10:41:39 | 
2021-05-29 13:41:39.167326 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 13:41:39.168921 (Thread-1): 10:41:39 | 1 of 1 START view model dw_adventure_works.dim_address............... [RUN]
2021-05-29 13:41:39.172345 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:41:39.173056 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 13:41:39.191008 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:41:39.195043 (Thread-1): finished collecting timing info
2021-05-29 13:41:39.662033 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 13:41:39.664027 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:41:39.679687 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 13:41:42.811231 (Thread-1): finished collecting timing info
2021-05-29 13:41:42.814224 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd22c888c-dd20-400f-b406-375d23132036', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017315BC2DC8>]}
2021-05-29 13:41:42.816220 (Thread-1): 10:41:42 | 1 of 1 OK created view model dw_adventure_works.dim_address.......... [OK in 3.64s]
2021-05-29 13:41:42.821160 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 13:41:42.863050 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:41:42.872021 (MainThread): 10:41:42 | 
2021-05-29 13:41:42.876546 (MainThread): 10:41:42 | Finished running 1 view model in 6.31s.
2021-05-29 13:41:42.880003 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:41:42.881001 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:41:42.883006 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:41:42.883006 (MainThread): Connection 'model.dw_adventure_works.dim_address' was properly closed.
2021-05-29 13:41:42.888984 (MainThread): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60702), raddr=('172.217.173.106', 443)>
2021-05-29 13:41:42.890980 (MainThread): unclosed <socket.socket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60703), raddr=('142.250.218.74', 443)>
2021-05-29 13:41:42.967772 (MainThread): 
2021-05-29 13:41:42.970761 (MainThread): Completed successfully
2021-05-29 13:41:42.980729 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 13:41:42.983932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017315C4A288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017317847CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731412EE88>]}
2021-05-29 13:41:42.984720 (MainThread): Flushing usage events
2021-05-29 13:46:22.537543 (MainThread): Running with dbt=0.19.1
2021-05-29 13:46:23.804800 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:46:23.806734 (MainThread): Tracking: tracking
2021-05-29 13:46:23.809097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A39C8A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A39D5E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A39D5D48>]}
2021-05-29 13:46:23.834697 (MainThread): Partial parsing not enabled
2021-05-29 13:46:23.839870 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:46:23.889667 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:46:23.906042 (MainThread): Parsing macros\etc.sql
2021-05-29 13:46:23.911727 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:46:23.926706 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:46:23.962849 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:46:23.971760 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:46:23.978303 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:46:24.008223 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:46:24.023184 (MainThread): Parsing macros\core.sql
2021-05-29 13:46:24.035374 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:46:24.132065 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:46:24.154521 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:46:24.158893 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:46:24.163903 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:46:24.170518 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:46:24.175730 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:46:24.178900 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:46:24.202447 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:46:24.229879 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:46:24.235303 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:46:24.248987 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:46:24.290655 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:46:24.376498 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:46:24.383546 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:46:24.438397 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:46:24.458380 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:46:24.470507 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:46:24.484315 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:46:24.490259 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:46:24.494462 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:46:24.499859 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:46:24.516402 (MainThread): Partial parsing not enabled
2021-05-29 13:46:24.576163 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:46:24.600098 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:46:24.610987 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:46:24.621612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:46:24.634437 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:46:24.647003 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:46:24.660426 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:46:24.672393 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:46:24.684396 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:46:24.698368 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:46:24.711334 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:46:24.724389 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:46:24.739022 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:46:24.750415 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:46:24.764380 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:46:24.776308 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:46:24.950650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A750F248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A7484608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A7484A08>]}
2021-05-29 13:46:24.951647 (MainThread): Flushing usage events
2021-05-29 13:46:26.380610 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 13:46:26.380610 (MainThread): Encountered an error:
2021-05-29 13:46:26.381605 (MainThread): Compilation Error
  dbt found two schema.yml entries for the same resource named dim_address. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_address in one of these files:
   - models\marts\dim_reason.yml
  models\marts\dim_address.yml
2021-05-29 13:46:26.412522 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 654, in parse_file
    for test_block in parser.parse():
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 865, in parse
    self.parse_patch(node_block, refs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 911, in parse_patch
    self.results.add_patch(self.yaml.file, result)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\results.py", line 158, in add_patch
    raise_duplicate_patch_name(patch, self.patches[patch.name])
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 857, in raise_duplicate_patch_name
    f'dbt found two schema.yml entries for the same resource named '
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two schema.yml entries for the same resource named dim_address. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_address in one of these files:
   - models\marts\dim_reason.yml
  models\marts\dim_address.yml

2021-05-29 13:47:06.824225 (MainThread): Running with dbt=0.19.1
2021-05-29 13:47:08.908893 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:47:08.912209 (MainThread): Tracking: tracking
2021-05-29 13:47:08.913881 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A6B44F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A6B449C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A6B42C48>]}
2021-05-29 13:47:08.962751 (MainThread): Partial parsing not enabled
2021-05-29 13:47:08.971725 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:47:09.054584 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:47:09.076144 (MainThread): Parsing macros\etc.sql
2021-05-29 13:47:09.084249 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:47:09.099424 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:47:09.152268 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:47:09.163488 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:47:09.171224 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:47:09.210804 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:47:09.232315 (MainThread): Parsing macros\core.sql
2021-05-29 13:47:09.249323 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:47:09.743402 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:47:09.804188 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:47:09.808126 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:47:09.818177 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:47:09.873276 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:47:09.886990 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:47:09.894002 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:47:09.968841 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:47:10.100561 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:47:10.140120 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:47:10.205486 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:47:10.337791 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:47:10.466230 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:47:10.475048 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:47:10.625174 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:47:10.704483 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:47:10.807865 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:47:10.951698 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:47:10.983916 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:47:10.993108 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:47:11.006942 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:47:11.050925 (MainThread): Partial parsing not enabled
2021-05-29 13:47:11.551722 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:47:11.780844 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:47:11.856219 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:47:11.882131 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:47:11.976106 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:47:12.003147 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:47:12.077111 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:47:12.137745 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:47:12.226569 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:47:12.315512 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:47:12.364048 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:47:12.414433 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:47:12.578645 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:47:12.598454 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:47:12.670358 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:47:12.708925 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:47:13.626470 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:47:13.635389 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da197613-3d94-46d3-abd8-7fa5a8842c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4AA865E08>]}
2021-05-29 13:47:13.665103 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da197613-3d94-46d3-abd8-7fa5a8842c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4AA87DC48>]}
2021-05-29 13:47:13.665103 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:47:13.671092 (MainThread): 
2021-05-29 13:47:13.672518 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:47:13.675083 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:47:13.676079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:47:14.841281 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:47:14.842278 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:47:14.858255 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:47:16.268167 (MainThread): 10:47:16 | Concurrency: 1 threads (target='dev')
2021-05-29 13:47:16.270320 (MainThread): 10:47:16 | 
2021-05-29 13:47:16.286117 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 13:47:16.287122 (Thread-1): 10:47:16 | 1 of 1 START view model dw_adventure_works.dim_reason................ [RUN]
2021-05-29 13:47:16.289951 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:47:16.290651 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 13:47:16.304602 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:47:16.308592 (Thread-1): finished collecting timing info
2021-05-29 13:47:16.519354 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:47:16.523453 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:47:16.541548 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesreasonid) as reasonorder_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 13:47:18.798933 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/8863f88d-b388-44e5-93dd-707077057f09?maxResults=0&location=US&prettyPrint=false: Column name salesreasonid is ambiguous at [34:37]')
2021-05-29 13:47:20.074463 (Thread-1): finished collecting timing info
2021-05-29 13:47:20.078439 (Thread-1): Database Error in model dim_reason (models\marts\dim_reason.sql)
  Column name salesreasonid is ambiguous at [34:37]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/b0478029-2834-4dd9-a197-3a8d48ec3f5c?maxResults=0&location=US&prettyPrint=false: Column name salesreasonid is ambiguous at [34:37]

(job ID: b0478029-2834-4dd9-a197-3a8d48ec3f5c)

                                                              -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
   5:  OPTIONS()
   6:  as with
   7:    reasonorder as (
   8:        select
   9:            /*Primary Key*/
  10:            salesreasonid
  11:
  12:            /*Foreign Keys*/
  13:            , salesorderid
  14:
  15:           /*Other Columns*/
  16:            , modifieddate
  17:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  18:    )
  19:
  20:    ,    reason as (
  21:        select
  22:            /*Primary Key*/
  23:            salesreasonid
  24:
  25:           /*Other Columns*/
  26:            , name
  27:            , modifieddate
  28:            , reasontype
  29:        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  30:    )
  31:
  32:    , transformed as (
  33:        select
  34:        row_number() over (order by salesreasonid) as reasonorder_sk
  35:            , reasonorder.salesreasonid
  36:            , reasonorder.salesorderid
  37:            , reasonorder.modifieddate
  38:            , reason.name
  39:            , reason.modifieddate
  40:            , reason.reasontype
  41:        from reasonorder
  42:        left join reason on reasonorder.salesreasonid = reason.salesreasonid
  43:    )
  44:    select * from transformed;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_reason (models\marts\dim_reason.sql)
  Column name salesreasonid is ambiguous at [34:37]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 13:47:20.219117 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da197613-3d94-46d3-abd8-7fa5a8842c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A6B909C8>]}
2021-05-29 13:47:20.219117 (Thread-1): 10:47:20 | 1 of 1 ERROR creating view model dw_adventure_works.dim_reason....... [ERROR in 3.93s]
2021-05-29 13:47:20.230673 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 13:47:20.251738 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:47:20.252613 (MainThread): 10:47:20 | 
2021-05-29 13:47:20.254621 (MainThread): 10:47:20 | Finished running 1 view model in 6.58s.
2021-05-29 13:47:20.257598 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:47:20.258598 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:47:20.261323 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:47:20.262603 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 13:47:20.301509 (MainThread): 
2021-05-29 13:47:20.302542 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:47:20.307467 (MainThread): 
2021-05-29 13:47:20.317438 (MainThread): Database Error in model dim_reason (models\marts\dim_reason.sql)
2021-05-29 13:47:20.319433 (MainThread):   Column name salesreasonid is ambiguous at [34:37]
2021-05-29 13:47:20.321428 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 13:47:20.324423 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:47:20.329407 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A895AC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4AA240408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4A6B7CA08>]}
2021-05-29 13:47:20.330572 (MainThread): Flushing usage events
2021-05-29 13:49:14.408295 (MainThread): Running with dbt=0.19.1
2021-05-29 13:49:15.653369 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:49:15.655401 (MainThread): Tracking: tracking
2021-05-29 13:49:15.657459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE25C72708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE25C75F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE25C75DC8>]}
2021-05-29 13:49:15.685606 (MainThread): Partial parsing not enabled
2021-05-29 13:49:15.691654 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:49:15.749783 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:49:15.769355 (MainThread): Parsing macros\etc.sql
2021-05-29 13:49:15.778158 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:49:15.793149 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:49:15.834172 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:49:15.848566 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:49:15.860010 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:49:15.894077 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:49:15.910034 (MainThread): Parsing macros\core.sql
2021-05-29 13:49:15.924060 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:49:16.058673 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:49:16.090548 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:49:16.094108 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:49:16.100235 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:49:16.112384 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:49:16.117374 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:49:16.122010 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:49:16.148125 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:49:16.190164 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:49:16.197035 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:49:16.216099 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:49:16.286436 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:49:16.393098 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:49:16.399166 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:49:16.453899 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:49:16.476330 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:49:16.493454 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:49:16.517944 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:49:16.530320 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:49:16.535753 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:49:16.542713 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:49:16.570858 (MainThread): Partial parsing not enabled
2021-05-29 13:49:16.691723 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:49:16.721607 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:49:16.733605 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:49:16.745314 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:49:16.756839 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:49:16.769805 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:49:16.780480 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:49:16.791451 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:49:16.803307 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:49:16.816310 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:49:16.830241 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:49:16.844235 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:49:16.860743 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:49:16.873590 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:49:16.888678 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:49:16.907283 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:49:17.476507 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:49:17.483400 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f622a620-fc03-4c21-84a7-e9aea1c11f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE29988F88>]}
2021-05-29 13:49:17.511698 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f622a620-fc03-4c21-84a7-e9aea1c11f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE299B2748>]}
2021-05-29 13:49:17.512231 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:49:17.517196 (MainThread): 
2021-05-29 13:49:17.518375 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:49:17.521259 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:49:17.522214 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:49:19.109731 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:49:19.111727 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:49:19.148260 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:49:20.812558 (MainThread): 10:49:20 | Concurrency: 1 threads (target='dev')
2021-05-29 13:49:20.815666 (MainThread): 10:49:20 | 
2021-05-29 13:49:20.831108 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 13:49:20.832105 (Thread-1): 10:49:20 | 1 of 1 START view model dw_adventure_works.dim_reason................ [RUN]
2021-05-29 13:49:20.834100 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:49:20.834100 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 13:49:20.843241 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:49:20.845070 (Thread-1): finished collecting timing info
2021-05-29 13:49:20.917998 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:49:20.921988 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:49:20.930794 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesorderid) as salesorder_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 13:49:23.443425 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/656191c4-e4b9-4db8-ab51-5426abf5b74b?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name modifieddate at [6:6]')
2021-05-29 13:49:25.378229 (Thread-1): finished collecting timing info
2021-05-29 13:49:25.381215 (Thread-1): Database Error in model dim_reason (models\marts\dim_reason.sql)
  CREATE VIEW has columns with duplicate name modifieddate at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/455119c5-f72c-4dc9-aced-2c475aa9dfd9?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name modifieddate at [6:6]

(job ID: 455119c5-f72c-4dc9-aced-2c475aa9dfd9)

                                                              -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
   5:  OPTIONS()
   6:  as with
   7:    reasonorder as (
   8:        select
   9:            /*Primary Key*/
  10:            salesreasonid
  11:
  12:            /*Foreign Keys*/
  13:            , salesorderid
  14:
  15:           /*Other Columns*/
  16:            , modifieddate
  17:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  18:    )
  19:
  20:    ,    reason as (
  21:        select
  22:            /*Primary Key*/
  23:            salesreasonid
  24:
  25:           /*Other Columns*/
  26:            , name
  27:            , modifieddate
  28:            , reasontype
  29:        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  30:    )
  31:
  32:    , transformed as (
  33:        select
  34:        row_number() over (order by salesorderid) as salesorder_sk
  35:            , reasonorder.salesreasonid
  36:            , reasonorder.salesorderid
  37:            , reasonorder.modifieddate
  38:            , reason.name
  39:            , reason.modifieddate
  40:            , reason.reasontype
  41:        from reasonorder
  42:        left join reason on reasonorder.salesreasonid = reason.salesreasonid
  43:    )
  44:    select * from transformed;
  45:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_reason (models\marts\dim_reason.sql)
  CREATE VIEW has columns with duplicate name modifieddate at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 13:49:25.501318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f622a620-fc03-4c21-84a7-e9aea1c11f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE29974A08>]}
2021-05-29 13:49:25.506081 (Thread-1): 10:49:25 | 1 of 1 ERROR creating view model dw_adventure_works.dim_reason....... [ERROR in 4.67s]
2021-05-29 13:49:25.515381 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 13:49:25.531782 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:49:25.534301 (MainThread): 10:49:25 | 
2021-05-29 13:49:25.542393 (MainThread): 10:49:25 | Finished running 1 view model in 8.02s.
2021-05-29 13:49:25.545393 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:49:25.547392 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:49:25.549403 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:49:25.558368 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 13:49:25.613081 (MainThread): 
2021-05-29 13:49:25.613668 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 13:49:25.615749 (MainThread): 
2021-05-29 13:49:25.616413 (MainThread): Database Error in model dim_reason (models\marts\dim_reason.sql)
2021-05-29 13:49:25.619406 (MainThread):   CREATE VIEW has columns with duplicate name modifieddate at [6:6]
2021-05-29 13:49:25.625540 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 13:49:25.627545 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 13:49:25.628592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE27C3B588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE2783A2C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE25C5EC88>]}
2021-05-29 13:49:25.629590 (MainThread): Flushing usage events
2021-05-29 13:49:49.804878 (MainThread): Running with dbt=0.19.1
2021-05-29 13:49:50.623869 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 13:49:50.623869 (MainThread): Tracking: tracking
2021-05-29 13:49:50.624868 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BC4D4F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BC4DBB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BC4DB1C8>]}
2021-05-29 13:49:50.646366 (MainThread): Partial parsing not enabled
2021-05-29 13:49:50.650356 (MainThread): Parsing macros\adapters.sql
2021-05-29 13:49:50.693327 (MainThread): Parsing macros\catalog.sql
2021-05-29 13:49:50.706765 (MainThread): Parsing macros\etc.sql
2021-05-29 13:49:50.711275 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 13:49:50.723164 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 13:49:50.752085 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 13:49:50.760143 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 13:49:50.765048 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 13:49:50.787039 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 13:49:50.797978 (MainThread): Parsing macros\core.sql
2021-05-29 13:49:50.807778 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 13:49:50.892470 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 13:49:50.910284 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 13:49:50.913283 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 13:49:50.917274 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 13:49:50.922156 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 13:49:50.926089 (MainThread): Parsing macros\etc\query.sql
2021-05-29 13:49:50.928707 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 13:49:50.950291 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 13:49:50.979148 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 13:49:50.983970 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 13:49:51.000525 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 13:49:51.056352 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 13:49:51.164086 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 13:49:51.170068 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 13:49:51.208441 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 13:49:51.222764 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 13:49:51.233600 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 13:49:51.247837 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 13:49:51.253909 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 13:49:51.257834 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 13:49:51.262580 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 13:49:51.276945 (MainThread): Partial parsing not enabled
2021-05-29 13:49:51.321629 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 13:49:51.351062 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 13:49:51.361939 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 13:49:51.371950 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 13:49:51.381602 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 13:49:51.394603 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 13:49:51.404582 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 13:49:51.415547 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 13:49:51.426486 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 13:49:51.441079 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 13:49:51.452551 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 13:49:51.462912 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 13:49:51.473945 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 13:49:51.482932 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 13:49:51.493903 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 13:49:51.503752 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:49:51.813086 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 13:49:51.818076 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37fdb754-b5c9-4cb6-85f2-ce1359d820ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2C01E6FC8>]}
2021-05-29 13:49:51.837024 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37fdb754-b5c9-4cb6-85f2-ce1359d820ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2C020F9C8>]}
2021-05-29 13:49:51.838200 (MainThread): Found 16 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 13:49:51.843006 (MainThread): 
2021-05-29 13:49:51.844005 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:49:51.845995 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 13:49:51.846993 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 13:49:53.236496 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 13:49:53.237493 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 13:49:53.263294 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 13:49:54.907130 (MainThread): 10:49:54 | Concurrency: 1 threads (target='dev')
2021-05-29 13:49:54.910135 (MainThread): 10:49:54 | 
2021-05-29 13:49:54.930962 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 13:49:54.932958 (Thread-1): 10:49:54 | 1 of 1 START view model dw_adventure_works.dim_reason................ [RUN]
2021-05-29 13:49:54.937943 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 13:49:54.938954 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 13:49:54.958948 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:49:54.963363 (Thread-1): finished collecting timing info
2021-05-29 13:49:55.094902 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 13:49:55.098211 (Thread-1): Opening a new connection, currently in state init
2021-05-29 13:49:55.108889 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesorderid) as salesorder_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 13:49:57.792466 (Thread-1): finished collecting timing info
2021-05-29 13:49:57.794457 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fdb754-b5c9-4cb6-85f2-ce1359d820ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BC48A508>]}
2021-05-29 13:49:57.796882 (Thread-1): 10:49:57 | 1 of 1 OK created view model dw_adventure_works.dim_reason........... [OK in 2.86s]
2021-05-29 13:49:57.801381 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 13:49:57.810318 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 13:49:57.813319 (MainThread): 10:49:57 | 
2021-05-29 13:49:57.815314 (MainThread): 10:49:57 | Finished running 1 view model in 5.97s.
2021-05-29 13:49:57.817300 (MainThread): Connection 'master' was properly closed.
2021-05-29 13:49:57.818294 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 13:49:57.819294 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 13:49:57.820291 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 13:49:57.861244 (MainThread): 
2021-05-29 13:49:57.863174 (MainThread): Completed successfully
2021-05-29 13:49:57.867176 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 13:49:57.872153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BDF22C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BFB99148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2BC519188>]}
2021-05-29 13:49:57.874206 (MainThread): Flushing usage events
2021-05-29 14:13:00.749112 (MainThread): Running with dbt=0.19.1
2021-05-29 14:13:02.101036 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:13:02.105085 (MainThread): Tracking: tracking
2021-05-29 14:13:02.106987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4AB0608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4C36C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4C36FC8>]}
2021-05-29 14:13:02.137985 (MainThread): Partial parsing not enabled
2021-05-29 14:13:02.144132 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:13:02.200976 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:13:02.217283 (MainThread): Parsing macros\etc.sql
2021-05-29 14:13:02.223073 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:13:02.238178 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:13:02.274810 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:13:02.281779 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:13:02.288078 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:13:02.315565 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:13:02.337029 (MainThread): Parsing macros\core.sql
2021-05-29 14:13:02.352205 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:13:02.488098 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:13:02.514022 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:13:02.518154 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:13:02.525035 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:13:02.532340 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:13:02.537697 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:13:02.542965 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:13:02.569400 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:13:02.611089 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:13:02.616840 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:13:02.634539 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:13:02.702916 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:13:02.800436 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:13:02.806429 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:13:02.856492 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:13:02.877135 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:13:02.892742 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:13:02.911824 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:13:02.918230 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:13:02.926209 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:13:02.931785 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:13:02.953521 (MainThread): Partial parsing not enabled
2021-05-29 14:13:03.025927 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:13:03.053695 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:13:03.067678 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:13:03.080939 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:13:03.093100 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:13:03.104357 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:13:03.116906 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:13:03.127390 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:13:03.139178 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:13:03.153170 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:13:03.166701 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:13:03.178699 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:13:03.192171 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:13:03.202670 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:13:03.215628 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:13:03.232082 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:13:03.243187 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:13:03.709426 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:13:03.762446 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:13:03.765282 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:13:03.769278 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:13:03.814379 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:13:03.822347 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB5D462C8>]}
2021-05-29 14:13:03.919952 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB86D7048>]}
2021-05-29 14:13:03.919952 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:13:03.929963 (MainThread): 
2021-05-29 14:13:03.931136 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:13:03.937164 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:13:03.937903 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:13:05.540788 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:13:05.541561 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:13:05.552564 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:13:06.985197 (MainThread): 11:13:06 | Concurrency: 1 threads (target='dev')
2021-05-29 14:13:06.988321 (MainThread): 11:13:06 | 
2021-05-29 14:13:07.097281 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 14:13:07.099289 (Thread-1): 11:13:07 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 14:13:07.102281 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:13:07.104870 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 14:13:07.133446 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:13:07.332740 (Thread-1): finished collecting timing info
2021-05-29 14:13:07.505235 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:13:07.517304 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:13:07.529200 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 14:13:09.964260 (Thread-1): finished collecting timing info
2021-05-29 14:13:09.965255 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4C04E08>]}
2021-05-29 14:13:09.966253 (Thread-1): 11:13:09 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 2.86s]
2021-05-29 14:13:09.968249 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 14:13:09.969247 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:13:09.971240 (Thread-1): 11:13:09 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 14:13:09.979167 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:13:09.980517 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 14:13:09.992494 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:13:09.999026 (Thread-1): finished collecting timing info
2021-05-29 14:13:10.003016 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:13:10.012175 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:10.024194 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 14:13:12.612397 (Thread-1): finished collecting timing info
2021-05-29 14:13:12.615543 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4C12DC8>]}
2021-05-29 14:13:12.617536 (Thread-1): 11:13:12 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.64s]
2021-05-29 14:13:12.623521 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:13:12.626415 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 14:13:12.630402 (Thread-1): 11:13:12 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 14:13:12.638394 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:13:12.639388 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 14:13:12.652408 (Thread-1): unclosed <socket.socket fd=820, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 60999), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:12.656373 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61000), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:12.658647 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61001), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:12.660246 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61002), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:12.678340 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:13:12.683315 (Thread-1): finished collecting timing info
2021-05-29 14:13:12.711853 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:13:12.718311 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:12.739806 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 14:13:15.377761 (Thread-1): finished collecting timing info
2021-05-29 14:13:15.381448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB8664708>]}
2021-05-29 14:13:15.384443 (Thread-1): 11:13:15 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 2.75s]
2021-05-29 14:13:15.393971 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 14:13:15.396082 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:13:15.398077 (Thread-1): 11:13:15 | 4 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 14:13:15.404059 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:13:15.405059 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:13:15.411052 (Thread-1): unclosed <socket.socket fd=820, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61003), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:15.413079 (Thread-1): unclosed <socket.socket fd=424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61004), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:15.439769 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:13:15.446263 (Thread-1): finished collecting timing info
2021-05-29 14:13:15.459673 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:13:15.463667 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:15.476167 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 14:13:18.144530 (Thread-1): finished collecting timing info
2021-05-29 14:13:18.147407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4C184C8>]}
2021-05-29 14:13:18.149442 (Thread-1): 11:13:18 | 4 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.75s]
2021-05-29 14:13:18.154175 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:13:18.157356 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 14:13:18.160626 (Thread-1): 11:13:18 | 5 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 14:13:18.165494 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:13:18.167038 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 14:13:18.200470 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:13:18.207396 (Thread-1): finished collecting timing info
2021-05-29 14:13:18.224223 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:13:18.226583 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:18.238217 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 14:13:20.132253 (Thread-1): finished collecting timing info
2021-05-29 14:13:20.133713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB8512688>]}
2021-05-29 14:13:20.134251 (Thread-1): 11:13:20 | 5 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 1.97s]
2021-05-29 14:13:20.138634 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 14:13:20.142235 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 14:13:20.143208 (Thread-1): 11:13:20 | 6 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 14:13:20.146203 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:13:20.146203 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 14:13:20.154205 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:13:20.160792 (Thread-1): finished collecting timing info
2021-05-29 14:13:20.167369 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:13:20.176509 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:20.191929 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 14:13:22.745480 (Thread-1): finished collecting timing info
2021-05-29 14:13:22.747482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB4BF4E48>]}
2021-05-29 14:13:22.748481 (Thread-1): 11:13:22 | 6 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.60s]
2021-05-29 14:13:22.750474 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 14:13:22.751469 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:13:22.752093 (Thread-1): 11:13:22 | 7 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 14:13:22.758199 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:13:22.758199 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 14:13:22.767070 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:13:22.772263 (Thread-1): finished collecting timing info
2021-05-29 14:13:22.781195 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:13:22.783186 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:22.798223 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 14:13:25.400595 (Thread-1): finished collecting timing info
2021-05-29 14:13:25.402589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB85C8E08>]}
2021-05-29 14:13:25.402589 (Thread-1): 11:13:25 | 7 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 2.65s]
2021-05-29 14:13:25.405104 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:13:25.405104 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:13:25.406260 (Thread-1): 11:13:25 | 8 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 14:13:25.408260 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:13:25.409258 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 14:13:25.417619 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:13:25.421461 (Thread-1): finished collecting timing info
2021-05-29 14:13:25.438497 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61006), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.439496 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61005), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.439496 (Thread-1): unclosed <socket.socket fd=1304, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61007), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.440494 (Thread-1): unclosed <socket.socket fd=1272, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61008), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.440494 (Thread-1): unclosed <socket.socket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61009), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.441663 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61010), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.442516 (Thread-1): unclosed <socket.socket fd=1368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61011), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.443484 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61012), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:25.445613 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:13:25.448603 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:25.465680 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 14:13:27.960025 (Thread-1): finished collecting timing info
2021-05-29 14:13:27.960980 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB85AACC8>]}
2021-05-29 14:13:27.962041 (Thread-1): 11:13:27 | 8 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 2.55s]
2021-05-29 14:13:27.963049 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:13:27.963049 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 14:13:27.964110 (Thread-1): 11:13:27 | 9 of 17 START view model dw_adventure_works.stg_orders............... [RUN]
2021-05-29 14:13:27.966292 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:13:27.966292 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 14:13:27.968105 (Thread-1): unclosed <socket.socket fd=1424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61013), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:27.969102 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61014), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:27.974605 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:13:27.976600 (Thread-1): finished collecting timing info
2021-05-29 14:13:27.979592 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:13:27.981828 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:27.997341 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 14:13:30.518024 (Thread-1): finished collecting timing info
2021-05-29 14:13:30.519023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB855AD08>]}
2021-05-29 14:13:30.520019 (Thread-1): 11:13:30 | 9 of 17 OK created view model dw_adventure_works.stg_orders.......... [OK in 2.55s]
2021-05-29 14:13:30.521016 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 14:13:30.521016 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:13:30.522016 (Thread-1): 11:13:30 | 10 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 14:13:30.523012 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:13:30.523012 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 14:13:30.528070 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:13:30.531509 (Thread-1): finished collecting timing info
2021-05-29 14:13:30.538584 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:13:30.541550 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:30.550054 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 14:13:32.984501 (Thread-1): finished collecting timing info
2021-05-29 14:13:32.987446 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB8573A08>]}
2021-05-29 14:13:32.989439 (Thread-1): 11:13:32 | 10 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 2.47s]
2021-05-29 14:13:32.994417 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:13:32.995967 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:13:32.998972 (Thread-1): 11:13:32 | 11 of 17 START view model dw_adventure_works.stg_orderdetail......... [RUN]
2021-05-29 14:13:33.003950 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:13:33.005193 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 14:13:33.015157 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:13:33.018232 (Thread-1): finished collecting timing info
2021-05-29 14:13:33.024198 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:13:33.027800 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:33.041269 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 14:13:35.441566 (Thread-1): finished collecting timing info
2021-05-29 14:13:35.443562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB8718C48>]}
2021-05-29 14:13:35.445556 (Thread-1): 11:13:35 | 11 of 17 OK created view model dw_adventure_works.stg_orderdetail.... [OK in 2.44s]
2021-05-29 14:13:35.450597 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:13:35.452541 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:13:35.455536 (Thread-1): 11:13:35 | 12 of 17 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 14:13:35.460516 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:13:35.461525 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 14:13:35.470546 (Thread-1): unclosed <socket.socket fd=1512, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61019), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:35.476474 (Thread-1): unclosed <socket.socket fd=1544, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61020), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:35.506396 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:13:35.514871 (Thread-1): finished collecting timing info
2021-05-29 14:13:35.540308 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:13:35.554269 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:35.576203 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:13:37.591983 (Thread-1): finished collecting timing info
2021-05-29 14:13:37.593978 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB857AE08>]}
2021-05-29 14:13:37.595972 (Thread-1): 11:13:37 | 12 of 17 OK created view model dw_adventure_works.dim_creditcard..... [OK in 2.13s]
2021-05-29 14:13:37.619900 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:13:37.620843 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 14:13:37.622177 (Thread-1): 11:13:37 | 13 of 17 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 14:13:37.624292 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:13:37.624833 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 14:13:37.626829 (Thread-1): unclosed <socket.socket fd=1556, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61021), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:37.627824 (Thread-1): unclosed <socket.socket fd=1544, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61022), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:37.639811 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:13:37.642909 (Thread-1): finished collecting timing info
2021-05-29 14:13:37.646772 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:13:37.650146 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:37.663111 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed;


2021-05-29 14:13:37.851172 (Thread-1): unclosed <socket.socket fd=1456, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61015), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:37.853165 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61016), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:37.854163 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61017), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:37.855158 (Thread-1): unclosed <socket.socket fd=1504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61018), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:39.457678 (Thread-1): finished collecting timing info
2021-05-29 14:13:39.460668 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB98C5808>]}
2021-05-29 14:13:39.461666 (Thread-1): 11:13:39 | 13 of 17 OK created view model dw_adventure_works.dim_customer....... [OK in 1.84s]
2021-05-29 14:13:39.466568 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 14:13:39.468477 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 14:13:39.471468 (Thread-1): 11:13:39 | 14 of 17 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 14:13:39.475464 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:13:39.476460 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 14:13:39.489419 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:13:39.491528 (Thread-1): finished collecting timing info
2021-05-29 14:13:39.496399 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:13:39.501472 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:39.510393 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:13:42.011670 (Thread-1): finished collecting timing info
2021-05-29 14:13:42.014649 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB8840048>]}
2021-05-29 14:13:42.015646 (Thread-1): 11:13:42 | 14 of 17 OK created view model dw_adventure_works.dim_product........ [OK in 2.54s]
2021-05-29 14:13:42.022579 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 14:13:42.024576 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 14:13:42.026574 (Thread-1): 11:13:42 | 15 of 17 START view model dw_adventure_works.dim_reason.............. [RUN]
2021-05-29 14:13:42.031557 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:13:42.032554 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 14:13:42.035544 (Thread-1): unclosed <socket.socket fd=1240, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61025), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:42.036541 (Thread-1): unclosed <socket.socket fd=1652, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61026), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:42.045516 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:13:42.047738 (Thread-1): finished collecting timing info
2021-05-29 14:13:42.053529 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:13:42.056485 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:42.070939 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by reasonorder.salesreasonid) as reason_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 14:13:44.042765 (Thread-1): finished collecting timing info
2021-05-29 14:13:44.044760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB98F5908>]}
2021-05-29 14:13:44.046755 (Thread-1): 11:13:44 | 15 of 17 OK created view model dw_adventure_works.dim_reason......... [OK in 2.01s]
2021-05-29 14:13:44.052742 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 14:13:44.053904 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 14:13:44.056731 (Thread-1): 11:13:44 | 16 of 17 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 14:13:44.061715 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:13:44.061715 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 14:13:44.087080 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:13:44.092055 (Thread-1): finished collecting timing info
2021-05-29 14:13:44.119988 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:13:44.124963 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:44.160873 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 14:13:46.622274 (Thread-1): finished collecting timing info
2021-05-29 14:13:46.623269 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB9915208>]}
2021-05-29 14:13:46.624346 (Thread-1): 11:13:46 | 16 of 17 OK created view model dw_adventure_works.dim_address........ [OK in 2.56s]
2021-05-29 14:13:46.626260 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 14:13:46.628256 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:13:46.628256 (Thread-1): 11:13:46 | 17 of 17 START view model dw_adventure_works.fact_order_details...... [RUN]
2021-05-29 14:13:46.630251 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:13:46.631276 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:13:46.644212 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:13:46.645209 (Thread-1): finished collecting timing info
2021-05-29 14:13:46.652229 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:13:46.655183 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:13:46.666186 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )


select * from orders_with_sk;


2021-05-29 14:13:48.100107 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/827fc871-a087-4d44-9904-08ca6f723759?maxResults=0&location=US&prettyPrint=false: Column name salesorderid is ambiguous at [29:13]')
2021-05-29 14:13:50.166051 (Thread-1): finished collecting timing info
2021-05-29 14:13:50.169043 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name salesorderid is ambiguous at [29:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/4f21d00b-bac0-4ccd-907e-4fddb0d9ea0a?maxResults=0&location=US&prettyPrint=false: Column name salesorderid is ambiguous at [29:13]

(job ID: 4f21d00b-bac0-4ccd-907e-4fddb0d9ea0a)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customer as (
   8:        select *
   9:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  10:    )
  11:    , creditcard as (
  12:        select *
  13:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  14:    )
  15:    , product as (
  16:        select *
  17:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  18:    )
  19:    , address as (
  20:        select *
  21:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  22:    )
  23:    , reason as (
  24:        select *
  25:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  26:    )
  27:    , orders_with_sk as (
  28:            select
  29:            salesorderid
  30:            , customer.customer_sk as customer_fk
  31:            , creditcard.creditcard_sk as creditcard_fk
  32:            , address.address_sk as address_fk
  33:            , reason.reason_sk as reason_fk
  34:            , shipmethodid
  35:            , billtoaddressid
  36:            , salespersonid
  37:            , currencyrateid
  38:            , territoryid
  39:            , orders.purchaseordernumber
  40:            , orders.modifieddate
  41:            , orders.rowguid
  42:            , orders.taxamt
  43:            , orders.onlineorderflag
  44:            , orders.status
  45:            , orders.orderdate
  46:            , orders.creditcardapprovalcode
  47:            , orders.subtotal
  48:            , orders.revisionnumber
  49:            , orders.freight
  50:            , orders.duedate
  51:            , orders.totaldue
  52:            , orders.shipdate
  53:            , orders.accountnumber
  54:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  55:
  56:        left join customer on orders.customerid = customer.customerid
  57:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  58:        left join address on orders.shiptoaddressid = address.addressid
  59:        left join reason on orders.salesorderid = reason.salesorderid
  60:
  61:    )
  62:
  63:
  64:select * from orders_with_sk;
  65:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name salesorderid is ambiguous at [29:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:13:50.254972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '543ea8dc-109f-4af1-949c-721a08062e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB9949888>]}
2021-05-29 14:13:50.257383 (Thread-1): 11:13:50 | 17 of 17 ERROR creating view model dw_adventure_works.fact_order_details [ERROR in 3.63s]
2021-05-29 14:13:50.263368 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:13:50.286658 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:13:50.289660 (MainThread): 11:13:50 | 
2021-05-29 14:13:50.292657 (MainThread): 11:13:50 | Finished running 17 view models in 46.36s.
2021-05-29 14:13:50.297806 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:13:50.299624 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:13:50.300622 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:13:50.302616 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:13:50.349509 (MainThread): unclosed <socket.socket fd=1652, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61027), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.350486 (MainThread): unclosed <socket.socket fd=1680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61028), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.351490 (MainThread): unclosed <socket.socket fd=1708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61029), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.352487 (MainThread): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61030), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.352696 (MainThread): unclosed <socket.socket fd=1744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61033), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.353924 (MainThread): unclosed <socket.socket fd=1712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61032), raddr=('142.250.79.202', 443)>
2021-05-29 14:13:50.371073 (MainThread): 
2021-05-29 14:13:50.371750 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 14:13:50.373170 (MainThread): 
2021-05-29 14:13:50.374192 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 14:13:50.375062 (MainThread):   Column name salesorderid is ambiguous at [29:13]
2021-05-29 14:13:50.376060 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:13:50.377057 (MainThread): 
Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
2021-05-29 14:13:50.378054 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB9AA4E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB9AE1108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BB9AE1588>]}
2021-05-29 14:13:50.378054 (MainThread): Flushing usage events
2021-05-29 14:14:52.914737 (MainThread): Running with dbt=0.19.1
2021-05-29 14:14:54.641087 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:14:54.642085 (MainThread): Tracking: tracking
2021-05-29 14:14:54.643082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACB8E0548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACBA62B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACBA62EC8>]}
2021-05-29 14:14:54.693823 (MainThread): Partial parsing not enabled
2021-05-29 14:14:54.702008 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:14:54.800515 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:14:54.823158 (MainThread): Parsing macros\etc.sql
2021-05-29 14:14:54.829688 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:14:54.847686 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:14:54.948126 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:14:54.962910 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:14:54.974947 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:14:55.031474 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:14:55.064098 (MainThread): Parsing macros\core.sql
2021-05-29 14:14:55.082566 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:14:55.298415 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:14:55.345205 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:14:55.348443 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:14:55.361502 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:14:55.373724 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:14:55.379656 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:14:55.382759 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:14:55.432891 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:14:55.496837 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:14:55.509088 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:14:55.544554 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:14:55.648781 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:14:55.850817 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:14:55.864740 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:14:55.957617 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:14:55.991128 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:14:56.013315 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:14:56.046695 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:14:56.067190 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:14:56.077853 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:14:56.090179 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:14:56.120842 (MainThread): Partial parsing not enabled
2021-05-29 14:14:56.257758 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:14:56.312248 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:14:56.333108 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:14:56.352008 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:14:56.367500 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:14:56.389659 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:14:56.428914 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:14:56.462167 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:14:56.483026 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:14:56.512870 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:14:56.529824 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:14:56.560201 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:14:56.580147 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:14:56.608763 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:14:56.626309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:14:56.646716 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:14:56.665693 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:14:57.374805 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:14:57.377774 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:14:57.379769 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:14:57.381763 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:14:57.427588 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:14:57.432510 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e87af20-f996-4852-8941-b7d68bc6e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF4A68C8>]}
2021-05-29 14:14:57.581461 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e87af20-f996-4852-8941-b7d68bc6e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF69CC08>]}
2021-05-29 14:14:57.586044 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:14:57.598665 (MainThread): 
2021-05-29 14:14:57.601785 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:14:57.608856 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:14:57.608856 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:14:58.992191 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:14:58.992735 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:14:59.011330 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:14:59.761735 (MainThread): 11:14:59 | Concurrency: 1 threads (target='dev')
2021-05-29 14:14:59.763681 (MainThread): 11:14:59 | 
2021-05-29 14:14:59.778640 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:14:59.783833 (Thread-1): 11:14:59 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:14:59.789798 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:14:59.791784 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:14:59.831644 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:14:59.840655 (Thread-1): finished collecting timing info
2021-05-29 14:14:59.986694 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:14:59.989684 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:15:00.007758 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )


select * from orders_with_sk;


2021-05-29 14:15:02.518140 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/ecca07ac-ce5d-4432-a4d2-90b726d8d87f?maxResults=0&location=US&prettyPrint=false: Column name territoryid is ambiguous at [38:15]')
2021-05-29 14:15:03.727039 (Thread-1): finished collecting timing info
2021-05-29 14:15:03.729034 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name territoryid is ambiguous at [38:15]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/f9dc7071-6a2e-46da-bc25-159935bd7579?maxResults=0&location=US&prettyPrint=false: Column name territoryid is ambiguous at [38:15]

(job ID: f9dc7071-6a2e-46da-bc25-159935bd7579)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customer as (
   8:        select *
   9:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  10:    )
  11:    , creditcard as (
  12:        select *
  13:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  14:    )
  15:    , product as (
  16:        select *
  17:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  18:    )
  19:    , address as (
  20:        select *
  21:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  22:    )
  23:    , reason as (
  24:        select *
  25:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  26:    )
  27:    , orders_with_sk as (
  28:            select
  29:            orders.salesorderid
  30:            , customer.customer_sk as customer_fk
  31:            , creditcard.creditcard_sk as creditcard_fk
  32:            , address.address_sk as address_fk
  33:            , reason.reason_sk as reason_fk
  34:            , shipmethodid
  35:            , billtoaddressid
  36:            , salespersonid
  37:            , currencyrateid
  38:            , territoryid
  39:            , orders.purchaseordernumber
  40:            , orders.modifieddate
  41:            , orders.rowguid
  42:            , orders.taxamt
  43:            , orders.onlineorderflag
  44:            , orders.status
  45:            , orders.orderdate
  46:            , orders.creditcardapprovalcode
  47:            , orders.subtotal
  48:            , orders.revisionnumber
  49:            , orders.freight
  50:            , orders.duedate
  51:            , orders.totaldue
  52:            , orders.shipdate
  53:            , orders.accountnumber
  54:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  55:
  56:        left join customer on orders.customerid = customer.customerid
  57:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  58:        left join address on orders.shiptoaddressid = address.addressid
  59:        left join reason on orders.salesorderid = reason.salesorderid
  60:
  61:    )
  62:
  63:
  64:select * from orders_with_sk;
  65:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name territoryid is ambiguous at [38:15]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:15:03.773293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e87af20-f996-4852-8941-b7d68bc6e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACBA97688>]}
2021-05-29 14:15:03.774840 (Thread-1): 11:15:03 | 1 of 1 ERROR creating view model dw_adventure_works.fact_order_details [ERROR in 3.99s]
2021-05-29 14:15:03.775824 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:15:03.797167 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:15:03.798163 (MainThread): 11:15:03 | 
2021-05-29 14:15:03.801165 (MainThread): 11:15:03 | Finished running 1 view model in 6.20s.
2021-05-29 14:15:03.805274 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:15:03.805274 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:15:03.806095 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:15:03.806095 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:15:03.828049 (MainThread): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61047), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.829096 (MainThread): unclosed <socket.socket fd=728, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61048), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.830424 (MainThread): unclosed <socket.socket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61050), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.831042 (MainThread): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61049), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.831575 (MainThread): unclosed <socket.socket fd=656, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61052), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.832558 (MainThread): unclosed <socket.socket fd=748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61051), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:03.860139 (MainThread): 
2021-05-29 14:15:03.862133 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 14:15:03.868176 (MainThread): 
2021-05-29 14:15:03.872172 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 14:15:03.874557 (MainThread):   Column name territoryid is ambiguous at [38:15]
2021-05-29 14:15:03.876076 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:15:03.878070 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 14:15:03.880660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF344108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF344148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF311288>]}
2021-05-29 14:15:03.881063 (MainThread): Flushing usage events
2021-05-29 14:15:37.957025 (MainThread): Running with dbt=0.19.1
2021-05-29 14:15:38.709657 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:15:38.712650 (MainThread): Tracking: tracking
2021-05-29 14:15:38.713827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CA9E108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CA9ACC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CAA5C88>]}
2021-05-29 14:15:38.741679 (MainThread): Partial parsing not enabled
2021-05-29 14:15:38.745207 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:15:38.808873 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:15:38.827681 (MainThread): Parsing macros\etc.sql
2021-05-29 14:15:38.833911 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:15:38.850116 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:15:38.887697 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:15:38.898554 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:15:38.904663 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:15:38.935881 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:15:38.951378 (MainThread): Parsing macros\core.sql
2021-05-29 14:15:38.964541 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:15:39.088461 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:15:39.117234 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:15:39.120214 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:15:39.125336 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:15:39.133360 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:15:39.138243 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:15:39.142232 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:15:39.172535 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:15:39.214615 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:15:39.220588 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:15:39.238546 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:15:39.300990 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:15:39.401392 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:15:39.407783 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:15:39.456775 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:15:39.474596 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:15:39.489501 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:15:39.510480 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:15:39.519510 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:15:39.524548 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:15:39.530696 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:15:39.551045 (MainThread): Partial parsing not enabled
2021-05-29 14:15:39.619655 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:15:39.649239 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:15:39.660260 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:15:39.669848 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:15:39.679386 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:15:39.689355 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:15:39.701657 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:15:39.712792 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:15:39.722612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:15:39.734615 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:15:39.745552 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:15:39.756777 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:15:39.767657 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:15:39.778614 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:15:39.792590 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:15:39.802434 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:15:39.813976 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:15:40.203400 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:15:40.205395 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:15:40.207732 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:15:40.209386 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:15:40.237593 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:15:40.244568 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad3c60e-d584-4f9d-bf2d-c7c6529cba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949035CB48>]}
2021-05-29 14:15:40.320750 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad3c60e-d584-4f9d-bf2d-c7c6529cba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CA3D3C8>]}
2021-05-29 14:15:40.320750 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:15:40.330297 (MainThread): 
2021-05-29 14:15:40.331046 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:15:40.334048 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:15:40.334048 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:15:41.174414 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:15:41.176895 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:15:41.233293 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:15:42.776430 (MainThread): 11:15:42 | Concurrency: 1 threads (target='dev')
2021-05-29 14:15:42.778425 (MainThread): 11:15:42 | 
2021-05-29 14:15:42.783413 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:15:42.784458 (Thread-1): 11:15:42 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:15:42.786405 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:15:42.786405 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:15:42.798409 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:15:42.800078 (Thread-1): finished collecting timing info
2021-05-29 14:15:42.880934 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:15:42.882919 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:15:42.895769 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )


select * from orders_with_sk;


2021-05-29 14:15:45.676529 (Thread-1): finished collecting timing info
2021-05-29 14:15:45.678525 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad3c60e-d584-4f9d-bf2d-c7c6529cba23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CAFEC88>]}
2021-05-29 14:15:45.681892 (Thread-1): 11:15:45 | 1 of 1 OK created view model dw_adventure_works.fact_order_details... [OK in 2.89s]
2021-05-29 14:15:45.686880 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:15:45.764390 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:15:45.766392 (MainThread): 11:15:45 | 
2021-05-29 14:15:45.769373 (MainThread): 11:15:45 | Finished running 1 view model in 5.44s.
2021-05-29 14:15:45.770974 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:15:45.773982 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:15:45.774981 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:15:45.776973 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:15:45.810821 (MainThread): unclosed <socket.socket fd=452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61057), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.812833 (MainThread): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61058), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.813824 (MainThread): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61060), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.814810 (MainThread): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61059), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.815764 (MainThread): unclosed <socket.socket fd=848, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61062), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.816806 (MainThread): unclosed <socket.socket fd=1060, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61061), raddr=('142.250.79.202', 443)>
2021-05-29 14:15:45.863510 (MainThread): 
2021-05-29 14:15:45.865500 (MainThread): Completed successfully
2021-05-29 14:15:45.870620 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 14:15:45.877887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949054AC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294906EC748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948CA795C8>]}
2021-05-29 14:15:45.880794 (MainThread): Flushing usage events
2021-05-29 14:28:48.402887 (MainThread): Running with dbt=0.19.1
2021-05-29 14:28:49.340997 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:28:49.342991 (MainThread): Tracking: tracking
2021-05-29 14:28:49.343989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001857E670548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018502184B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018502184C88>]}
2021-05-29 14:28:49.366045 (MainThread): Partial parsing not enabled
2021-05-29 14:28:49.370564 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:28:49.410872 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:28:49.425550 (MainThread): Parsing macros\etc.sql
2021-05-29 14:28:49.430783 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:28:49.441277 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:28:49.467247 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:28:49.473757 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:28:49.478426 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:28:49.500372 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:28:49.516350 (MainThread): Parsing macros\core.sql
2021-05-29 14:28:49.526326 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:28:49.617080 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:28:49.639054 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:28:49.642652 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:28:49.646684 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:28:49.651639 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:28:49.656624 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:28:49.659616 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:28:49.678497 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:28:49.708422 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:28:49.712411 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:28:49.725953 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:28:49.770874 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:28:49.837657 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:28:49.842645 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:28:49.882540 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:28:49.897231 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:28:49.909205 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:28:49.925829 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:28:49.931853 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:28:49.936825 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:28:49.941791 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:28:49.955752 (MainThread): Partial parsing not enabled
2021-05-29 14:28:50.002306 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:28:50.021346 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:28:50.030322 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:28:50.037874 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:28:50.047440 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:28:50.055417 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:28:50.064393 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:28:50.073424 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:28:50.082332 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:28:50.091309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:28:50.099521 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:28:50.107500 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:28:50.116456 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:28:50.124885 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:28:50.134018 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:28:50.142426 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:28:50.150404 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:28:50.460405 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:28:50.462365 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:28:50.464361 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:28:50.466357 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:28:50.493284 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:28:50.500263 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7416dd4b-5f99-4f50-9834-8646e83e4a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185023E4388>]}
2021-05-29 14:28:50.590022 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7416dd4b-5f99-4f50-9834-8646e83e4a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850258BE88>]}
2021-05-29 14:28:50.590022 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:28:50.596007 (MainThread): 
2021-05-29 14:28:50.597004 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:28:50.598999 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:28:50.599998 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:28:52.123399 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:28:52.124395 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:28:52.135360 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:28:53.450097 (MainThread): 11:28:53 | Concurrency: 1 threads (target='dev')
2021-05-29 14:28:53.453087 (MainThread): 11:28:53 | 
2021-05-29 14:28:53.461423 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:28:53.462419 (Thread-1): 11:28:53 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:28:53.463420 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:28:53.463420 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:28:53.472395 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:28:53.475385 (Thread-1): finished collecting timing info
2021-05-29 14:28:53.578110 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:28:53.581677 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:28:53.593649 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.product_id
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.rowguid
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.modifieddate
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:28:55.786286 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/672c1b65-fc9e-4e93-985d-be3a58117922?maxResults=0&location=US&prettyPrint=false: Name product_id not found inside product at [76:64]')
2021-05-29 14:28:57.927107 (Thread-1): finished collecting timing info
2021-05-29 14:28:57.928105 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name product_id not found inside product at [76:64]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/7db069e3-19d7-4583-8963-cf2d9fdd7d57?maxResults=0&location=US&prettyPrint=false: Name product_id not found inside product at [76:64]

(job ID: 7db069e3-19d7-4583-8963-cf2d9fdd7d57)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customer as (
   8:        select *
   9:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  10:    )
  11:    , creditcard as (
  12:        select *
  13:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  14:    )
  15:    , product as (
  16:        select *
  17:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  18:    )
  19:    , address as (
  20:        select *
  21:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  22:    )
  23:    , reason as (
  24:        select *
  25:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  26:    )
  27:    , orders_with_sk as (
  28:            select
  29:            orders.salesorderid
  30:            , customer.customer_sk as customer_fk
  31:            , creditcard.creditcard_sk as creditcard_fk
  32:            , address.address_sk as address_fk
  33:            , reason.reason_sk as reason_fk
  34:            , orders.shipmethodid
  35:            , orders.billtoaddressid
  36:            , orders.salespersonid
  37:            , orders.currencyrateid
  38:            , orders.territoryid
  39:            , orders.purchaseordernumber
  40:            , orders.modifieddate
  41:            , orders.rowguid
  42:            , orders.taxamt
  43:            , orders.onlineorderflag
  44:            , orders.status
  45:            , orders.orderdate
  46:            , orders.creditcardapprovalcode
  47:            , orders.subtotal
  48:            , orders.revisionnumber
  49:            , orders.freight
  50:            , orders.duedate
  51:            , orders.totaldue
  52:            , orders.shipdate
  53:            , orders.accountnumber
  54:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  55:
  56:        left join customer on orders.customerid = customer.customerid
  57:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  58:        left join address on orders.shiptoaddressid = address.addressid
  59:        left join reason on orders.salesorderid = reason.salesorderid
  60:
  61:    )
  62:
  63:   , order_detail_with_sk as (
  64:        select
  65:            order_details.salesorderid
  66:            , order_details.specialofferid
  67:            , order_details.salesorderdetailid
  68:            , order_details.unitpricediscount
  69:            , order_details.unitprice
  70:            , order_details.rowguid
  71:            , order_details.orderqty
  72:            , order_details.modifieddate
  73:            , order_details.carriertrackingnumber
  74:            , product.product_sk as product_fk
  75:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  76:        left join product on order_details.productid = product.product_id
  77:    )
  78:
  79:    , final as (
  80:        select
  81:         orders_with_sk.salesorderid
  82:            , orders_with_sk.customer_fk
  83:            , orders_with_sk.creditcard_fk
  84:            , orders_with_sk.address_fk
  85:            , orders_with_sk.reason_fk
  86:            , orders_with_sk.shipmethodid
  87:            , orders_with_sk.billtoaddressid
  88:            , orders_with_sk.salespersonid
  89:            , orders_with_sk.currencyrateid
  90:            , orders_with_sk.territoryid
  91:            , orders_with_sk.purchaseordernumber
  92:            , orders_with_sk.modifieddate
  93:            , orders_with_sk.rowguid
  94:            , orders_with_sk.taxamt
  95:            , orders_with_sk.onlineorderflag
  96:            , orders_with_sk.status
  97:            , orders_with_sk.orderdate
  98:            , orders_with_sk.creditcardapprovalcode
  99:            , orders_with_sk.subtotal
 100:            , orders_with_sk.revisionnumber
 101:            , orders_with_sk.freight
 102:            , orders_with_sk.duedate
 103:            , orders_with_sk.totaldue
 104:            , orders_with_sk.shipdate
 105:            , orders_with_sk.accountnumber
 106:            , order_detail_with_sk.specialofferid
 107:            , order_detail_with_sk.salesorderdetailid
 108:            , order_detail_with_sk.unitpricediscount
 109:            , order_detail_with_sk.unitprice
 110:            , order_detail_with_sk.rowguid
 111:            , order_detail_with_sk.orderqty
 112:            , order_detail_with_sk.modifieddate
 113:            , order_detail_with_sk.carriertrackingnumber
 114:            , order_detail_with_sk.product_fk
 115:
 116:            from orders_with_sk
 117:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 118:    )
 119:
 120:select * from final;
 121:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name product_id not found inside product at [76:64]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:28:57.965641 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7416dd4b-5f99-4f50-9834-8646e83e4a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185021D2688>]}
2021-05-29 14:28:57.966639 (Thread-1): 11:28:57 | 1 of 1 ERROR creating view model dw_adventure_works.fact_order_details [ERROR in 4.50s]
2021-05-29 14:28:57.967637 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:28:58.056561 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:28:58.057560 (MainThread): 11:28:58 | 
2021-05-29 14:28:58.058624 (MainThread): 11:28:58 | Finished running 1 view model in 7.46s.
2021-05-29 14:28:58.059629 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:28:58.060625 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:28:58.060625 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:28:58.061623 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:28:58.070606 (MainThread): unclosed <socket.socket fd=1240, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61224), raddr=('172.217.29.10', 443)>
2021-05-29 14:28:58.071602 (MainThread): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61225), raddr=('142.250.219.10', 443)>
2021-05-29 14:28:58.072630 (MainThread): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61227), raddr=('142.250.219.10', 443)>
2021-05-29 14:28:58.072630 (MainThread): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61226), raddr=('172.217.29.10', 443)>
2021-05-29 14:28:58.073592 (MainThread): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61228), raddr=('172.217.29.10', 443)>
2021-05-29 14:28:58.073592 (MainThread): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61229), raddr=('142.250.219.10', 443)>
2021-05-29 14:28:58.085581 (MainThread): 
2021-05-29 14:28:58.086556 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 14:28:58.087554 (MainThread): 
2021-05-29 14:28:58.088552 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 14:28:58.089548 (MainThread):   Name product_id not found inside product at [76:64]
2021-05-29 14:28:58.090545 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:28:58.091548 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 14:28:58.093539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185021D7F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018502214EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185023C9C88>]}
2021-05-29 14:28:58.094536 (MainThread): Flushing usage events
2021-05-29 14:29:19.764543 (MainThread): Running with dbt=0.19.1
2021-05-29 14:29:20.690252 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:29:20.691250 (MainThread): Tracking: tracking
2021-05-29 14:29:20.692248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022674035EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022674035D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022674032E88>]}
2021-05-29 14:29:20.711197 (MainThread): Partial parsing not enabled
2021-05-29 14:29:20.714188 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:29:20.755081 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:29:20.769042 (MainThread): Parsing macros\etc.sql
2021-05-29 14:29:20.777020 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:29:20.785996 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:29:20.812926 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:29:20.818908 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:29:20.823895 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:29:20.843843 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:29:20.853816 (MainThread): Parsing macros\core.sql
2021-05-29 14:29:20.862792 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:29:20.955582 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:29:20.973533 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:29:20.976489 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:29:20.980514 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:29:20.984503 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:29:20.988455 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:29:20.991447 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:29:21.010432 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:29:21.038920 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:29:21.043189 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:29:21.058881 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:29:21.111744 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:29:21.212474 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:29:21.218459 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:29:21.265332 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:29:21.283284 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:29:21.295254 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:29:21.313210 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:29:21.321182 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:29:21.325172 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:29:21.331163 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:29:21.350106 (MainThread): Partial parsing not enabled
2021-05-29 14:29:21.435876 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:29:21.465796 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:29:21.478762 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:29:21.490731 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:29:21.508683 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:29:21.523642 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:29:21.538602 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:29:21.553563 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:29:21.572511 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:29:21.589468 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:29:21.605425 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:29:21.624373 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:29:21.641328 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:29:21.674240 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:29:21.698184 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:29:21.718125 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:29:21.736074 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:29:22.184876 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:29:22.186868 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:29:22.187866 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:29:22.190859 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:29:22.223770 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:29:22.229755 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d014e11-288c-419d-84a3-8249025e374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022677B42988>]}
2021-05-29 14:29:22.322506 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d014e11-288c-419d-84a3-8249025e374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022677B55488>]}
2021-05-29 14:29:22.323504 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:29:22.330497 (MainThread): 
2021-05-29 14:29:22.331484 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:29:22.333480 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:29:22.334477 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:29:23.680982 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:29:23.681978 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:29:23.692484 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:29:24.983465 (MainThread): 11:29:24 | Concurrency: 1 threads (target='dev')
2021-05-29 14:29:24.984462 (MainThread): 11:29:24 | 
2021-05-29 14:29:24.989450 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:29:24.990448 (Thread-1): 11:29:24 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:29:24.991445 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:29:24.992443 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:29:25.011391 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:29:25.014397 (Thread-1): finished collecting timing info
2021-05-29 14:29:25.110126 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:29:25.112122 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:29:25.119102 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.rowguid
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.modifieddate
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:29:27.172659 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/c77d769f-3781-48ae-a5da-d3d26e9222a8?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name rowguid at [6:6]')
2021-05-29 14:29:29.080611 (Thread-1): finished collecting timing info
2021-05-29 14:29:29.081641 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE VIEW has columns with duplicate name rowguid at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/52cfa109-7bd6-42d7-bc3b-673edbb7391e?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name rowguid at [6:6]

(job ID: 52cfa109-7bd6-42d7-bc3b-673edbb7391e)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customer as (
   8:        select *
   9:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  10:    )
  11:    , creditcard as (
  12:        select *
  13:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  14:    )
  15:    , product as (
  16:        select *
  17:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  18:    )
  19:    , address as (
  20:        select *
  21:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  22:    )
  23:    , reason as (
  24:        select *
  25:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  26:    )
  27:    , orders_with_sk as (
  28:            select
  29:            orders.salesorderid
  30:            , customer.customer_sk as customer_fk
  31:            , creditcard.creditcard_sk as creditcard_fk
  32:            , address.address_sk as address_fk
  33:            , reason.reason_sk as reason_fk
  34:            , orders.shipmethodid
  35:            , orders.billtoaddressid
  36:            , orders.salespersonid
  37:            , orders.currencyrateid
  38:            , orders.territoryid
  39:            , orders.purchaseordernumber
  40:            , orders.modifieddate
  41:            , orders.rowguid
  42:            , orders.taxamt
  43:            , orders.onlineorderflag
  44:            , orders.status
  45:            , orders.orderdate
  46:            , orders.creditcardapprovalcode
  47:            , orders.subtotal
  48:            , orders.revisionnumber
  49:            , orders.freight
  50:            , orders.duedate
  51:            , orders.totaldue
  52:            , orders.shipdate
  53:            , orders.accountnumber
  54:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  55:
  56:        left join customer on orders.customerid = customer.customerid
  57:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  58:        left join address on orders.shiptoaddressid = address.addressid
  59:        left join reason on orders.salesorderid = reason.salesorderid
  60:
  61:    )
  62:
  63:   , order_detail_with_sk as (
  64:        select
  65:            order_details.salesorderid
  66:            , order_details.specialofferid
  67:            , order_details.salesorderdetailid
  68:            , order_details.unitpricediscount
  69:            , order_details.unitprice
  70:            , order_details.rowguid
  71:            , order_details.orderqty
  72:            , order_details.modifieddate
  73:            , order_details.carriertrackingnumber
  74:            , product.product_sk as product_fk
  75:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  76:        left join product on order_details.productid = product.productid
  77:    )
  78:
  79:    , final as (
  80:        select
  81:         orders_with_sk.salesorderid
  82:            , orders_with_sk.customer_fk
  83:            , orders_with_sk.creditcard_fk
  84:            , orders_with_sk.address_fk
  85:            , orders_with_sk.reason_fk
  86:            , orders_with_sk.shipmethodid
  87:            , orders_with_sk.billtoaddressid
  88:            , orders_with_sk.salespersonid
  89:            , orders_with_sk.currencyrateid
  90:            , orders_with_sk.territoryid
  91:            , orders_with_sk.purchaseordernumber
  92:            , orders_with_sk.modifieddate
  93:            , orders_with_sk.rowguid
  94:            , orders_with_sk.taxamt
  95:            , orders_with_sk.onlineorderflag
  96:            , orders_with_sk.status
  97:            , orders_with_sk.orderdate
  98:            , orders_with_sk.creditcardapprovalcode
  99:            , orders_with_sk.subtotal
 100:            , orders_with_sk.revisionnumber
 101:            , orders_with_sk.freight
 102:            , orders_with_sk.duedate
 103:            , orders_with_sk.totaldue
 104:            , orders_with_sk.shipdate
 105:            , orders_with_sk.accountnumber
 106:            , order_detail_with_sk.specialofferid
 107:            , order_detail_with_sk.salesorderdetailid
 108:            , order_detail_with_sk.unitpricediscount
 109:            , order_detail_with_sk.unitprice
 110:            , order_detail_with_sk.rowguid
 111:            , order_detail_with_sk.orderqty
 112:            , order_detail_with_sk.modifieddate
 113:            , order_detail_with_sk.carriertrackingnumber
 114:            , order_detail_with_sk.product_fk
 115:
 116:            from orders_with_sk
 117:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 118:    )
 119:
 120:select * from final;
 121:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE VIEW has columns with duplicate name rowguid at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:29:29.095603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d014e11-288c-419d-84a3-8249025e374f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226711A74C8>]}
2021-05-29 14:29:29.095603 (Thread-1): 11:29:29 | 1 of 1 ERROR creating view model dw_adventure_works.fact_order_details [ERROR in 4.10s]
2021-05-29 14:29:29.097860 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:29:29.186138 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:29:29.187139 (MainThread): 11:29:29 | 
2021-05-29 14:29:29.188135 (MainThread): 11:29:29 | Finished running 1 view model in 6.86s.
2021-05-29 14:29:29.189131 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:29:29.189131 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:29:29.189131 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:29:29.189131 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:29:29.199106 (MainThread): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61236), raddr=('172.217.29.10', 443)>
2021-05-29 14:29:29.200104 (MainThread): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61237), raddr=('142.250.219.10', 443)>
2021-05-29 14:29:29.201100 (MainThread): unclosed <socket.socket fd=856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61239), raddr=('142.250.219.10', 443)>
2021-05-29 14:29:29.202114 (MainThread): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61238), raddr=('172.217.29.10', 443)>
2021-05-29 14:29:29.204173 (MainThread): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61240), raddr=('172.217.29.10', 443)>
2021-05-29 14:29:29.206089 (MainThread): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61241), raddr=('142.250.219.10', 443)>
2021-05-29 14:29:29.219051 (MainThread): 
2021-05-29 14:29:29.220049 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 14:29:29.221046 (MainThread): 
2021-05-29 14:29:29.222043 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 14:29:29.225037 (MainThread):   CREATE VIEW has columns with duplicate name rowguid at [6:6]
2021-05-29 14:29:29.226033 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:29:29.227033 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 14:29:29.230027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022677AD5D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022677B181C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022677B18348>]}
2021-05-29 14:29:29.232022 (MainThread): Flushing usage events
2021-05-29 14:30:13.009854 (MainThread): Running with dbt=0.19.1
2021-05-29 14:30:13.835927 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:30:13.837922 (MainThread): Tracking: tracking
2021-05-29 14:30:13.838920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254FF94E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254FF94CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254FF94888>]}
2021-05-29 14:30:13.860864 (MainThread): Partial parsing not enabled
2021-05-29 14:30:13.864853 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:30:13.903660 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:30:13.917627 (MainThread): Parsing macros\etc.sql
2021-05-29 14:30:13.922149 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:30:13.932125 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:30:13.956063 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:30:13.962082 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:30:13.967046 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:30:13.987138 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:30:13.998264 (MainThread): Parsing macros\core.sql
2021-05-29 14:30:14.007245 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:30:14.094941 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:30:14.114029 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:30:14.117081 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:30:14.122072 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:30:14.126657 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:30:14.130759 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:30:14.134022 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:30:14.153449 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:30:14.182165 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:30:14.187785 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:30:14.201041 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:30:14.243126 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:30:14.308991 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:30:14.313941 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:30:14.348881 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:30:14.362847 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:30:14.374780 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:30:14.388740 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:30:14.394724 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:30:14.398714 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:30:14.402702 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:30:14.416802 (MainThread): Partial parsing not enabled
2021-05-29 14:30:14.462720 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:30:14.480634 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:30:14.488648 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:30:14.496596 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:30:14.505607 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:30:14.513586 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:30:14.520565 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:30:14.528508 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:30:14.535525 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:30:14.544499 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:30:14.551482 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:30:14.560425 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:30:14.568437 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:30:14.674456 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:30:14.690789 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:30:14.698844 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:30:14.707841 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:30:14.974960 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:30:14.976917 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:30:14.979911 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:30:14.981906 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:30:15.010827 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:30:15.015814 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a2d2d9-01df-42f4-972b-5b975a8a5d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553A52448>]}
2021-05-29 14:30:15.097597 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a2d2d9-01df-42f4-972b-5b975a8a5d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022553AB7108>]}
2021-05-29 14:30:15.098592 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:30:15.105608 (MainThread): 
2021-05-29 14:30:15.105608 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:30:15.107567 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:30:15.108565 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:30:16.939022 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:30:16.939985 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:30:16.947964 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:30:18.237181 (MainThread): 11:30:18 | Concurrency: 1 threads (target='dev')
2021-05-29 14:30:18.238189 (MainThread): 11:30:18 | 
2021-05-29 14:30:18.243181 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:30:18.243181 (Thread-1): 11:30:18 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:30:18.244178 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:30:18.245214 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:30:18.261136 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:30:18.263127 (Thread-1): finished collecting timing info
2021-05-29 14:30:18.330985 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:30:18.331954 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:30:18.340955 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.modifieddate
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:30:20.355299 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/b40ae7dd-ad94-422a-994c-cc4dcdfece6a?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name modifieddate at [6:6]')
2021-05-29 14:30:22.285114 (Thread-1): finished collecting timing info
2021-05-29 14:30:22.287099 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE VIEW has columns with duplicate name modifieddate at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/7ffbcbc1-028c-49ea-a90d-446671940db0?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name modifieddate at [6:6]

(job ID: 7ffbcbc1-028c-49ea-a90d-446671940db0)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customer as (
   8:        select *
   9:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  10:    )
  11:    , creditcard as (
  12:        select *
  13:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  14:    )
  15:    , product as (
  16:        select *
  17:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  18:    )
  19:    , address as (
  20:        select *
  21:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  22:    )
  23:    , reason as (
  24:        select *
  25:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  26:    )
  27:    , orders_with_sk as (
  28:            select
  29:            orders.salesorderid
  30:            , customer.customer_sk as customer_fk
  31:            , creditcard.creditcard_sk as creditcard_fk
  32:            , address.address_sk as address_fk
  33:            , reason.reason_sk as reason_fk
  34:            , orders.shipmethodid
  35:            , orders.billtoaddressid
  36:            , orders.salespersonid
  37:            , orders.currencyrateid
  38:            , orders.territoryid
  39:            , orders.purchaseordernumber
  40:            , orders.modifieddate
  41:            , orders.rowguid
  42:            , orders.taxamt
  43:            , orders.onlineorderflag
  44:            , orders.status
  45:            , orders.orderdate
  46:            , orders.creditcardapprovalcode
  47:            , orders.subtotal
  48:            , orders.revisionnumber
  49:            , orders.freight
  50:            , orders.duedate
  51:            , orders.totaldue
  52:            , orders.shipdate
  53:            , orders.accountnumber
  54:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  55:
  56:        left join customer on orders.customerid = customer.customerid
  57:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  58:        left join address on orders.shiptoaddressid = address.addressid
  59:        left join reason on orders.salesorderid = reason.salesorderid
  60:
  61:    )
  62:
  63:   , order_detail_with_sk as (
  64:        select
  65:            order_details.salesorderid
  66:            , order_details.specialofferid
  67:            , order_details.salesorderdetailid
  68:            , order_details.unitpricediscount
  69:            , order_details.unitprice
  70:            , order_details.rowguid
  71:            , order_details.orderqty
  72:            , order_details.modifieddate
  73:            , order_details.carriertrackingnumber
  74:            , product.product_sk as product_fk
  75:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  76:        left join product on order_details.productid = product.productid
  77:    )
  78:
  79:    , final as (
  80:        select
  81:         orders_with_sk.salesorderid
  82:            , orders_with_sk.customer_fk
  83:            , orders_with_sk.creditcard_fk
  84:            , orders_with_sk.address_fk
  85:            , orders_with_sk.reason_fk
  86:            , orders_with_sk.shipmethodid
  87:            , orders_with_sk.billtoaddressid
  88:            , orders_with_sk.salespersonid
  89:            , orders_with_sk.currencyrateid
  90:            , orders_with_sk.territoryid
  91:            , orders_with_sk.purchaseordernumber
  92:            , orders_with_sk.modifieddate
  93:            , orders_with_sk.rowguid
  94:            , orders_with_sk.taxamt
  95:            , orders_with_sk.onlineorderflag
  96:            , orders_with_sk.status
  97:            , orders_with_sk.orderdate
  98:            , orders_with_sk.creditcardapprovalcode
  99:            , orders_with_sk.subtotal
 100:            , orders_with_sk.revisionnumber
 101:            , orders_with_sk.freight
 102:            , orders_with_sk.duedate
 103:            , orders_with_sk.totaldue
 104:            , orders_with_sk.shipdate
 105:            , orders_with_sk.accountnumber
 106:            , order_detail_with_sk.specialofferid
 107:            , order_detail_with_sk.salesorderdetailid
 108:            , order_detail_with_sk.unitpricediscount
 109:            , order_detail_with_sk.unitprice
 110:            , order_detail_with_sk.orderqty
 111:            , order_detail_with_sk.modifieddate
 112:            , order_detail_with_sk.carriertrackingnumber
 113:            , order_detail_with_sk.product_fk
 114:
 115:            from orders_with_sk
 116:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 117:    )
 118:
 119:select * from final;
 120:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE VIEW has columns with duplicate name modifieddate at [6:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:30:22.314011 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a2d2d9-01df-42f4-972b-5b975a8a5d0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002254FF7B788>]}
2021-05-29 14:30:22.314011 (Thread-1): 11:30:22 | 1 of 1 ERROR creating view model dw_adventure_works.fact_order_details [ERROR in 4.07s]
2021-05-29 14:30:22.315968 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:30:22.335371 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:30:22.336365 (MainThread): 11:30:22 | 
2021-05-29 14:30:22.337363 (MainThread): 11:30:22 | Finished running 1 view model in 7.23s.
2021-05-29 14:30:22.337363 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:30:22.338362 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:30:22.338362 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:30:22.338362 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:30:22.346339 (MainThread): unclosed <socket.socket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61256), raddr=('172.217.29.10', 443)>
2021-05-29 14:30:22.347338 (MainThread): unclosed <socket.socket fd=396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61257), raddr=('142.250.219.10', 443)>
2021-05-29 14:30:22.348384 (MainThread): unclosed <socket.socket fd=412, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61259), raddr=('142.250.219.10', 443)>
2021-05-29 14:30:22.348384 (MainThread): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61258), raddr=('172.217.29.10', 443)>
2021-05-29 14:30:22.351337 (MainThread): unclosed <socket.socket fd=904, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61260), raddr=('172.217.29.10', 443)>
2021-05-29 14:30:22.352324 (MainThread): unclosed <socket.socket fd=872, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61261), raddr=('142.250.219.10', 443)>
2021-05-29 14:30:22.362296 (MainThread): 
2021-05-29 14:30:22.363294 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 14:30:22.364291 (MainThread): 
2021-05-29 14:30:22.365292 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 14:30:22.366298 (MainThread):   CREATE VIEW has columns with duplicate name modifieddate at [6:6]
2021-05-29 14:30:22.370297 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 14:30:22.371275 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 14:30:22.372270 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022550053F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022550053488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022551F67BC8>]}
2021-05-29 14:30:22.372270 (MainThread): Flushing usage events
2021-05-29 14:30:53.380717 (MainThread): Running with dbt=0.19.1
2021-05-29 14:30:54.039736 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:30:54.040735 (MainThread): Tracking: tracking
2021-05-29 14:30:54.041733 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754FD4DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754FD4C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D754FC2C08>]}
2021-05-29 14:30:54.060679 (MainThread): Partial parsing not enabled
2021-05-29 14:30:54.063670 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:30:54.101723 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:30:54.114867 (MainThread): Parsing macros\etc.sql
2021-05-29 14:30:54.119640 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:30:54.128619 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:30:54.155550 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:30:54.161989 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:30:54.166341 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:30:54.186721 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:30:54.197718 (MainThread): Parsing macros\core.sql
2021-05-29 14:30:54.209079 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:30:54.295774 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:30:54.315725 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:30:54.317719 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:30:54.322102 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:30:54.326788 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:30:54.330738 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:30:54.333734 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:30:54.354478 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:30:54.382409 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:30:54.386845 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:30:54.400810 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:30:54.445692 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:30:54.516007 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:30:54.520000 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:30:54.554908 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:30:54.568986 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:30:54.579698 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:30:54.593863 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:30:54.600225 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:30:54.604218 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:30:54.608278 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:30:54.621286 (MainThread): Partial parsing not enabled
2021-05-29 14:30:54.667163 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:30:54.686115 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:30:54.693094 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:30:54.701072 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:30:54.708053 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:30:54.716033 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:30:54.723013 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:30:54.730992 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:30:54.737973 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:30:54.746949 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:30:54.753930 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:30:54.762872 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:30:54.771846 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:30:54.779861 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:30:54.787840 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:30:54.795781 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:30:54.803760 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:30:55.078440 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_customers' which was not found
2021-05-29 14:30:55.080420 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_shippers' which was not found
2021-05-29 14:30:55.082394 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_' (models\marts\fact_order_details.yml) depends on a node named 'dim_products' which was not found
2021-05-29 14:30:55.084390 (MainThread): [WARNING]: Test 'test.dw_adventure_works.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_' (models\marts\fact_order_details.yml) depends on a node named 'dim_suppliers' which was not found
2021-05-29 14:30:55.119297 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:30:55.123285 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98a4130-71a3-4aa6-b0e1-f34c28637f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D758A89CC8>]}
2021-05-29 14:30:55.215039 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98a4130-71a3-4aa6-b0e1-f34c28637f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D758C8CC08>]}
2021-05-29 14:30:55.216037 (MainThread): Found 17 models, 13 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:30:55.223018 (MainThread): 
2021-05-29 14:30:55.224016 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:30:55.226009 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:30:55.226009 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:30:56.584756 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:30:56.585762 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:30:56.595511 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:30:57.975886 (MainThread): 11:30:57 | Concurrency: 1 threads (target='dev')
2021-05-29 14:30:57.976887 (MainThread): 11:30:57 | 
2021-05-29 14:30:57.981881 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:30:57.981881 (Thread-1): 11:30:57 | 1 of 1 START view model dw_adventure_works.fact_order_details........ [RUN]
2021-05-29 14:30:57.983876 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:30:57.983876 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:30:57.997839 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:30:57.999829 (Thread-1): finished collecting timing info
2021-05-29 14:30:58.071674 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:30:58.073631 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:30:58.081610 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:31:00.979861 (Thread-1): finished collecting timing info
2021-05-29 14:31:00.979861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98a4130-71a3-4aa6-b0e1-f34c28637f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D756D8C608>]}
2021-05-29 14:31:00.980859 (Thread-1): 11:31:00 | 1 of 1 OK created view model dw_adventure_works.fact_order_details... [OK in 3.00s]
2021-05-29 14:31:00.982428 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:31:01.090844 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:31:01.093848 (MainThread): 11:31:01 | 
2021-05-29 14:31:01.095836 (MainThread): 11:31:01 | Finished running 1 view model in 5.87s.
2021-05-29 14:31:01.098828 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:31:01.099825 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:31:01.100824 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:31:01.101833 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:31:01.113781 (MainThread): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61267), raddr=('172.217.29.10', 443)>
2021-05-29 14:31:01.114779 (MainThread): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61268), raddr=('142.250.219.10', 443)>
2021-05-29 14:31:01.115789 (MainThread): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61270), raddr=('142.250.219.10', 443)>
2021-05-29 14:31:01.116778 (MainThread): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61269), raddr=('172.217.29.10', 443)>
2021-05-29 14:31:01.118792 (MainThread): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61271), raddr=('172.217.29.10', 443)>
2021-05-29 14:31:01.119767 (MainThread): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61272), raddr=('142.250.219.10', 443)>
2021-05-29 14:31:01.131732 (MainThread): 
2021-05-29 14:31:01.132731 (MainThread): Completed successfully
2021-05-29 14:31:01.133727 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 14:31:01.135722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D758CD6608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D758AE4988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D758AE4908>]}
2021-05-29 14:31:01.135722 (MainThread): Flushing usage events
2021-05-29 14:33:34.798327 (MainThread): Running with dbt=0.19.1
2021-05-29 14:33:35.607651 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:33:35.608915 (MainThread): Tracking: tracking
2021-05-29 14:33:35.609917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F23235C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F2311E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F2311D48>]}
2021-05-29 14:33:35.630859 (MainThread): Partial parsing not enabled
2021-05-29 14:33:35.633904 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:33:35.674058 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:33:35.686990 (MainThread): Parsing macros\etc.sql
2021-05-29 14:33:35.691992 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:33:35.700954 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:33:35.726577 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:33:35.732582 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:33:35.736573 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:33:35.757714 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:33:35.768690 (MainThread): Parsing macros\core.sql
2021-05-29 14:33:35.776882 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:33:35.864488 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:33:35.882665 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:33:35.886280 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:33:35.890868 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:33:35.894860 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:33:35.899848 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:33:35.902259 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:33:35.921715 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:33:35.950679 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:33:35.956050 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:33:35.969019 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:33:36.009914 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:33:36.076780 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:33:36.081037 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:33:36.116014 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:33:36.132301 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:33:36.143276 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:33:36.157715 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:33:36.163742 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:33:36.166732 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:33:36.170721 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:33:36.184647 (MainThread): Partial parsing not enabled
2021-05-29 14:33:36.231071 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:33:36.251978 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:33:36.260265 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:33:36.268246 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:33:36.276187 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:33:36.284537 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:33:36.291483 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:33:36.300620 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:33:36.308609 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:33:36.316987 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:33:36.325874 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:33:36.334710 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:33:36.343686 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:33:36.350668 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:33:36.360604 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:33:36.368678 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:33:36.376620 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:33:36.504077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F5E5C088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F5E5C108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220F5E5C448>]}
2021-05-29 14:33:36.505118 (MainThread): Flushing usage events
2021-05-29 14:33:37.914392 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:33:37.914392 (MainThread): Encountered an error:
2021-05-29 14:33:37.915392 (MainThread): Compilation Error
  Error reading dw_adventure_works: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 34
    ------------------------------
    31 |               to: ref('dim_address')
    32 |               field: address_sk
    33 | 
    34 |        - name: reason_fk
    35 |         tests:
    36 |           - relationships:
    37 |               to: ref('dim_reason')
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 34, column 8
2021-05-29 14:33:37.940341 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 6, column 7
did not find expected '-' indicator
  in "<unicode string>", line 34, column 8

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 34
  ------------------------------
  31 |               to: ref('dim_address')
  32 |               field: address_sk
  33 | 
  34 |        - name: reason_fk
  35 |         tests:
  36 |           - relationships:
  37 |               to: ref('dim_reason')
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 6, column 7
  did not find expected '-' indicator
    in "<unicode string>", line 34, column 8

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading dw_adventure_works: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 34
    ------------------------------
    31 |               to: ref('dim_address')
    32 |               field: address_sk
    33 | 
    34 |        - name: reason_fk
    35 |         tests:
    36 |           - relationships:
    37 |               to: ref('dim_reason')
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 34, column 8

2021-05-29 14:35:22.204156 (MainThread): Running with dbt=0.19.1
2021-05-29 14:35:23.387352 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:35:23.388754 (MainThread): Tracking: tracking
2021-05-29 14:35:23.389583 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949E304C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F35C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F35FC8>]}
2021-05-29 14:35:23.413561 (MainThread): Partial parsing not enabled
2021-05-29 14:35:23.416743 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:35:23.460633 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:35:23.473594 (MainThread): Parsing macros\etc.sql
2021-05-29 14:35:23.479779 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:35:23.489440 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:35:23.518366 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:35:23.524352 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:35:23.529706 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:35:23.552784 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:35:23.565318 (MainThread): Parsing macros\core.sql
2021-05-29 14:35:23.574316 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:35:23.672524 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:35:23.692492 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:35:23.695471 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:35:23.700698 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:35:23.705399 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:35:23.710145 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:35:23.713640 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:35:23.733779 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:35:23.762442 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:35:23.767834 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:35:23.781468 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:35:23.822549 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:35:23.892030 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:35:23.896842 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:35:23.931751 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:35:23.946289 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:35:23.959405 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:35:23.973146 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:35:23.979135 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:35:23.982162 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:35:23.987151 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:35:24.001076 (MainThread): Partial parsing not enabled
2021-05-29 14:35:24.047413 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:35:24.067324 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:35:24.077337 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:35:24.085279 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:35:24.094254 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:35:24.102325 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:35:24.110276 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:35:24.119250 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:35:24.130121 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:35:24.140980 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:35:24.149956 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:35:24.161613 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:35:24.173699 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:35:24.182215 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:35:24.193224 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:35:24.205387 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:35:24.217353 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:35:24.530793 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:35:24.536459 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794DC03C08>]}
2021-05-29 14:35:24.619234 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794D63BDC8>]}
2021-05-29 14:35:24.619234 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:35:24.628244 (MainThread): 
2021-05-29 14:35:24.629244 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:35:24.639198 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:35:24.639198 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:35:26.066489 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:35:26.066489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:35:26.074929 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:35:27.415235 (MainThread): 11:35:27 | Concurrency: 1 threads (target='dev')
2021-05-29 14:35:27.418231 (MainThread): 11:35:27 | 
2021-05-29 14:35:27.447148 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 14:35:27.449144 (Thread-1): 11:35:27 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 14:35:27.452159 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:35:27.454128 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 14:35:27.464101 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:35:27.469088 (Thread-1): finished collecting timing info
2021-05-29 14:35:27.549872 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:35:27.552746 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:35:27.561727 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 14:35:30.636219 (Thread-1): finished collecting timing info
2021-05-29 14:35:30.637217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F06AC8>]}
2021-05-29 14:35:30.637217 (Thread-1): 11:35:30 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 3.19s]
2021-05-29 14:35:30.639226 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 14:35:30.639226 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:35:30.640222 (Thread-1): 11:35:30 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 14:35:30.641223 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:35:30.641223 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 14:35:30.649198 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:35:30.651192 (Thread-1): finished collecting timing info
2021-05-29 14:35:30.654184 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:35:30.658179 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:30.670169 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 14:35:33.304711 (Thread-1): finished collecting timing info
2021-05-29 14:35:33.305709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F65B48>]}
2021-05-29 14:35:33.305709 (Thread-1): 11:35:33 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.67s]
2021-05-29 14:35:33.307669 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:35:33.307669 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 14:35:33.308669 (Thread-1): 11:35:33 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 14:35:33.309664 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:35:33.310662 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 14:35:33.312661 (Thread-1): unclosed <socket.socket fd=644, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61316), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:33.313658 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61317), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:33.313658 (Thread-1): unclosed <socket.socket fd=660, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61318), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:33.313658 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61319), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:33.320650 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:35:33.325634 (Thread-1): finished collecting timing info
2021-05-29 14:35:33.330646 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:35:33.333601 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:33.343572 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 14:35:35.704021 (Thread-1): finished collecting timing info
2021-05-29 14:35:35.706017 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F09F08>]}
2021-05-29 14:35:35.710017 (Thread-1): 11:35:35 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 2.40s]
2021-05-29 14:35:35.713993 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 14:35:35.713993 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:35:35.714992 (Thread-1): 11:35:35 | 4 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 14:35:35.716986 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:35:35.717984 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:35:35.729953 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:35:35.735955 (Thread-1): finished collecting timing info
2021-05-29 14:35:35.752889 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:35:35.762862 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:35.790788 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 14:35:38.287734 (Thread-1): finished collecting timing info
2021-05-29 14:35:38.289730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794DA05088>]}
2021-05-29 14:35:38.293732 (Thread-1): 11:35:38 | 4 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.57s]
2021-05-29 14:35:38.297707 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:35:38.297707 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 14:35:38.298712 (Thread-1): 11:35:38 | 5 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 14:35:38.299702 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:35:38.300708 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 14:35:38.313663 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:35:38.317654 (Thread-1): finished collecting timing info
2021-05-29 14:35:38.329623 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:35:38.331615 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:38.347573 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 14:35:40.661927 (Thread-1): finished collecting timing info
2021-05-29 14:35:40.662925 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794DA81E88>]}
2021-05-29 14:35:40.663923 (Thread-1): 11:35:40 | 5 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 2.36s]
2021-05-29 14:35:40.664920 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 14:35:40.665917 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 14:35:40.666915 (Thread-1): 11:35:40 | 6 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 14:35:40.668914 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:35:40.668914 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 14:35:40.681436 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:35:40.684430 (Thread-1): finished collecting timing info
2021-05-29 14:35:40.696395 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:35:40.699386 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:40.713351 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 14:35:43.096416 (Thread-1): finished collecting timing info
2021-05-29 14:35:43.096416 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794A002A48>]}
2021-05-29 14:35:43.097416 (Thread-1): 11:35:43 | 6 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.43s]
2021-05-29 14:35:43.098378 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 14:35:43.099374 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:35:43.100374 (Thread-1): 11:35:43 | 7 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 14:35:43.101386 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:35:43.102405 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 14:35:43.108351 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:35:43.111342 (Thread-1): finished collecting timing info
2021-05-29 14:35:43.115330 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:35:43.118324 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:43.129613 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 14:35:44.828827 (Thread-1): finished collecting timing info
2021-05-29 14:35:44.829825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794DBC6788>]}
2021-05-29 14:35:44.830822 (Thread-1): 11:35:44 | 7 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 1.73s]
2021-05-29 14:35:44.832822 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:35:44.833815 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:35:44.833815 (Thread-1): 11:35:44 | 8 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 14:35:44.835809 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:35:44.835809 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 14:35:44.844785 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:35:44.846780 (Thread-1): finished collecting timing info
2021-05-29 14:35:44.864732 (Thread-1): unclosed <socket.socket fd=1360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61321), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:44.865729 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61320), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:44.866726 (Thread-1): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61322), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:44.866726 (Thread-1): unclosed <socket.socket fd=1372, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61323), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:44.872720 (Thread-1): unclosed <socket.socket fd=1112, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61326), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:44.876706 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61327), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:44.879691 (Thread-1): unclosed <socket.socket fd=1380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61329), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:44.880689 (Thread-1): unclosed <socket.socket fd=740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61330), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:44.881686 (Thread-1): unclosed <socket.socket fd=1424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61332), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:44.882684 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61333), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:44.885677 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:35:44.898641 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:44.932549 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 14:35:47.435220 (Thread-1): finished collecting timing info
2021-05-29 14:35:47.437215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794DB9E308>]}
2021-05-29 14:35:47.438212 (Thread-1): 11:35:47 | 8 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 2.60s]
2021-05-29 14:35:47.445194 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:35:47.445194 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:35:47.447189 (Thread-1): 11:35:47 | 9 of 17 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 14:35:47.448194 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:35:47.449183 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 14:35:47.451178 (Thread-1): unclosed <socket.socket fd=712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61336), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:47.451178 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61339), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:47.461151 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:35:47.465141 (Thread-1): finished collecting timing info
2021-05-29 14:35:47.478104 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:35:47.480099 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:47.497055 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 14:35:49.912719 (Thread-1): finished collecting timing info
2021-05-29 14:35:49.913716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794D943508>]}
2021-05-29 14:35:49.914712 (Thread-1): 11:35:49 | 9 of 17 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.47s]
2021-05-29 14:35:49.927678 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:35:49.927678 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 14:35:49.928675 (Thread-1): 11:35:49 | 10 of 17 START view model dw_adventure_works.stg_orders.............. [RUN]
2021-05-29 14:35:49.930670 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:35:49.931669 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 14:35:49.943635 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:35:49.946627 (Thread-1): finished collecting timing info
2021-05-29 14:35:49.959593 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:35:49.962584 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:49.994499 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 14:35:52.508926 (Thread-1): finished collecting timing info
2021-05-29 14:35:52.509924 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794D98AFC8>]}
2021-05-29 14:35:52.510920 (Thread-1): 11:35:52 | 10 of 17 OK created view model dw_adventure_works.stg_orders......... [OK in 2.58s]
2021-05-29 14:35:52.512916 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 14:35:52.513439 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:35:52.513965 (Thread-1): 11:35:52 | 11 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 14:35:52.515946 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:35:52.515946 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 14:35:52.523985 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:35:52.527951 (Thread-1): finished collecting timing info
2021-05-29 14:35:52.534969 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:35:52.536967 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:52.551924 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 14:35:55.390070 (Thread-1): finished collecting timing info
2021-05-29 14:35:55.391067 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794D96E108>]}
2021-05-29 14:35:55.392068 (Thread-1): 11:35:55 | 11 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 2.88s]
2021-05-29 14:35:55.399045 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:35:55.403036 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:35:55.404033 (Thread-1): 11:35:55 | 12 of 17 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 14:35:55.417994 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:35:55.418993 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 14:35:55.424978 (Thread-1): unclosed <socket.socket fd=1536, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61351), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:55.425975 (Thread-1): unclosed <socket.socket fd=696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61352), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:55.432955 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:35:55.439936 (Thread-1): finished collecting timing info
2021-05-29 14:35:55.448912 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:35:55.517728 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:55.546653 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:35:57.938255 (Thread-1): finished collecting timing info
2021-05-29 14:35:57.939250 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794D8EA288>]}
2021-05-29 14:35:57.940249 (Thread-1): 11:35:57 | 12 of 17 OK created view model dw_adventure_works.dim_creditcard..... [OK in 2.52s]
2021-05-29 14:35:57.941248 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:35:57.942244 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 14:35:57.943240 (Thread-1): 11:35:57 | 13 of 17 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 14:35:57.945236 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:35:57.945236 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 14:35:57.947234 (Thread-1): unclosed <socket.socket fd=1424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61353), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:57.948228 (Thread-1): unclosed <socket.socket fd=148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61354), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:57.957203 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:35:57.961192 (Thread-1): finished collecting timing info
2021-05-29 14:35:57.968184 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:35:57.971166 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:35:57.987124 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed;


2021-05-29 14:35:58.191576 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61343), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:58.192574 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61344), raddr=('172.217.162.202', 443)>
2021-05-29 14:35:58.193572 (Thread-1): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61348), raddr=('216.58.202.170', 443)>
2021-05-29 14:35:58.193572 (Thread-1): unclosed <socket.socket fd=972, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61350), raddr=('172.217.162.202', 443)>
2021-05-29 14:36:00.526332 (Thread-1): finished collecting timing info
2021-05-29 14:36:00.527330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794EC3C308>]}
2021-05-29 14:36:00.528328 (Thread-1): 11:36:00 | 13 of 17 OK created view model dw_adventure_works.dim_customer....... [OK in 2.58s]
2021-05-29 14:36:00.530322 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 14:36:00.530322 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 14:36:00.531326 (Thread-1): 11:36:00 | 14 of 17 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 14:36:00.533314 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:36:00.534316 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 14:36:00.542291 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:36:00.544284 (Thread-1): finished collecting timing info
2021-05-29 14:36:00.552271 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:36:00.555255 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:36:00.569219 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:36:02.886570 (Thread-1): finished collecting timing info
2021-05-29 14:36:02.887568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794EC20788>]}
2021-05-29 14:36:02.888566 (Thread-1): 11:36:02 | 14 of 17 OK created view model dw_adventure_works.dim_product........ [OK in 2.36s]
2021-05-29 14:36:02.890560 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 14:36:02.890560 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 14:36:02.891556 (Thread-1): 11:36:02 | 15 of 17 START view model dw_adventure_works.dim_reason.............. [RUN]
2021-05-29 14:36:02.893550 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:36:02.893550 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 14:36:02.895545 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61360), raddr=('216.58.202.170', 443)>
2021-05-29 14:36:02.896543 (Thread-1): unclosed <socket.socket fd=868, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61363), raddr=('172.217.162.202', 443)>
2021-05-29 14:36:02.906517 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:36:02.908510 (Thread-1): finished collecting timing info
2021-05-29 14:36:02.915493 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:36:02.919482 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:36:02.934450 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by reasonorder.salesreasonid) as reason_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 14:36:05.380899 (Thread-1): finished collecting timing info
2021-05-29 14:36:05.381897 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794EC7A488>]}
2021-05-29 14:36:05.382893 (Thread-1): 11:36:05 | 15 of 17 OK created view model dw_adventure_works.dim_reason......... [OK in 2.49s]
2021-05-29 14:36:05.384888 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 14:36:05.384888 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 14:36:05.385886 (Thread-1): 11:36:05 | 16 of 17 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 14:36:05.387881 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:36:05.387881 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 14:36:05.396856 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:36:05.398852 (Thread-1): finished collecting timing info
2021-05-29 14:36:05.405831 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:36:05.407827 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:36:05.423788 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 14:36:07.912130 (Thread-1): finished collecting timing info
2021-05-29 14:36:07.913127 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794EC74588>]}
2021-05-29 14:36:07.914124 (Thread-1): 11:36:07 | 16 of 17 OK created view model dw_adventure_works.dim_address........ [OK in 2.53s]
2021-05-29 14:36:07.919112 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 14:36:07.921110 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:36:07.922109 (Thread-1): 11:36:07 | 17 of 17 START view model dw_adventure_works.fact_order_details...... [RUN]
2021-05-29 14:36:07.923101 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:36:07.924098 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:36:07.941053 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:36:07.943050 (Thread-1): finished collecting timing info
2021-05-29 14:36:07.952023 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:36:07.955014 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:36:07.970971 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:36:10.610072 (Thread-1): finished collecting timing info
2021-05-29 14:36:10.613064 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e703fd5-11da-4f42-8d68-65231686a7b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794ECC4F88>]}
2021-05-29 14:36:10.618055 (Thread-1): 11:36:10 | 17 of 17 OK created view model dw_adventure_works.fact_order_details. [OK in 2.69s]
2021-05-29 14:36:10.632013 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:36:10.682899 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:36:10.699833 (MainThread): 11:36:10 | 
2021-05-29 14:36:10.700829 (MainThread): 11:36:10 | Finished running 17 view models in 46.07s.
2021-05-29 14:36:10.704831 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:36:10.706813 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:36:10.706813 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:36:10.707811 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:36:10.789592 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61368), raddr=('216.58.202.170', 443)>
2021-05-29 14:36:10.790589 (MainThread): unclosed <socket.socket fd=732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61369), raddr=('172.217.162.202', 443)>
2021-05-29 14:36:10.791586 (MainThread): unclosed <socket.socket fd=1644, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61372), raddr=('216.58.202.170', 443)>
2021-05-29 14:36:10.792584 (MainThread): unclosed <socket.socket fd=1640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61374), raddr=('172.217.162.202', 443)>
2021-05-29 14:36:10.792584 (MainThread): unclosed <socket.socket fd=1696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61378), raddr=('172.217.162.202', 443)>
2021-05-29 14:36:10.793589 (MainThread): unclosed <socket.socket fd=1684, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61377), raddr=('216.58.202.170', 443)>
2021-05-29 14:36:10.890322 (MainThread): 
2021-05-29 14:36:10.891319 (MainThread): Completed successfully
2021-05-29 14:36:10.895316 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-05-29 14:36:10.913262 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F8F2C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027949F8F5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002794ED21FC8>]}
2021-05-29 14:36:10.914259 (MainThread): Flushing usage events
2021-05-29 14:46:04.085580 (MainThread): Running with dbt=0.19.1
2021-05-29 14:46:05.952585 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:46:05.956575 (MainThread): Tracking: tracking
2021-05-29 14:46:05.957573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636976DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636AA8888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636AA8C88>]}
2021-05-29 14:46:05.985500 (MainThread): Partial parsing not enabled
2021-05-29 14:46:05.989488 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:46:06.056310 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:46:06.077253 (MainThread): Parsing macros\etc.sql
2021-05-29 14:46:06.087226 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:46:06.098197 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:46:06.141084 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:46:06.155045 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:46:06.163024 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:46:06.200923 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:46:06.225856 (MainThread): Parsing macros\core.sql
2021-05-29 14:46:06.243807 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:46:06.528048 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:46:06.576916 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:46:06.582901 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:46:06.591877 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:46:06.603844 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:46:06.611824 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:46:06.618806 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:46:06.687621 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:46:06.821264 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:46:06.834243 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:46:06.879108 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:46:07.090543 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:46:07.254107 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:46:07.264080 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:46:07.438621 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:46:07.476510 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:46:07.494465 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:46:07.530367 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:46:07.540341 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:46:07.548319 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:46:07.568272 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:46:07.604171 (MainThread): Partial parsing not enabled
2021-05-29 14:46:07.728836 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:46:07.791669 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:46:07.815606 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:46:07.837546 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:46:07.858490 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:46:07.886414 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:46:07.918330 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:46:07.940272 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:46:07.974179 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:46:07.995123 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:46:08.018062 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:46:08.035018 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:46:08.061946 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:46:08.077902 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:46:08.102835 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:46:08.123780 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:46:08.168660 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:46:08.801221 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.example

2021-05-29 14:46:08.816182 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A5B9508>]}
2021-05-29 14:46:08.933840 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636A47108>]}
2021-05-29 14:46:08.934837 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:46:08.945807 (MainThread): 
2021-05-29 14:46:08.945807 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:46:08.951793 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:46:08.952795 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:46:10.549727 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:46:10.550726 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:46:10.565686 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:46:11.885600 (MainThread): 11:46:11 | Concurrency: 1 threads (target='dev')
2021-05-29 14:46:11.888592 (MainThread): 11:46:11 | 
2021-05-29 14:46:11.895573 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 14:46:11.897568 (Thread-1): 11:46:11 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 14:46:11.901578 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:46:11.901578 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 14:46:11.909537 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:46:11.913533 (Thread-1): finished collecting timing info
2021-05-29 14:46:12.033206 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:46:12.036196 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:46:12.053151 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 14:46:15.098687 (Thread-1): finished collecting timing info
2021-05-29 14:46:15.100683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636A7EAC8>]}
2021-05-29 14:46:15.101687 (Thread-1): 11:46:15 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 3.20s]
2021-05-29 14:46:15.102677 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 14:46:15.103674 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:46:15.104672 (Thread-1): 11:46:15 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 14:46:15.105669 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:46:15.106667 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 14:46:15.122623 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:46:15.124618 (Thread-1): finished collecting timing info
2021-05-29 14:46:15.137583 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:46:15.143566 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:15.156532 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 14:46:17.606647 (Thread-1): finished collecting timing info
2021-05-29 14:46:17.607645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636A69F48>]}
2021-05-29 14:46:17.608641 (Thread-1): 11:46:17 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.50s]
2021-05-29 14:46:17.610646 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:46:17.611635 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 14:46:17.613628 (Thread-1): 11:46:17 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 14:46:17.617635 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:46:17.618616 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 14:46:17.621608 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61507), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:17.622604 (Thread-1): unclosed <socket.socket fd=304, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61508), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:17.623603 (Thread-1): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61509), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:17.624599 (Thread-1): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61510), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:17.638562 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:46:17.640556 (Thread-1): finished collecting timing info
2021-05-29 14:46:17.652524 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:46:17.657512 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:17.676502 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 14:46:20.162330 (Thread-1): finished collecting timing info
2021-05-29 14:46:20.164325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636A6ABC8>]}
2021-05-29 14:46:20.166319 (Thread-1): 11:46:20 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 2.55s]
2021-05-29 14:46:20.168315 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 14:46:20.169312 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:46:20.170309 (Thread-1): 11:46:20 | 4 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 14:46:20.171307 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:46:20.171307 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:46:20.181280 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:46:20.184270 (Thread-1): finished collecting timing info
2021-05-29 14:46:20.190257 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:46:20.192250 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:20.209204 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 14:46:22.908049 (Thread-1): finished collecting timing info
2021-05-29 14:46:22.909043 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A585F08>]}
2021-05-29 14:46:22.910041 (Thread-1): 11:46:22 | 4 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.74s]
2021-05-29 14:46:22.912091 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:46:22.913031 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 14:46:22.914029 (Thread-1): 11:46:22 | 5 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 14:46:22.915025 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:46:22.916024 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 14:46:22.924001 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:46:22.926995 (Thread-1): finished collecting timing info
2021-05-29 14:46:22.936975 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:46:22.940957 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:22.956913 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 14:46:25.450967 (Thread-1): finished collecting timing info
2021-05-29 14:46:25.450967 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014636B61388>]}
2021-05-29 14:46:25.451964 (Thread-1): 11:46:25 | 5 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 2.54s]
2021-05-29 14:46:25.453958 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 14:46:25.453958 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 14:46:25.454957 (Thread-1): 11:46:25 | 6 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 14:46:25.456952 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:46:25.456952 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 14:46:25.465926 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:46:25.469915 (Thread-1): finished collecting timing info
2021-05-29 14:46:25.479890 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:46:25.481885 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:25.506817 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 14:46:28.007857 (Thread-1): finished collecting timing info
2021-05-29 14:46:28.008892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A685888>]}
2021-05-29 14:46:28.010849 (Thread-1): 11:46:28 | 6 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.55s]
2021-05-29 14:46:28.016836 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 14:46:28.016836 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:46:28.017832 (Thread-1): 11:46:28 | 7 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 14:46:28.019828 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:46:28.020824 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 14:46:28.028831 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:46:28.099999 (Thread-1): finished collecting timing info
2021-05-29 14:46:28.112962 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:46:28.187739 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:28.221647 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 14:46:30.618680 (Thread-1): finished collecting timing info
2021-05-29 14:46:30.619677 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A504288>]}
2021-05-29 14:46:30.620673 (Thread-1): 11:46:30 | 7 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 2.60s]
2021-05-29 14:46:30.623664 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:46:30.623664 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:46:30.624662 (Thread-1): 11:46:30 | 8 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 14:46:30.626657 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:46:30.626657 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 14:46:30.639621 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:46:30.641616 (Thread-1): finished collecting timing info
2021-05-29 14:46:30.650593 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61514), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:30.651590 (Thread-1): unclosed <socket.socket fd=1236, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61513), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:30.651590 (Thread-1): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61516), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:30.652588 (Thread-1): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61517), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:30.652588 (Thread-1): unclosed <socket.socket fd=1204, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61518), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:30.653584 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61519), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:30.653584 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61520), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:30.654581 (Thread-1): unclosed <socket.socket fd=1344, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61521), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:30.654581 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61522), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:30.655579 (Thread-1): unclosed <socket.socket fd=1388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61523), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:30.657577 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:46:30.662572 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:30.682523 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 14:46:33.141416 (Thread-1): finished collecting timing info
2021-05-29 14:46:33.142413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A6BA588>]}
2021-05-29 14:46:33.143412 (Thread-1): 11:46:33 | 8 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 2.52s]
2021-05-29 14:46:33.147400 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:46:33.148398 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:46:33.149395 (Thread-1): 11:46:33 | 9 of 17 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 14:46:33.150392 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:46:33.150392 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 14:46:33.152386 (Thread-1): unclosed <socket.socket fd=1304, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61524), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:33.152386 (Thread-1): unclosed <socket.socket fd=1388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61525), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:33.161363 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:46:33.164354 (Thread-1): finished collecting timing info
2021-05-29 14:46:33.170339 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:46:33.173331 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:33.187292 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , unitprice * (1 - unitpricediscount) * orderqty as saleprice
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 14:46:35.639074 (Thread-1): finished collecting timing info
2021-05-29 14:46:35.640071 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A49EC48>]}
2021-05-29 14:46:35.640071 (Thread-1): 11:46:35 | 9 of 17 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.49s]
2021-05-29 14:46:35.650242 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:46:35.651264 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 14:46:35.652258 (Thread-1): 11:46:35 | 10 of 17 START view model dw_adventure_works.stg_orders.............. [RUN]
2021-05-29 14:46:35.653255 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:46:35.654254 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 14:46:35.661239 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:46:35.665225 (Thread-1): finished collecting timing info
2021-05-29 14:46:35.669212 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:46:35.670826 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:35.681366 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 14:46:38.072180 (Thread-1): finished collecting timing info
2021-05-29 14:46:38.073176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A4BFF08>]}
2021-05-29 14:46:38.075170 (Thread-1): 11:46:38 | 10 of 17 OK created view model dw_adventure_works.stg_orders......... [OK in 2.42s]
2021-05-29 14:46:38.082152 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 14:46:38.083149 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:46:38.084145 (Thread-1): 11:46:38 | 11 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 14:46:38.086141 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:46:38.086141 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 14:46:38.099107 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:46:38.101100 (Thread-1): finished collecting timing info
2021-05-29 14:46:38.112074 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:46:38.118064 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:38.130025 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 14:46:40.519689 (Thread-1): finished collecting timing info
2021-05-29 14:46:40.520663 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A444848>]}
2021-05-29 14:46:40.521666 (Thread-1): 11:46:40 | 11 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 2.44s]
2021-05-29 14:46:40.522660 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:46:40.523655 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:46:40.524654 (Thread-1): 11:46:40 | 12 of 17 START view model dw_adventure_works.dim_creditcard.......... [RUN]
2021-05-29 14:46:40.531644 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:46:40.532633 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 14:46:40.534627 (Thread-1): unclosed <socket.socket fd=1488, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61530), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:40.535645 (Thread-1): unclosed <socket.socket fd=1504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61531), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:40.541608 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:46:40.565608 (Thread-1): finished collecting timing info
2021-05-29 14:46:40.571569 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:46:40.582541 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:40.603484 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  OPTIONS()
  as with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:46:43.269446 (Thread-1): finished collecting timing info
2021-05-29 14:46:43.271442 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A437F88>]}
2021-05-29 14:46:43.272438 (Thread-1): 11:46:43 | 12 of 17 OK created view model dw_adventure_works.dim_creditcard..... [OK in 2.74s]
2021-05-29 14:46:43.274433 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:46:43.274433 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 14:46:43.275432 (Thread-1): 11:46:43 | 13 of 17 START view model dw_adventure_works.dim_customer............ [RUN]
2021-05-29 14:46:43.277425 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:46:43.278421 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 14:46:43.287398 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:46:43.316349 (Thread-1): finished collecting timing info
2021-05-29 14:46:43.332278 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:46:43.334272 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:43.350229 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  OPTIONS()
  as with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed;


2021-05-29 14:46:43.572102 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61526), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:43.573103 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61527), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:43.574102 (Thread-1): unclosed <socket.socket fd=1444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61529), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:43.575094 (Thread-1): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61528), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:43.585193 (Thread-1): unclosed <socket.socket fd=1520, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61533), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:43.586171 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61532), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:45.773127 (Thread-1): finished collecting timing info
2021-05-29 14:46:45.777164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463B789588>]}
2021-05-29 14:46:45.781107 (Thread-1): 11:46:45 | 13 of 17 OK created view model dw_adventure_works.dim_customer....... [OK in 2.50s]
2021-05-29 14:46:45.784098 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 14:46:45.785101 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 14:46:45.786098 (Thread-1): 11:46:45 | 14 of 17 START view model dw_adventure_works.dim_product............. [RUN]
2021-05-29 14:46:45.787091 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:46:45.788089 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 14:46:45.801065 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:46:45.804043 (Thread-1): finished collecting timing info
2021-05-29 14:46:45.817012 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:46:45.819004 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:45.832968 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_product`
  OPTIONS()
  as with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-05-29 14:46:48.271442 (Thread-1): finished collecting timing info
2021-05-29 14:46:48.273391 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463A61CD48>]}
2021-05-29 14:46:48.275384 (Thread-1): 11:46:48 | 14 of 17 OK created view model dw_adventure_works.dim_product........ [OK in 2.49s]
2021-05-29 14:46:48.278375 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 14:46:48.278375 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 14:46:48.279375 (Thread-1): 11:46:48 | 15 of 17 START view model dw_adventure_works.dim_reason.............. [RUN]
2021-05-29 14:46:48.281366 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:46:48.281366 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 14:46:48.282401 (Thread-1): unclosed <socket.socket fd=1576, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61536), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:48.283397 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61537), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:48.287386 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:46:48.291135 (Thread-1): finished collecting timing info
2021-05-29 14:46:48.296128 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:46:48.298123 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:48.305105 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  OPTIONS()
  as with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by reasonorder.salesreasonid) as reason_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed;


2021-05-29 14:46:49.997594 (Thread-1): finished collecting timing info
2021-05-29 14:46:49.998554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463B7CA0C8>]}
2021-05-29 14:46:49.999551 (Thread-1): 11:46:49 | 15 of 17 OK created view model dw_adventure_works.dim_reason......... [OK in 1.72s]
2021-05-29 14:46:50.002541 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 14:46:50.002541 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 14:46:50.003579 (Thread-1): 11:46:50 | 16 of 17 START view model dw_adventure_works.dim_address............. [RUN]
2021-05-29 14:46:50.005539 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:46:50.006530 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 14:46:50.012512 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:46:50.503644 (Thread-1): finished collecting timing info
2021-05-29 14:46:50.511670 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:46:50.700693 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:50.715653 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`dim_address`
  OPTIONS()
  as with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed;


2021-05-29 14:46:53.145214 (Thread-1): finished collecting timing info
2021-05-29 14:46:53.146205 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463B7C3748>]}
2021-05-29 14:46:53.147166 (Thread-1): 11:46:53 | 16 of 17 OK created view model dw_adventure_works.dim_address........ [OK in 3.14s]
2021-05-29 14:46:53.149159 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 14:46:53.150158 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:46:53.151153 (Thread-1): 11:46:53 | 17 of 17 START view model dw_adventure_works.fact_order_details...... [RUN]
2021-05-29 14:46:53.151855 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:46:53.152859 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:46:53.163831 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:46:53.166623 (Thread-1): finished collecting timing info
2021-05-29 14:46:53.170621 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:46:53.173612 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:46:53.181591 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  OPTIONS()
  as with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final;


2021-05-29 14:46:56.121302 (Thread-1): finished collecting timing info
2021-05-29 14:46:56.124306 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '721779a4-4201-4495-bc71-f320af022353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463B815FC8>]}
2021-05-29 14:46:56.125291 (Thread-1): 11:46:56 | 17 of 17 OK created view model dw_adventure_works.fact_order_details. [OK in 2.97s]
2021-05-29 14:46:56.164188 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:46:56.241979 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:46:56.253951 (MainThread): 11:46:56 | 
2021-05-29 14:46:56.262928 (MainThread): 11:46:56 | Finished running 17 view models in 47.31s.
2021-05-29 14:46:56.268908 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:46:56.269906 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:46:56.269906 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:46:56.270904 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:46:56.321767 (MainThread): unclosed <socket.socket fd=1544, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61539), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:56.323761 (MainThread): unclosed <socket.socket fd=1600, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61540), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:56.326753 (MainThread): unclosed <socket.socket fd=1632, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61541), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:56.326753 (MainThread): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61542), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:56.327754 (MainThread): unclosed <socket.socket fd=1692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61544), raddr=('142.250.218.74', 443)>
2021-05-29 14:46:56.329745 (MainThread): unclosed <socket.socket fd=1676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61543), raddr=('216.58.202.10', 443)>
2021-05-29 14:46:56.359693 (MainThread): 
2021-05-29 14:46:56.360665 (MainThread): Completed successfully
2021-05-29 14:46:56.361663 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-05-29 14:46:56.364331 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463C846148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463C85D108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001463C85D488>]}
2021-05-29 14:46:56.365318 (MainThread): Flushing usage events
2021-05-29 14:52:47.876743 (MainThread): Running with dbt=0.19.1
2021-05-29 14:52:49.861714 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 14:52:49.866702 (MainThread): Tracking: tracking
2021-05-29 14:52:49.867697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39B03DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39B04AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39B04688>]}
2021-05-29 14:52:49.916567 (MainThread): Partial parsing not enabled
2021-05-29 14:52:49.926540 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:52:51.127746 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:52:51.559433 (MainThread): Parsing macros\etc.sql
2021-05-29 14:52:51.585422 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:52:51.622337 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:52:51.716094 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:52:51.733047 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:52:51.749003 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:52:51.793883 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:52:51.817914 (MainThread): Parsing macros\core.sql
2021-05-29 14:52:51.842866 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:52:52.034452 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:52:52.071370 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:52:52.079336 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:52:52.085321 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:52:52.097298 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:52:52.109257 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:52:52.113245 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:52:52.150147 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:52:52.228937 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:52:52.237852 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:52:52.266769 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:52:52.363648 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:52:52.513768 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:52:52.519746 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:52:52.598682 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:52:52.631595 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:52:52.661515 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:52:52.696422 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:52:52.709390 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:52:52.715374 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:52:52.728341 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:52:52.764240 (MainThread): Partial parsing not enabled
2021-05-29 14:52:52.895271 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:52:52.932172 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:52:52.951121 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:52:52.975367 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:52:52.993824 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:52:53.013768 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:52:53.032719 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:52:53.049671 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:52:53.069623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:52:53.093555 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:52:53.110101 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:52:53.130045 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:52:53.147996 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:52:53.170937 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:52:53.190888 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:52:53.210828 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:52:53.228780 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:52:54.050007 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.staging

2021-05-29 14:52:54.064969 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D43C448>]}
2021-05-29 14:52:54.199780 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39ACE208>]}
2021-05-29 14:52:54.200777 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:52:54.226725 (MainThread): 
2021-05-29 14:52:54.227706 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:52:54.232692 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 14:52:54.232692 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 14:52:55.215192 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:52:55.215192 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:52:55.230149 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:52:55.994813 (MainThread): 11:52:55 | Concurrency: 1 threads (target='dev')
2021-05-29 14:52:55.996808 (MainThread): 11:52:55 | 
2021-05-29 14:52:56.015762 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 14:52:56.017752 (Thread-1): 11:52:56 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 14:52:56.024748 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:52:56.025732 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 14:52:56.041688 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:52:56.048669 (Thread-1): finished collecting timing info
2021-05-29 14:52:56.195278 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 14:52:56.197273 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:52:56.212233 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 14:52:59.379619 (Thread-1): finished collecting timing info
2021-05-29 14:52:59.380609 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E39AF06C8>]}
2021-05-29 14:52:59.381609 (Thread-1): 11:52:59 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 3.36s]
2021-05-29 14:52:59.383602 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 14:52:59.384601 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:52:59.387601 (Thread-1): 11:52:59 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 14:52:59.393576 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:52:59.393576 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 14:52:59.406567 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:52:59.409532 (Thread-1): finished collecting timing info
2021-05-29 14:52:59.418510 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61625), raddr=('172.217.29.234', 443)>
2021-05-29 14:52:59.426488 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61626), raddr=('142.250.219.10', 443)>
2021-05-29 14:52:59.429480 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 14:52:59.432471 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:52:59.446435 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 14:53:02.109483 (Thread-1): finished collecting timing info
2021-05-29 14:53:02.110481 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D536D48>]}
2021-05-29 14:53:02.111477 (Thread-1): 11:53:02 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 2.72s]
2021-05-29 14:53:02.113476 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 14:53:02.114475 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 14:53:02.115506 (Thread-1): 11:53:02 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 14:53:02.116463 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:53:02.117466 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 14:53:02.118458 (Thread-1): unclosed <socket.socket fd=912, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61627), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:02.119458 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61628), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:02.123447 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:53:02.126439 (Thread-1): finished collecting timing info
2021-05-29 14:53:02.130459 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 14:53:02.131423 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:02.140435 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 14:53:03.926168 (Thread-1): finished collecting timing info
2021-05-29 14:53:03.927204 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D5EFC08>]}
2021-05-29 14:53:03.928202 (Thread-1): 11:53:03 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 1.81s]
2021-05-29 14:53:03.930158 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 14:53:03.930158 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:53:03.931155 (Thread-1): 11:53:03 | 4 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 14:53:03.934147 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:53:03.935146 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:53:03.943126 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:53:03.946114 (Thread-1): finished collecting timing info
2021-05-29 14:53:03.951102 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 14:53:03.952733 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:03.961714 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 14:53:06.182743 (Thread-1): finished collecting timing info
2021-05-29 14:53:06.185748 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D53F488>]}
2021-05-29 14:53:06.189724 (Thread-1): 11:53:06 | 4 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.25s]
2021-05-29 14:53:06.191719 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 14:53:06.192716 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 14:53:06.193714 (Thread-1): 11:53:06 | 5 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 14:53:06.194711 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:53:06.194711 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 14:53:06.206678 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:53:06.208677 (Thread-1): finished collecting timing info
2021-05-29 14:53:06.216652 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 14:53:06.225627 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:06.237632 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 14:53:07.963070 (Thread-1): finished collecting timing info
2021-05-29 14:53:07.964068 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3BE290C8>]}
2021-05-29 14:53:07.965063 (Thread-1): 11:53:07 | 5 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 1.77s]
2021-05-29 14:53:07.973045 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 14:53:07.973045 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 14:53:07.975038 (Thread-1): 11:53:07 | 6 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 14:53:07.976037 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:53:07.977034 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 14:53:07.982020 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:53:07.989998 (Thread-1): finished collecting timing info
2021-05-29 14:53:07.994987 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 14:53:07.996980 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:08.012937 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 14:53:10.408752 (Thread-1): finished collecting timing info
2021-05-29 14:53:10.409746 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D5EF508>]}
2021-05-29 14:53:10.410745 (Thread-1): 11:53:10 | 6 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.43s]
2021-05-29 14:53:10.412740 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 14:53:10.412740 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:53:10.413737 (Thread-1): 11:53:10 | 7 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 14:53:10.415735 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:53:10.416771 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 14:53:10.428697 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:53:10.430692 (Thread-1): finished collecting timing info
2021-05-29 14:53:10.443658 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 14:53:10.446648 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:10.458617 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 14:53:12.910815 (Thread-1): finished collecting timing info
2021-05-29 14:53:12.911812 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D673288>]}
2021-05-29 14:53:12.911812 (Thread-1): 11:53:12 | 7 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 2.50s]
2021-05-29 14:53:12.913809 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 14:53:12.914806 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:53:12.915802 (Thread-1): 11:53:12 | 8 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 14:53:12.920813 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:53:12.921789 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 14:53:12.929763 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61629), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:12.929763 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61630), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:12.930760 (Thread-1): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61631), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:12.931760 (Thread-1): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61632), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:12.931760 (Thread-1): unclosed <socket.socket fd=1264, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61633), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:12.932756 (Thread-1): unclosed <socket.socket fd=1280, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61634), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:12.932756 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61635), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:12.933753 (Thread-1): unclosed <socket.socket fd=1336, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61636), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:12.933753 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61638), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:12.934753 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61639), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:12.939738 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:53:12.942730 (Thread-1): finished collecting timing info
2021-05-29 14:53:12.951705 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 14:53:12.954699 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:12.972664 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 14:53:14.827034 (Thread-1): finished collecting timing info
2021-05-29 14:53:14.828032 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D4A8CC8>]}
2021-05-29 14:53:14.829031 (Thread-1): 11:53:14 | 8 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 1.91s]
2021-05-29 14:53:14.838006 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 14:53:14.839005 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:53:14.841075 (Thread-1): 11:53:14 | 9 of 17 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 14:53:14.843053 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:53:14.843053 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 14:53:14.845044 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61640), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:14.845044 (Thread-1): unclosed <socket.socket fd=1400, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61641), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:14.856137 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:53:14.858131 (Thread-1): finished collecting timing info
2021-05-29 14:53:14.867108 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 14:53:14.870100 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:14.887068 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , unitprice * (1 - unitpricediscount) * orderqty as saleprice
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 14:53:16.807066 (Thread-1): finished collecting timing info
2021-05-29 14:53:16.808065 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D4B6908>]}
2021-05-29 14:53:16.809063 (Thread-1): 11:53:16 | 9 of 17 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 1.97s]
2021-05-29 14:53:16.811054 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 14:53:16.812053 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 14:53:16.812053 (Thread-1): 11:53:16 | 10 of 17 START view model dw_adventure_works.stg_orders.............. [RUN]
2021-05-29 14:53:16.814047 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:53:16.815045 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 14:53:16.823022 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:53:16.826013 (Thread-1): finished collecting timing info
2021-05-29 14:53:16.831998 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 14:53:16.835987 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:16.854450 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 14:53:19.241541 (Thread-1): finished collecting timing info
2021-05-29 14:53:19.244508 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D697B88>]}
2021-05-29 14:53:19.247499 (Thread-1): 11:53:19 | 10 of 17 OK created view model dw_adventure_works.stg_orders......... [OK in 2.43s]
2021-05-29 14:53:19.256490 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 14:53:19.259481 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:53:19.261462 (Thread-1): 11:53:19 | 11 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 14:53:19.264456 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:53:19.268457 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 14:53:19.291385 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:53:19.294374 (Thread-1): finished collecting timing info
2021-05-29 14:53:19.311330 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 14:53:19.324294 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:19.343243 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 14:53:21.145807 (Thread-1): finished collecting timing info
2021-05-29 14:53:21.152831 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D4E1248>]}
2021-05-29 14:53:21.154781 (Thread-1): 11:53:21 | 11 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 1.89s]
2021-05-29 14:53:21.157775 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 14:53:21.158770 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:53:21.159766 (Thread-1): 11:53:21 | 12 of 17 START table model dw_adventure_works.dim_creditcard......... [RUN]
2021-05-29 14:53:21.164765 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:53:21.166756 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 14:53:21.194677 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:53:21.203658 (Thread-1): finished collecting timing info
2021-05-29 14:53:21.426055 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:21.449001 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:22.354932 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:22.940056 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 14:53:23.318878 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 14:53:26.122522 (Thread-1): finished collecting timing info
2021-05-29 14:53:26.123519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D505908>]}
2021-05-29 14:53:26.124517 (Thread-1): 11:53:26 | 12 of 17 OK created table model dw_adventure_works.dim_creditcard.... [CREATE TABLE (19.1k rows, 1.1 MB processed) in 4.96s]
2021-05-29 14:53:26.126514 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 14:53:26.127508 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 14:53:26.128506 (Thread-1): 11:53:26 | 13 of 17 START table model dw_adventure_works.dim_customer........... [RUN]
2021-05-29 14:53:26.131515 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:53:26.133522 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 14:53:26.143465 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61642), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:26.144463 (Thread-1): unclosed <socket.socket fd=1336, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61643), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:26.145461 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61644), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:26.145461 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61645), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:26.146460 (Thread-1): unclosed <socket.socket fd=1464, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61646), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:26.147455 (Thread-1): unclosed <socket.socket fd=1484, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61647), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:26.149465 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61649), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:26.150450 (Thread-1): unclosed <socket.socket fd=1532, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61648), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:26.159424 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:53:26.162416 (Thread-1): finished collecting timing info
2021-05-29 14:53:26.171391 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:26.187347 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:26.977749 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:27.846502 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 14:53:28.067730 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  
  
  OPTIONS()
  as (
    with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed
  );
    
2021-05-29 14:53:31.611263 (Thread-1): finished collecting timing info
2021-05-29 14:53:31.615272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E7B7B08>]}
2021-05-29 14:53:31.617245 (Thread-1): 11:53:31 | 13 of 17 OK created table model dw_adventure_works.dim_customer...... [CREATE TABLE (19.8k rows, 1.8 MB processed) in 5.48s]
2021-05-29 14:53:31.619239 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 14:53:31.620239 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 14:53:31.621236 (Thread-1): 11:53:31 | 14 of 17 START table model dw_adventure_works.dim_product............ [RUN]
2021-05-29 14:53:31.623229 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:53:31.623229 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 14:53:31.635199 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:53:31.638190 (Thread-1): finished collecting timing info
2021-05-29 14:53:31.643178 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:31.660133 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:32.515279 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:33.087242 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 14:53:33.091233 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_product`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 14:53:36.206873 (Thread-1): finished collecting timing info
2021-05-29 14:53:36.207869 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3D503AC8>]}
2021-05-29 14:53:36.208866 (Thread-1): 11:53:36 | 14 of 17 OK created table model dw_adventure_works.dim_product....... [CREATE TABLE (504.0 rows, 71.3 KB processed) in 4.59s]
2021-05-29 14:53:36.218839 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 14:53:36.219836 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 14:53:36.220834 (Thread-1): 11:53:36 | 15 of 17 START table model dw_adventure_works.dim_reason............. [RUN]
2021-05-29 14:53:36.221832 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:53:36.222829 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 14:53:36.236791 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:53:36.241777 (Thread-1): finished collecting timing info
2021-05-29 14:53:36.247762 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:36.266710 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:37.651832 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:37.919638 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 14:53:37.921634 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by reasonorder.salesreasonid) as reason_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 14:53:41.542497 (Thread-1): finished collecting timing info
2021-05-29 14:53:41.546518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E7E0E08>]}
2021-05-29 14:53:41.549478 (Thread-1): 11:53:41 | 15 of 17 OK created table model dw_adventure_works.dim_reason........ [CREATE TABLE (27.6k rows, 648.3 KB processed) in 5.32s]
2021-05-29 14:53:41.551471 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 14:53:41.552471 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 14:53:41.553467 (Thread-1): 11:53:41 | 16 of 17 START table model dw_adventure_works.dim_address............ [RUN]
2021-05-29 14:53:41.554464 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:53:41.554464 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 14:53:41.569425 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:53:41.571418 (Thread-1): finished collecting timing info
2021-05-29 14:53:41.583385 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:41.598372 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:42.972264 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:43.253768 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 14:53:43.255764 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_address`
  
  
  OPTIONS()
  as (
    with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed
  );
    
2021-05-29 14:53:46.900603 (Thread-1): finished collecting timing info
2021-05-29 14:53:46.901598 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E81CD48>]}
2021-05-29 14:53:46.902598 (Thread-1): 11:53:46 | 16 of 17 OK created table model dw_adventure_works.dim_address....... [CREATE TABLE (19.6k rows, 2.7 MB processed) in 5.35s]
2021-05-29 14:53:46.904590 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 14:53:46.905588 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 14:53:46.905588 (Thread-1): 11:53:46 | 17 of 17 START table model dw_adventure_works.fact_order_details..... [RUN]
2021-05-29 14:53:46.907583 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:53:46.907583 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 14:53:46.926552 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:53:46.933513 (Thread-1): finished collecting timing info
2021-05-29 14:53:46.936507 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:53:46.950471 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:48.298787 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:53:48.566132 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 14:53:48.568125 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 14:53:54.690905 (Thread-1): finished collecting timing info
2021-05-29 14:53:54.694911 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6ea2e6c-4f46-4d43-85c8-b11f7e71d663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E835888>]}
2021-05-29 14:53:54.696888 (Thread-1): 11:53:54 | 17 of 17 OK created table model dw_adventure_works.fact_order_details [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.79s]
2021-05-29 14:53:54.698881 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 14:53:54.798614 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:53:54.799614 (MainThread): 11:53:54 | 
2021-05-29 14:53:54.800610 (MainThread): 11:53:54 | Finished running 11 view models, 6 table models in 60.57s.
2021-05-29 14:53:54.801608 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:53:54.802605 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 14:53:54.802605 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:53:54.802605 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 14:53:54.814576 (MainThread): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61652), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:54.815570 (MainThread): unclosed <socket.socket fd=1556, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61651), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:54.815570 (MainThread): unclosed <socket.socket fd=1500, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61657), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:54.816566 (MainThread): unclosed <socket.socket fd=1568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61656), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:54.816566 (MainThread): unclosed <socket.socket fd=1648, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61659), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:54.817565 (MainThread): unclosed <socket.socket fd=1652, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61658), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:54.817565 (MainThread): unclosed <socket.socket fd=884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61660), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:54.818562 (MainThread): unclosed <socket.socket fd=1596, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61661), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:54.819562 (MainThread): unclosed <socket.socket fd=1668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61663), raddr=('142.250.219.10', 443)>
2021-05-29 14:53:54.819562 (MainThread): unclosed <socket.socket fd=1688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61662), raddr=('172.217.29.234', 443)>
2021-05-29 14:53:54.850475 (MainThread): 
2021-05-29 14:53:54.851486 (MainThread): Completed successfully
2021-05-29 14:53:54.852472 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-05-29 14:53:54.853473 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E80D588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E823388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3E820508>]}
2021-05-29 14:53:54.854466 (MainThread): Flushing usage events
2021-05-29 14:54:36.573566 (MainThread): Running with dbt=0.19.1
2021-05-29 14:54:37.483828 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 14:54:37.485032 (MainThread): Tracking: tracking
2021-05-29 14:54:37.486039 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5DF5F748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5F1C4708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5DF5F688>]}
2021-05-29 14:54:37.505178 (MainThread): Partial parsing not enabled
2021-05-29 14:54:37.508795 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:54:37.550531 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:54:37.563530 (MainThread): Parsing macros\etc.sql
2021-05-29 14:54:37.568952 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:54:37.577967 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:54:37.602481 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:54:37.609430 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:54:37.616292 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:54:37.636243 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:54:37.647212 (MainThread): Parsing macros\core.sql
2021-05-29 14:54:37.656948 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:54:37.744303 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:54:37.763514 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:54:37.766359 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:54:37.770835 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:54:37.775837 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:54:37.779828 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:54:37.783172 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:54:37.802169 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:54:37.830090 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:54:37.835078 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:54:37.849076 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:54:37.894732 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:54:37.965553 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:54:37.969997 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:54:38.006334 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:54:38.021546 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:54:38.032543 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:54:38.047508 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:54:38.056484 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:54:38.060476 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:54:38.066470 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:54:38.084569 (MainThread): Partial parsing not enabled
2021-05-29 14:54:38.140455 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:54:38.162300 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:54:38.171311 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:54:38.179255 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:54:38.187234 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:54:38.196248 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:54:38.204194 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:54:38.212862 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:54:38.236032 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:54:38.257843 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:54:38.285309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:54:38.295109 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:54:38.304324 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:54:38.312788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:54:38.321775 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:54:38.330750 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:54:38.340078 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:54:38.647907 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.staging

2021-05-29 14:54:38.662867 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79729096-22cc-4437-98d6-0a7f7a0b91ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF61C29B08>]}
2021-05-29 14:54:38.736704 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79729096-22cc-4437-98d6-0a7f7a0b91ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5DF262C8>]}
2021-05-29 14:54:38.737671 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:54:38.745683 (MainThread): 
2021-05-29 14:54:38.746680 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:54:38.759610 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:54:38.759610 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:54:38.779556 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:54:40.138352 (MainThread): 11:54:40 | Concurrency: 1 threads (target='dev')
2021-05-29 14:54:40.139356 (MainThread): 11:54:40 | 
2021-05-29 14:54:40.149324 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:54:40.150323 (Thread-1): 11:54:40 | 1 of 18 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 14:54:40.152319 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 14:54:40.154331 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:54:40.173259 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 14:54:40.178249 (Thread-1): finished collecting timing info
2021-05-29 14:54:40.179244 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:54:40.191244 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 14:54:43.195233 (Thread-1): finished collecting timing info
2021-05-29 14:54:43.196231 (Thread-1): 11:54:43 | 1 of 18 PASS not_null_dim_address_address_sk......................... [PASS in 3.04s]
2021-05-29 14:54:43.199225 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:54:43.200221 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:54:43.201216 (Thread-1): 11:54:43 | 2 of 18 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 14:54:43.203213 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 14:54:43.203213 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:54:43.219172 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 14:54:43.261280 (Thread-1): finished collecting timing info
2021-05-29 14:54:43.262284 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:43.273251 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 14:54:46.114128 (Thread-1): finished collecting timing info
2021-05-29 14:54:46.118879 (Thread-1): 11:54:46 | 2 of 18 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.92s]
2021-05-29 14:54:46.120710 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:54:46.121708 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:54:46.122705 (Thread-1): 11:54:46 | 3 of 18 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 14:54:46.123703 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 14:54:46.124702 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:54:46.127694 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61675), raddr=('172.217.29.234', 443)>
2021-05-29 14:54:46.129687 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61676), raddr=('142.250.219.10', 443)>
2021-05-29 14:54:46.145645 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 14:54:46.150634 (Thread-1): finished collecting timing info
2021-05-29 14:54:46.151629 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:46.169583 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 14:54:49.481166 (Thread-1): finished collecting timing info
2021-05-29 14:54:49.483135 (Thread-1): 11:54:49 | 3 of 18 PASS not_null_dim_customer_customer_sk....................... [PASS in 3.36s]
2021-05-29 14:54:49.484132 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:54:49.485131 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:54:49.485131 (Thread-1): 11:54:49 | 4 of 18 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 14:54:49.486128 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 14:54:49.487126 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:54:49.495103 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 14:54:49.503082 (Thread-1): finished collecting timing info
2021-05-29 14:54:49.503082 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:49.513057 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 14:54:49.518046 (Thread-1): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61673), raddr=('172.217.29.234', 443)>
2021-05-29 14:54:49.519045 (Thread-1): unclosed <socket.socket fd=968, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61674), raddr=('142.250.219.10', 443)>
2021-05-29 14:54:49.523028 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61677), raddr=('172.217.29.234', 443)>
2021-05-29 14:54:49.523028 (Thread-1): unclosed <socket.socket fd=428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61678), raddr=('142.250.219.10', 443)>
2021-05-29 14:54:52.368194 (Thread-1): finished collecting timing info
2021-05-29 14:54:52.369189 (Thread-1): 11:54:52 | 4 of 18 PASS not_null_dim_product_product_sk......................... [PASS in 2.88s]
2021-05-29 14:54:52.371184 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:54:52.372182 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_reasonorder_sk
2021-05-29 14:54:52.372182 (Thread-1): 11:54:52 | 5 of 18 START test not_null_dim_reason_reasonorder_sk................ [RUN]
2021-05-29 14:54:52.374183 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_reasonorder_sk".
2021-05-29 14:54:52.374183 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_reasonorder_sk
2021-05-29 14:54:52.390134 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_reasonorder_sk"
2021-05-29 14:54:52.393125 (Thread-1): finished collecting timing info
2021-05-29 14:54:52.394123 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:52.422642 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_reasonorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reasonorder_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where reasonorder_sk is null



2021-05-29 14:54:54.193115 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/97c70284-73e0-4ec7-b514-0856212fa766?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reasonorder_sk at [10:7]')
2021-05-29 14:54:55.903540 (Thread-1): finished collecting timing info
2021-05-29 14:54:55.905568 (Thread-1): Database Error in test not_null_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
  Unrecognized name: reasonorder_sk at [10:7]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reasonorder_sk.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/003fac53-4209-40e1-9abf-5734700e8d59?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reasonorder_sk at [10:7]

(job ID: 003fac53-4209-40e1-9abf-5734700e8d59)

                                                                          -----Query Job SQL Follows-----                                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reasonorder_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  10:where reasonorder_sk is null
  11:
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
  Unrecognized name: reasonorder_sk at [10:7]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reasonorder_sk.sql
2021-05-29 14:54:55.949906 (Thread-1): 11:54:55 | 5 of 18 ERROR not_null_dim_reason_reasonorder_sk..................... [ERROR in 3.58s]
2021-05-29 14:54:55.950910 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_reasonorder_sk
2021-05-29 14:54:55.951910 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:54:55.951910 (Thread-1): 11:54:55 | 6 of 18 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 14:54:55.953901 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 14:54:55.953901 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:54:55.961884 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 14:54:55.967202 (Thread-1): finished collecting timing info
2021-05-29 14:54:55.968197 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:55.976176 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 14:54:58.817707 (Thread-1): finished collecting timing info
2021-05-29 14:54:58.819684 (Thread-1): 11:54:58 | 6 of 18 PASS not_null_fact_order_details_salesorderid................ [PASS in 2.87s]
2021-05-29 14:54:58.821677 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:54:58.821677 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:54:58.822676 (Thread-1): 11:54:58 | 7 of 18 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 14:54:58.823674 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 14:54:58.824670 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:54:58.827662 (Thread-1): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61683), raddr=('172.217.29.234', 443)>
2021-05-29 14:54:58.831681 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61684), raddr=('142.250.219.10', 443)>
2021-05-29 14:54:58.875535 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 14:54:58.882529 (Thread-1): finished collecting timing info
2021-05-29 14:54:58.884509 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:54:58.902460 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:55:01.979253 (Thread-1): finished collecting timing info
2021-05-29 14:55:01.982241 (Thread-1): 11:55:01 | 7 of 18 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 3.16s]
2021-05-29 14:55:01.986204 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:55:01.988179 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:55:01.990174 (Thread-1): 11:55:01 | 8 of 18 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 14:55:01.995160 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 14:55:01.996155 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:55:02.027099 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 14:55:02.031058 (Thread-1): finished collecting timing info
2021-05-29 14:55:02.031058 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:02.043025 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:55:05.553848 (Thread-1): finished collecting timing info
2021-05-29 14:55:05.555843 (Thread-1): 11:55:05 | 8 of 18 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 3.56s]
2021-05-29 14:55:05.565816 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:55:05.566814 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:55:05.566814 (Thread-1): 11:55:05 | 9 of 18 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 14:55:05.568809 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 14:55:05.568809 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:55:05.570804 (Thread-1): unclosed <socket.socket fd=692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61687), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:05.571802 (Thread-1): unclosed <socket.socket fd=1432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61688), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:05.594755 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 14:55:05.600795 (Thread-1): finished collecting timing info
2021-05-29 14:55:05.601720 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:05.622664 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:55:09.200802 (Thread-1): finished collecting timing info
2021-05-29 14:55:09.201802 (Thread-1): 11:55:09 | 9 of 18 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 3.63s]
2021-05-29 14:55:09.202763 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:55:09.203759 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:55:09.203759 (Thread-1): 11:55:09 | 10 of 18 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 14:55:09.204755 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 14:55:09.205754 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:55:09.215728 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 14:55:09.217726 (Thread-1): finished collecting timing info
2021-05-29 14:55:09.218720 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:09.230687 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:55:12.554010 (Thread-1): finished collecting timing info
2021-05-29 14:55:12.555007 (Thread-1): 11:55:12 | 10 of 18 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 3.35s]
2021-05-29 14:55:12.557996 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:55:12.558994 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:55:12.558994 (Thread-1): 11:55:12 | 11 of 18 START test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [RUN]
2021-05-29 14:55:12.560989 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_".
2021-05-29 14:55:12.561991 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:55:12.564978 (Thread-1): unclosed <socket.socket fd=856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61691), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:12.565980 (Thread-1): unclosed <socket.socket fd=1480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61692), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:12.576946 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"
2021-05-29 14:55:12.577944 (Thread-1): finished collecting timing info
2021-05-29 14:55:12.578939 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:12.589909 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"} */

    
    




select count(*) as validation_errors
from (
    select reason_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select reason_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:55:15.167112 (Thread-1): finished collecting timing info
2021-05-29 14:55:15.170104 (Thread-1): 11:55:15 | 11 of 18 PASS relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [PASS in 2.61s]
2021-05-29 14:55:15.176087 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:55:15.177084 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:15.178080 (Thread-1): 11:55:15 | 12 of 18 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 14:55:15.180074 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 14:55:15.181072 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:15.193041 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61681), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:15.194038 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61682), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:15.200061 (Thread-1): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61685), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:15.201020 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61686), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:15.206005 (Thread-1): unclosed <socket.socket fd=1464, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61689), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:15.206005 (Thread-1): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61690), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:15.210994 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61693), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:15.211993 (Thread-1): unclosed <socket.socket fd=1516, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61694), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:15.213984 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 14:55:15.221131 (Thread-1): finished collecting timing info
2021-05-29 14:55:15.222133 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:15.233184 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 14:55:18.077658 (Thread-1): finished collecting timing info
2021-05-29 14:55:18.079655 (Thread-1): 11:55:18 | 12 of 18 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.90s]
2021-05-29 14:55:18.083607 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:18.085590 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:18.086604 (Thread-1): 11:55:18 | 13 of 18 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 14:55:18.091586 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 14:55:18.092582 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:18.097561 (Thread-1): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61695), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:18.098553 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61696), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:18.125478 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 14:55:18.129167 (Thread-1): finished collecting timing info
2021-05-29 14:55:18.129167 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:18.137144 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 14:55:21.160390 (Thread-1): finished collecting timing info
2021-05-29 14:55:21.163332 (Thread-1): 11:55:21 | 13 of 18 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 3.07s]
2021-05-29 14:55:21.168369 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:55:21.169384 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:55:21.170365 (Thread-1): 11:55:21 | 14 of 18 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 14:55:21.176348 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 14:55:21.177347 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:55:21.211254 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 14:55:21.215241 (Thread-1): finished collecting timing info
2021-05-29 14:55:21.216241 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:21.232190 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:55:24.311593 (Thread-1): finished collecting timing info
2021-05-29 14:55:24.313586 (Thread-1): 11:55:24 | 14 of 18 PASS unique_dim_address_address_sk.......................... [PASS in 3.14s]
2021-05-29 14:55:24.318566 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:55:24.319571 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:55:24.321553 (Thread-1): 11:55:24 | 15 of 18 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 14:55:24.325544 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 14:55:24.326540 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:55:24.329534 (Thread-1): unclosed <socket.socket fd=1612, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61699), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:24.330531 (Thread-1): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61700), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:24.339505 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 14:55:24.342495 (Thread-1): finished collecting timing info
2021-05-29 14:55:24.342495 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:24.350472 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:55:27.385673 (Thread-1): finished collecting timing info
2021-05-29 14:55:27.388617 (Thread-1): 11:55:27 | 15 of 18 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 3.06s]
2021-05-29 14:55:27.392596 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:55:27.394591 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:55:27.396587 (Thread-1): 11:55:27 | 16 of 18 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 14:55:27.400573 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 14:55:27.401586 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:55:27.438477 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 14:55:27.440464 (Thread-1): finished collecting timing info
2021-05-29 14:55:27.441462 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:27.454426 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:55:29.800696 (Thread-1): finished collecting timing info
2021-05-29 14:55:29.802678 (Thread-1): 11:55:29 | 16 of 18 PASS unique_dim_customer_customer_sk........................ [PASS in 2.40s]
2021-05-29 14:55:29.806623 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:55:29.807622 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:55:29.809614 (Thread-1): 11:55:29 | 17 of 18 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 14:55:29.812607 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 14:55:29.813621 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:55:29.819593 (Thread-1): unclosed <socket.socket fd=1236, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61703), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:29.821583 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61704), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:29.830559 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 14:55:29.834345 (Thread-1): finished collecting timing info
2021-05-29 14:55:29.834345 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:29.846311 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:55:32.550735 (Thread-1): finished collecting timing info
2021-05-29 14:55:32.551732 (Thread-1): 11:55:32 | 17 of 18 PASS unique_dim_product_product_sk.......................... [PASS in 2.74s]
2021-05-29 14:55:32.554724 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:55:32.555721 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_reasonorder_sk
2021-05-29 14:55:32.556717 (Thread-1): 11:55:32 | 18 of 18 START test unique_dim_reason_reasonorder_sk................. [RUN]
2021-05-29 14:55:32.558712 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_reasonorder_sk".
2021-05-29 14:55:32.559710 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_reasonorder_sk
2021-05-29 14:55:32.569683 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_reasonorder_sk"
2021-05-29 14:55:32.571677 (Thread-1): finished collecting timing info
2021-05-29 14:55:32.572678 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:32.582646 (Thread-1): On test.dw_adventure_works.unique_dim_reason_reasonorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reasonorder_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        reasonorder_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where reasonorder_sk is not null
    group by reasonorder_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:55:34.449863 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/d53440d3-54a7-4d27-9845-f97e8c9eb139?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reasonorder_sk at [15:11]')
2021-05-29 14:55:35.665793 (Thread-1): finished collecting timing info
2021-05-29 14:55:35.667163 (Thread-1): Database Error in test unique_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
  Unrecognized name: reasonorder_sk at [15:11]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reasonorder_sk.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/07f12644-8629-4f8a-a9f6-4178d72e15d6?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reasonorder_sk at [15:11]

(job ID: 07f12644-8629-4f8a-a9f6-4178d72e15d6)

                                                                         -----Query Job SQL Follows-----                                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reasonorder_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from (
  10:
  11:    select
  12:        reasonorder_sk
  13:
  14:    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  15:    where reasonorder_sk is not null
  16:    group by reasonorder_sk
  17:    having count(*) > 1
  18:
  19:) validation_errors
  20:
  21:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
  Unrecognized name: reasonorder_sk at [15:11]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reasonorder_sk.sql
2021-05-29 14:55:35.669180 (Thread-1): 11:55:35 | 18 of 18 ERROR unique_dim_reason_reasonorder_sk...................... [ERROR in 3.11s]
2021-05-29 14:55:35.670810 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_reasonorder_sk
2021-05-29 14:55:35.674881 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:55:35.675879 (MainThread): 11:55:35 | 
2021-05-29 14:55:35.676876 (MainThread): 11:55:35 | Finished running 18 tests in 56.93s.
2021-05-29 14:55:35.677874 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:55:35.677874 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:55:35.677874 (MainThread): Connection 'test.dw_adventure_works.unique_dim_reason_reasonorder_sk' was properly closed.
2021-05-29 14:55:35.691835 (MainThread): unclosed <socket.socket fd=1548, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61697), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:35.691835 (MainThread): unclosed <socket.socket fd=1572, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61698), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:35.697819 (MainThread): unclosed <socket.socket fd=804, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61701), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:35.698840 (MainThread): unclosed <socket.socket fd=1660, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61702), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:35.703804 (MainThread): unclosed <socket.socket fd=1708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61706), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:35.704802 (MainThread): unclosed <socket.socket fd=1692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61705), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:35.704802 (MainThread): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61709), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:35.705798 (MainThread): unclosed <socket.socket fd=1632, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61708), raddr=('172.217.29.234', 443)>
2021-05-29 14:55:35.719761 (MainThread): 
2021-05-29 14:55:35.721754 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-29 14:55:35.722753 (MainThread): 
2021-05-29 14:55:35.723754 (MainThread): Database Error in test not_null_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
2021-05-29 14:55:35.725744 (MainThread):   Unrecognized name: reasonorder_sk at [10:7]
2021-05-29 14:55:35.726742 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reasonorder_sk.sql
2021-05-29 14:55:35.727739 (MainThread): 
2021-05-29 14:55:35.727739 (MainThread): Database Error in test unique_dim_reason_reasonorder_sk (models\marts\dim_reason.yml)
2021-05-29 14:55:35.729757 (MainThread):   Unrecognized name: reasonorder_sk at [15:11]
2021-05-29 14:55:35.730731 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reasonorder_sk.sql
2021-05-29 14:55:35.731728 (MainThread): 
Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
2021-05-29 14:55:35.733723 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF62D63488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF62D78148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF62D786C8>]}
2021-05-29 14:55:35.733723 (MainThread): Flushing usage events
2021-05-29 14:55:51.919518 (MainThread): Running with dbt=0.19.1
2021-05-29 14:55:52.627130 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 14:55:52.628134 (MainThread): Tracking: tracking
2021-05-29 14:55:52.629126 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024577256D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245773F5288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245773F54C8>]}
2021-05-29 14:55:52.651068 (MainThread): Partial parsing not enabled
2021-05-29 14:55:52.654771 (MainThread): Parsing macros\adapters.sql
2021-05-29 14:55:52.696176 (MainThread): Parsing macros\catalog.sql
2021-05-29 14:55:52.710139 (MainThread): Parsing macros\etc.sql
2021-05-29 14:55:52.714428 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 14:55:52.725403 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 14:55:52.754364 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 14:55:52.760309 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 14:55:52.764336 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 14:55:52.787238 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 14:55:52.797211 (MainThread): Parsing macros\core.sql
2021-05-29 14:55:52.808184 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 14:55:52.909947 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 14:55:52.929856 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 14:55:52.932849 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 14:55:52.937835 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 14:55:52.942822 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 14:55:52.946811 (MainThread): Parsing macros\etc\query.sql
2021-05-29 14:55:52.949804 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 14:55:52.969750 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 14:55:53.000674 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 14:55:53.005483 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 14:55:53.019450 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 14:55:53.068378 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 14:55:53.141124 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 14:55:53.145759 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 14:55:53.184677 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 14:55:53.199620 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 14:55:53.212591 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 14:55:53.225574 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 14:55:53.233530 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 14:55:53.237823 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 14:55:53.242814 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 14:55:53.260767 (MainThread): Partial parsing not enabled
2021-05-29 14:55:53.309671 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 14:55:53.334045 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 14:55:53.343020 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 14:55:53.350999 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 14:55:53.361969 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 14:55:53.371221 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 14:55:53.379234 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 14:55:53.388610 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 14:55:53.397586 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 14:55:53.406561 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 14:55:53.413543 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 14:55:53.424514 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 14:55:53.435485 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 14:55:53.444319 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 14:55:53.455291 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 14:55:53.463272 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 14:55:53.473243 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 14:55:53.793373 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dw_adventure_works.staging

2021-05-29 14:55:53.799323 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '121a7b58-5e52-4e30-b711-81a5d2137cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457AE98648>]}
2021-05-29 14:55:53.871129 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '121a7b58-5e52-4e30-b711-81a5d2137cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245773BE6C8>]}
2021-05-29 14:55:53.871129 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 14:55:53.880106 (MainThread): 
2021-05-29 14:55:53.881101 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:55:53.887058 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 14:55:53.887058 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 14:55:53.896035 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 14:55:54.613682 (MainThread): 11:55:54 | Concurrency: 1 threads (target='dev')
2021-05-29 14:55:54.614680 (MainThread): 11:55:54 | 
2021-05-29 14:55:54.623658 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:55:54.624695 (Thread-1): 11:55:54 | 1 of 18 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 14:55:54.626648 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 14:55:54.626648 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:55:54.641608 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 14:55:54.642604 (Thread-1): finished collecting timing info
2021-05-29 14:55:54.643601 (Thread-1): Opening a new connection, currently in state init
2021-05-29 14:55:54.652310 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 14:55:56.933134 (Thread-1): finished collecting timing info
2021-05-29 14:55:56.942128 (Thread-1): 11:55:56 | 1 of 18 PASS not_null_dim_address_address_sk......................... [PASS in 2.32s]
2021-05-29 14:55:56.946126 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 14:55:56.947096 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:55:56.948101 (Thread-1): 11:55:56 | 2 of 18 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 14:55:56.950091 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 14:55:56.952083 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:55:56.979010 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 14:55:56.981004 (Thread-1): finished collecting timing info
2021-05-29 14:55:56.983001 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:57.004948 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 14:55:58.998550 (Thread-1): finished collecting timing info
2021-05-29 14:55:59.001556 (Thread-1): 11:55:59 | 2 of 18 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.05s]
2021-05-29 14:55:59.006529 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 14:55:59.006529 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:55:59.007526 (Thread-1): 11:55:59 | 3 of 18 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 14:55:59.008524 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 14:55:59.008524 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:55:59.011515 (Thread-1): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61722), raddr=('172.217.162.202', 443)>
2021-05-29 14:55:59.012513 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61723), raddr=('142.250.219.10', 443)>
2021-05-29 14:55:59.027471 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 14:55:59.029471 (Thread-1): finished collecting timing info
2021-05-29 14:55:59.030463 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:55:59.045424 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 14:56:01.415541 (Thread-1): finished collecting timing info
2021-05-29 14:56:01.417536 (Thread-1): 11:56:01 | 3 of 18 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.41s]
2021-05-29 14:56:01.427510 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 14:56:01.428511 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:56:01.428511 (Thread-1): 11:56:01 | 4 of 18 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 14:56:01.432500 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 14:56:01.433497 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:56:01.452442 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 14:56:01.456433 (Thread-1): finished collecting timing info
2021-05-29 14:56:01.457433 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:01.474384 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 14:56:01.479377 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61718), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:01.481366 (Thread-1): unclosed <socket.socket fd=856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61719), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:01.490344 (Thread-1): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61724), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:01.492337 (Thread-1): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61725), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:03.906718 (Thread-1): finished collecting timing info
2021-05-29 14:56:03.907713 (Thread-1): 11:56:03 | 4 of 18 PASS not_null_dim_product_product_sk......................... [PASS in 2.48s]
2021-05-29 14:56:03.910705 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 14:56:03.910705 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 14:56:03.911702 (Thread-1): 11:56:03 | 5 of 18 START test not_null_dim_reason_reason_sk..................... [RUN]
2021-05-29 14:56:03.912703 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_reason_sk".
2021-05-29 14:56:03.913696 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 14:56:03.931650 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_reason_sk"
2021-05-29 14:56:03.938636 (Thread-1): finished collecting timing info
2021-05-29 14:56:03.939626 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:03.959574 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where reason_sk is null



2021-05-29 14:56:07.245034 (Thread-1): finished collecting timing info
2021-05-29 14:56:07.246032 (Thread-1): 11:56:07 | 5 of 18 PASS not_null_dim_reason_reason_sk........................... [PASS in 3.33s]
2021-05-29 14:56:07.250028 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 14:56:07.253031 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:56:07.254011 (Thread-1): 11:56:07 | 6 of 18 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 14:56:07.256014 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 14:56:07.256014 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:56:07.273956 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 14:56:07.275955 (Thread-1): finished collecting timing info
2021-05-29 14:56:07.275955 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:07.289918 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 14:56:10.340968 (Thread-1): finished collecting timing info
2021-05-29 14:56:10.341965 (Thread-1): 11:56:10 | 6 of 18 PASS not_null_fact_order_details_salesorderid................ [PASS in 3.09s]
2021-05-29 14:56:10.344958 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 14:56:10.344958 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:56:10.345954 (Thread-1): 11:56:10 | 7 of 18 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 14:56:10.350957 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 14:56:10.352938 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:56:10.386847 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 14:56:10.387842 (Thread-1): finished collecting timing info
2021-05-29 14:56:10.388839 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:10.404797 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:56:12.792948 (Thread-1): finished collecting timing info
2021-05-29 14:56:12.793944 (Thread-1): 11:56:12 | 7 of 18 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 2.45s]
2021-05-29 14:56:12.796939 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 14:56:12.799960 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:56:12.801946 (Thread-1): 11:56:12 | 8 of 18 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 14:56:12.803920 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 14:56:12.804921 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:56:12.821873 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 14:56:12.822868 (Thread-1): finished collecting timing info
2021-05-29 14:56:12.823866 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:12.838824 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:56:15.470932 (Thread-1): finished collecting timing info
2021-05-29 14:56:15.472925 (Thread-1): 11:56:15 | 8 of 18 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.67s]
2021-05-29 14:56:15.477914 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 14:56:15.479907 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:56:15.481902 (Thread-1): 11:56:15 | 9 of 18 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 14:56:15.485889 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 14:56:15.486887 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:56:15.515808 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 14:56:15.518799 (Thread-1): finished collecting timing info
2021-05-29 14:56:15.518799 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:15.530767 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:56:18.353393 (Thread-1): finished collecting timing info
2021-05-29 14:56:18.354390 (Thread-1): 11:56:18 | 9 of 18 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.87s]
2021-05-29 14:56:18.355387 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 14:56:18.356387 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:56:18.357381 (Thread-1): 11:56:18 | 10 of 18 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 14:56:18.361371 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 14:56:18.361371 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:56:18.369350 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61738), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:18.370348 (Thread-1): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61739), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:18.380325 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 14:56:18.382317 (Thread-1): finished collecting timing info
2021-05-29 14:56:18.382317 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:18.391290 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:56:21.244601 (Thread-1): finished collecting timing info
2021-05-29 14:56:21.247607 (Thread-1): 11:56:21 | 10 of 18 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 2.89s]
2021-05-29 14:56:21.253576 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 14:56:21.254570 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:56:21.255566 (Thread-1): 11:56:21 | 11 of 18 START test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [RUN]
2021-05-29 14:56:21.256565 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_".
2021-05-29 14:56:21.257562 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:56:21.275514 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"
2021-05-29 14:56:21.278505 (Thread-1): finished collecting timing info
2021-05-29 14:56:21.281525 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:21.300470 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"} */

    
    




select count(*) as validation_errors
from (
    select reason_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select reason_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 14:56:24.099645 (Thread-1): finished collecting timing info
2021-05-29 14:56:24.100596 (Thread-1): 11:56:24 | 11 of 18 PASS relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [PASS in 2.84s]
2021-05-29 14:56:24.101590 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 14:56:24.102589 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:24.103586 (Thread-1): 11:56:24 | 12 of 18 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 14:56:24.104584 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 14:56:24.104584 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:24.106578 (Thread-1): unclosed <socket.socket fd=1520, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61743), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.107573 (Thread-1): unclosed <socket.socket fd=1432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61744), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:24.119543 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 14:56:24.121538 (Thread-1): finished collecting timing info
2021-05-29 14:56:24.121538 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:24.134508 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 14:56:24.620357 (Thread-1): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61729), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:24.621355 (Thread-1): unclosed <socket.socket fd=684, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61728), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.622355 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61731), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:24.622355 (Thread-1): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61730), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.623352 (Thread-1): unclosed <socket.socket fd=460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61734), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:24.623352 (Thread-1): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61733), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.624348 (Thread-1): unclosed <socket.socket fd=1364, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61736), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:24.624348 (Thread-1): unclosed <socket.socket fd=1352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61735), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.634318 (Thread-1): unclosed <socket.socket fd=1472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61740), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:24.634318 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61741), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:27.022965 (Thread-1): finished collecting timing info
2021-05-29 14:56:27.023962 (Thread-1): 11:56:27 | 12 of 18 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.92s]
2021-05-29 14:56:27.024957 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:27.025956 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:27.025956 (Thread-1): 11:56:27 | 13 of 18 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 14:56:27.030961 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 14:56:27.033937 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:27.057875 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 14:56:27.060863 (Thread-1): finished collecting timing info
2021-05-29 14:56:27.064877 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:27.082804 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 14:56:29.950592 (Thread-1): finished collecting timing info
2021-05-29 14:56:29.950592 (Thread-1): 11:56:29 | 13 of 18 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 2.92s]
2021-05-29 14:56:29.952586 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 14:56:29.952586 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:56:29.953586 (Thread-1): 11:56:29 | 14 of 18 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 14:56:29.954583 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 14:56:29.954583 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:56:29.969540 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 14:56:29.971535 (Thread-1): finished collecting timing info
2021-05-29 14:56:29.972532 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:29.984501 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:56:32.355413 (Thread-1): finished collecting timing info
2021-05-29 14:56:32.358401 (Thread-1): 11:56:32 | 14 of 18 PASS unique_dim_address_address_sk.......................... [PASS in 2.40s]
2021-05-29 14:56:32.363393 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 14:56:32.364386 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:56:32.366382 (Thread-1): 11:56:32 | 15 of 18 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 14:56:32.370372 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 14:56:32.372289 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:56:32.384166 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 14:56:32.386159 (Thread-1): finished collecting timing info
2021-05-29 14:56:32.386159 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:32.395171 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:56:34.717364 (Thread-1): finished collecting timing info
2021-05-29 14:56:34.718356 (Thread-1): 11:56:34 | 15 of 18 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.35s]
2021-05-29 14:56:34.720310 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 14:56:34.721309 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:56:34.721309 (Thread-1): 11:56:34 | 16 of 18 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 14:56:34.724323 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 14:56:34.724323 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:56:34.729286 (Thread-1): unclosed <socket.socket fd=1608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61751), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:34.730298 (Thread-1): unclosed <socket.socket fd=1612, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61752), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:34.738261 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 14:56:34.739259 (Thread-1): finished collecting timing info
2021-05-29 14:56:34.739259 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:34.748232 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:56:37.524282 (Thread-1): finished collecting timing info
2021-05-29 14:56:37.525303 (Thread-1): 11:56:37 | 16 of 18 PASS unique_dim_customer_customer_sk........................ [PASS in 2.80s]
2021-05-29 14:56:37.527290 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 14:56:37.527290 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:56:37.528274 (Thread-1): 11:56:37 | 17 of 18 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 14:56:37.529268 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 14:56:37.530266 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:56:37.535293 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 14:56:37.536286 (Thread-1): finished collecting timing info
2021-05-29 14:56:37.537250 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:37.546199 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:56:39.837421 (Thread-1): finished collecting timing info
2021-05-29 14:56:39.838420 (Thread-1): 11:56:39 | 17 of 18 PASS unique_dim_product_product_sk.......................... [PASS in 2.31s]
2021-05-29 14:56:39.840087 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 14:56:39.840087 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 14:56:39.841085 (Thread-1): 11:56:39 | 18 of 18 START test unique_dim_reason_reason_sk...................... [RUN]
2021-05-29 14:56:39.846095 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_reason_sk".
2021-05-29 14:56:39.847095 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 14:56:39.857042 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_reason_sk"
2021-05-29 14:56:39.863046 (Thread-1): finished collecting timing info
2021-05-29 14:56:39.864023 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 14:56:39.877012 (Thread-1): On test.dw_adventure_works.unique_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        reason_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where reason_sk is not null
    group by reason_sk
    having count(*) > 1

) validation_errors



2021-05-29 14:56:42.148802 (Thread-1): finished collecting timing info
2021-05-29 14:56:42.149809 (Thread-1): 11:56:42 | 18 of 18 PASS unique_dim_reason_reason_sk............................ [PASS in 2.31s]
2021-05-29 14:56:42.152787 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 14:56:42.219613 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 14:56:42.221606 (MainThread): 11:56:42 | 
2021-05-29 14:56:42.226602 (MainThread): 11:56:42 | Finished running 18 tests in 48.34s.
2021-05-29 14:56:42.230582 (MainThread): Connection 'master' was properly closed.
2021-05-29 14:56:42.231578 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 14:56:42.231578 (MainThread): Connection 'test.dw_adventure_works.unique_dim_reason_reason_sk' was properly closed.
2021-05-29 14:56:42.234569 (MainThread): unclosed <socket.socket fd=1744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61758), raddr=('172.217.162.202', 443)>
2021-05-29 14:56:42.234569 (MainThread): unclosed <socket.socket fd=1748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61759), raddr=('142.250.219.10', 443)>
2021-05-29 14:56:42.266487 (MainThread): 
2021-05-29 14:56:42.267480 (MainThread): Completed successfully
2021-05-29 14:56:42.269476 (MainThread): 
Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
2021-05-29 14:56:42.270485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457AEED508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457AEED648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024578E4A208>]}
2021-05-29 14:56:42.271470 (MainThread): Flushing usage events
2021-05-29 15:15:21.411088 (MainThread): Running with dbt=0.19.1
2021-05-29 15:15:22.511198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 15:15:22.514464 (MainThread): Tracking: tracking
2021-05-29 15:15:22.515224 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021151779C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021151774088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021151774808>]}
2021-05-29 15:15:22.534955 (MainThread): Partial parsing not enabled
2021-05-29 15:15:22.538990 (MainThread): Parsing macros\adapters.sql
2021-05-29 15:15:22.580439 (MainThread): Parsing macros\catalog.sql
2021-05-29 15:15:22.594407 (MainThread): Parsing macros\etc.sql
2021-05-29 15:15:22.600185 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 15:15:22.611477 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 15:15:22.638409 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 15:15:22.644396 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 15:15:22.648381 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 15:15:22.669256 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 15:15:22.691719 (MainThread): Parsing macros\core.sql
2021-05-29 15:15:22.700698 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 15:15:22.816454 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 15:15:22.837933 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 15:15:22.841176 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 15:15:22.846935 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 15:15:22.852920 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 15:15:22.857907 (MainThread): Parsing macros\etc\query.sql
2021-05-29 15:15:22.861842 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 15:15:22.882813 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 15:15:22.915731 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 15:15:22.920718 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 15:15:22.949639 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 15:15:23.146115 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 15:15:23.259810 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 15:15:23.264798 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 15:15:23.310673 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 15:15:23.334176 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 15:15:23.352140 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 15:15:23.369096 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 15:15:23.380067 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 15:15:23.384056 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 15:15:23.389043 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 15:15:23.411776 (MainThread): Partial parsing not enabled
2021-05-29 15:15:23.493557 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 15:15:23.522479 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 15:15:23.537439 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 15:15:23.559382 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 15:15:23.581322 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 15:15:23.606148 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 15:15:23.625097 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 15:15:23.638077 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 15:15:23.651948 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 15:15:23.669901 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 15:15:23.683864 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 15:15:23.699822 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 15:15:23.713783 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 15:15:23.723756 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 15:15:23.733730 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 15:15:23.746696 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 15:15:23.758664 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 15:15:23.787587 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 15:15:24.243832 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec673d7-98f8-4540-809c-20d590f69aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154E70288>]}
2021-05-29 15:15:24.265714 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec673d7-98f8-4540-809c-20d590f69aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211517A14C8>]}
2021-05-29 15:15:24.265714 (MainThread): Found 17 models, 20 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 15:15:24.276684 (MainThread): 
2021-05-29 15:15:24.277686 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 15:15:24.282704 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 15:15:24.283705 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 15:15:24.305269 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 15:15:25.176746 (MainThread): 12:15:25 | Concurrency: 1 threads (target='dev')
2021-05-29 15:15:25.177642 (MainThread): 12:15:25 | 
2021-05-29 15:15:25.195720 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 15:15:25.195720 (Thread-1): 12:15:25 | 1 of 20 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 15:15:25.197710 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 15:15:25.198707 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 15:15:25.215661 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 15:15:25.217879 (Thread-1): finished collecting timing info
2021-05-29 15:15:25.218883 (Thread-1): Opening a new connection, currently in state init
2021-05-29 15:15:25.226844 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 15:15:28.657538 (Thread-1): finished collecting timing info
2021-05-29 15:15:28.664521 (Thread-1): 12:15:28 | 1 of 20 PASS not_null_dim_address_address_sk......................... [PASS in 3.47s]
2021-05-29 15:15:28.686465 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 15:15:28.689457 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 15:15:28.691452 (Thread-1): 12:15:28 | 2 of 20 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 15:15:28.694440 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 15:15:28.695436 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 15:15:28.709400 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 15:15:28.761302 (Thread-1): finished collecting timing info
2021-05-29 15:15:28.761302 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:28.782244 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 15:15:31.157469 (Thread-1): finished collecting timing info
2021-05-29 15:15:31.158480 (Thread-1): 12:15:31 | 2 of 20 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.47s]
2021-05-29 15:15:31.160467 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 15:15:31.161463 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 15:15:31.161463 (Thread-1): 12:15:31 | 3 of 20 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 15:15:31.163459 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 15:15:31.163459 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 15:15:31.168445 (Thread-1): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61971), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:31.169444 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61972), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:31.170440 (Thread-1): unclosed <socket.socket fd=1324, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61973), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:31.170440 (Thread-1): unclosed <socket.socket fd=1344, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61974), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:31.177420 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 15:15:31.179417 (Thread-1): finished collecting timing info
2021-05-29 15:15:31.180414 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:31.192383 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 15:15:34.117126 (Thread-1): finished collecting timing info
2021-05-29 15:15:34.119121 (Thread-1): 12:15:34 | 3 of 20 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.96s]
2021-05-29 15:15:34.122138 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 15:15:34.123107 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 15:15:34.123107 (Thread-1): 12:15:34 | 4 of 20 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 15:15:34.125100 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 15:15:34.125100 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 15:15:34.133081 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 15:15:34.225376 (Thread-1): finished collecting timing info
2021-05-29 15:15:34.225376 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:34.233359 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 15:15:36.519949 (Thread-1): finished collecting timing info
2021-05-29 15:15:36.521907 (Thread-1): 12:15:36 | 4 of 20 PASS not_null_dim_product_product_sk......................... [PASS in 2.40s]
2021-05-29 15:15:36.528708 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 15:15:36.529702 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 15:15:36.531707 (Thread-1): 12:15:36 | 5 of 20 START test not_null_dim_reason_reason_sk..................... [RUN]
2021-05-29 15:15:36.535608 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_reason_sk".
2021-05-29 15:15:36.535608 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 15:15:36.546568 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_reason_sk"
2021-05-29 15:15:36.552722 (Thread-1): finished collecting timing info
2021-05-29 15:15:36.553726 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:36.561387 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where reason_sk is null



2021-05-29 15:15:38.935216 (Thread-1): finished collecting timing info
2021-05-29 15:15:38.936277 (Thread-1): 12:15:38 | 5 of 20 PASS not_null_dim_reason_reason_sk........................... [PASS in 2.40s]
2021-05-29 15:15:38.937233 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 15:15:38.938235 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 15:15:38.938235 (Thread-1): 12:15:38 | 6 of 20 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 15:15:38.939227 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 15:15:38.940226 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 15:15:38.941226 (Thread-1): unclosed <socket.socket fd=1448, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61980), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:38.942235 (Thread-1): unclosed <socket.socket fd=1460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61981), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:38.947208 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 15:15:38.950200 (Thread-1): finished collecting timing info
2021-05-29 15:15:38.951197 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:38.959211 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 15:15:41.874458 (Thread-1): finished collecting timing info
2021-05-29 15:15:41.875465 (Thread-1): 12:15:41 | 6 of 20 PASS not_null_fact_order_details_salesorderid................ [PASS in 2.94s]
2021-05-29 15:15:41.877461 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 15:15:41.877461 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 15:15:41.877461 (Thread-1): 12:15:41 | 7 of 20 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 15:15:41.878457 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 15:15:41.879453 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 15:15:41.907382 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 15:15:41.909376 (Thread-1): finished collecting timing info
2021-05-29 15:15:41.910372 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:41.922339 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 15:15:44.802877 (Thread-1): finished collecting timing info
2021-05-29 15:15:44.803839 (Thread-1): 12:15:44 | 7 of 20 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 2.93s]
2021-05-29 15:15:44.805140 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 15:15:44.806144 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 15:15:44.806144 (Thread-1): 12:15:44 | 8 of 20 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 15:15:44.807140 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 15:15:44.808181 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 15:15:44.809138 (Thread-1): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61984), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:44.810133 (Thread-1): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61985), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:44.819145 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 15:15:44.820770 (Thread-1): finished collecting timing info
2021-05-29 15:15:44.821773 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:44.829241 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 15:15:47.719252 (Thread-1): finished collecting timing info
2021-05-29 15:15:47.721244 (Thread-1): 12:15:47 | 8 of 20 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.91s]
2021-05-29 15:15:47.725234 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 15:15:47.725234 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 15:15:47.726230 (Thread-1): 12:15:47 | 9 of 20 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 15:15:47.728229 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 15:15:47.728229 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 15:15:47.743186 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 15:15:47.746185 (Thread-1): finished collecting timing info
2021-05-29 15:15:47.748170 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:47.756184 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 15:15:50.554704 (Thread-1): finished collecting timing info
2021-05-29 15:15:50.554704 (Thread-1): 12:15:50 | 9 of 20 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.83s]
2021-05-29 15:15:50.556707 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 15:15:50.556707 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 15:15:50.557703 (Thread-1): 12:15:50 | 10 of 20 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 15:15:50.558702 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 15:15:50.558702 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 15:15:50.560695 (Thread-1): unclosed <socket.socket fd=1584, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61988), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:50.561695 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61989), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:50.570706 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 15:15:50.571703 (Thread-1): finished collecting timing info
2021-05-29 15:15:50.572663 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:50.581644 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 15:15:53.407827 (Thread-1): finished collecting timing info
2021-05-29 15:15:53.408818 (Thread-1): 12:15:53 | 10 of 20 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 2.85s]
2021-05-29 15:15:53.410430 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 15:15:53.410430 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 15:15:53.410430 (Thread-1): 12:15:53 | 11 of 20 START test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [RUN]
2021-05-29 15:15:53.412425 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_".
2021-05-29 15:15:53.412425 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 15:15:53.421403 (Thread-1): unclosed <socket.socket fd=1332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61976), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:53.422396 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61977), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:53.422396 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61979), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:53.423394 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61978), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:53.427386 (Thread-1): unclosed <socket.socket fd=1464, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61982), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:53.427386 (Thread-1): unclosed <socket.socket fd=1444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61983), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:53.430376 (Thread-1): unclosed <socket.socket fd=1548, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61986), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:53.431382 (Thread-1): unclosed <socket.socket fd=1560, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61987), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:53.434366 (Thread-1): unclosed <socket.socket fd=1608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61990), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:53.435365 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61991), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:53.436362 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"
2021-05-29 15:15:53.437360 (Thread-1): finished collecting timing info
2021-05-29 15:15:53.438358 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:53.447082 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"} */

    
    




select count(*) as validation_errors
from (
    select reason_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select reason_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 15:15:56.321171 (Thread-1): finished collecting timing info
2021-05-29 15:15:56.322169 (Thread-1): 12:15:56 | 11 of 20 PASS relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [PASS in 2.91s]
2021-05-29 15:15:56.323167 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 15:15:56.324167 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 15:15:56.325162 (Thread-1): 12:15:56 | 12 of 20 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 15:15:56.326159 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 15:15:56.327156 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 15:15:56.329150 (Thread-1): unclosed <socket.socket fd=1620, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61992), raddr=('172.217.173.106', 443)>
2021-05-29 15:15:56.329150 (Thread-1): unclosed <socket.socket fd=1608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61993), raddr=('142.250.218.10', 443)>
2021-05-29 15:15:56.336131 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 15:15:56.341116 (Thread-1): finished collecting timing info
2021-05-29 15:15:56.342116 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:56.354082 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 15:15:59.138424 (Thread-1): finished collecting timing info
2021-05-29 15:15:59.140418 (Thread-1): 12:15:59 | 12 of 20 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.82s]
2021-05-29 15:15:59.143357 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 15:15:59.143357 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 15:15:59.144355 (Thread-1): 12:15:59 | 13 of 20 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 15:15:59.145351 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 15:15:59.145351 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 15:15:59.159316 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 15:15:59.161132 (Thread-1): finished collecting timing info
2021-05-29 15:15:59.162135 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:15:59.170111 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 15:16:02.140894 (Thread-1): finished collecting timing info
2021-05-29 15:16:02.143460 (Thread-1): 12:16:02 | 13 of 20 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 3.00s]
2021-05-29 15:16:02.148006 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 15:16:02.149006 (Thread-1): Began running node test.dw_adventure_works.test
2021-05-29 15:16:02.151001 (Thread-1): 12:16:02 | 14 of 20 START test test............................................. [RUN]
2021-05-29 15:16:02.154986 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 15:16:02.155984 (Thread-1): Compiling test.dw_adventure_works.test
2021-05-29 15:16:02.160985 (Thread-1): unclosed <socket.socket fd=1672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61998), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:02.161969 (Thread-1): unclosed <socket.socket fd=1680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61999), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:02.191882 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.test"
2021-05-29 15:16:02.194875 (Thread-1): finished collecting timing info
2021-05-29 15:16:02.194875 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:02.207839 (Thread-1): On test.dw_adventure_works.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation_od as (
        select sum(quantity) as sum_val
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
        where order_date between '1998-03-01' and '1998-03-31'
    )

    select * from validation where sum_val != 4065
   
    ,    validation_ct as (
        select count(customer_fk) as count_ct
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    ,    validation_pd as (
        select sum(product_fk) as sum_pd
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    select * from validation_od where sum_val != 4065
    select * from validation_ct where count_ct != 91
    select * from validation_pd where sum_pd != 3003
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-29 15:16:03.533369 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/a5405c2f-4d35-441f-9f85-2a344d694451?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "," at [13:5]')
2021-05-29 15:16:05.396717 (Thread-1): finished collecting timing info
2021-05-29 15:16:05.398710 (Thread-1): Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got "," at [13:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/541af708-531e-4eda-827d-9d4c59fed012?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "," at [13:5]

(job ID: 541af708-531e-4eda-827d-9d4c59fed012)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */
   2:
   3:with dbt__CTE__INTERNAL_test as (
   4:with   
   5:    validation_od as (
   6:        select sum(quantity) as sum_val
   7:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   8:        where order_date between '1998-03-01' and '1998-03-31'
   9:    )
  10:
  11:    select * from validation where sum_val != 4065
  12:   
  13:    ,    validation_ct as (
  14:        select count(customer_fk) as count_ct
  15:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  16:    )
  17:
  18:    ,    validation_pd as (
  19:        select sum(product_fk) as sum_pd
  20:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  21:    )
  22:
  23:    select * from validation_od where sum_val != 4065
  24:    select * from validation_ct where count_ct != 91
  25:    select * from validation_pd where sum_pd != 3003
  26:)select count(*) from dbt__CTE__INTERNAL_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 46, in execute_data_test
    test.compiled_sql, auto_begin=True, fetch=True
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got "," at [13:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 15:16:05.439362 (Thread-1): 12:16:05 | 14 of 20 ERROR test.................................................. [ERROR in 3.29s]
2021-05-29 15:16:05.440760 (Thread-1): Finished running node test.dw_adventure_works.test
2021-05-29 15:16:05.440760 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 15:16:05.441769 (Thread-1): 12:16:05 | 15 of 20 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 15:16:05.442755 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 15:16:05.442755 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 15:16:05.444784 (Thread-1): unclosed <socket.socket fd=1704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62000), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:05.444784 (Thread-1): unclosed <socket.socket fd=1712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62001), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:05.449769 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 15:16:05.452735 (Thread-1): finished collecting timing info
2021-05-29 15:16:05.452735 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:05.463697 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 15:16:08.359989 (Thread-1): finished collecting timing info
2021-05-29 15:16:08.359989 (Thread-1): 12:16:08 | 15 of 20 PASS unique_dim_address_address_sk.......................... [PASS in 2.92s]
2021-05-29 15:16:08.362060 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 15:16:08.362060 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 15:16:08.363074 (Thread-1): 12:16:08 | 16 of 20 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 15:16:08.364053 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 15:16:08.364053 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 15:16:08.370039 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 15:16:08.371037 (Thread-1): finished collecting timing info
2021-05-29 15:16:08.372033 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:08.380011 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 15:16:11.083133 (Thread-1): finished collecting timing info
2021-05-29 15:16:11.085068 (Thread-1): 12:16:11 | 16 of 20 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.72s]
2021-05-29 15:16:11.089064 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 15:16:11.091061 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 15:16:11.092053 (Thread-1): 12:16:11 | 17 of 20 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 15:16:11.096043 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 15:16:11.097041 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 15:16:11.105015 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 15:16:11.106172 (Thread-1): finished collecting timing info
2021-05-29 15:16:11.107175 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:11.114611 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 15:16:14.063930 (Thread-1): finished collecting timing info
2021-05-29 15:16:14.065925 (Thread-1): 12:16:14 | 17 of 20 PASS unique_dim_customer_customer_sk........................ [PASS in 2.97s]
2021-05-29 15:16:14.067921 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 15:16:14.068915 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 15:16:14.069912 (Thread-1): 12:16:14 | 18 of 20 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 15:16:14.072904 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 15:16:14.072904 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 15:16:14.078888 (Thread-1): unclosed <socket.socket fd=1776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62007), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:14.078888 (Thread-1): unclosed <socket.socket fd=1784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62008), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:14.089859 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 15:16:14.094845 (Thread-1): finished collecting timing info
2021-05-29 15:16:14.095844 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:14.125763 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 15:16:17.032845 (Thread-1): finished collecting timing info
2021-05-29 15:16:17.034842 (Thread-1): 12:16:17 | 18 of 20 PASS unique_dim_product_product_sk.......................... [PASS in 2.96s]
2021-05-29 15:16:17.036832 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 15:16:17.036832 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 15:16:17.037837 (Thread-1): 12:16:17 | 19 of 20 START test unique_dim_reason_reason_sk...................... [RUN]
2021-05-29 15:16:17.038828 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_reason_sk".
2021-05-29 15:16:17.039826 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 15:16:17.052790 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_reason_sk"
2021-05-29 15:16:17.054784 (Thread-1): finished collecting timing info
2021-05-29 15:16:17.055783 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:17.074732 (Thread-1): On test.dw_adventure_works.unique_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        reason_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where reason_sk is not null
    group by reason_sk
    having count(*) > 1

) validation_errors



2021-05-29 15:16:17.084704 (Thread-1): unclosed <socket.socket fd=1632, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61996), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:17.084704 (Thread-1): unclosed <socket.socket fd=1620, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 61997), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:17.098671 (Thread-1): unclosed <socket.socket fd=1724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62002), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:17.099665 (Thread-1): unclosed <socket.socket fd=1676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62003), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:17.099665 (Thread-1): unclosed <socket.socket fd=1772, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62006), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:17.100664 (Thread-1): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62005), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:17.104651 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62010), raddr=('172.217.173.106', 443)>
2021-05-29 15:16:17.105649 (Thread-1): unclosed <socket.socket fd=476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62012), raddr=('142.250.218.10', 443)>
2021-05-29 15:16:19.965305 (Thread-1): finished collecting timing info
2021-05-29 15:16:19.968299 (Thread-1): 12:16:19 | 19 of 20 PASS unique_dim_reason_reason_sk............................ [PASS in 2.93s]
2021-05-29 15:16:19.973241 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 15:16:19.975247 (Thread-1): Began running node test.dw_adventure_works.unique_fact_order_details_salesorderid
2021-05-29 15:16:19.976230 (Thread-1): 12:16:19 | 20 of 20 START test unique_fact_order_details_salesorderid........... [RUN]
2021-05-29 15:16:19.980231 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_fact_order_details_salesorderid".
2021-05-29 15:16:19.981228 (Thread-1): Compiling test.dw_adventure_works.unique_fact_order_details_salesorderid
2021-05-29 15:16:19.998169 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_fact_order_details_salesorderid"
2021-05-29 15:16:20.000159 (Thread-1): finished collecting timing info
2021-05-29 15:16:20.001163 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 15:16:20.009173 (Thread-1): On test.dw_adventure_works.unique_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 15:16:23.291552 (Thread-1): finished collecting timing info
2021-05-29 15:16:23.294549 (Thread-1): 12:16:23 | 20 of 20 FAIL 22973 unique_fact_order_details_salesorderid........... [FAIL 22973 in 3.31s]
2021-05-29 15:16:23.301528 (Thread-1): Finished running node test.dw_adventure_works.unique_fact_order_details_salesorderid
2021-05-29 15:16:23.389103 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 15:16:23.390101 (MainThread): 12:16:23 | 
2021-05-29 15:16:23.392095 (MainThread): 12:16:23 | Finished running 20 tests in 59.11s.
2021-05-29 15:16:23.395099 (MainThread): Connection 'master' was properly closed.
2021-05-29 15:16:23.396079 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 15:16:23.396079 (MainThread): Connection 'test.dw_adventure_works.unique_fact_order_details_salesorderid' was properly closed.
2021-05-29 15:16:23.454427 (MainThread): 
2021-05-29 15:16:23.455431 (MainThread): Completed with 2 errors and 0 warnings:
2021-05-29 15:16:23.457425 (MainThread): 
2021-05-29 15:16:23.457425 (MainThread): Database Error in test test (tests\test.sql)
2021-05-29 15:16:23.462429 (MainThread):   Syntax error: Expected ")" but got "," at [13:5]
2021-05-29 15:16:23.466400 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 15:16:23.467397 (MainThread): 
2021-05-29 15:16:23.468404 (MainThread): Failure in test unique_fact_order_details_salesorderid (models\marts\fact_order_details.yml)
2021-05-29 15:16:23.469391 (MainThread):   Got 22973 results, expected 0.
2021-05-29 15:16:23.470390 (MainThread): 
2021-05-29 15:16:23.471389 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\fact_order_details.yml\schema_test\unique_fact_order_details_salesorderid.sql
2021-05-29 15:16:23.474378 (MainThread): 
Done. PASS=18 WARN=0 ERROR=2 SKIP=0 TOTAL=20
2021-05-29 15:16:23.477372 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211565485C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021156548748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021151749548>]}
2021-05-29 15:16:23.478371 (MainThread): Flushing usage events
2021-05-29 16:23:44.067656 (MainThread): Running with dbt=0.19.1
2021-05-29 16:23:45.154721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:23:45.175510 (MainThread): Tracking: tracking
2021-05-29 16:23:45.177496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E42D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E43848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E43448>]}
2021-05-29 16:23:45.219876 (MainThread): Partial parsing not enabled
2021-05-29 16:23:45.226175 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:23:45.285017 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:23:45.300973 (MainThread): Parsing macros\etc.sql
2021-05-29 16:23:45.316934 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:23:45.340870 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:23:45.470036 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:23:45.491979 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:23:45.506461 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:23:45.571288 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:23:45.614303 (MainThread): Parsing macros\core.sql
2021-05-29 16:23:45.637241 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:23:45.832243 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:23:45.882111 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:23:45.887096 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:23:45.900060 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:23:45.906055 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:23:45.921011 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:23:45.933978 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:23:45.985840 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:23:46.046679 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:23:46.053658 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:23:46.086569 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:23:46.188301 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:23:46.331443 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:23:46.347401 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:23:46.487024 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:23:46.542839 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:23:46.587270 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:23:46.616197 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:23:46.632150 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:23:46.639137 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:23:46.665065 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:23:46.701963 (MainThread): Partial parsing not enabled
2021-05-29 16:23:46.867520 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:23:46.952297 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:23:46.985207 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:23:47.267098 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:23:47.401149 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:23:47.422093 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:23:47.519712 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:23:47.620195 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:23:47.782511 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:23:47.901972 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:23:47.971318 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:23:48.003950 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:23:48.032871 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:23:48.053814 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:23:48.116604 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:23:48.149374 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:23:48.205613 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:23:48.285397 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:23:49.296010 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4DF7608>]}
2021-05-29 16:23:49.354724 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E18408>]}
2021-05-29 16:23:49.354724 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:23:49.370681 (MainThread): 
2021-05-29 16:23:49.371678 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:23:49.383645 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:23:49.383645 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:23:52.067956 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:23:52.068958 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:23:52.076425 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:23:53.383312 (MainThread): 13:23:53 | Concurrency: 1 threads (target='dev')
2021-05-29 16:23:53.384309 (MainThread): 13:23:53 | 
2021-05-29 16:23:53.391291 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 16:23:53.391291 (Thread-1): 13:23:53 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 16:23:53.392288 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:23:53.393286 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 16:23:53.399269 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 16:23:53.402261 (Thread-1): finished collecting timing info
2021-05-29 16:23:53.501995 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 16:23:53.508298 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:23:53.520267 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 16:23:56.068021 (Thread-1): finished collecting timing info
2021-05-29 16:23:56.069019 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4DFAB88>]}
2021-05-29 16:23:56.070017 (Thread-1): 13:23:56 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 2.68s]
2021-05-29 16:23:56.077997 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 16:23:56.077997 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 16:23:56.078992 (Thread-1): 13:23:56 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 16:23:56.080988 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:23:56.081986 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 16:23:56.084978 (Thread-1): unclosed <socket.socket fd=1208, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62457), raddr=('172.217.29.10', 443)>
2021-05-29 16:23:56.086970 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62458), raddr=('142.250.218.10', 443)>
2021-05-29 16:23:56.107941 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 16:23:56.114896 (Thread-1): finished collecting timing info
2021-05-29 16:23:56.120880 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 16:23:56.128859 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:23:56.144816 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 16:23:57.920553 (Thread-1): finished collecting timing info
2021-05-29 16:23:57.921550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B8991B88>]}
2021-05-29 16:23:57.923549 (Thread-1): 13:23:57 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 1.84s]
2021-05-29 16:23:57.925540 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 16:23:57.925540 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 16:23:57.926544 (Thread-1): 13:23:57 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 16:23:57.929530 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:23:57.929530 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 16:23:57.931523 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62459), raddr=('172.217.29.10', 443)>
2021-05-29 16:23:57.933525 (Thread-1): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62460), raddr=('142.250.218.10', 443)>
2021-05-29 16:23:57.942494 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 16:23:57.972687 (Thread-1): finished collecting timing info
2021-05-29 16:23:58.005704 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 16:23:58.067172 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:23:58.173503 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 16:24:00.618375 (Thread-1): finished collecting timing info
2021-05-29 16:24:00.620369 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B893C748>]}
2021-05-29 16:24:00.620369 (Thread-1): 13:24:00 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 2.69s]
2021-05-29 16:24:00.623322 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 16:24:00.624316 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 16:24:00.625356 (Thread-1): 13:24:00 | 4 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 16:24:00.627310 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:24:00.627310 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 16:24:00.635287 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 16:24:00.640277 (Thread-1): finished collecting timing info
2021-05-29 16:24:00.644269 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 16:24:00.646259 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:00.657233 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 16:24:03.028566 (Thread-1): finished collecting timing info
2021-05-29 16:24:03.030560 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E426C8>]}
2021-05-29 16:24:03.032555 (Thread-1): 13:24:03 | 4 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.40s]
2021-05-29 16:24:03.035495 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 16:24:03.036497 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 16:24:03.037491 (Thread-1): 13:24:03 | 5 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 16:24:03.039485 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:24:03.040483 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 16:24:03.048496 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 16:24:03.050453 (Thread-1): finished collecting timing info
2021-05-29 16:24:03.057437 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 16:24:03.059430 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:03.072396 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 16:24:05.439197 (Thread-1): finished collecting timing info
2021-05-29 16:24:05.440194 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E439C8>]}
2021-05-29 16:24:05.441192 (Thread-1): 13:24:05 | 5 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 2.40s]
2021-05-29 16:24:05.505332 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 16:24:05.506347 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 16:24:05.507340 (Thread-1): 13:24:05 | 6 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 16:24:05.509335 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:24:05.510340 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 16:24:05.518310 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 16:24:05.522301 (Thread-1): finished collecting timing info
2021-05-29 16:24:05.531312 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 16:24:05.532272 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:05.542246 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 16:24:07.830123 (Thread-1): finished collecting timing info
2021-05-29 16:24:07.830123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E43288>]}
2021-05-29 16:24:07.831120 (Thread-1): 13:24:07 | 6 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.32s]
2021-05-29 16:24:07.832079 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 16:24:07.833078 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 16:24:07.833078 (Thread-1): 13:24:07 | 7 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 16:24:07.835073 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:24:07.835073 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 16:24:07.843053 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 16:24:07.845671 (Thread-1): finished collecting timing info
2021-05-29 16:24:07.848698 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 16:24:07.849697 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:07.859637 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 16:24:07.867658 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62461), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:07.868645 (Thread-1): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62462), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:07.868645 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62463), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:07.869607 (Thread-1): unclosed <socket.socket fd=996, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62464), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:07.870623 (Thread-1): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62465), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:07.871603 (Thread-1): unclosed <socket.socket fd=1340, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62466), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:07.871603 (Thread-1): unclosed <socket.socket fd=404, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62467), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:07.871603 (Thread-1): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62468), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:09.616680 (Thread-1): finished collecting timing info
2021-05-29 16:24:09.619234 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B8A31748>]}
2021-05-29 16:24:09.621227 (Thread-1): 13:24:09 | 7 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 1.79s]
2021-05-29 16:24:09.624598 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 16:24:09.625595 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 16:24:09.626597 (Thread-1): 13:24:09 | 8 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 16:24:09.629585 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:24:09.629585 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 16:24:09.640555 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 16:24:09.642549 (Thread-1): finished collecting timing info
2021-05-29 16:24:09.647534 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 16:24:09.650526 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:09.662494 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 16:24:11.428888 (Thread-1): finished collecting timing info
2021-05-29 16:24:11.428888 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B884FD08>]}
2021-05-29 16:24:11.429884 (Thread-1): 13:24:11 | 8 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 1.80s]
2021-05-29 16:24:11.430847 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 16:24:11.431844 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 16:24:11.431844 (Thread-1): 13:24:11 | 9 of 17 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 16:24:11.433839 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:24:11.433839 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 16:24:11.439823 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 16:24:11.442812 (Thread-1): finished collecting timing info
2021-05-29 16:24:11.446802 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 16:24:11.448798 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:11.460769 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , unitprice * (1 - unitpricediscount) * orderqty as saleprice
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 16:24:13.755914 (Thread-1): finished collecting timing info
2021-05-29 16:24:13.756912 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B8A39848>]}
2021-05-29 16:24:13.756912 (Thread-1): 13:24:13 | 9 of 17 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.32s]
2021-05-29 16:24:13.758870 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 16:24:13.758870 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 16:24:13.759870 (Thread-1): 13:24:13 | 10 of 17 START view model dw_adventure_works.stg_orders.............. [RUN]
2021-05-29 16:24:13.760865 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:24:13.760865 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 16:24:13.765852 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 16:24:13.767848 (Thread-1): finished collecting timing info
2021-05-29 16:24:13.776841 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 16:24:13.779815 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:13.790789 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 16:24:15.796316 (Thread-1): finished collecting timing info
2021-05-29 16:24:15.796316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B885AD08>]}
2021-05-29 16:24:15.797315 (Thread-1): 13:24:15 | 10 of 17 OK created view model dw_adventure_works.stg_orders......... [OK in 2.04s]
2021-05-29 16:24:15.798280 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 16:24:15.799278 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 16:24:15.799278 (Thread-1): 13:24:15 | 11 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 16:24:15.801275 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:24:15.801275 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 16:24:15.806259 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 16:24:15.807412 (Thread-1): finished collecting timing info
2021-05-29 16:24:15.811408 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 16:24:15.813692 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:15.823670 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 16:24:18.256853 (Thread-1): finished collecting timing info
2021-05-29 16:24:18.258841 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B88A8308>]}
2021-05-29 16:24:18.259839 (Thread-1): 13:24:18 | 11 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 2.46s]
2021-05-29 16:24:18.262789 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 16:24:18.263784 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 16:24:18.264782 (Thread-1): 13:24:18 | 12 of 17 START table model dw_adventure_works.dim_creditcard......... [RUN]
2021-05-29 16:24:18.266776 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:24:18.267775 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 16:24:18.275751 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 16:24:18.279856 (Thread-1): finished collecting timing info
2021-05-29 16:24:18.315748 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:18.325721 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:19.634440 (Thread-1): unclosed <socket.socket fd=1396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62472), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:19.635435 (Thread-1): unclosed <socket.socket fd=1400, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62471), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:19.635435 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62474), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:19.636460 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62475), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:19.636460 (Thread-1): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62476), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:19.637430 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62477), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:19.637430 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62478), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:19.637430 (Thread-1): unclosed <socket.socket fd=1480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62479), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:19.655384 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 16:24:19.662842 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 16:24:22.928004 (Thread-1): finished collecting timing info
2021-05-29 16:24:22.929999 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E12F08>]}
2021-05-29 16:24:22.932946 (Thread-1): 13:24:22 | 12 of 17 OK created table model dw_adventure_works.dim_creditcard.... [CREATE TABLE (19.1k rows, 1.1 MB processed) in 4.66s]
2021-05-29 16:24:22.938936 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 16:24:22.939928 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 16:24:22.942918 (Thread-1): 13:24:22 | 13 of 17 START table model dw_adventure_works.dim_customer........... [RUN]
2021-05-29 16:24:22.946908 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:24:22.947918 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 16:24:22.959872 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 16:24:22.964884 (Thread-1): finished collecting timing info
2021-05-29 16:24:22.970842 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:22.981808 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:23.937389 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 16:24:23.942572 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  
  
  OPTIONS()
  as (
    with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed
  );
    
2021-05-29 16:24:27.542080 (Thread-1): finished collecting timing info
2021-05-29 16:24:27.543084 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B889A988>]}
2021-05-29 16:24:27.544078 (Thread-1): 13:24:27 | 13 of 17 OK created table model dw_adventure_works.dim_customer...... [CREATE TABLE (19.8k rows, 1.8 MB processed) in 4.60s]
2021-05-29 16:24:27.546036 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 16:24:27.547071 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 16:24:27.548031 (Thread-1): 13:24:27 | 14 of 17 START table model dw_adventure_works.dim_product............ [RUN]
2021-05-29 16:24:27.551028 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:24:27.551028 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 16:24:27.560992 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 16:24:27.562985 (Thread-1): finished collecting timing info
2021-05-29 16:24:27.566012 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:27.577531 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:28.425037 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 16:24:28.467587 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_product`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 16:24:31.909471 (Thread-1): finished collecting timing info
2021-05-29 16:24:31.909471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9B37308>]}
2021-05-29 16:24:31.910467 (Thread-1): 13:24:31 | 14 of 17 OK created table model dw_adventure_works.dim_product....... [CREATE TABLE (504.0 rows, 71.3 KB processed) in 4.36s]
2021-05-29 16:24:31.912426 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 16:24:31.912426 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 16:24:31.913425 (Thread-1): 13:24:31 | 15 of 17 START table model dw_adventure_works.dim_reason............. [RUN]
2021-05-29 16:24:31.914422 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:24:31.915418 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 16:24:31.929419 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 16:24:31.932375 (Thread-1): finished collecting timing info
2021-05-29 16:24:31.936364 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:31.947366 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:32.675566 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 16:24:32.685407 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    ,    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by reasonorder.salesreasonid) as reason_sk
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reasonorder.modifieddate
            , reason.name
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 16:24:35.910182 (Thread-1): finished collecting timing info
2021-05-29 16:24:35.911216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9B58F08>]}
2021-05-29 16:24:35.912213 (Thread-1): 13:24:35 | 15 of 17 OK created table model dw_adventure_works.dim_reason........ [CREATE TABLE (27.6k rows, 648.3 KB processed) in 4.00s]
2021-05-29 16:24:35.914171 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 16:24:35.914171 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 16:24:35.915169 (Thread-1): 13:24:35 | 16 of 17 START table model dw_adventure_works.dim_address............ [RUN]
2021-05-29 16:24:35.916169 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:24:35.916169 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 16:24:35.923181 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 16:24:35.926140 (Thread-1): finished collecting timing info
2021-05-29 16:24:35.934122 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:35.943137 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:37.357319 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 16:24:37.359348 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_address`
  
  
  OPTIONS()
  as (
    with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed
  );
    
2021-05-29 16:24:40.666921 (Thread-1): finished collecting timing info
2021-05-29 16:24:40.667912 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9B76EC8>]}
2021-05-29 16:24:40.668910 (Thread-1): 13:24:40 | 16 of 17 OK created table model dw_adventure_works.dim_address....... [CREATE TABLE (19.6k rows, 2.7 MB processed) in 4.75s]
2021-05-29 16:24:40.671864 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 16:24:40.672862 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:24:40.673865 (Thread-1): 13:24:40 | 17 of 17 START table model dw_adventure_works.fact_order_details..... [RUN]
2021-05-29 16:24:40.674857 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:24:40.674857 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:24:40.692807 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:24:40.696876 (Thread-1): finished collecting timing info
2021-05-29 16:24:40.702859 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 16:24:40.711835 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:24:42.034287 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:24:42.035773 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         orders_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:24:42.905303 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/fbef4637-5983-41ee-bf70-6fab888eaf18?maxResults=0&location=US&prettyPrint=false: Unrecognized name: orders_detail_with_sk; Did you mean order_detail_with_sk? at [85:10]')
2021-05-29 16:24:43.922357 (Thread-1): unclosed <socket.socket fd=1584, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62487), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:43.922357 (Thread-1): unclosed <socket.socket fd=1568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62486), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:43.923322 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62489), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:43.923322 (Thread-1): unclosed <socket.socket fd=1616, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62488), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:43.923322 (Thread-1): unclosed <socket.socket fd=1628, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62490), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:43.923322 (Thread-1): unclosed <socket.socket fd=1668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62491), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:43.924319 (Thread-1): unclosed <socket.socket fd=1672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62493), raddr=('172.217.29.10', 443)>
2021-05-29 16:24:43.924319 (Thread-1): unclosed <socket.socket fd=1452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 62494), raddr=('142.250.218.10', 443)>
2021-05-29 16:24:44.817305 (Thread-1): finished collecting timing info
2021-05-29 16:24:44.817305 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: orders_detail_with_sk; Did you mean order_detail_with_sk? at [85:10]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/23456fe2-de8a-46b9-9a1f-f3a7da57c09a?maxResults=0&location=US&prettyPrint=false: Unrecognized name: orders_detail_with_sk; Did you mean order_detail_with_sk? at [85:10]

(job ID: 23456fe2-de8a-46b9-9a1f-f3a7da57c09a)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:    , reason as (
  27:        select *
  28:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  29:    )
  30:    , orders_with_sk as (
  31:            select
  32:            orders.salesorderid
  33:            , customer.customer_sk as customer_fk
  34:            , creditcard.creditcard_sk as creditcard_fk
  35:            , address.address_sk as address_fk
  36:            , reason.reason_sk as reason_fk
  37:            , orders.shipmethodid
  38:            , orders.billtoaddressid
  39:            , orders.salespersonid
  40:            , orders.currencyrateid
  41:            , orders.territoryid
  42:            , orders.purchaseordernumber
  43:            , orders.modifieddate
  44:            , orders.rowguid
  45:            , orders.taxamt
  46:            , orders.onlineorderflag
  47:            , orders.status
  48:            , orders.orderdate
  49:            , orders.creditcardapprovalcode
  50:            , orders.subtotal
  51:            , orders.revisionnumber
  52:            , orders.freight
  53:            , orders.duedate
  54:            , orders.totaldue
  55:            , orders.shipdate
  56:            , orders.accountnumber
  57:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  58:
  59:        left join customer on orders.customerid = customer.customerid
  60:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  61:        left join address on orders.shiptoaddressid = address.addressid
  62:        left join reason on orders.salesorderid = reason.salesorderid
  63:
  64:    )
  65:
  66:   , order_detail_with_sk as (
  67:        select
  68:            order_details.salesorderid
  69:            , order_details.specialofferid
  70:            , order_details.salesorderdetailid
  71:            , order_details.unitpricediscount
  72:            , order_details.unitprice
  73:            , order_details.rowguid
  74:            , order_details.orderqty
  75:            , order_details.saleprice
  76:            , order_details.modifieddate
  77:            , order_details.carriertrackingnumber
  78:            , product.product_sk as product_fk
  79:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  80:        left join product on order_details.productid = product.productid
  81:    )
  82:
  83:    , final as (
  84:        select
  85:         orders_detail_with_sk.salesorderid
  86:            , orders_with_sk.customer_fk
  87:            , orders_with_sk.creditcard_fk
  88:            , orders_with_sk.address_fk
  89:            , orders_with_sk.reason_fk
  90:            , orders_with_sk.shipmethodid
  91:            , orders_with_sk.billtoaddressid
  92:            , orders_with_sk.salespersonid
  93:            , orders_with_sk.currencyrateid
  94:            , orders_with_sk.territoryid
  95:            , orders_with_sk.purchaseordernumber
  96:            , orders_with_sk.modifieddate
  97:            , orders_with_sk.rowguid
  98:            , orders_with_sk.taxamt
  99:            , orders_with_sk.onlineorderflag
 100:            , orders_with_sk.status
 101:            , orders_with_sk.orderdate
 102:            , orders_with_sk.creditcardapprovalcode
 103:            , orders_with_sk.subtotal
 104:            , orders_with_sk.revisionnumber
 105:            , orders_with_sk.freight
 106:            , orders_with_sk.duedate
 107:            , orders_with_sk.totaldue
 108:            , orders_with_sk.shipdate
 109:            , orders_with_sk.accountnumber
 110:            , order_detail_with_sk.specialofferid
 111:            , order_detail_with_sk.salesorderdetailid
 112:            , order_detail_with_sk.unitpricediscount
 113:            , order_detail_with_sk.unitprice
 114:            , order_detail_with_sk.orderqty
 115:            , order_detail_with_sk.saleprice
 116:            , order_detail_with_sk.carriertrackingnumber
 117:            , order_detail_with_sk.product_fk
 118:
 119:            from orders_with_sk
 120:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 121:    )
 122:
 123:select * from final
 124:  );
 125:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: orders_detail_with_sk; Did you mean order_detail_with_sk? at [85:10]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:24:44.856492 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bab411cd-42a6-4135-9f47-e1c9b04bf86e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9BB96C8>]}
2021-05-29 16:24:44.856492 (Thread-1): 13:24:44 | 17 of 17 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 4.18s]
2021-05-29 16:24:44.857972 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:24:44.945988 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:24:44.946988 (MainThread): 13:24:44 | 
2021-05-29 16:24:44.948050 (MainThread): 13:24:44 | Finished running 11 view models, 6 table models in 55.58s.
2021-05-29 16:24:44.949059 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:24:44.949059 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:24:44.950056 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:24:44.950056 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:24:44.970843 (MainThread): 
2021-05-29 16:24:44.971839 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 16:24:44.972835 (MainThread): 
2021-05-29 16:24:44.973833 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 16:24:44.976824 (MainThread):   Unrecognized name: orders_detail_with_sk; Did you mean order_detail_with_sk? at [85:10]
2021-05-29 16:24:44.978818 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:24:44.979816 (MainThread): 
Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
2021-05-29 16:24:44.981812 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B4E12F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9B86348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9B86588>]}
2021-05-29 16:24:44.981812 (MainThread): Flushing usage events
2021-05-29 16:25:43.061133 (MainThread): Running with dbt=0.19.1
2021-05-29 16:25:43.738426 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:25:43.739424 (MainThread): Tracking: tracking
2021-05-29 16:25:43.739424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B15E3408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B15E47C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B15E4548>]}
2021-05-29 16:25:43.761397 (MainThread): Partial parsing not enabled
2021-05-29 16:25:43.764237 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:25:43.806646 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:25:43.819614 (MainThread): Parsing macros\etc.sql
2021-05-29 16:25:43.824578 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:25:43.836550 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:25:43.861132 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:25:43.867120 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:25:43.871753 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:25:43.901789 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:25:43.912259 (MainThread): Parsing macros\core.sql
2021-05-29 16:25:43.920729 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:25:44.020985 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:25:44.038747 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:25:44.041779 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:25:44.046021 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:25:44.051014 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:25:44.055286 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:25:44.057975 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:25:44.077273 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:25:44.105679 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:25:44.110285 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:25:44.124253 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:25:44.166687 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:25:44.239531 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:25:44.244484 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:25:44.289362 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:25:44.303880 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:25:44.313892 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:25:44.326859 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:25:44.332806 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:25:44.336798 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:25:44.340811 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:25:44.355749 (MainThread): Partial parsing not enabled
2021-05-29 16:25:44.405647 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:25:44.425596 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:25:44.433540 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:25:44.442516 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:25:44.450529 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:25:44.458508 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:25:44.470477 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:25:44.477459 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:25:44.486434 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:25:44.494412 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:25:44.501394 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:25:44.509374 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:25:44.517352 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:25:44.525331 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:25:44.532308 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:25:44.540255 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:25:44.549231 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:25:44.571204 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:25:44.904828 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1890e102-b9d3-4722-84b2-8e6fc74d025f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B1594A08>]}
2021-05-29 16:25:44.921880 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1890e102-b9d3-4722-84b2-8e6fc74d025f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B15B73C8>]}
2021-05-29 16:25:44.921880 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:25:44.929860 (MainThread): 
2021-05-29 16:25:44.929860 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:25:44.932641 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:25:44.932641 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:25:45.671982 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:25:45.671982 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:25:45.679963 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:25:46.985212 (MainThread): 13:25:46 | Concurrency: 1 threads (target='dev')
2021-05-29 16:25:46.986209 (MainThread): 13:25:46 | 
2021-05-29 16:25:46.991197 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:25:46.992197 (Thread-1): 13:25:46 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:25:46.993192 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:25:46.993192 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:25:47.009172 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:25:47.010144 (Thread-1): finished collecting timing info
2021-05-29 16:25:47.060010 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:25:47.069133 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:25:47.805004 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:25:47.806965 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:25:54.018235 (Thread-1): finished collecting timing info
2021-05-29 16:25:54.019233 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1890e102-b9d3-4722-84b2-8e6fc74d025f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B33EC148>]}
2021-05-29 16:25:54.020230 (Thread-1): 13:25:54 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.03s]
2021-05-29 16:25:54.022225 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:25:54.059129 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:25:54.059129 (MainThread): 13:25:54 | 
2021-05-29 16:25:54.060126 (MainThread): 13:25:54 | Finished running 1 table model in 9.13s.
2021-05-29 16:25:54.064114 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:25:54.068125 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:25:54.068125 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:25:54.069120 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:25:54.097024 (MainThread): 
2021-05-29 16:25:54.103049 (MainThread): Completed successfully
2021-05-29 16:25:54.105004 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:25:54.106999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B159F0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B159F2C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2B5143288>]}
2021-05-29 16:25:54.107998 (MainThread): Flushing usage events
2021-05-29 16:29:11.716534 (MainThread): Running with dbt=0.19.1
2021-05-29 16:29:12.782193 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:29:12.783783 (MainThread): Tracking: tracking
2021-05-29 16:29:12.784592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3970688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3A6A908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3A6A808>]}
2021-05-29 16:29:12.803375 (MainThread): Partial parsing not enabled
2021-05-29 16:29:12.807578 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:29:12.856421 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:29:12.873387 (MainThread): Parsing macros\etc.sql
2021-05-29 16:29:12.879023 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:29:12.889015 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:29:12.919562 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:29:12.926314 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:29:12.931323 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:29:12.952329 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:29:12.967473 (MainThread): Parsing macros\core.sql
2021-05-29 16:29:12.976875 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:29:13.064075 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:29:13.082609 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:29:13.085517 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:29:13.089803 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:29:13.093833 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:29:13.097823 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:29:13.101775 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:29:13.120725 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:29:13.149647 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:29:13.154355 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:29:13.169424 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:29:13.217548 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:29:13.287385 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:29:13.292377 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:29:13.327284 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:29:13.341234 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:29:13.352145 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:29:13.365447 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:29:13.371473 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:29:13.375425 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:29:13.379451 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:29:13.396370 (MainThread): Partial parsing not enabled
2021-05-29 16:29:13.448231 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:29:13.470984 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:29:13.479013 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:29:13.487950 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:29:13.497036 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:29:13.505015 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:29:13.516791 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:29:13.525181 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:29:13.534655 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:29:13.542810 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:29:13.551752 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:29:13.560790 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:29:13.569576 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:29:13.577518 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:29:13.586736 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:29:13.595454 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:29:13.603803 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:29:13.624743 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:29:13.951622 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbff0022-7ee6-44e1-bfa6-ad91c477de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3A238C8>]}
2021-05-29 16:29:13.969798 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbff0022-7ee6-44e1-bfa6-ad91c477de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3A46548>]}
2021-05-29 16:29:13.969798 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:29:13.977180 (MainThread): 
2021-05-29 16:29:13.978177 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:29:13.980173 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:29:13.981170 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:29:15.620268 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:29:15.620268 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:29:15.628285 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:29:16.926709 (MainThread): 13:29:16 | Concurrency: 1 threads (target='dev')
2021-05-29 16:29:16.927717 (MainThread): 13:29:16 | 
2021-05-29 16:29:17.006100 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:29:17.006100 (Thread-1): 13:29:17 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:29:17.007204 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:29:17.008210 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:29:17.020217 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:29:17.021689 (Thread-1): finished collecting timing info
2021-05-29 16:29:17.071598 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:29:17.079370 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:29:18.431343 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:29:18.433335 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
         order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from order_detail_with_sk
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:29:25.168526 (Thread-1): finished collecting timing info
2021-05-29 16:29:25.169555 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbff0022-7ee6-44e1-bfa6-ad91c477de8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3A46648>]}
2021-05-29 16:29:25.170552 (Thread-1): 13:29:25 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 8.16s]
2021-05-29 16:29:25.172165 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:29:25.184132 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:29:25.185137 (MainThread): 13:29:25 | 
2021-05-29 16:29:25.187128 (MainThread): 13:29:25 | Finished running 1 table model in 11.21s.
2021-05-29 16:29:25.188121 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:29:25.189121 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:29:25.189121 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:29:25.189121 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:29:25.209064 (MainThread): 
2021-05-29 16:29:25.210062 (MainThread): Completed successfully
2021-05-29 16:29:25.218058 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:29:25.219039 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A59F9948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3AD9508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A3AD99C8>]}
2021-05-29 16:29:25.220038 (MainThread): Flushing usage events
2021-05-29 16:33:10.128926 (MainThread): Running with dbt=0.19.1
2021-05-29 16:33:11.091458 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:33:11.093685 (MainThread): Tracking: tracking
2021-05-29 16:33:11.094480 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297190105C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029719113308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029719113608>]}
2021-05-29 16:33:11.115435 (MainThread): Partial parsing not enabled
2021-05-29 16:33:11.119970 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:33:11.161936 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:33:11.175427 (MainThread): Parsing macros\etc.sql
2021-05-29 16:33:11.180961 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:33:11.191318 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:33:11.216143 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:33:11.223729 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:33:11.228721 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:33:11.253002 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:33:11.267744 (MainThread): Parsing macros\core.sql
2021-05-29 16:33:11.276724 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:33:11.364304 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:33:11.383256 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:33:11.385251 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:33:11.390238 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:33:11.394262 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:33:11.453938 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:33:11.516975 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:33:11.581626 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:33:11.689984 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:33:11.851772 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:33:11.958966 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:33:12.021928 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:33:12.092722 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:33:12.101188 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:33:12.146077 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:33:12.167356 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:33:12.181750 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:33:12.201876 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:33:12.210729 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:33:12.215383 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:33:12.220372 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:33:12.247278 (MainThread): Partial parsing not enabled
2021-05-29 16:33:12.338712 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:33:12.391574 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:33:12.408528 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:33:12.429467 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:33:12.446424 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:33:12.460384 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:33:12.473353 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:33:12.482326 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:33:12.492424 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:33:12.501399 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:33:12.509378 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:33:12.518263 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:33:12.526711 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:33:12.534690 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:33:12.543363 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:33:12.552339 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:33:12.560600 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:33:12.582479 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:33:12.919474 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67a3652-d171-4117-8f39-837ff7b71961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297190C6388>]}
2021-05-29 16:33:12.935431 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67a3652-d171-4117-8f39-837ff7b71961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297190E7288>]}
2021-05-29 16:33:12.935431 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:33:12.944850 (MainThread): 
2021-05-29 16:33:12.945851 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:33:12.951833 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:33:12.952847 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:33:14.356478 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:33:14.356478 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:33:14.365489 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:33:16.041437 (MainThread): 13:33:16 | Concurrency: 1 threads (target='dev')
2021-05-29 16:33:16.042438 (MainThread): 13:33:16 | 
2021-05-29 16:33:16.052676 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:33:16.052676 (Thread-1): 13:33:16 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:33:16.053739 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:33:16.054744 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:33:16.061723 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:33:16.064715 (Thread-1): finished collecting timing info
2021-05-29 16:33:16.125553 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:33:16.134526 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:33:17.506163 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:33:17.509603 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from order_detail_with_sk
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:33:23.954260 (Thread-1): finished collecting timing info
2021-05-29 16:33:23.955259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67a3652-d171-4117-8f39-837ff7b71961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971C639548>]}
2021-05-29 16:33:23.956256 (Thread-1): 13:33:23 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.90s]
2021-05-29 16:33:23.958251 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:33:24.068972 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:33:24.070967 (MainThread): 13:33:24 | 
2021-05-29 16:33:24.073959 (MainThread): 13:33:24 | Finished running 1 table model in 11.13s.
2021-05-29 16:33:24.075951 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:33:24.077949 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:33:24.078943 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:33:24.078943 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:33:24.114846 (MainThread): 
2021-05-29 16:33:24.115845 (MainThread): Completed successfully
2021-05-29 16:33:24.117839 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:33:24.119834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297190E9208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297190CFE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002971C639548>]}
2021-05-29 16:33:24.120832 (MainThread): Flushing usage events
2021-05-29 16:35:49.649063 (MainThread): Running with dbt=0.19.1
2021-05-29 16:35:50.503826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:35:50.506941 (MainThread): Tracking: tracking
2021-05-29 16:35:50.508944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55874348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55874688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55874148>]}
2021-05-29 16:35:50.531584 (MainThread): Partial parsing not enabled
2021-05-29 16:35:50.537349 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:35:50.587592 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:35:50.601110 (MainThread): Parsing macros\etc.sql
2021-05-29 16:35:50.606801 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:35:50.616583 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:35:50.640564 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:35:50.647912 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:35:50.653525 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:35:50.676244 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:35:50.690279 (MainThread): Parsing macros\core.sql
2021-05-29 16:35:50.699262 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:35:50.784520 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:35:50.803335 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:35:50.805370 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:35:50.814231 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:35:50.818507 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:35:50.822537 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:35:50.825840 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:35:50.843797 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:35:50.872719 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:35:50.877022 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:35:50.891781 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:35:50.933674 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:35:51.007416 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:35:51.012455 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:35:51.052466 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:35:51.066750 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:35:51.078285 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:35:51.097254 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:35:51.104226 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:35:51.109216 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:35:51.114186 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:35:51.129894 (MainThread): Partial parsing not enabled
2021-05-29 16:35:51.181582 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:35:51.203448 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:35:51.212423 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:35:51.221441 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:35:51.231435 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:35:51.240322 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:35:51.252256 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:35:51.261232 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:35:51.271256 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:35:51.281105 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:35:51.290027 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:35:51.299202 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:35:51.309176 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:35:51.318273 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:35:51.326718 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:35:51.335536 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:35:51.344310 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:35:51.366309 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:35:51.706055 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1761bbc1-d0d6-408e-954c-80c5b3dc0cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55826848>]}
2021-05-29 16:35:51.731141 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1761bbc1-d0d6-408e-954c-80c5b3dc0cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55845308>]}
2021-05-29 16:35:51.732139 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:35:51.740302 (MainThread): 
2021-05-29 16:35:51.741298 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:35:51.746316 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:35:51.747313 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:35:53.280602 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:35:53.280602 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:35:53.289014 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:35:54.641689 (MainThread): 13:35:54 | Concurrency: 1 threads (target='dev')
2021-05-29 16:35:54.643239 (MainThread): 13:35:54 | 
2021-05-29 16:35:54.652244 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:35:54.653246 (Thread-1): 13:35:54 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:35:54.656233 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:35:54.656233 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:35:54.671192 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:35:54.673002 (Thread-1): finished collecting timing info
2021-05-29 16:35:54.718888 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:35:54.726864 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:35:56.086182 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:35:56.095507 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from order_detail_with_sk
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from order_detail_with_sk
  );
    
2021-05-29 16:36:00.828264 (Thread-1): finished collecting timing info
2021-05-29 16:36:00.828264 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1761bbc1-d0d6-408e-954c-80c5b3dc0cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB55843D08>]}
2021-05-29 16:36:00.829261 (Thread-1): 13:36:00 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 14.5 MB processed) in 6.17s]
2021-05-29 16:36:00.831256 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:36:00.862367 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:36:00.864363 (MainThread): 13:36:00 | 
2021-05-29 16:36:00.865360 (MainThread): 13:36:00 | Finished running 1 table model in 9.12s.
2021-05-29 16:36:00.865360 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:36:00.866357 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:36:00.866357 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:36:00.867354 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:36:00.883312 (MainThread): 
2021-05-29 16:36:00.884310 (MainThread): Completed successfully
2021-05-29 16:36:00.887790 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:36:00.888795 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59539F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59539708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59531248>]}
2021-05-29 16:36:00.889796 (MainThread): Flushing usage events
2021-05-29 16:38:06.592792 (MainThread): Running with dbt=0.19.1
2021-05-29 16:38:07.668721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:38:07.670212 (MainThread): Tracking: tracking
2021-05-29 16:38:07.671123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8554C3208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D857543F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8554C4588>]}
2021-05-29 16:38:07.690716 (MainThread): Partial parsing not enabled
2021-05-29 16:38:07.694705 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:38:07.736697 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:38:07.749666 (MainThread): Parsing macros\etc.sql
2021-05-29 16:38:07.754652 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:38:07.765828 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:38:07.796748 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:38:07.803734 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:38:07.809038 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:38:07.832056 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:38:07.844600 (MainThread): Parsing macros\core.sql
2021-05-29 16:38:07.854529 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:38:07.953050 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:38:07.977354 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:38:07.981618 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:38:07.986157 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:38:07.992792 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:38:07.997113 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:38:08.000318 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:38:08.027744 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:38:08.056043 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:38:08.062660 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:38:08.076627 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:38:08.118238 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:38:08.184670 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:38:08.190577 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:38:08.225114 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:38:08.239265 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:38:08.250429 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:38:08.266675 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:38:08.272694 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:38:08.277667 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:38:08.281677 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:38:08.296148 (MainThread): Partial parsing not enabled
2021-05-29 16:38:08.341887 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:38:08.362487 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:38:08.370957 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:38:08.379781 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:38:08.388076 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:38:08.398635 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:38:08.409872 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:38:08.418549 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:38:08.427851 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:38:08.440056 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:38:08.449377 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:38:08.457555 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:38:08.466016 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:38:08.474147 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:38:08.483476 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:38:08.491748 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:38:08.499728 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:38:08.521669 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:38:08.902070 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49bbc258-0ecd-4c06-b6e9-c54c79f13213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D858BBF648>]}
2021-05-29 16:38:08.917030 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49bbc258-0ecd-4c06-b6e9-c54c79f13213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8554F32C8>]}
2021-05-29 16:38:08.918028 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:38:08.924585 (MainThread): 
2021-05-29 16:38:08.925584 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:38:08.928576 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:38:08.929572 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:38:09.783640 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:38:09.784601 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:38:09.792948 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:38:11.127319 (MainThread): 13:38:11 | Concurrency: 1 threads (target='dev')
2021-05-29 16:38:11.128315 (MainThread): 13:38:11 | 
2021-05-29 16:38:11.142301 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:38:11.143297 (Thread-1): 13:38:11 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:38:11.145241 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:38:11.145241 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:38:11.156244 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:38:11.157210 (Thread-1): finished collecting timing info
2021-05-29 16:38:11.202090 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:38:11.210068 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:38:11.990666 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:38:11.991665 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )
    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , reason.reason_sk as reason_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from order_detail_with_sk
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from orders_with_sk
  );
    
2021-05-29 16:38:16.738036 (Thread-1): finished collecting timing info
2021-05-29 16:38:16.739037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49bbc258-0ecd-4c06-b6e9-c54c79f13213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D855510F88>]}
2021-05-29 16:38:16.739037 (Thread-1): 13:38:16 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (36.1k rows, 8.6 MB processed) in 5.59s]
2021-05-29 16:38:16.740994 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:38:16.790174 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:38:16.790174 (MainThread): 13:38:16 | 
2021-05-29 16:38:16.791531 (MainThread): 13:38:16 | Finished running 1 table model in 7.86s.
2021-05-29 16:38:16.792536 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:38:16.792536 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:38:16.792536 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:38:16.792536 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:38:16.809487 (MainThread): 
2021-05-29 16:38:16.811484 (MainThread): Completed successfully
2021-05-29 16:38:16.812821 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:38:16.813824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D855504B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D855504E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8554F3C88>]}
2021-05-29 16:38:16.814822 (MainThread): Flushing usage events
2021-05-29 16:57:42.937923 (MainThread): Running with dbt=0.19.1
2021-05-29 16:57:43.902575 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:57:43.904331 (MainThread): Tracking: tracking
2021-05-29 16:57:43.905333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C6D1C6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C6D1C748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C6D1C9C8>]}
2021-05-29 16:57:43.924280 (MainThread): Partial parsing not enabled
2021-05-29 16:57:43.928470 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:57:43.970188 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:57:43.983156 (MainThread): Parsing macros\etc.sql
2021-05-29 16:57:43.989140 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:57:43.999113 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:57:44.024047 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:57:44.032079 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:57:44.037089 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:57:44.060033 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:57:44.087029 (MainThread): Parsing macros\core.sql
2021-05-29 16:57:44.096129 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:57:44.183570 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:57:44.201754 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:57:44.204751 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:57:44.208706 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:57:44.213316 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:57:44.217346 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:57:44.220302 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:57:44.239500 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:57:44.267463 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:57:44.272534 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:57:44.287125 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:57:44.329057 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:57:44.397157 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:57:44.403032 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:57:44.438143 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:57:44.452789 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:57:44.464094 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:57:44.478368 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:57:44.484355 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:57:44.493705 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:57:44.498137 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:57:44.513177 (MainThread): Partial parsing not enabled
2021-05-29 16:57:44.558292 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:57:44.578236 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:57:44.586943 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:57:44.595925 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:57:44.604879 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:57:44.613653 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:57:44.626839 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:57:44.636621 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:57:44.646438 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:57:44.655558 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:57:44.664831 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:57:44.672809 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:57:44.681274 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:57:44.689581 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:57:44.698186 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:57:44.706164 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:57:44.715038 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:57:44.736789 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:57:45.063143 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e5b66a-b57f-41cb-aa26-87d3f0d7faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CA4207C8>]}
2021-05-29 16:57:45.079358 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e5b66a-b57f-41cb-aa26-87d3f0d7faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C6D06C88>]}
2021-05-29 16:57:45.080357 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:57:45.088995 (MainThread): 
2021-05-29 16:57:45.091998 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:57:45.094984 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:57:45.094984 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:57:46.126011 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:57:46.126011 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:57:46.134458 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:57:46.894125 (MainThread): 13:57:46 | Concurrency: 1 threads (target='dev')
2021-05-29 16:57:46.895142 (MainThread): 13:57:46 | 
2021-05-29 16:57:46.948389 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 16:57:46.950363 (Thread-1): 13:57:46 | 1 of 1 START table model dw_adventure_works.dim_reason............... [RUN]
2021-05-29 16:57:46.952321 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:57:46.952321 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 16:57:46.962295 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 16:57:46.966927 (Thread-1): finished collecting timing info
2021-05-29 16:57:47.012828 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:57:47.020744 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:57:48.478169 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 16:57:48.485218 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesreasonid) as salesreason_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 16:57:51.115222 (Thread-1): finished collecting timing info
2021-05-29 16:57:51.116219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e5b66a-b57f-41cb-aa26-87d3f0d7faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C3F46088>]}
2021-05-29 16:57:51.116219 (Thread-1): 13:57:51 | 1 of 1 OK created table model dw_adventure_works.dim_reason.......... [CREATE TABLE (10.0 rows, 385.0 Bytes processed) in 4.16s]
2021-05-29 16:57:51.119171 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 16:57:51.141461 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:57:51.142461 (MainThread): 13:57:51 | 
2021-05-29 16:57:51.145462 (MainThread): 13:57:51 | Finished running 1 table model in 6.05s.
2021-05-29 16:57:51.146450 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:57:51.146450 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:57:51.146450 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:57:51.147445 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 16:57:51.163432 (MainThread): 
2021-05-29 16:57:51.164403 (MainThread): Completed successfully
2021-05-29 16:57:51.166165 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 16:57:51.167168 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CA9D2EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C8CB1C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289C6CF9D48>]}
2021-05-29 16:57:51.167168 (MainThread): Flushing usage events
2021-05-29 16:58:20.459314 (MainThread): Running with dbt=0.19.1
2021-05-29 16:58:21.149233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:58:21.150235 (MainThread): Tracking: tracking
2021-05-29 16:58:21.151228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B5824388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B56EF448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B5826F08>]}
2021-05-29 16:58:21.169143 (MainThread): Partial parsing not enabled
2021-05-29 16:58:21.172171 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:58:21.211069 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:58:21.224000 (MainThread): Parsing macros\etc.sql
2021-05-29 16:58:21.228983 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:58:21.238959 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:58:21.264922 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:58:21.273899 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:58:21.280845 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:58:21.305780 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:58:21.315752 (MainThread): Parsing macros\core.sql
2021-05-29 16:58:21.323731 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:58:21.408539 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:58:21.426497 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:58:21.429483 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:58:21.432474 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:58:21.437461 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:58:21.441415 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:58:21.443446 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:58:21.462395 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:58:21.491284 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:58:21.495312 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:58:21.509234 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:58:21.550163 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:58:21.624881 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:58:21.629483 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:58:21.668268 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:58:21.683390 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:58:21.694414 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:58:21.707440 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:58:21.714419 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:58:21.718326 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:58:21.722727 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:58:21.736784 (MainThread): Partial parsing not enabled
2021-05-29 16:58:21.781837 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:58:21.802422 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:58:21.810230 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:58:21.818392 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:58:21.826469 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:58:21.834175 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:58:21.845498 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:58:21.853477 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:58:21.864042 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:58:21.872020 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:58:21.880159 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:58:21.888138 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:58:21.896436 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:58:21.905118 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:58:21.913099 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:58:21.921724 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:58:21.929370 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:58:21.950339 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:58:22.323776 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2873455-ca01-4120-bb6b-9531fa6d10a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B57BF4C8>]}
2021-05-29 16:58:22.342726 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2873455-ca01-4120-bb6b-9531fa6d10a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B57D3448>]}
2021-05-29 16:58:22.344420 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:58:22.353500 (MainThread): 
2021-05-29 16:58:22.354494 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:58:22.359483 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:58:22.360478 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:58:23.778496 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:58:23.780488 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:58:23.834344 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:58:25.167424 (MainThread): 13:58:25 | Concurrency: 1 threads (target='dev')
2021-05-29 16:58:25.169421 (MainThread): 13:58:25 | 
2021-05-29 16:58:25.175402 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:58:25.176398 (Thread-1): 13:58:25 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:58:25.177397 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:58:25.177397 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:58:25.197356 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:58:25.200346 (Thread-1): finished collecting timing info
2021-05-29 16:58:25.260175 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:58:25.270147 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:58:26.057354 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:58:26.059347 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            order_reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:58:27.143844 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/5d7f95d4-0a63-46e3-834d-e172a1a3baec?maxResults=0&location=US&prettyPrint=false: Name salesreason_sk not found inside order_reason at [68:26]')
2021-05-29 16:58:29.094544 (Thread-1): finished collecting timing info
2021-05-29 16:58:29.095535 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name salesreason_sk not found inside order_reason at [68:26]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/07fc81a5-92ba-4721-b948-2d8c38aa3999?maxResults=0&location=US&prettyPrint=false: Name salesreason_sk not found inside order_reason at [68:26]

(job ID: 07fc81a5-92ba-4721-b948-2d8c38aa3999)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:
  27:    , reason as (
  28:        select *
  29:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  30:    )
  31:
  32:    , orders_with_sk as (
  33:            select
  34:            orders.salesorderid
  35:            , customer.customer_sk as customer_fk
  36:            , creditcard.creditcard_sk as creditcard_fk
  37:            , address.address_sk as address_fk
  38:            , orders.shipmethodid
  39:            , orders.billtoaddressid
  40:            , orders.salespersonid
  41:            , orders.currencyrateid
  42:            , orders.territoryid
  43:            , orders.purchaseordernumber
  44:            , orders.modifieddate
  45:            , orders.rowguid
  46:            , orders.taxamt
  47:            , orders.onlineorderflag
  48:            , orders.status
  49:            , orders.orderdate
  50:            , orders.creditcardapprovalcode
  51:            , orders.subtotal
  52:            , orders.revisionnumber
  53:            , orders.freight
  54:            , orders.duedate
  55:            , orders.totaldue
  56:            , orders.shipdate
  57:            , orders.accountnumber
  58:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  59:
  60:        left join customer on orders.customerid = customer.customerid
  61:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  62:        left join address on orders.shiptoaddressid = address.addressid
  63:
  64:    )
  65:
  66:    , reason_with_sk as (
  67:        select
  68:            order_reason.salesreason_sk as salesreason_fk
  69:            , order_reason.salesorderid
  70:            , order_reason.modifieddate
  71:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
  72:        left join reason on order_reason.salesreasonid = reason.salesreasonid
  73:    )
  74:
  75:   , order_detail_with_sk as (
  76:        select
  77:            order_details.salesorderid
  78:            , order_details.specialofferid
  79:            , order_details.salesorderdetailid
  80:            , order_details.unitpricediscount
  81:            , order_details.unitprice
  82:            , order_details.rowguid
  83:            , order_details.orderqty
  84:            , order_details.saleprice
  85:            , order_details.modifieddate
  86:            , order_details.carriertrackingnumber
  87:            , product.product_sk as product_fk
  88:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  89:        left join product on order_details.productid = product.productid
  90:    )
  91:
  92:    , final as (
  93:        select
  94:        order_detail_with_sk.salesorderid
  95:            , orders_with_sk.customer_fk
  96:            , orders_with_sk.creditcard_fk
  97:            , orders_with_sk.address_fk
  98:            , orders_with_sk.reason_fk
  99:            , orders_with_sk.shipmethodid
 100:            , orders_with_sk.billtoaddressid
 101:            , orders_with_sk.salespersonid
 102:            , orders_with_sk.currencyrateid
 103:            , orders_with_sk.territoryid
 104:            , orders_with_sk.purchaseordernumber
 105:            , orders_with_sk.modifieddate
 106:            , orders_with_sk.rowguid
 107:            , orders_with_sk.taxamt
 108:            , orders_with_sk.onlineorderflag
 109:            , orders_with_sk.status
 110:            , orders_with_sk.orderdate
 111:            , orders_with_sk.creditcardapprovalcode
 112:            , orders_with_sk.subtotal
 113:            , orders_with_sk.revisionnumber
 114:            , orders_with_sk.freight
 115:            , orders_with_sk.duedate
 116:            , orders_with_sk.totaldue
 117:            , orders_with_sk.shipdate
 118:            , orders_with_sk.accountnumber
 119:            , order_detail_with_sk.specialofferid
 120:            , order_detail_with_sk.salesorderdetailid
 121:            , order_detail_with_sk.unitpricediscount
 122:            , order_detail_with_sk.unitprice
 123:            , order_detail_with_sk.orderqty
 124:            , order_detail_with_sk.saleprice
 125:            , order_detail_with_sk.carriertrackingnumber
 126:            , order_detail_with_sk.product_fk
 127:
 128:            from orders_with_sk
 129:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 130:            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
 131:    )
 132:
 133:select * from final
 134:  );
 135:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name salesreason_sk not found inside order_reason at [68:26]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:58:29.150248 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2873455-ca01-4120-bb6b-9531fa6d10a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B57DC2C8>]}
2021-05-29 16:58:29.151243 (Thread-1): 13:58:29 | 1 of 1 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 3.97s]
2021-05-29 16:58:29.152236 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:58:29.229371 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:58:29.229371 (MainThread): 13:58:29 | 
2021-05-29 16:58:29.230465 (MainThread): 13:58:29 | Finished running 1 table model in 6.87s.
2021-05-29 16:58:29.231487 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:58:29.231487 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:58:29.231487 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:58:29.231487 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:58:29.246484 (MainThread): 
2021-05-29 16:58:29.247442 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 16:58:29.249437 (MainThread): 
2021-05-29 16:58:29.250436 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 16:58:29.251432 (MainThread):   Name salesreason_sk not found inside order_reason at [68:26]
2021-05-29 16:58:29.253428 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:58:29.256422 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 16:58:29.257417 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B57D9A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B57D9C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7B5858B08>]}
2021-05-29 16:58:29.257417 (MainThread): Flushing usage events
2021-05-29 16:59:23.034127 (MainThread): Running with dbt=0.19.1
2021-05-29 16:59:23.680139 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 16:59:23.681135 (MainThread): Tracking: tracking
2021-05-29 16:59:23.681135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE2005408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1FA3448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1FA3388>]}
2021-05-29 16:59:23.700880 (MainThread): Partial parsing not enabled
2021-05-29 16:59:23.703654 (MainThread): Parsing macros\adapters.sql
2021-05-29 16:59:23.741591 (MainThread): Parsing macros\catalog.sql
2021-05-29 16:59:23.754556 (MainThread): Parsing macros\etc.sql
2021-05-29 16:59:23.759546 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 16:59:23.770480 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 16:59:23.795411 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 16:59:23.801396 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 16:59:23.805385 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 16:59:23.824353 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 16:59:23.835305 (MainThread): Parsing macros\core.sql
2021-05-29 16:59:23.843692 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 16:59:23.938918 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 16:59:23.956876 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 16:59:23.958869 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 16:59:23.962858 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 16:59:23.967847 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 16:59:23.971835 (MainThread): Parsing macros\etc\query.sql
2021-05-29 16:59:23.973829 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 16:59:23.994222 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 16:59:24.032124 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 16:59:24.037113 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 16:59:24.055100 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 16:59:24.108918 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 16:59:24.181956 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 16:59:24.186218 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 16:59:24.225078 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 16:59:24.239247 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 16:59:24.250383 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 16:59:24.263486 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 16:59:24.269475 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 16:59:24.273463 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 16:59:24.277453 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 16:59:24.292412 (MainThread): Partial parsing not enabled
2021-05-29 16:59:24.336645 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 16:59:24.356747 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 16:59:24.364731 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 16:59:24.373263 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 16:59:24.381241 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 16:59:24.388996 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:59:24.400312 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 16:59:24.408271 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 16:59:24.418070 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 16:59:24.426052 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 16:59:24.435193 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 16:59:24.443621 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 16:59:24.451739 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 16:59:24.460015 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 16:59:24.468026 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 16:59:24.476479 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 16:59:24.485229 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 16:59:24.506173 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 16:59:24.844332 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '029ca3b5-b623-4824-967d-8f6393e0b360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F57C48>]}
2021-05-29 16:59:24.861290 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '029ca3b5-b623-4824-967d-8f6393e0b360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F792C8>]}
2021-05-29 16:59:24.861290 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 16:59:24.873795 (MainThread): 
2021-05-29 16:59:24.875790 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:59:24.877787 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 16:59:24.877787 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 16:59:26.213887 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 16:59:26.213887 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 16:59:26.222319 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:59:26.963330 (MainThread): 13:59:26 | Concurrency: 1 threads (target='dev')
2021-05-29 16:59:26.964385 (MainThread): 13:59:26 | 
2021-05-29 16:59:26.969377 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 16:59:26.969377 (Thread-1): 13:59:26 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 16:59:26.970377 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 16:59:26.971372 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 16:59:26.979386 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:59:26.980382 (Thread-1): finished collecting timing info
2021-05-29 16:59:27.028254 (Thread-1): Opening a new connection, currently in state init
2021-05-29 16:59:27.038231 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 16:59:28.415387 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 16:59:28.416351 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 16:59:29.254517 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/483ce4bf-9ab4-4403-9073-bcd613574076?maxResults=0&location=US&prettyPrint=false: Name reason_fk not found inside orders_with_sk at [98:30]')
2021-05-29 16:59:30.731947 (Thread-1): finished collecting timing info
2021-05-29 16:59:30.732940 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name reason_fk not found inside orders_with_sk at [98:30]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/59101ac1-3e84-4a9b-9997-5dfb34469fea?maxResults=0&location=US&prettyPrint=false: Name reason_fk not found inside orders_with_sk at [98:30]

(job ID: 59101ac1-3e84-4a9b-9997-5dfb34469fea)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:
  27:    , reason as (
  28:        select *
  29:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  30:    )
  31:
  32:    , orders_with_sk as (
  33:            select
  34:            orders.salesorderid
  35:            , customer.customer_sk as customer_fk
  36:            , creditcard.creditcard_sk as creditcard_fk
  37:            , address.address_sk as address_fk
  38:            , orders.shipmethodid
  39:            , orders.billtoaddressid
  40:            , orders.salespersonid
  41:            , orders.currencyrateid
  42:            , orders.territoryid
  43:            , orders.purchaseordernumber
  44:            , orders.modifieddate
  45:            , orders.rowguid
  46:            , orders.taxamt
  47:            , orders.onlineorderflag
  48:            , orders.status
  49:            , orders.orderdate
  50:            , orders.creditcardapprovalcode
  51:            , orders.subtotal
  52:            , orders.revisionnumber
  53:            , orders.freight
  54:            , orders.duedate
  55:            , orders.totaldue
  56:            , orders.shipdate
  57:            , orders.accountnumber
  58:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  59:
  60:        left join customer on orders.customerid = customer.customerid
  61:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  62:        left join address on orders.shiptoaddressid = address.addressid
  63:
  64:    )
  65:
  66:    , reason_with_sk as (
  67:        select
  68:            reason.salesreason_sk as salesreason_fk
  69:            , order_reason.salesorderid
  70:            , order_reason.modifieddate
  71:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
  72:        left join reason on order_reason.salesreasonid = reason.salesreasonid
  73:    )
  74:
  75:   , order_detail_with_sk as (
  76:        select
  77:            order_details.salesorderid
  78:            , order_details.specialofferid
  79:            , order_details.salesorderdetailid
  80:            , order_details.unitpricediscount
  81:            , order_details.unitprice
  82:            , order_details.rowguid
  83:            , order_details.orderqty
  84:            , order_details.saleprice
  85:            , order_details.modifieddate
  86:            , order_details.carriertrackingnumber
  87:            , product.product_sk as product_fk
  88:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  89:        left join product on order_details.productid = product.productid
  90:    )
  91:
  92:    , final as (
  93:        select
  94:        order_detail_with_sk.salesorderid
  95:            , orders_with_sk.customer_fk
  96:            , orders_with_sk.creditcard_fk
  97:            , orders_with_sk.address_fk
  98:            , orders_with_sk.reason_fk
  99:            , orders_with_sk.shipmethodid
 100:            , orders_with_sk.billtoaddressid
 101:            , orders_with_sk.salespersonid
 102:            , orders_with_sk.currencyrateid
 103:            , orders_with_sk.territoryid
 104:            , orders_with_sk.purchaseordernumber
 105:            , orders_with_sk.modifieddate
 106:            , orders_with_sk.rowguid
 107:            , orders_with_sk.taxamt
 108:            , orders_with_sk.onlineorderflag
 109:            , orders_with_sk.status
 110:            , orders_with_sk.orderdate
 111:            , orders_with_sk.creditcardapprovalcode
 112:            , orders_with_sk.subtotal
 113:            , orders_with_sk.revisionnumber
 114:            , orders_with_sk.freight
 115:            , orders_with_sk.duedate
 116:            , orders_with_sk.totaldue
 117:            , orders_with_sk.shipdate
 118:            , orders_with_sk.accountnumber
 119:            , order_detail_with_sk.specialofferid
 120:            , order_detail_with_sk.salesorderdetailid
 121:            , order_detail_with_sk.unitpricediscount
 122:            , order_detail_with_sk.unitprice
 123:            , order_detail_with_sk.orderqty
 124:            , order_detail_with_sk.saleprice
 125:            , order_detail_with_sk.carriertrackingnumber
 126:            , order_detail_with_sk.product_fk
 127:
 128:            from orders_with_sk
 129:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 130:            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
 131:    )
 132:
 133:select * from final
 134:  );
 135:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name reason_fk not found inside orders_with_sk at [98:30]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:59:30.745966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '029ca3b5-b623-4824-967d-8f6393e0b360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F645C8>]}
2021-05-29 16:59:30.745966 (Thread-1): 13:59:30 | 1 of 1 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 3.77s]
2021-05-29 16:59:30.747961 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 16:59:30.842653 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 16:59:30.844648 (MainThread): 13:59:30 | 
2021-05-29 16:59:30.845646 (MainThread): 13:59:30 | Finished running 1 table model in 5.97s.
2021-05-29 16:59:30.846630 (MainThread): Connection 'master' was properly closed.
2021-05-29 16:59:30.846630 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 16:59:30.847627 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 16:59:30.847627 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 16:59:30.864617 (MainThread): 
2021-05-29 16:59:30.865737 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 16:59:30.866644 (MainThread): 
2021-05-29 16:59:30.867662 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 16:59:30.871664 (MainThread):   Name reason_fk not found inside orders_with_sk at [98:30]
2021-05-29 16:59:30.873656 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 16:59:30.874658 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 16:59:30.876649 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F96648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F96BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE1F8F7C8>]}
2021-05-29 16:59:30.877649 (MainThread): Flushing usage events
2021-05-29 17:00:24.131157 (MainThread): Running with dbt=0.19.1
2021-05-29 17:00:24.828551 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:00:24.835539 (MainThread): Tracking: tracking
2021-05-29 17:00:24.837597 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B538C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B542C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B54488>]}
2021-05-29 17:00:24.862481 (MainThread): Partial parsing not enabled
2021-05-29 17:00:24.865470 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:00:24.911347 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:00:24.929336 (MainThread): Parsing macros\etc.sql
2021-05-29 17:00:24.937282 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:00:24.948251 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:00:24.977171 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:00:24.984154 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:00:24.988142 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:00:25.008127 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:00:25.019097 (MainThread): Parsing macros\core.sql
2021-05-29 17:00:25.027076 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:00:25.117798 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:00:25.144760 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:00:25.148714 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:00:25.155695 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:00:25.161677 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:00:25.165668 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:00:25.168660 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:00:25.194593 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:00:25.225507 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:00:25.229533 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:00:25.243459 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:00:25.286346 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:00:25.352206 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:00:25.357157 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:00:25.398047 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:00:25.412644 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:00:25.423847 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:00:25.438609 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:00:25.445137 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:00:25.449100 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:00:25.454126 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:00:25.468939 (MainThread): Partial parsing not enabled
2021-05-29 17:00:25.513823 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:00:25.532772 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:00:25.540944 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:00:25.549886 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:00:25.557862 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:00:25.566839 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:00:25.579805 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:00:25.587784 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:00:25.597791 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:00:25.605262 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:00:25.613241 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:00:25.620874 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:00:25.628885 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:00:25.636686 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:00:25.645662 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:00:25.653642 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:00:25.662618 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:00:25.683559 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:00:26.026722 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1265ff5-38d1-4139-9e39-021947376f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B07648>]}
2021-05-29 17:00:26.041680 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1265ff5-38d1-4139-9e39-021947376f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B294C8>]}
2021-05-29 17:00:26.042646 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:00:26.049625 (MainThread): 
2021-05-29 17:00:26.051623 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:00:26.055608 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:00:26.055608 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:00:26.803852 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:00:26.805179 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:00:26.812767 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:00:28.123564 (MainThread): 14:00:28 | Concurrency: 1 threads (target='dev')
2021-05-29 17:00:28.124561 (MainThread): 14:00:28 | 
2021-05-29 17:00:28.129552 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:00:28.129552 (Thread-1): 14:00:28 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:00:28.131545 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:00:28.132546 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:00:28.144511 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:00:28.148498 (Thread-1): finished collecting timing info
2021-05-29 17:00:28.195406 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:00:28.203463 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:00:29.569782 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:00:29.570776 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , reason_with_sk.reason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:00:30.521634 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/6c465db6-6139-45d7-8829-0898352f8b55?maxResults=0&location=US&prettyPrint=false: Name reason_fk not found inside reason_with_sk at [98:30]')
2021-05-29 17:00:32.411119 (Thread-1): finished collecting timing info
2021-05-29 17:00:32.417103 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name reason_fk not found inside reason_with_sk at [98:30]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/c5760b2a-1782-43f3-9407-750cf76a714e?maxResults=0&location=US&prettyPrint=false: Name reason_fk not found inside reason_with_sk at [98:30]

(job ID: c5760b2a-1782-43f3-9407-750cf76a714e)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:
  27:    , reason as (
  28:        select *
  29:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  30:    )
  31:
  32:    , orders_with_sk as (
  33:            select
  34:            orders.salesorderid
  35:            , customer.customer_sk as customer_fk
  36:            , creditcard.creditcard_sk as creditcard_fk
  37:            , address.address_sk as address_fk
  38:            , orders.shipmethodid
  39:            , orders.billtoaddressid
  40:            , orders.salespersonid
  41:            , orders.currencyrateid
  42:            , orders.territoryid
  43:            , orders.purchaseordernumber
  44:            , orders.modifieddate
  45:            , orders.rowguid
  46:            , orders.taxamt
  47:            , orders.onlineorderflag
  48:            , orders.status
  49:            , orders.orderdate
  50:            , orders.creditcardapprovalcode
  51:            , orders.subtotal
  52:            , orders.revisionnumber
  53:            , orders.freight
  54:            , orders.duedate
  55:            , orders.totaldue
  56:            , orders.shipdate
  57:            , orders.accountnumber
  58:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  59:
  60:        left join customer on orders.customerid = customer.customerid
  61:        left join creditcard on orders.creditcardid= creditcard.creditcardid
  62:        left join address on orders.shiptoaddressid = address.addressid
  63:
  64:    )
  65:
  66:    , reason_with_sk as (
  67:        select
  68:            reason.salesreason_sk as salesreason_fk
  69:            , order_reason.salesorderid
  70:            , order_reason.modifieddate
  71:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
  72:        left join reason on order_reason.salesreasonid = reason.salesreasonid
  73:    )
  74:
  75:   , order_detail_with_sk as (
  76:        select
  77:            order_details.salesorderid
  78:            , order_details.specialofferid
  79:            , order_details.salesorderdetailid
  80:            , order_details.unitpricediscount
  81:            , order_details.unitprice
  82:            , order_details.rowguid
  83:            , order_details.orderqty
  84:            , order_details.saleprice
  85:            , order_details.modifieddate
  86:            , order_details.carriertrackingnumber
  87:            , product.product_sk as product_fk
  88:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  89:        left join product on order_details.productid = product.productid
  90:    )
  91:
  92:    , final as (
  93:        select
  94:        order_detail_with_sk.salesorderid
  95:            , orders_with_sk.customer_fk
  96:            , orders_with_sk.creditcard_fk
  97:            , orders_with_sk.address_fk
  98:            , reason_with_sk.reason_fk
  99:            , orders_with_sk.shipmethodid
 100:            , orders_with_sk.billtoaddressid
 101:            , orders_with_sk.salespersonid
 102:            , orders_with_sk.currencyrateid
 103:            , orders_with_sk.territoryid
 104:            , orders_with_sk.purchaseordernumber
 105:            , orders_with_sk.modifieddate
 106:            , orders_with_sk.rowguid
 107:            , orders_with_sk.taxamt
 108:            , orders_with_sk.onlineorderflag
 109:            , orders_with_sk.status
 110:            , orders_with_sk.orderdate
 111:            , orders_with_sk.creditcardapprovalcode
 112:            , orders_with_sk.subtotal
 113:            , orders_with_sk.revisionnumber
 114:            , orders_with_sk.freight
 115:            , orders_with_sk.duedate
 116:            , orders_with_sk.totaldue
 117:            , orders_with_sk.shipdate
 118:            , orders_with_sk.accountnumber
 119:            , order_detail_with_sk.specialofferid
 120:            , order_detail_with_sk.salesorderdetailid
 121:            , order_detail_with_sk.unitpricediscount
 122:            , order_detail_with_sk.unitprice
 123:            , order_detail_with_sk.orderqty
 124:            , order_detail_with_sk.saleprice
 125:            , order_detail_with_sk.carriertrackingnumber
 126:            , order_detail_with_sk.product_fk
 127:
 128:            from orders_with_sk
 129:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 130:            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
 131:    )
 132:
 133:select * from final
 134:  );
 135:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name reason_fk not found inside reason_with_sk at [98:30]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 17:00:32.438592 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1265ff5-38d1-4139-9e39-021947376f45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B08508>]}
2021-05-29 17:00:32.438592 (Thread-1): 14:00:32 | 1 of 1 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 4.31s]
2021-05-29 17:00:32.440589 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:00:32.536334 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:00:32.536334 (MainThread): 14:00:32 | 
2021-05-29 17:00:32.537750 (MainThread): 14:00:32 | Finished running 1 table model in 6.49s.
2021-05-29 17:00:32.538754 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:00:32.538754 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:00:32.538754 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:00:32.538754 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:00:32.556705 (MainThread): 
2021-05-29 17:00:32.557737 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 17:00:32.559697 (MainThread): 
2021-05-29 17:00:32.560696 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 17:00:32.561692 (MainThread):   Name reason_fk not found inside reason_with_sk at [98:30]
2021-05-29 17:00:32.563713 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 17:00:32.566680 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 17:00:32.567676 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1A7F6A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1A7F61C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A16B14848>]}
2021-05-29 17:00:32.567676 (MainThread): Flushing usage events
2021-05-29 17:01:23.633352 (MainThread): Running with dbt=0.19.1
2021-05-29 17:01:24.379053 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:01:24.380052 (MainThread): Tracking: tracking
2021-05-29 17:01:24.382048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC784588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC7843C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC784648>]}
2021-05-29 17:01:24.401147 (MainThread): Partial parsing not enabled
2021-05-29 17:01:24.404724 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:01:24.443392 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:01:24.457355 (MainThread): Parsing macros\etc.sql
2021-05-29 17:01:24.462380 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:01:24.472166 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:01:24.497140 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:01:24.503127 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:01:24.508075 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:01:24.530936 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:01:24.542337 (MainThread): Parsing macros\core.sql
2021-05-29 17:01:24.551400 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:01:24.638422 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:01:24.658137 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:01:24.660911 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:01:24.664905 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:01:24.669930 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:01:24.673916 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:01:24.676887 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:01:24.695842 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:01:24.723768 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:01:24.728658 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:01:24.741973 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:01:24.784530 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:01:24.850553 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:01:24.855745 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:01:24.897556 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:01:24.917265 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:01:24.928334 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:01:24.942552 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:01:24.949540 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:01:24.953529 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:01:24.958515 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:01:24.973472 (MainThread): Partial parsing not enabled
2021-05-29 17:01:25.079113 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:01:25.105126 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:01:25.114835 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:01:25.123756 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:01:25.132089 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:01:25.141544 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:01:25.157546 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:01:25.166525 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:01:25.176894 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:01:25.186225 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:01:25.195602 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:01:25.207183 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:01:25.216969 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:01:25.231761 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:01:25.263187 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:01:25.276149 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:01:25.288275 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:01:25.316203 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:01:25.777003 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '201238fb-2bee-49f0-946e-ac2a75cbda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAFE7F4C8>]}
2021-05-29 17:01:25.791965 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '201238fb-2bee-49f0-946e-ac2a75cbda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC7B5308>]}
2021-05-29 17:01:25.791965 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:01:25.798910 (MainThread): 
2021-05-29 17:01:25.800907 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:01:25.805894 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:01:25.805894 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:01:26.581077 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:01:26.582062 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:01:26.589645 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:01:27.353818 (MainThread): 14:01:27 | Concurrency: 1 threads (target='dev')
2021-05-29 17:01:27.356791 (MainThread): 14:01:27 | 
2021-05-29 17:01:27.373733 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:01:27.374764 (Thread-1): 14:01:27 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:01:27.375949 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:01:27.376971 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:01:27.388975 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:01:27.389971 (Thread-1): finished collecting timing info
2021-05-29 17:01:27.440797 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:01:27.449778 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:01:28.211868 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:01:28.213863 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid= creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , reason_with_sk.salesreason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:01:35.191511 (Thread-1): finished collecting timing info
2021-05-29 17:01:35.192510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '201238fb-2bee-49f0-946e-ac2a75cbda22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC7C43C8>]}
2021-05-29 17:01:35.192510 (Thread-1): 14:01:35 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.82s]
2021-05-29 17:01:35.194422 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:01:35.245762 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:01:35.246761 (MainThread): 14:01:35 | 
2021-05-29 17:01:35.246761 (MainThread): 14:01:35 | Finished running 1 table model in 9.45s.
2021-05-29 17:01:35.247766 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:01:35.247766 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:01:35.248753 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:01:35.248753 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:01:35.265708 (MainThread): 
2021-05-29 17:01:35.266705 (MainThread): Completed successfully
2021-05-29 17:01:35.269421 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:01:35.270445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB0273EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB0273D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC7C1448>]}
2021-05-29 17:01:35.271445 (MainThread): Flushing usage events
2021-05-29 17:05:13.623882 (MainThread): Running with dbt=0.19.1
2021-05-29 17:05:15.072503 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:05:15.074495 (MainThread): Tracking: tracking
2021-05-29 17:05:15.075493 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD4024548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD5FB1308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD40846C8>]}
2021-05-29 17:05:15.105413 (MainThread): Partial parsing not enabled
2021-05-29 17:05:15.111400 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:05:15.177355 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:05:15.194315 (MainThread): Parsing macros\etc.sql
2021-05-29 17:05:15.202293 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:05:15.222240 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:05:15.341921 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:05:15.354887 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:05:15.389792 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:05:15.452635 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:05:15.485535 (MainThread): Parsing macros\core.sql
2021-05-29 17:05:15.495511 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:05:15.620541 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:05:15.639091 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:05:15.642364 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:05:15.646971 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:05:15.650963 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:05:15.654955 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:05:15.661178 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:05:15.680704 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:05:15.711648 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:05:15.719230 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:05:15.735185 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:05:15.782845 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:05:15.853073 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:05:15.858866 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:05:15.898059 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:05:15.913081 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:05:15.924532 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:05:15.939262 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:05:15.946352 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:05:15.950483 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:05:15.956762 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:05:15.971739 (MainThread): Partial parsing not enabled
2021-05-29 17:05:16.019470 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:05:16.041535 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:05:16.049778 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:05:16.058738 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:05:16.067749 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:05:16.078724 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:05:16.090246 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:05:16.100182 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:05:16.115180 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:05:16.126150 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:05:16.135146 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:05:16.143700 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:05:16.152642 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:05:16.162627 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:05:16.171641 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:05:16.179977 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:05:16.188725 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:05:16.211513 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:05:16.622113 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD771F488>]}
2021-05-29 17:05:16.640034 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD4074048>]}
2021-05-29 17:05:16.640034 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:05:16.650006 (MainThread): 
2021-05-29 17:05:16.651006 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:05:16.656990 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:05:16.656990 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:05:18.119866 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:05:18.120861 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:05:18.132861 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:05:19.505926 (MainThread): 14:05:19 | Concurrency: 1 threads (target='dev')
2021-05-29 17:05:19.507075 (MainThread): 14:05:19 | 
2021-05-29 17:05:19.516629 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 17:05:19.517626 (Thread-1): 14:05:19 | 1 of 17 START view model dw_adventure_works.stg_address.............. [RUN]
2021-05-29 17:05:19.519627 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:05:19.519627 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 17:05:19.528599 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 17:05:19.532671 (Thread-1): finished collecting timing info
2021-05-29 17:05:19.584531 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 17:05:19.587091 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:05:19.595076 (Thread-1): On model.dw_adventure_works.stg_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_address"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_address`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`address`
    )

    select * from source;


2021-05-29 17:05:22.134712 (Thread-1): finished collecting timing info
2021-05-29 17:05:22.135708 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD4007188>]}
2021-05-29 17:05:22.135708 (Thread-1): 14:05:22 | 1 of 17 OK created view model dw_adventure_works.stg_address......... [OK in 2.62s]
2021-05-29 17:05:22.137703 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 17:05:22.137703 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 17:05:22.138700 (Thread-1): 14:05:22 | 2 of 17 START view model dw_adventure_works.stg_creditcard........... [RUN]
2021-05-29 17:05:22.139699 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:05:22.140698 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 17:05:22.144717 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 17:05:22.147213 (Thread-1): finished collecting timing info
2021-05-29 17:05:22.151238 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 17:05:22.153198 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:22.162212 (Thread-1): On model.dw_adventure_works.stg_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_creditcard"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber


           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`creditcard`
    )

    select * from source;


2021-05-29 17:05:24.096196 (Thread-1): finished collecting timing info
2021-05-29 17:05:24.098200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7AE4D88>]}
2021-05-29 17:05:24.100236 (Thread-1): 14:05:24 | 2 of 17 OK created view model dw_adventure_works.stg_creditcard...... [OK in 1.96s]
2021-05-29 17:05:24.102180 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 17:05:24.102180 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 17:05:24.103175 (Thread-1): 14:05:24 | 3 of 17 START view model dw_adventure_works.stg_customer............. [RUN]
2021-05-29 17:05:24.105170 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:05:24.105170 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 17:05:24.107166 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63009), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:24.108162 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63010), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:24.113149 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 17:05:24.117206 (Thread-1): finished collecting timing info
2021-05-29 17:05:24.125117 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 17:05:24.127113 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:24.140079 (Thread-1): On model.dw_adventure_works.stg_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_customer"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_customer`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`customer`
    )

    select * from source;


2021-05-29 17:05:26.440477 (Thread-1): finished collecting timing info
2021-05-29 17:05:26.443413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7A9FF08>]}
2021-05-29 17:05:26.445408 (Thread-1): 14:05:26 | 3 of 17 OK created view model dw_adventure_works.stg_customer........ [OK in 2.34s]
2021-05-29 17:05:26.450280 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 17:05:26.451289 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 17:05:26.453336 (Thread-1): 14:05:26 | 4 of 17 START view model dw_adventure_works.stg_person............... [RUN]
2021-05-29 17:05:26.456063 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:05:26.456063 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 17:05:26.459055 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63011), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:26.460109 (Thread-1): unclosed <socket.socket fd=1224, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63012), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:26.465036 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 17:05:26.467753 (Thread-1): finished collecting timing info
2021-05-29 17:05:26.471748 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 17:05:26.473745 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:26.480723 (Thread-1): On model.dw_adventure_works.stg_person: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_person"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_person`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            businessentityid

           /*Other Columns*/
            , title
            , suffix
            , rowguid
            , persontype
            , namestyle
            , modifieddate
            , middlename
            , lastname
            , firstname
            , emailpromotion

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`person`
    )

    select * from source;


2021-05-29 17:05:28.729608 (Thread-1): finished collecting timing info
2021-05-29 17:05:28.730615 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7AA78C8>]}
2021-05-29 17:05:28.733614 (Thread-1): 14:05:28 | 4 of 17 OK created view model dw_adventure_works.stg_person.......... [OK in 2.28s]
2021-05-29 17:05:28.735592 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 17:05:28.736590 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 17:05:28.737590 (Thread-1): 14:05:28 | 5 of 17 START view model dw_adventure_works.stg_product.............. [RUN]
2021-05-29 17:05:28.738586 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:05:28.738586 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 17:05:28.743572 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 17:05:28.744570 (Thread-1): finished collecting timing info
2021-05-29 17:05:28.752552 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 17:05:28.754099 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:28.763118 (Thread-1): On model.dw_adventure_works.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_product"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`product`
    )

    select * from source;


2021-05-29 17:05:31.021844 (Thread-1): finished collecting timing info
2021-05-29 17:05:31.021844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7B407C8>]}
2021-05-29 17:05:31.022844 (Thread-1): 14:05:31 | 5 of 17 OK created view model dw_adventure_works.stg_product......... [OK in 2.28s]
2021-05-29 17:05:31.023807 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 17:05:31.024803 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 17:05:31.024803 (Thread-1): 14:05:31 | 6 of 17 START view model dw_adventure_works.stg_salesreason.......... [RUN]
2021-05-29 17:05:31.026797 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:05:31.026797 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 17:05:31.031818 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 17:05:31.032781 (Thread-1): finished collecting timing info
2021-05-29 17:05:31.036809 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 17:05:31.038766 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:31.046779 (Thread-1): On model.dw_adventure_works.stg_salesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_salesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
           
           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesreason`
    )

    select * from source;


2021-05-29 17:05:32.727438 (Thread-1): finished collecting timing info
2021-05-29 17:05:32.729443 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7B5B9C8>]}
2021-05-29 17:05:32.731438 (Thread-1): 14:05:32 | 6 of 17 OK created view model dw_adventure_works.stg_salesreason..... [OK in 1.70s]
2021-05-29 17:05:32.735368 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 17:05:32.735368 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 17:05:32.737361 (Thread-1): 14:05:32 | 7 of 17 START view model dw_adventure_works.stg_stateprovince........ [RUN]
2021-05-29 17:05:32.739356 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:05:32.740351 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 17:05:32.753316 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63013), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:32.753316 (Thread-1): unclosed <socket.socket fd=1296, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63014), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:32.754313 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63015), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:32.754313 (Thread-1): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63016), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:32.754313 (Thread-1): unclosed <socket.socket fd=936, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63017), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:32.755311 (Thread-1): unclosed <socket.socket fd=1340, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63018), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:32.762326 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 17:05:32.764321 (Thread-1): finished collecting timing info
2021-05-29 17:05:32.768281 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 17:05:32.771267 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:32.782255 (Thread-1): On model.dw_adventure_works.stg_stateprovince: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_stateprovince"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`stateprovince`
    )

    select * from source;


2021-05-29 17:05:35.179315 (Thread-1): finished collecting timing info
2021-05-29 17:05:35.180280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7A588C8>]}
2021-05-29 17:05:35.181276 (Thread-1): 14:05:35 | 7 of 17 OK created view model dw_adventure_works.stg_stateprovince... [OK in 2.44s]
2021-05-29 17:05:35.183284 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 17:05:35.183284 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 17:05:35.184281 (Thread-1): 14:05:35 | 8 of 17 START view model dw_adventure_works.stg_orderdetail.......... [RUN]
2021-05-29 17:05:35.185278 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:05:35.185278 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 17:05:35.186276 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63019), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:35.187273 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63020), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:35.192258 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 17:05:35.194256 (Thread-1): finished collecting timing info
2021-05-29 17:05:35.199247 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 17:05:35.201234 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:35.210210 (Thread-1): On model.dw_adventure_works.stg_orderdetail: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderdetail"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , specialofferid
            , salesorderdetailid
            , productid

           /*Other Columns*/
            , unitpricediscount
            , unitprice
            , rowguid
            , orderqty
            , unitprice * (1 - unitpricediscount) * orderqty as saleprice
            , modifieddate
            , carriertrackingnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderdetail`
    )

    select * from source;


2021-05-29 17:05:37.575365 (Thread-1): finished collecting timing info
2021-05-29 17:05:37.577357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7A26108>]}
2021-05-29 17:05:37.578355 (Thread-1): 14:05:37 | 8 of 17 OK created view model dw_adventure_works.stg_orderdetail..... [OK in 2.39s]
2021-05-29 17:05:37.582344 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 17:05:37.582344 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 17:05:37.583348 (Thread-1): 14:05:37 | 9 of 17 START view model dw_adventure_works.stg_orderheadersalesreason [RUN]
2021-05-29 17:05:37.585338 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:05:37.585338 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 17:05:37.590322 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 17:05:37.592376 (Thread-1): finished collecting timing info
2021-05-29 17:05:37.596340 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 17:05:37.597711 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:37.605694 (Thread-1): On model.dw_adventure_works.stg_orderheadersalesreason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orderheadersalesreason"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheadersalesreason`
    )

    select * from source;


2021-05-29 17:05:39.885810 (Thread-1): finished collecting timing info
2021-05-29 17:05:39.886808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7A26308>]}
2021-05-29 17:05:39.886808 (Thread-1): 14:05:39 | 9 of 17 OK created view model dw_adventure_works.stg_orderheadersalesreason [OK in 2.30s]
2021-05-29 17:05:39.888802 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 17:05:39.888802 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 17:05:39.889798 (Thread-1): 14:05:39 | 10 of 17 START view model dw_adventure_works.stg_orders.............. [RUN]
2021-05-29 17:05:39.890792 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:05:39.890792 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 17:05:39.895782 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 17:05:39.896867 (Thread-1): finished collecting timing info
2021-05-29 17:05:39.900862 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 17:05:39.902857 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:39.910835 (Thread-1): On model.dw_adventure_works.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_orders"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            salesorderid

            /*Foreign Keys*/
            , customerid
            , shipmethodid
            , billtoaddressid
            , salespersonid
            , currencyrateid
            , creditcardid
            , territoryid
            , shiptoaddressid

           /*Other Columns*/
            , purchaseordernumber
            , modifieddate
            , rowguid
            , taxamt
            , onlineorderflag
            , status
            , orderdate
            , creditcardapprovalcode
            , subtotal
            , revisionnumber
            , freight
            , duedate
            , totaldue
            , shipdate
            , accountnumber

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`salesorderheader`
    )

    select * from source;


2021-05-29 17:05:41.581192 (Thread-1): finished collecting timing info
2021-05-29 17:05:41.581192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7A0F788>]}
2021-05-29 17:05:41.582224 (Thread-1): 14:05:41 | 10 of 17 OK created view model dw_adventure_works.stg_orders......... [OK in 1.69s]
2021-05-29 17:05:41.584181 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 17:05:41.584181 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 17:05:41.585179 (Thread-1): 14:05:41 | 11 of 17 START view model dw_adventure_works.stg_countryregion....... [RUN]
2021-05-29 17:05:41.586176 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:05:41.587173 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 17:05:41.596151 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 17:05:41.598144 (Thread-1): finished collecting timing info
2021-05-29 17:05:41.605124 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 17:05:41.608136 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:41.619091 (Thread-1): On model.dw_adventure_works.stg_countryregion: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.stg_countryregion"} */


  create or replace view `desafio-indicium`.`dw_adventure_works`.`stg_countryregion`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            countryregioncode

           /*Other Columns*/
            , name
            , modifieddate

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_received_at
            , _sdc_sequence
            , _sdc_table_version
        from `desafio-indicium`.`adventure_works`.`countryregion`
    )

    select * from source;


2021-05-29 17:05:43.875399 (Thread-1): finished collecting timing info
2021-05-29 17:05:43.878391 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD79E2548>]}
2021-05-29 17:05:43.882376 (Thread-1): 14:05:43 | 11 of 17 OK created view model dw_adventure_works.stg_countryregion.. [OK in 2.29s]
2021-05-29 17:05:43.885370 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 17:05:43.886367 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 17:05:43.887364 (Thread-1): 14:05:43 | 12 of 17 START table model dw_adventure_works.dim_creditcard......... [RUN]
2021-05-29 17:05:43.889360 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:05:43.889360 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 17:05:43.898332 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 17:05:43.901327 (Thread-1): finished collecting timing info
2021-05-29 17:05:43.915287 (Thread-1): unclosed <socket.socket fd=1296, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63022), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:43.915287 (Thread-1): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63021), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:43.916286 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63023), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:43.916286 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63024), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:43.916286 (Thread-1): unclosed <socket.socket fd=360, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63025), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:43.917283 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63026), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:43.917283 (Thread-1): unclosed <socket.socket fd=1492, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63027), raddr=('172.217.28.234', 443)>
2021-05-29 17:05:43.918278 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63028), raddr=('172.217.162.138', 443)>
2021-05-29 17:05:43.938224 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:43.946220 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:05:45.297543 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 17:05:45.299536 (Thread-1): On model.dw_adventure_works.dim_creditcard: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_creditcard"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
           /*Primary Key*/
            creditcardid

           /*Other Columns*/
            , modifieddate
            , expyear
            , expmonth
            , cardtype
            , cardnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_creditcard`
    )

    , transformed as (
        select
        row_number() over (order by creditcardid) as creditcard_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 17:05:48.375794 (Thread-1): finished collecting timing info
2021-05-29 17:05:48.377788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7C5A4C8>]}
2021-05-29 17:05:48.378784 (Thread-1): 14:05:48 | 12 of 17 OK created table model dw_adventure_works.dim_creditcard.... [CREATE TABLE (19.1k rows, 1.1 MB processed) in 4.49s]
2021-05-29 17:05:48.379781 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 17:05:48.380782 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 17:05:48.381778 (Thread-1): 14:05:48 | 13 of 17 START table model dw_adventure_works.dim_customer........... [RUN]
2021-05-29 17:05:48.382775 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:05:48.383773 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 17:05:48.391750 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 17:05:48.395739 (Thread-1): finished collecting timing info
2021-05-29 17:05:48.401724 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:48.414690 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:05:49.793512 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 17:05:49.795159 (Thread-1): On model.dw_adventure_works.dim_customer: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_customer"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  
  
  OPTIONS()
  as (
    with
    person as (
            select
                /*Primary Key*/
                businessentityid

               /*Other Columns*/
                , title
                , suffix
                , rowguid
                , persontype
                , namestyle
                , modifieddate
                , middlename
                , lastname
                , firstname
                , emailpromotion
            from `desafio-indicium`.`dw_adventure_works`.`stg_person`
        )

    , customer as (
        select
          /*Primary Key*/
            customerid

            /*Foreign Keys*/
            , territoryid
            , storeid
            , personid

           /*Other Columns*/
            , rowguid
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_customer`
    )

    , transformed as (
        select
        row_number() over (order by customerid) as customer_sk
        , customer.customerid
        , customer.territoryid
        , customer.storeid
        , customer.personid
        , customer.rowguid
        , customer.modifieddate
        , person.middlename
        , person.lastname
        , person.firstname
        from customer
        left join person on customer.customerid = person.businessentityid
    )

    select * from transformed
  );
    
2021-05-29 17:05:52.559160 (Thread-1): finished collecting timing info
2021-05-29 17:05:52.560160 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7CA4B88>]}
2021-05-29 17:05:52.561155 (Thread-1): 14:05:52 | 13 of 17 OK created table model dw_adventure_works.dim_customer...... [CREATE TABLE (19.8k rows, 1.8 MB processed) in 4.18s]
2021-05-29 17:05:52.564106 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 17:05:52.565104 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 17:05:52.566145 (Thread-1): 14:05:52 | 14 of 17 START table model dw_adventure_works.dim_product............ [RUN]
2021-05-29 17:05:52.568097 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:05:52.568097 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 17:05:52.575123 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 17:05:52.577098 (Thread-1): finished collecting timing info
2021-05-29 17:05:52.581099 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:52.589117 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:05:53.886589 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 17:05:53.889490 (Thread-1): On model.dw_adventure_works.dim_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_product"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_product`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
             /*Primary Key*/
            productid

            /*Foreign Keys*/
            , productsubcategoryid
            , productmodelid

           /*Other Columns*/
            , weightunitmeasurecode
            , weight
            , style
            , standardcost
            , sizeunitmeasurecode
            , size
            , sellstartdate
            , sellenddate
            , safetystocklevel
            , reorderpoint
            , productnumber
            , productline
            , name
            , modifieddate
            , makeflag
            , listprice
            , finishedgoodsflag
            , daystomanufacture
            , color
            , class
        from `desafio-indicium`.`dw_adventure_works`.`stg_product`
    )

    , transformed as (
        select
        row_number() over (order by productid) as product_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 17:05:56.377035 (Thread-1): finished collecting timing info
2021-05-29 17:05:56.378030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D0DDC8>]}
2021-05-29 17:05:56.378030 (Thread-1): 14:05:56 | 14 of 17 OK created table model dw_adventure_works.dim_product....... [CREATE TABLE (504.0 rows, 71.3 KB processed) in 3.81s]
2021-05-29 17:05:56.379989 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 17:05:56.379989 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 17:05:56.380985 (Thread-1): 14:05:56 | 15 of 17 START table model dw_adventure_works.dim_reason............. [RUN]
2021-05-29 17:05:56.381985 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:05:56.381985 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 17:05:56.388963 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 17:05:56.390961 (Thread-1): finished collecting timing info
2021-05-29 17:05:56.393950 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:05:56.401929 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:05:57.727950 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 17:05:57.733942 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    selected as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesreasonid) as salesreason_sk
        , *
        from selected
    )

    select * from transformed
  );
    
2021-05-29 17:06:00.309184 (Thread-1): finished collecting timing info
2021-05-29 17:06:00.312166 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D18948>]}
2021-05-29 17:06:00.313164 (Thread-1): 14:06:00 | 15 of 17 OK created table model dw_adventure_works.dim_reason........ [CREATE TABLE (10.0 rows, 385.0 Bytes processed) in 3.93s]
2021-05-29 17:06:00.316152 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 17:06:00.317148 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 17:06:00.318150 (Thread-1): 14:06:00 | 16 of 17 START table model dw_adventure_works.dim_address............ [RUN]
2021-05-29 17:06:00.320138 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:06:00.321139 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 17:06:00.328118 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 17:06:00.330114 (Thread-1): finished collecting timing info
2021-05-29 17:06:00.332140 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:06:00.340583 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:06:01.649861 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 17:06:01.651822 (Thread-1): On model.dw_adventure_works.dim_address: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_address"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_address`
  
  
  OPTIONS()
  as (
    with
    address as (
        select
            /*Primary Key*/
            addressid

            /*Foreign Keys*/
            , stateprovinceid

           /*Other Columns*/
            , spatiallocation
            , rowguid
            , postalcode
            , modifieddate
            , city
            , addressline2
            , addressline1
        from `desafio-indicium`.`dw_adventure_works`.`stg_address`
    )

    ,    stateprovince as (
        select
             /*Primary Key*/
            stateprovinceid

            /*Foreign Keys*/
            , territoryid
            , countryregioncode

           /*Other Columns*/
            , stateprovincecode
            , rowguid
            , name
            , modifieddate
            , isonlystateprovinceflag
        from `desafio-indicium`.`dw_adventure_works`.`stg_stateprovince`
    )

    , transformed as (
        select
        row_number() over (order by addressid) as address_sk
            , address.addressid
            , address.stateprovinceid
            , address.spatiallocation
            , address.rowguid
            , address.postalcode
            , address.modifieddate
            , address.city
            , address.addressline2
            , address.addressline1
            , stateprovince.name
            , stateprovince.countryregioncode
        from address
        left join stateprovince on address.stateprovinceid = stateprovince.stateprovinceid
    )
    select * from transformed
  );
    
2021-05-29 17:06:04.994677 (Thread-1): finished collecting timing info
2021-05-29 17:06:04.996676 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D52FC8>]}
2021-05-29 17:06:04.997669 (Thread-1): 14:06:04 | 16 of 17 OK created table model dw_adventure_works.dim_address....... [CREATE TABLE (19.6k rows, 2.7 MB processed) in 4.68s]
2021-05-29 17:06:04.999667 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 17:06:05.000662 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:06:05.001665 (Thread-1): 14:06:05 | 17 of 17 START table model dw_adventure_works.fact_order_details..... [RUN]
2021-05-29 17:06:05.003660 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:06:05.003660 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:06:05.013628 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:06:05.014625 (Thread-1): finished collecting timing info
2021-05-29 17:06:05.017618 (Thread-1): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63030), raddr=('172.217.162.138', 443)>
2021-05-29 17:06:05.017618 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63029), raddr=('172.217.28.234', 443)>
2021-05-29 17:06:05.017618 (Thread-1): unclosed <socket.socket fd=1508, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63034), raddr=('172.217.162.138', 443)>
2021-05-29 17:06:05.018615 (Thread-1): unclosed <socket.socket fd=1552, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63033), raddr=('172.217.28.234', 443)>
2021-05-29 17:06:05.018615 (Thread-1): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63036), raddr=('172.217.162.138', 443)>
2021-05-29 17:06:05.018615 (Thread-1): unclosed <socket.socket fd=1572, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63035), raddr=('172.217.28.234', 443)>
2021-05-29 17:06:05.019612 (Thread-1): unclosed <socket.socket fd=1620, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63037), raddr=('172.217.28.234', 443)>
2021-05-29 17:06:05.019612 (Thread-1): unclosed <socket.socket fd=1628, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63038), raddr=('172.217.162.138', 443)>
2021-05-29 17:06:05.019612 (Thread-1): unclosed <socket.socket fd=1640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63039), raddr=('172.217.28.234', 443)>
2021-05-29 17:06:05.019612 (Thread-1): unclosed <socket.socket fd=1664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 63040), raddr=('172.217.162.138', 443)>
2021-05-29 17:06:05.022603 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 17:06:05.030615 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:06:06.325854 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:06:06.329845 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , reason_with_sk.salesreason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from orders_with_sk
  );
    
2021-05-29 17:06:09.978713 (Thread-1): finished collecting timing info
2021-05-29 17:06:09.980756 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e729f9-5903-4e26-a20c-0addcb76e983', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D52FC8>]}
2021-05-29 17:06:09.982714 (Thread-1): 14:06:09 | 17 of 17 OK created table model dw_adventure_works.fact_order_details [CREATE TABLE (31.5k rows, 8.2 MB processed) in 4.98s]
2021-05-29 17:06:09.988689 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:06:10.077677 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:06:10.079670 (MainThread): 14:06:10 | 
2021-05-29 17:06:10.081437 (MainThread): 14:06:10 | Finished running 11 view models, 6 table models in 53.43s.
2021-05-29 17:06:10.084446 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:06:10.085444 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:06:10.086442 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:06:10.087450 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:06:10.106381 (MainThread): 
2021-05-29 17:06:10.106381 (MainThread): Completed successfully
2021-05-29 17:06:10.108375 (MainThread): 
Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2021-05-29 17:06:10.109373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD7AB5C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D3F688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FD8D5F888>]}
2021-05-29 17:06:10.110371 (MainThread): Flushing usage events
2021-05-29 17:10:14.182147 (MainThread): Running with dbt=0.19.1
2021-05-29 17:10:15.013107 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:10:15.014463 (MainThread): Tracking: tracking
2021-05-29 17:10:15.015276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE54C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE43C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE530C8>]}
2021-05-29 17:10:15.034045 (MainThread): Partial parsing not enabled
2021-05-29 17:10:15.037775 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:10:15.076676 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:10:15.089640 (MainThread): Parsing macros\etc.sql
2021-05-29 17:10:15.097341 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:10:15.107319 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:10:15.133250 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:10:15.139232 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:10:15.144232 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:10:15.164566 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:10:15.175803 (MainThread): Parsing macros\core.sql
2021-05-29 17:10:15.184524 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:10:15.276787 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:10:15.296119 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:10:15.299227 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:10:15.303494 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:10:15.308484 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:10:15.312464 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:10:15.315775 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:10:15.335269 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:10:15.364761 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:10:15.370427 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:10:15.386547 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:10:15.432171 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:10:15.497572 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:10:15.502866 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:10:15.543192 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:10:15.557829 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:10:15.568715 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:10:15.582670 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:10:15.588659 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:10:15.591687 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:10:15.596637 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:10:15.609603 (MainThread): Partial parsing not enabled
2021-05-29 17:10:15.658471 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:10:15.680322 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:10:15.688641 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:10:15.697606 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:10:15.706193 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:10:15.714161 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:10:15.726137 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:10:15.735113 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:10:15.745453 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:10:15.755179 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:10:15.763706 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:10:15.772145 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:10:15.780394 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:10:15.788503 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:10:15.796482 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:10:15.804841 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:10:15.813778 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:10:15.839711 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:10:16.170564 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77f21c11-ca84-44c1-af36-50b5466978e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE03208>]}
2021-05-29 17:10:16.186254 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77f21c11-ca84-44c1-af36-50b5466978e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE26408>]}
2021-05-29 17:10:16.187270 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:10:16.195232 (MainThread): 
2021-05-29 17:10:16.198226 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:10:16.200340 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:10:16.200340 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:10:17.077848 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:10:17.077848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:10:17.085828 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:10:18.501329 (MainThread): 14:10:18 | Concurrency: 1 threads (target='dev')
2021-05-29 17:10:18.502321 (MainThread): 14:10:18 | 
2021-05-29 17:10:18.514295 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:10:18.515292 (Thread-1): 14:10:18 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:10:18.516200 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:10:18.516200 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:10:18.528200 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:10:18.530190 (Thread-1): finished collecting timing info
2021-05-29 17:10:18.589029 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:10:18.598002 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:10:19.954746 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:10:19.955744 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , reason_with_sk.salesreason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from order_detail_with_sk
  );
    
2021-05-29 17:10:23.815302 (Thread-1): finished collecting timing info
2021-05-29 17:10:23.816294 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77f21c11-ca84-44c1-af36-50b5466978e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE85A88>]}
2021-05-29 17:10:23.816294 (Thread-1): 14:10:23 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 14.5 MB processed) in 5.30s]
2021-05-29 17:10:23.818290 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:10:23.893092 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:10:23.894091 (MainThread): 14:10:23 | 
2021-05-29 17:10:23.895084 (MainThread): 14:10:23 | Finished running 1 table model in 7.70s.
2021-05-29 17:10:23.896082 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:10:23.896082 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:10:23.897080 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:10:23.897080 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:10:23.925004 (MainThread): 
2021-05-29 17:10:23.927000 (MainThread): Completed successfully
2021-05-29 17:10:23.928000 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:10:23.928995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98056088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB98054B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB9AE151C8>]}
2021-05-29 17:10:23.929992 (MainThread): Flushing usage events
2021-05-29 17:12:08.439226 (MainThread): Running with dbt=0.19.1
2021-05-29 17:12:09.146600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:12:09.147598 (MainThread): Tracking: tracking
2021-05-29 17:12:09.148565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B54508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B54848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B54308>]}
2021-05-29 17:12:09.170426 (MainThread): Partial parsing not enabled
2021-05-29 17:12:09.173419 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:12:09.215995 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:12:09.230958 (MainThread): Parsing macros\etc.sql
2021-05-29 17:12:09.236941 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:12:09.250905 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:12:09.290157 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:12:09.296145 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:12:09.300134 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:12:09.321079 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:12:09.332052 (MainThread): Parsing macros\core.sql
2021-05-29 17:12:09.342028 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:12:09.441758 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:12:09.466693 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:12:09.469683 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:12:09.475665 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:12:09.481649 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:12:09.487636 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:12:09.490572 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:12:09.510524 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:12:09.543835 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:12:09.548844 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:12:09.566796 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:12:09.628668 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:12:09.699443 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:12:09.704106 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:12:09.739016 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:12:09.754283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:12:09.765266 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:12:09.779161 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:12:09.786047 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:12:09.790311 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:12:09.794915 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:12:09.809553 (MainThread): Partial parsing not enabled
2021-05-29 17:12:09.854439 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:12:09.873391 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:12:09.882088 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:12:09.890866 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:12:09.898883 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:12:09.906824 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:12:09.918829 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:12:09.927059 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:12:09.936035 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:12:09.944021 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:12:09.952955 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:12:09.960934 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:12:09.968913 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:12:09.976892 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:12:09.984870 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:12:09.993883 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:12:10.000862 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:12:10.022236 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:12:10.375846 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '962fe6fd-4f60-4f8a-8227-9e62ec0256e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B07C48>]}
2021-05-29 17:12:10.389805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '962fe6fd-4f60-4f8a-8227-9e62ec0256e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B29248>]}
2021-05-29 17:12:10.390773 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:12:10.397751 (MainThread): 
2021-05-29 17:12:10.398749 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:12:10.402751 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:12:10.403734 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:12:11.753770 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:12:11.753770 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:12:11.761751 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:12:13.068877 (MainThread): 14:12:13 | Concurrency: 1 threads (target='dev')
2021-05-29 17:12:13.069879 (MainThread): 14:12:13 | 
2021-05-29 17:12:13.074873 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:12:13.074873 (Thread-1): 14:12:13 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:12:13.076867 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:12:13.076867 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:12:13.091878 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:12:13.092826 (Thread-1): finished collecting timing info
2021-05-29 17:12:13.133747 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:12:13.141727 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:12:14.529839 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:12:14.530835 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
        order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , reason_with_sk.salesreason_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:12:20.356917 (Thread-1): finished collecting timing info
2021-05-29 17:12:20.357911 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '962fe6fd-4f60-4f8a-8227-9e62ec0256e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71BB22C8>]}
2021-05-29 17:12:20.358906 (Thread-1): 14:12:20 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.28s]
2021-05-29 17:12:20.361898 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:12:20.405969 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:12:20.405969 (MainThread): 14:12:20 | 
2021-05-29 17:12:20.407154 (MainThread): 14:12:20 | Finished running 1 table model in 10.01s.
2021-05-29 17:12:20.408157 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:12:20.408157 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:12:20.408157 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:12:20.408157 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:12:20.425112 (MainThread): 
2021-05-29 17:12:20.426123 (MainThread): Completed successfully
2021-05-29 17:12:20.427105 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:12:20.429100 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B53F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B08D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B08048>]}
2021-05-29 17:12:20.429100 (MainThread): Flushing usage events
2021-05-29 17:17:05.622659 (MainThread): Running with dbt=0.19.1
2021-05-29 17:17:06.456674 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:17:06.458384 (MainThread): Tracking: tracking
2021-05-29 17:17:06.459443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B3AA8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B3AA7C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B3AA488>]}
2021-05-29 17:17:06.480546 (MainThread): Partial parsing not enabled
2021-05-29 17:17:06.484670 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:17:06.524085 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:17:06.537052 (MainThread): Parsing macros\etc.sql
2021-05-29 17:17:06.542037 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:17:06.556000 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:17:06.586915 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:17:06.593902 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:17:06.598883 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:17:06.620826 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:17:06.662715 (MainThread): Parsing macros\core.sql
2021-05-29 17:17:06.676677 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:17:06.840273 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:17:06.864175 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:17:06.866168 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:17:06.870157 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:17:06.876143 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:17:06.882165 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:17:06.887115 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:17:06.917753 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:17:06.945681 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:17:06.950616 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:17:06.964734 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:17:07.018238 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:17:07.084067 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:17:07.088827 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:17:07.127057 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:17:07.141023 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:17:07.154169 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:17:07.171127 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:17:07.177149 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:17:07.182100 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:17:07.186124 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:17:07.200050 (MainThread): Partial parsing not enabled
2021-05-29 17:17:07.248672 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:17:07.269615 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:17:07.277593 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:17:07.286191 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:17:07.294528 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:17:07.302507 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:17:07.313680 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:17:07.322142 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:17:07.331386 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:17:07.339668 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:17:07.347769 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:17:07.356459 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:17:07.366289 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:17:07.374757 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:17:07.382606 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:17:07.391583 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:17:07.399615 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:17:07.425728 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:17:07.752449 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '269785c0-152c-4d9b-9ba0-dc8361405d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EAAF788>]}
2021-05-29 17:17:07.768408 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '269785c0-152c-4d9b-9ba0-dc8361405d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B403248>]}
2021-05-29 17:17:07.768408 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:17:07.783368 (MainThread): 
2021-05-29 17:17:07.784365 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:17:07.787357 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:17:07.788353 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:17:08.784260 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:17:08.785260 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:17:08.803246 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:17:10.113825 (MainThread): 14:17:10 | Concurrency: 1 threads (target='dev')
2021-05-29 17:17:10.115133 (MainThread): 14:17:10 | 
2021-05-29 17:17:10.123126 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:17:10.125114 (Thread-1): 14:17:10 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:17:10.128106 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:17:10.129109 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:17:10.142101 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:17:10.147055 (Thread-1): finished collecting timing info
2021-05-29 17:17:10.197918 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:17:10.208925 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:17:11.534695 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:17:11.538401 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.rowguid
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk

            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:17:12.599592 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/d323eefe-04dc-4782-9a5b-5cccd01969e9?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name rowguid at [8:6]')
2021-05-29 17:17:14.579354 (Thread-1): finished collecting timing info
2021-05-29 17:17:14.581298 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE TABLE has columns with duplicate name rowguid at [8:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/299612d0-70d9-4d04-9ef0-816cb9bc591e?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name rowguid at [8:6]

(job ID: 299612d0-70d9-4d04-9ef0-816cb9bc591e)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:
  27:    , reason as (
  28:        select *
  29:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  30:    )
  31:
  32:    , orders_with_sk as (
  33:            select
  34:            orders.salesorderid
  35:            , customer.customer_sk as customer_fk
  36:            , creditcard.creditcard_sk as creditcard_fk
  37:            , address.address_sk as address_fk
  38:            , orders.shipmethodid
  39:            , orders.billtoaddressid
  40:            , orders.salespersonid
  41:            , orders.currencyrateid
  42:            , orders.territoryid
  43:            , orders.purchaseordernumber
  44:            , orders.modifieddate
  45:            , orders.rowguid
  46:            , orders.taxamt
  47:            , orders.onlineorderflag
  48:            , orders.status
  49:            , orders.orderdate
  50:            , orders.creditcardapprovalcode
  51:            , orders.subtotal
  52:            , orders.revisionnumber
  53:            , orders.freight
  54:            , orders.duedate
  55:            , orders.totaldue
  56:            , orders.shipdate
  57:            , orders.accountnumber
  58:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  59:
  60:        left join customer on orders.customerid = customer.customerid
  61:        left join creditcard on orders.creditcardid = creditcard.creditcardid
  62:        left join address on orders.shiptoaddressid = address.addressid
  63:
  64:    )
  65:
  66:    , reason_with_sk as (
  67:        select
  68:            reason.salesreason_sk as salesreason_fk
  69:            , order_reason.salesorderid
  70:            , order_reason.modifieddate
  71:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
  72:        left join reason on order_reason.salesreasonid = reason.salesreasonid
  73:    )
  74:
  75:   , order_detail_with_sk as (
  76:        select
  77:            order_details.salesorderid
  78:            , order_details.specialofferid
  79:            , order_details.salesorderdetailid
  80:            , order_details.unitpricediscount
  81:            , order_details.unitprice
  82:            , order_details.rowguid
  83:            , order_details.orderqty
  84:            , order_details.saleprice
  85:            , order_details.modifieddate
  86:            , order_details.carriertrackingnumber
  87:            , product.product_sk as product_fk
  88:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  89:        left join product on order_details.productid = product.productid
  90:    )
  91:
  92:    , final as (
  93:        select
  94:            order_detail_with_sk.salesorderid
  95:            , orders_with_sk.customer_fk
  96:            , orders_with_sk.creditcard_fk
  97:            , orders_with_sk.address_fk
  98:            , orders_with_sk.shipmethodid
  99:            , orders_with_sk.billtoaddressid
 100:            , orders_with_sk.salespersonid
 101:            , orders_with_sk.currencyrateid
 102:            , orders_with_sk.territoryid
 103:            , orders_with_sk.purchaseordernumber
 104:            , orders_with_sk.modifieddate
 105:            , orders_with_sk.rowguid
 106:            , orders_with_sk.taxamt
 107:            , orders_with_sk.onlineorderflag
 108:            , orders_with_sk.status
 109:            , orders_with_sk.orderdate
 110:            , orders_with_sk.creditcardapprovalcode
 111:            , orders_with_sk.subtotal
 112:            , orders_with_sk.revisionnumber
 113:            , orders_with_sk.freight
 114:            , orders_with_sk.duedate
 115:            , orders_with_sk.totaldue
 116:            , orders_with_sk.shipdate
 117:            , orders_with_sk.accountnumber
 118:            , reason_with_sk.salesreason_fk
 119:            , order_detail_with_sk.specialofferid
 120:            , order_detail_with_sk.salesorderdetailid
 121:            , order_detail_with_sk.unitpricediscount
 122:            , order_detail_with_sk.unitprice
 123:            , order_detail_with_sk.rowguid
 124:            , order_detail_with_sk.orderqty
 125:            , order_detail_with_sk.saleprice
 126:            , order_detail_with_sk.carriertrackingnumber
 127:            , order_detail_with_sk.product_fk
 128:
 129:            from orders_with_sk
 130:
 131:            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
 132:            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
 133:
 134:    )
 135:
 136:select * from final
 137:  );
 138:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE TABLE has columns with duplicate name rowguid at [8:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 17:17:14.628027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '269785c0-152c-4d9b-9ba0-dc8361405d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B3FBF08>]}
2021-05-29 17:17:14.629024 (Thread-1): 14:17:14 | 1 of 1 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 4.50s]
2021-05-29 17:17:14.630344 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:17:14.660786 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:17:14.661764 (MainThread): 14:17:14 | 
2021-05-29 17:17:14.663170 (MainThread): 14:17:14 | Finished running 1 table model in 6.88s.
2021-05-29 17:17:14.664175 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:17:14.664175 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:17:14.664175 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:17:14.664175 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:17:14.684135 (MainThread): 
2021-05-29 17:17:14.685118 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 17:17:14.686457 (MainThread): 
2021-05-29 17:17:14.687459 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 17:17:14.688458 (MainThread):   CREATE TABLE has columns with duplicate name rowguid at [8:6]
2021-05-29 17:17:14.689454 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 17:17:14.690451 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 17:17:14.691448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8D1AB948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8B3F4408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8CE8B5C8>]}
2021-05-29 17:17:14.692447 (MainThread): Flushing usage events
2021-05-29 17:17:37.882638 (MainThread): Running with dbt=0.19.1
2021-05-29 17:17:38.527397 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:17:38.528396 (MainThread): Tracking: tracking
2021-05-29 17:17:38.529358 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E636CD4488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E636CD4448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E636CD4888>]}
2021-05-29 17:17:38.548519 (MainThread): Partial parsing not enabled
2021-05-29 17:17:38.552600 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:17:38.592426 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:17:38.606395 (MainThread): Parsing macros\etc.sql
2021-05-29 17:17:38.610381 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:17:38.620355 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:17:38.645132 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:17:38.651156 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:17:38.655145 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:17:38.675093 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:17:38.686062 (MainThread): Parsing macros\core.sql
2021-05-29 17:17:38.695039 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:17:38.780773 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:17:38.798725 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:17:38.800755 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:17:38.804746 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:17:38.809696 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:17:38.813687 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:17:38.815716 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:17:38.835661 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:17:38.864584 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:17:38.868576 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:17:38.882503 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:17:38.932367 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:17:38.998192 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:17:39.002217 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:17:39.040082 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:17:39.055040 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:17:39.066012 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:17:39.081969 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:17:39.087955 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:17:39.091941 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:17:39.095931 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:17:39.110723 (MainThread): Partial parsing not enabled
2021-05-29 17:17:39.161670 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:17:39.183612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:17:39.191686 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:17:39.199661 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:17:39.207644 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:17:39.214623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:17:39.226592 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:17:39.233537 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:17:39.242513 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:17:39.250530 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:17:39.258507 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:17:39.266449 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:17:39.274427 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:17:39.282406 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:17:39.290385 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:17:39.298400 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:17:39.305381 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:17:39.326324 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:17:39.646595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3a7218d-6839-4b17-ab29-de8e6835c8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63A3CF788>]}
2021-05-29 17:17:39.663586 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a7218d-6839-4b17-ab29-de8e6835c8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E636CBBA08>]}
2021-05-29 17:17:39.664550 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:17:39.676513 (MainThread): 
2021-05-29 17:17:39.678508 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:17:39.680540 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:17:39.680900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:17:41.012066 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:17:41.013061 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:17:41.023036 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:17:42.339860 (MainThread): 14:17:42 | Concurrency: 1 threads (target='dev')
2021-05-29 17:17:42.341540 (MainThread): 14:17:42 | 
2021-05-29 17:17:42.346535 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:17:42.346535 (Thread-1): 14:17:42 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:17:42.347532 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:17:42.348528 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:17:42.362522 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:17:42.363506 (Thread-1): finished collecting timing info
2021-05-29 17:17:42.411391 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:17:42.420882 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:17:43.762811 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:17:43.763810 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk

            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:17:48.978848 (Thread-1): finished collecting timing info
2021-05-29 17:17:48.979810 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3a7218d-6839-4b17-ab29-de8e6835c8da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E638CA6E08>]}
2021-05-29 17:17:48.980811 (Thread-1): 14:17:48 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 6.63s]
2021-05-29 17:17:48.981806 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:17:49.084729 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:17:49.085725 (MainThread): 14:17:49 | 
2021-05-29 17:17:49.086722 (MainThread): 14:17:49 | Finished running 1 table model in 9.41s.
2021-05-29 17:17:49.087720 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:17:49.087720 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:17:49.087720 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:17:49.087720 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:17:49.112652 (MainThread): 
2021-05-29 17:17:49.113654 (MainThread): Completed successfully
2021-05-29 17:17:49.114646 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:17:49.116643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63A798B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63A798688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63A798508>]}
2021-05-29 17:17:49.117640 (MainThread): Flushing usage events
2021-05-29 17:22:14.118962 (MainThread): Running with dbt=0.19.1
2021-05-29 17:22:14.990714 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:22:14.992867 (MainThread): Tracking: tracking
2021-05-29 17:22:14.993664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22135688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2218E1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF2218E788>]}
2021-05-29 17:22:15.012652 (MainThread): Partial parsing not enabled
2021-05-29 17:22:15.016857 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:22:15.057350 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:22:15.072084 (MainThread): Parsing macros\etc.sql
2021-05-29 17:22:15.077967 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:22:15.087975 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:22:15.112746 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:22:15.118777 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:22:15.124090 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:22:15.146070 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:22:15.161994 (MainThread): Parsing macros\core.sql
2021-05-29 17:22:15.170479 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:22:15.268264 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:22:15.289884 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:22:15.293085 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:22:15.297879 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:22:15.305307 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:22:15.309319 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:22:15.313311 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:22:15.337089 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:22:15.372000 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:22:15.377986 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:22:15.393752 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:22:15.442956 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:22:15.527733 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:22:15.535716 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:22:15.581590 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:22:15.597050 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:22:15.609793 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:22:15.626779 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:22:15.634196 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:22:15.638188 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:22:15.643176 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:22:15.659633 (MainThread): Partial parsing not enabled
2021-05-29 17:22:15.712662 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:22:15.736271 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:22:15.745100 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:22:15.754965 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:22:15.763940 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:22:15.772767 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:22:15.786071 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:22:15.793921 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:22:15.804096 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:22:15.813331 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:22:15.821309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:22:15.830415 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:22:15.839309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:22:15.848939 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:22:15.856881 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:22:15.865756 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:22:15.874650 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:22:15.897581 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:22:16.297446 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dccb3b1-b413-4fe3-b6ed-ea324ef70e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF220E6508>]}
2021-05-29 17:22:16.314237 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dccb3b1-b413-4fe3-b6ed-ea324ef70e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22107448>]}
2021-05-29 17:22:16.315235 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:22:16.324213 (MainThread): 
2021-05-29 17:22:16.327203 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:22:16.329198 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:22:16.330197 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:22:17.254694 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:22:17.255720 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:22:17.267383 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:22:18.579008 (MainThread): 14:22:18 | Concurrency: 1 threads (target='dev')
2021-05-29 17:22:18.580890 (MainThread): 14:22:18 | 
2021-05-29 17:22:18.594864 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:22:18.595862 (Thread-1): 14:22:18 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:22:18.603848 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:22:18.606830 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:22:18.619826 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:22:18.621790 (Thread-1): finished collecting timing info
2021-05-29 17:22:18.666707 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:22:18.674685 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:22:20.050760 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:22:20.055729 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk

            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:22:26.506284 (Thread-1): finished collecting timing info
2021-05-29 17:22:26.507282 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dccb3b1-b413-4fe3-b6ed-ea324ef70e1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF220DCFC8>]}
2021-05-29 17:22:26.507282 (Thread-1): 14:22:26 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.90s]
2021-05-29 17:22:26.509341 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:22:26.565039 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:22:26.566114 (MainThread): 14:22:26 | 
2021-05-29 17:22:26.566913 (MainThread): 14:22:26 | Finished running 1 table model in 10.24s.
2021-05-29 17:22:26.567921 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:22:26.567921 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:22:26.567921 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:22:26.567921 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:22:26.585870 (MainThread): 
2021-05-29 17:22:26.588868 (MainThread): Completed successfully
2021-05-29 17:22:26.590806 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:22:26.592876 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1F2D4AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF259F86C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF22109988>]}
2021-05-29 17:22:26.593878 (MainThread): Flushing usage events
2021-05-29 17:23:26.608564 (MainThread): Running with dbt=0.19.1
2021-05-29 17:23:27.398147 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:23:27.399925 (MainThread): Tracking: tracking
2021-05-29 17:23:27.400718 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A8F5808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A8F5908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A8F56C8>]}
2021-05-29 17:23:27.422994 (MainThread): Partial parsing not enabled
2021-05-29 17:23:27.426818 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:23:27.474116 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:23:27.487087 (MainThread): Parsing macros\etc.sql
2021-05-29 17:23:27.492360 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:23:27.503376 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:23:27.528314 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:23:27.534335 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:23:27.538968 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:23:27.559096 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:23:27.570665 (MainThread): Parsing macros\core.sql
2021-05-29 17:23:27.578858 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:23:27.670609 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:23:27.689340 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:23:27.692433 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:23:27.696825 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:23:27.701743 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:23:27.705735 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:23:27.708729 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:23:27.727677 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:23:27.755602 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:23:27.763582 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:23:27.779538 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:23:27.850351 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:23:27.946272 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:23:27.951264 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:23:27.985379 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:23:28.001128 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:23:28.012434 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:23:28.027398 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:23:28.033385 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:23:28.037356 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:23:28.042266 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:23:28.057204 (MainThread): Partial parsing not enabled
2021-05-29 17:23:28.107392 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:23:28.129633 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:23:28.137649 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:23:28.147564 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:23:28.156570 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:23:28.166068 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:23:28.179754 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:23:28.188169 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:23:28.197588 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:23:28.206644 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:23:28.214623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:23:28.223446 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:23:28.231424 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:23:28.239391 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:23:28.247868 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:23:28.261012 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:23:28.270681 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:23:28.291589 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:23:28.614950 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '771d7127-9eba-4046-9ccb-0450e06483b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A88F6C8>]}
2021-05-29 17:23:28.631903 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '771d7127-9eba-4046-9ccb-0450e06483b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A94BB08>]}
2021-05-29 17:23:28.632655 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:23:28.639591 (MainThread): 
2021-05-29 17:23:28.640589 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:23:28.645116 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:23:28.645116 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:23:29.460721 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:23:29.461717 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:23:29.476678 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:23:30.200801 (MainThread): 14:23:30 | Concurrency: 1 threads (target='dev')
2021-05-29 17:23:30.202786 (MainThread): 14:23:30 | 
2021-05-29 17:23:30.220736 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:23:30.220736 (Thread-1): 14:23:30 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:23:30.223728 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:23:30.224722 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:23:30.241677 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:23:30.243675 (Thread-1): finished collecting timing info
2021-05-29 17:23:30.331436 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:23:30.343405 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:23:31.684484 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:23:31.686480 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk

            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid

    )

select * from order_detail_with_sk
  );
    
2021-05-29 17:23:35.607807 (Thread-1): finished collecting timing info
2021-05-29 17:23:35.608805 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771d7127-9eba-4046-9ccb-0450e06483b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A37AA6088>]}
2021-05-29 17:23:35.609800 (Thread-1): 14:23:35 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 14.5 MB processed) in 5.39s]
2021-05-29 17:23:35.611794 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:23:35.674208 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:23:35.674208 (MainThread): 14:23:35 | 
2021-05-29 17:23:35.675201 (MainThread): 14:23:35 | Finished running 1 table model in 7.03s.
2021-05-29 17:23:35.676203 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:23:35.676203 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:23:35.676203 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:23:35.676203 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:23:35.694148 (MainThread): 
2021-05-29 17:23:35.695195 (MainThread): Completed successfully
2021-05-29 17:23:35.696550 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:23:35.697552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A37AA4B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A97D748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A3A929688>]}
2021-05-29 17:23:35.698588 (MainThread): Flushing usage events
2021-05-29 17:24:13.357682 (MainThread): Running with dbt=0.19.1
2021-05-29 17:24:14.159640 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:24:14.160598 (MainThread): Tracking: tracking
2021-05-29 17:24:14.161630 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDBE5988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDB84248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDB84308>]}
2021-05-29 17:24:14.180576 (MainThread): Partial parsing not enabled
2021-05-29 17:24:14.195108 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:24:14.239059 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:24:14.253296 (MainThread): Parsing macros\etc.sql
2021-05-29 17:24:14.259288 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:24:14.269056 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:24:14.294128 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:24:14.301217 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:24:14.306243 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:24:14.328571 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:24:14.340741 (MainThread): Parsing macros\core.sql
2021-05-29 17:24:14.349720 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:24:14.437828 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:24:14.458780 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:24:14.462985 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:24:14.467613 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:24:14.471993 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:24:14.476384 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:24:14.479768 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:24:14.499537 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:24:14.528761 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:24:14.533772 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:24:14.550495 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:24:14.605351 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:24:14.715059 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:24:14.764783 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:24:14.857137 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:24:14.929296 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:24:14.972344 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:24:15.039343 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:24:15.051323 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:24:15.058233 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:24:15.062926 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:24:15.077732 (MainThread): Partial parsing not enabled
2021-05-29 17:24:15.127841 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:24:15.149809 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:24:15.157977 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:24:15.167113 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:24:15.175501 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:24:15.183631 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:24:15.195381 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:24:15.204098 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:24:15.214073 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:24:15.221970 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:24:15.230186 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:24:15.238148 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:24:15.246914 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:24:15.254777 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:24:15.269249 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:24:15.293667 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:24:15.308478 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:24:15.331415 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:24:15.682763 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfbb7dd2-bad1-4871-9856-015a078a9f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDB33388>]}
2021-05-29 17:24:15.698782 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfbb7dd2-bad1-4871-9856-015a078a9f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDB56248>]}
2021-05-29 17:24:15.698782 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:24:15.707761 (MainThread): 
2021-05-29 17:24:15.710749 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:24:15.712745 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:24:15.713744 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:24:16.500973 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:24:16.501997 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:24:16.514405 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:24:17.836722 (MainThread): 14:24:17 | Concurrency: 1 threads (target='dev')
2021-05-29 17:24:17.837843 (MainThread): 14:24:17 | 
2021-05-29 17:24:17.845828 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:24:17.846824 (Thread-1): 14:24:17 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:24:17.849840 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:24:17.850816 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:24:17.860790 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:24:17.863782 (Thread-1): finished collecting timing info
2021-05-29 17:24:17.910690 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:24:17.918533 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:24:18.667909 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:24:18.669902 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk

            from orders_with_sk

            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid

    )

select * from orders_with_sk
  );
    
2021-05-29 17:24:22.585965 (Thread-1): finished collecting timing info
2021-05-29 17:24:22.586962 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfbb7dd2-bad1-4871-9856-015a078a9f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADF9401C8>]}
2021-05-29 17:24:22.587960 (Thread-1): 14:24:22 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (31.5k rows, 8.2 MB processed) in 4.74s]
2021-05-29 17:24:22.598929 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:24:22.686399 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:24:22.686399 (MainThread): 14:24:22 | 
2021-05-29 17:24:22.687397 (MainThread): 14:24:22 | Finished running 1 table model in 6.98s.
2021-05-29 17:24:22.689394 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:24:22.689394 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:24:22.689394 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:24:22.690390 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:24:22.709354 (MainThread): 
2021-05-29 17:24:22.710338 (MainThread): Completed successfully
2021-05-29 17:24:22.711333 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:24:22.713330 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADF962088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDC11808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ADDB39A48>]}
2021-05-29 17:24:22.714326 (MainThread): Flushing usage events
2021-05-29 17:31:59.641230 (MainThread): Running with dbt=0.19.1
2021-05-29 17:32:00.493735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:32:00.495923 (MainThread): Tracking: tracking
2021-05-29 17:32:00.497927 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7CA588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7CA548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7CA748>]}
2021-05-29 17:32:00.521513 (MainThread): Partial parsing not enabled
2021-05-29 17:32:00.527702 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:32:00.577497 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:32:00.591465 (MainThread): Parsing macros\etc.sql
2021-05-29 17:32:00.598191 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:32:00.608346 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:32:00.635280 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:32:00.645251 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:32:00.650737 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:32:00.671392 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:32:00.687527 (MainThread): Parsing macros\core.sql
2021-05-29 17:32:00.696493 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:32:00.791027 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:32:00.809053 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:32:00.812698 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:32:00.817388 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:32:00.822379 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:32:00.825370 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:32:00.828635 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:32:00.848444 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:32:00.877963 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:32:00.882634 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:32:00.897241 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:32:00.951101 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:32:01.025595 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:32:01.031584 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:32:01.066500 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:32:01.081595 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:32:01.092302 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:32:01.105733 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:32:01.111721 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:32:01.116248 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:32:01.121199 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:32:01.134201 (MainThread): Partial parsing not enabled
2021-05-29 17:32:01.182669 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:32:01.202612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:32:01.210976 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:32:01.219941 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:32:01.228743 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:32:01.236724 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:32:01.248839 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:32:01.258047 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:32:01.268066 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:32:01.276230 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:32:01.284734 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:32:01.292884 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:32:01.302126 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:32:01.311330 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:32:01.319233 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:32:01.328432 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:32:01.338028 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:32:01.359512 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:32:01.689609 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96528cba-c9fe-439b-9d74-5d4d640f08d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7830C8>]}
2021-05-29 17:32:01.705857 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96528cba-c9fe-439b-9d74-5d4d640f08d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7A6488>]}
2021-05-29 17:32:01.706822 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:32:01.713803 (MainThread): 
2021-05-29 17:32:01.714799 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:32:01.719822 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:32:01.719822 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:32:03.343565 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:32:03.344573 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:32:03.357536 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:32:04.664665 (MainThread): 14:32:04 | Concurrency: 1 threads (target='dev')
2021-05-29 17:32:04.667404 (MainThread): 14:32:04 | 
2021-05-29 17:32:04.679368 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:32:04.682379 (Thread-1): 14:32:04 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:32:04.683358 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:32:04.684356 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:32:04.700316 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:32:04.705299 (Thread-1): finished collecting timing info
2021-05-29 17:32:04.744228 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:32:04.752826 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:32:06.092224 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:32:06.094925 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from orders_with_sk
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:32:11.973717 (Thread-1): finished collecting timing info
2021-05-29 17:32:11.974712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96528cba-c9fe-439b-9d74-5d4d640f08d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A7A85C8>]}
2021-05-29 17:32:11.974712 (Thread-1): 14:32:11 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.29s]
2021-05-29 17:32:11.977709 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:32:12.017504 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:32:12.019503 (MainThread): 14:32:12 | 
2021-05-29 17:32:12.020496 (MainThread): 14:32:12 | Finished running 1 table model in 10.30s.
2021-05-29 17:32:12.021493 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:32:12.021493 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:32:12.021493 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:32:12.022490 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:32:12.054406 (MainThread): 
2021-05-29 17:32:12.055403 (MainThread): Completed successfully
2021-05-29 17:32:12.056403 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:32:12.057400 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A805C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A834D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975A788648>]}
2021-05-29 17:32:12.058394 (MainThread): Flushing usage events
2021-05-29 17:32:59.973104 (MainThread): Running with dbt=0.19.1
2021-05-29 17:33:00.811609 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:33:00.812607 (MainThread): Tracking: tracking
2021-05-29 17:33:00.813605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EF4748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EF46C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EF4848>]}
2021-05-29 17:33:00.833126 (MainThread): Partial parsing not enabled
2021-05-29 17:33:00.836603 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:33:00.876577 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:33:00.888587 (MainThread): Parsing macros\etc.sql
2021-05-29 17:33:00.893897 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:33:00.904081 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:33:00.931030 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:33:00.937033 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:33:00.942981 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:33:00.968337 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:33:00.979531 (MainThread): Parsing macros\core.sql
2021-05-29 17:33:00.988512 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:33:01.073953 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:33:01.092188 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:33:01.094949 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:33:01.098943 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:33:01.103930 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:33:01.107919 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:33:01.110760 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:33:01.129795 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:33:01.157758 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:33:01.162696 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:33:01.176184 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:33:01.220452 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:33:01.290565 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:33:01.295789 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:33:01.332025 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:33:01.346674 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:33:01.359758 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:33:01.373727 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:33:01.380705 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:33:01.384695 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:33:01.391679 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:33:01.409629 (MainThread): Partial parsing not enabled
2021-05-29 17:33:01.458606 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:33:01.479310 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:33:01.487851 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:33:01.497095 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:33:01.505727 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:33:01.513708 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:33:01.527243 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:33:01.536708 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:33:01.545683 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:33:01.554038 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:33:01.563582 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:33:01.572281 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:33:01.580879 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:33:01.589434 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:33:01.598408 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:33:01.606386 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:33:01.615157 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:33:01.635103 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:33:01.951673 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a972f53-8a8a-43d4-8425-8fed20d979c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EA49C8>]}
2021-05-29 17:33:01.968628 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a972f53-8a8a-43d4-8425-8fed20d979c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EC71C8>]}
2021-05-29 17:33:01.968628 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:33:01.975609 (MainThread): 
2021-05-29 17:33:01.976643 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:33:01.978601 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:33:01.978601 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:33:03.306844 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:33:03.307779 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:33:03.318751 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:33:04.616918 (MainThread): 14:33:04 | Concurrency: 1 threads (target='dev')
2021-05-29 17:33:04.617847 (MainThread): 14:33:04 | 
2021-05-29 17:33:04.626824 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:33:04.627822 (Thread-1): 14:33:04 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:33:04.628819 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:33:04.628819 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:33:04.636831 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:33:04.638607 (Thread-1): finished collecting timing info
2021-05-29 17:33:04.672558 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:33:04.680536 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:33:06.018439 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:33:06.020405 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            orders_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from orders_with_sk
            left join reason_with_sk on orders_with_sk.salesorderid = reason_with_sk.salesorderid
            left join order_detail_with_sk on orders_with_sk.salesorderid = order_detail_with_sk.salesorderid
    )

select * from orders_with_sk
  );
    
2021-05-29 17:33:10.035726 (Thread-1): finished collecting timing info
2021-05-29 17:33:10.036723 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a972f53-8a8a-43d4-8425-8fed20d979c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A7024348>]}
2021-05-29 17:33:10.036723 (Thread-1): 14:33:10 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (31.5k rows, 8.2 MB processed) in 5.41s]
2021-05-29 17:33:10.038709 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:33:10.078341 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:33:10.079342 (MainThread): 14:33:10 | 
2021-05-29 17:33:10.079864 (MainThread): 14:33:10 | Finished running 1 table model in 8.10s.
2021-05-29 17:33:10.080886 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:33:10.080886 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:33:10.080886 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:33:10.080886 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:33:10.094849 (MainThread): 
2021-05-29 17:33:10.095845 (MainThread): Completed successfully
2021-05-29 17:33:10.096841 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:33:10.097838 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EE2808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A4EB7C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167A8A33C88>]}
2021-05-29 17:33:10.098837 (MainThread): Flushing usage events
2021-05-29 17:34:26.202986 (MainThread): Running with dbt=0.19.1
2021-05-29 17:34:26.859899 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:34:26.860863 (MainThread): Tracking: tracking
2021-05-29 17:34:26.860863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1A54288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1A54508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1A54588>]}
2021-05-29 17:34:26.881278 (MainThread): Partial parsing not enabled
2021-05-29 17:34:26.884273 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:34:26.922750 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:34:26.936222 (MainThread): Parsing macros\etc.sql
2021-05-29 17:34:26.941009 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:34:26.951365 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:34:26.976331 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:34:26.983003 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:34:26.986995 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:34:27.006348 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:34:27.018239 (MainThread): Parsing macros\core.sql
2021-05-29 17:34:27.028255 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:34:27.120498 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:34:27.138939 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:34:27.141484 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:34:27.145511 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:34:27.151500 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:34:27.155650 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:34:27.158664 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:34:27.177481 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:34:27.208061 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:34:27.212060 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:34:27.225478 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:34:27.269456 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:34:27.335848 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:34:27.340838 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:34:27.380766 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:34:27.397841 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:34:27.408846 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:34:27.424144 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:34:27.430536 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:34:27.434479 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:34:27.438975 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:34:27.453882 (MainThread): Partial parsing not enabled
2021-05-29 17:34:27.500473 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:34:27.520147 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:34:27.528063 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:34:27.536701 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:34:27.544470 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:34:27.553323 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:34:27.564663 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:34:27.572640 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:34:27.581617 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:34:27.590274 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:34:27.598641 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:34:27.606354 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:34:27.614333 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:34:27.621994 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:34:27.630566 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:34:27.638590 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:34:27.646568 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:34:27.666478 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:34:27.984665 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f30b51f-118a-43ea-ba01-320215dba1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C514F708>]}
2021-05-29 17:34:28.000585 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f30b51f-118a-43ea-ba01-320215dba1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1A3CCC8>]}
2021-05-29 17:34:28.000585 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:34:28.013376 (MainThread): 
2021-05-29 17:34:28.014247 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:34:28.016514 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:34:28.016514 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:34:29.366946 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:34:29.366946 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:34:29.375341 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:34:30.694748 (MainThread): 14:34:30 | Concurrency: 1 threads (target='dev')
2021-05-29 17:34:30.695745 (MainThread): 14:34:30 | 
2021-05-29 17:34:30.701729 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:34:30.702727 (Thread-1): 14:34:30 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:34:30.704722 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:34:30.705720 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:34:30.718683 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:34:30.719680 (Thread-1): finished collecting timing info
2021-05-29 17:34:30.768550 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:34:30.777525 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:34:32.161020 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:34:32.162017 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from order_detail_with_sk
  );
    
2021-05-29 17:34:36.859934 (Thread-1): finished collecting timing info
2021-05-29 17:34:36.860931 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f30b51f-118a-43ea-ba01-320215dba1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1C873C8>]}
2021-05-29 17:34:36.860931 (Thread-1): 14:34:36 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 14.5 MB processed) in 6.16s]
2021-05-29 17:34:36.862891 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:34:36.912258 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:34:36.913268 (MainThread): 14:34:36 | 
2021-05-29 17:34:36.914185 (MainThread): 14:34:36 | Finished running 1 table model in 8.90s.
2021-05-29 17:34:36.915188 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:34:36.915188 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:34:36.915188 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:34:36.915188 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:34:36.931186 (MainThread): 
2021-05-29 17:34:36.932305 (MainThread): Completed successfully
2021-05-29 17:34:36.933585 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:34:36.934595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1A10148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C1C873C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0C3A1C788>]}
2021-05-29 17:34:36.934595 (MainThread): Flushing usage events
2021-05-29 17:35:14.317524 (MainThread): Running with dbt=0.19.1
2021-05-29 17:35:15.024635 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:35:15.025634 (MainThread): Tracking: tracking
2021-05-29 17:35:15.026631 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4E3F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4E5788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4E5648>]}
2021-05-29 17:35:15.046101 (MainThread): Partial parsing not enabled
2021-05-29 17:35:15.048968 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:35:15.090688 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:35:15.103695 (MainThread): Parsing macros\etc.sql
2021-05-29 17:35:15.107682 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:35:15.116665 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:35:15.141559 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:35:15.148539 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:35:15.152529 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:35:15.172475 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:35:15.183444 (MainThread): Parsing macros\core.sql
2021-05-29 17:35:15.191424 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:35:15.276196 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:35:15.294149 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:35:15.296571 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:35:15.300670 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:35:15.305347 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:35:15.309342 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:35:15.312093 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:35:15.331987 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:35:15.361547 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:35:15.365579 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:35:15.380537 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:35:15.422426 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:35:15.489244 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:35:15.493237 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:35:15.530103 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:35:15.546060 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:35:15.556068 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:35:15.570993 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:35:15.577974 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:35:15.581963 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:35:15.586950 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:35:15.602905 (MainThread): Partial parsing not enabled
2021-05-29 17:35:15.651777 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:35:15.673716 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:35:15.684689 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:35:15.696657 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:35:15.704635 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:35:15.712614 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:35:15.726577 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:35:15.734588 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:35:15.744002 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:35:15.751984 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:35:15.761086 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:35:15.769064 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:35:15.776892 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:35:15.784625 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:35:15.793438 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:35:15.801553 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:35:15.809534 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:35:15.832738 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:35:16.150511 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f03d1d-ef6e-4468-b7b8-673e8ebce449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C497188>]}
2021-05-29 17:35:16.169460 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f03d1d-ef6e-4468-b7b8-673e8ebce449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4BA388>]}
2021-05-29 17:35:16.169460 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:35:16.182424 (MainThread): 
2021-05-29 17:35:16.183422 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:35:16.186417 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:35:16.187411 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:35:17.524099 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:35:17.525186 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:35:17.533823 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:35:18.834950 (MainThread): 14:35:18 | Concurrency: 1 threads (target='dev')
2021-05-29 17:35:18.838057 (MainThread): 14:35:18 | 
2021-05-29 17:35:18.849021 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:35:18.850019 (Thread-1): 14:35:18 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:35:18.853011 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:35:18.853011 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:35:18.870029 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:35:18.873957 (Thread-1): finished collecting timing info
2021-05-29 17:35:18.921862 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:35:18.929840 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:35:20.262162 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:35:20.264157 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:35:26.678799 (Thread-1): finished collecting timing info
2021-05-29 17:35:26.679799 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60f03d1d-ef6e-4468-b7b8-673e8ebce449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C574448>]}
2021-05-29 17:35:26.679799 (Thread-1): 14:35:26 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.83s]
2021-05-29 17:35:26.682240 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:35:26.686260 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:35:26.686260 (MainThread): 14:35:26 | 
2021-05-29 17:35:26.687261 (MainThread): 14:35:26 | Finished running 1 table model in 10.50s.
2021-05-29 17:35:26.688220 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:35:26.688220 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:35:26.689219 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:35:26.689219 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:35:26.708169 (MainThread): 
2021-05-29 17:35:26.709164 (MainThread): Completed successfully
2021-05-29 17:35:26.710160 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:35:26.715148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4F5788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4CA108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992C4CAB48>]}
2021-05-29 17:35:26.715148 (MainThread): Flushing usage events
2021-05-29 17:37:31.370341 (MainThread): Running with dbt=0.19.1
2021-05-29 17:37:32.904755 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:37:32.913730 (MainThread): Tracking: tracking
2021-05-29 17:37:32.915726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD17F788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD27EE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD27E608>]}
2021-05-29 17:37:32.953624 (MainThread): Partial parsing not enabled
2021-05-29 17:37:32.959608 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:37:33.050366 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:37:33.073304 (MainThread): Parsing macros\etc.sql
2021-05-29 17:37:33.083278 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:37:33.101230 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:37:33.157080 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:37:33.166057 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:37:33.174036 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:37:33.219911 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:37:33.243849 (MainThread): Parsing macros\core.sql
2021-05-29 17:37:33.255816 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:37:33.433341 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:37:33.475229 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:37:33.480216 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:37:33.486200 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:37:33.495175 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:37:33.503181 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:37:33.509139 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:37:33.548035 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:37:33.608872 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:37:33.618846 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:37:33.639791 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:37:33.723565 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:37:33.835275 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:37:33.844250 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:37:33.916059 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:37:33.942987 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:37:33.962933 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:37:33.989861 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:37:34.000831 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:37:34.005819 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:37:34.011803 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:37:34.032747 (MainThread): Partial parsing not enabled
2021-05-29 17:37:34.141456 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:37:34.192319 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:37:34.208276 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:37:34.239193 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:37:34.257657 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:37:34.283587 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:37:34.310515 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:37:34.326474 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:37:34.351416 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:37:34.368360 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:37:34.402271 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:37:34.419225 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:37:34.446152 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:37:34.464104 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:37:34.503998 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:37:34.520952 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:37:34.591763 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:37:34.679528 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:37:35.695162 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '020a084e-21b9-436f-9bd3-eb92f92ff3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD233A48>]}
2021-05-29 17:37:35.728075 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '020a084e-21b9-436f-9bd3-eb92f92ff3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD258308>]}
2021-05-29 17:37:35.729073 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:37:35.741039 (MainThread): 
2021-05-29 17:37:35.742037 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:37:35.744031 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:37:35.745029 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:37:36.692706 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:37:36.693703 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:37:36.709661 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:37:37.530040 (MainThread): 14:37:37 | Concurrency: 1 threads (target='dev')
2021-05-29 17:37:37.532034 (MainThread): 14:37:37 | 
2021-05-29 17:37:37.546995 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:37:37.546995 (Thread-1): 14:37:37 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:37:37.548992 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:37:37.549987 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:37:37.571927 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:37:37.574921 (Thread-1): finished collecting timing info
2021-05-29 17:37:37.692605 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:37:37.709566 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:37:39.131354 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:37:39.134347 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid
            inner join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:37:45.343221 (Thread-1): finished collecting timing info
2021-05-29 17:37:45.344220 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '020a084e-21b9-436f-9bd3-eb92f92ff3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DEC959C8>]}
2021-05-29 17:37:45.345217 (Thread-1): 14:37:45 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.80s]
2021-05-29 17:37:45.347212 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:37:45.452152 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:37:45.453150 (MainThread): 14:37:45 | 
2021-05-29 17:37:45.454146 (MainThread): 14:37:45 | Finished running 1 table model in 9.71s.
2021-05-29 17:37:45.455145 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:37:45.456143 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:37:45.456143 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:37:45.456143 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:37:45.488317 (MainThread): 
2021-05-29 17:37:45.489311 (MainThread): Completed successfully
2021-05-29 17:37:45.490313 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:37:45.491306 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD27EBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD27E048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149DD23D748>]}
2021-05-29 17:37:45.492303 (MainThread): Flushing usage events
2021-05-29 17:39:58.821341 (MainThread): Running with dbt=0.19.1
2021-05-29 17:39:59.754911 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:39:59.755908 (MainThread): Tracking: tracking
2021-05-29 17:39:59.757908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFC6FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFD35C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFD36C8>]}
2021-05-29 17:39:59.779814 (MainThread): Partial parsing not enabled
2021-05-29 17:39:59.783489 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:39:59.824698 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:39:59.837668 (MainThread): Parsing macros\etc.sql
2021-05-29 17:39:59.842710 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:39:59.853685 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:39:59.880612 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:39:59.886597 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:39:59.891390 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:39:59.912613 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:39:59.924750 (MainThread): Parsing macros\core.sql
2021-05-29 17:39:59.933392 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:40:00.033130 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:40:00.065044 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:40:00.068035 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:40:00.075018 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:40:00.080003 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:40:00.083992 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:40:00.088980 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:40:00.116906 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:40:00.147822 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:40:00.152809 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:40:00.166773 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:40:00.229381 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:40:00.403919 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:40:00.415886 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:40:00.734036 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:40:00.770936 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:40:00.798861 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:40:00.832771 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:40:00.846735 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:40:00.856708 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:40:00.869676 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:40:00.909566 (MainThread): Partial parsing not enabled
2021-05-29 17:40:01.042210 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:40:01.121997 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:40:01.143938 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:40:01.182834 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:40:01.223727 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:40:01.246668 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:40:01.307501 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:40:01.346399 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:40:01.376319 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:40:01.437155 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:40:01.562819 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:40:01.654573 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:40:01.796201 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:40:01.855037 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:40:01.914879 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:40:01.941805 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:40:01.971724 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:40:02.083426 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:40:02.653516 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82bae905-59fe-42b7-b749-f593822cf9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BF87848>]}
2021-05-29 17:40:02.713357 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82bae905-59fe-42b7-b749-f593822cf9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFA6408>]}
2021-05-29 17:40:02.713357 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:40:02.734300 (MainThread): 
2021-05-29 17:40:02.738309 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:40:02.745271 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:40:02.745271 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:40:04.179559 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:40:04.180513 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:40:04.198468 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:40:04.937255 (MainThread): 14:40:04 | Concurrency: 1 threads (target='dev')
2021-05-29 17:40:04.938253 (MainThread): 14:40:04 | 
2021-05-29 17:40:04.945236 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:40:04.945236 (Thread-1): 14:40:04 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:40:04.946230 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:40:04.947229 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:40:04.957203 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:40:04.959200 (Thread-1): finished collecting timing info
2021-05-29 17:40:04.999090 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:40:05.012054 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:40:05.814927 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:40:05.816921 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
where salesorderid <= 31465
  );
    
2021-05-29 17:40:09.365062 (Thread-1): finished collecting timing info
2021-05-29 17:40:09.365062 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82bae905-59fe-42b7-b749-f593822cf9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65C06C5C8>]}
2021-05-29 17:40:09.366058 (Thread-1): 14:40:09 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (0.0 rows, 17.8 MB processed) in 4.42s]
2021-05-29 17:40:09.373010 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:40:09.393050 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:40:09.394049 (MainThread): 14:40:09 | 
2021-05-29 17:40:09.395045 (MainThread): 14:40:09 | Finished running 1 table model in 6.66s.
2021-05-29 17:40:09.396041 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:40:09.397063 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:40:09.397063 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:40:09.397063 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:40:09.413992 (MainThread): 
2021-05-29 17:40:09.413992 (MainThread): Completed successfully
2021-05-29 17:40:09.415983 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:40:09.416985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFBBA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65D166208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65BFAA488>]}
2021-05-29 17:40:09.416985 (MainThread): Flushing usage events
2021-05-29 17:40:58.280844 (MainThread): Running with dbt=0.19.1
2021-05-29 17:40:59.071966 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:40:59.072964 (MainThread): Tracking: tracking
2021-05-29 17:40:59.073962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB6825C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB682608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB6823C8>]}
2021-05-29 17:40:59.092909 (MainThread): Partial parsing not enabled
2021-05-29 17:40:59.096036 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:40:59.137152 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:40:59.151120 (MainThread): Parsing macros\etc.sql
2021-05-29 17:40:59.156484 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:40:59.166722 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:40:59.192695 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:40:59.198642 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:40:59.202632 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:40:59.222990 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:40:59.234518 (MainThread): Parsing macros\core.sql
2021-05-29 17:40:59.243499 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:40:59.331219 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:40:59.351387 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:40:59.354556 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:40:59.359205 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:40:59.364048 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:40:59.368340 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:40:59.371334 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:40:59.390701 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:40:59.418800 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:40:59.423818 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:40:59.437753 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:40:59.479980 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:40:59.545898 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:40:59.550891 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:40:59.592821 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:40:59.610244 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:40:59.621581 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:40:59.635179 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:40:59.641128 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:40:59.646119 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:40:59.651066 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:40:59.665989 (MainThread): Partial parsing not enabled
2021-05-29 17:40:59.715674 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:40:59.736361 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:40:59.745055 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:40:59.754159 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:40:59.764327 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:40:59.772305 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:40:59.784338 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:40:59.793249 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:40:59.803221 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:40:59.811488 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:40:59.832538 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:40:59.855921 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:40:59.869651 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:40:59.877595 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:40:59.886913 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:40:59.894857 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:40:59.904119 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:40:59.925066 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:41:00.281486 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61262bca-c1d6-4fdd-acc6-34c43e324422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB6332C8>]}
2021-05-29 17:41:00.297442 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61262bca-c1d6-4fdd-acc6-34c43e324422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB658488>]}
2021-05-29 17:41:00.297442 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:41:00.304423 (MainThread): 
2021-05-29 17:41:00.305422 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:41:00.307418 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:41:00.308434 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:41:01.102056 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:41:01.103060 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:41:01.115641 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:41:02.516365 (MainThread): 14:41:02 | Concurrency: 1 threads (target='dev')
2021-05-29 17:41:02.517364 (MainThread): 14:41:02 | 
2021-05-29 17:41:02.522350 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:41:02.523348 (Thread-1): 14:41:02 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:41:02.524344 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:41:02.524344 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:41:02.536313 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:41:02.537311 (Thread-1): finished collecting timing info
2021-05-29 17:41:02.575207 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:41:02.583237 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:41:03.426151 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:41:03.430138 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            , reason_with_sk.salesreason_fk
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 17:41:10.884430 (Thread-1): finished collecting timing info
2021-05-29 17:41:10.885423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61262bca-c1d6-4fdd-acc6-34c43e324422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FF33E9C8>]}
2021-05-29 17:41:10.886421 (Thread-1): 14:41:10 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 8.36s]
2021-05-29 17:41:10.888372 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:41:10.891364 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:41:10.894374 (MainThread): 14:41:10 | 
2021-05-29 17:41:10.898358 (MainThread): 14:41:10 | Finished running 1 table model in 10.59s.
2021-05-29 17:41:10.899350 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:41:10.900341 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:41:10.900341 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:41:10.900341 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:41:10.923279 (MainThread): 
2021-05-29 17:41:10.924277 (MainThread): Completed successfully
2021-05-29 17:41:10.925274 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:41:10.928273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB65AC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB65A508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FB65AA48>]}
2021-05-29 17:41:10.929266 (MainThread): Flushing usage events
2021-05-29 17:45:34.182927 (MainThread): Running with dbt=0.19.1
2021-05-29 17:45:36.817958 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:45:36.820950 (MainThread): Tracking: tracking
2021-05-29 17:45:36.821948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F59A45088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F599E7508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F599E7408>]}
2021-05-29 17:45:36.860844 (MainThread): Partial parsing not enabled
2021-05-29 17:45:36.867825 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:45:36.939633 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:45:36.958582 (MainThread): Parsing macros\etc.sql
2021-05-29 17:45:36.965563 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:45:36.981522 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:45:37.021415 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:45:37.031393 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:45:37.040365 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:45:37.078262 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:45:37.097211 (MainThread): Parsing macros\core.sql
2021-05-29 17:45:37.110176 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:45:37.638764 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:45:37.762435 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:45:37.767421 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:45:37.775398 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:45:37.782381 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:45:37.788366 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:45:37.793351 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:45:37.834241 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:45:37.902062 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:45:37.914028 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:45:37.948934 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:45:38.014761 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:45:38.123470 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:45:38.129454 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:45:38.180316 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:45:38.212231 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:45:38.231181 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:45:38.252125 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:45:38.264092 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:45:38.268312 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:45:38.274301 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:45:38.292297 (MainThread): Partial parsing not enabled
2021-05-29 17:45:38.354527 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:45:38.380378 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:45:38.391489 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:45:38.401764 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:45:38.412114 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:45:38.423085 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:45:38.451900 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:45:38.462668 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:45:38.474036 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:45:38.483848 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:45:38.494820 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:45:38.503796 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:45:38.517726 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:45:38.528696 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:45:38.537968 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:45:38.549110 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:45:38.567891 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:45:38.595587 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:45:39.114005 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e5a722-c2cf-47d1-af80-241e346153e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5D0DF6C8>]}
2021-05-29 17:45:39.134951 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e5a722-c2cf-47d1-af80-241e346153e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F599CBC48>]}
2021-05-29 17:45:39.134951 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:45:39.145975 (MainThread): 
2021-05-29 17:45:39.146973 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:45:39.148970 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:45:39.149970 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:45:40.886821 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:45:40.886821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:45:40.901782 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:45:41.667233 (MainThread): 14:45:41 | Concurrency: 1 threads (target='dev')
2021-05-29 17:45:41.669463 (MainThread): 14:45:41 | 
2021-05-29 17:45:41.890688 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:45:41.890688 (Thread-1): 14:45:41 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:45:41.893680 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:45:41.893680 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:45:41.904651 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:45:42.058494 (Thread-1): finished collecting timing info
2021-05-29 17:45:42.173187 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:45:42.182162 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:45:43.539516 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:45:43.541122 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk


    )

select * from final
  );
    
2021-05-29 17:45:47.548789 (Thread-1): finished collecting timing info
2021-05-29 17:45:47.549787 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e5a722-c2cf-47d1-af80-241e346153e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F59A19708>]}
2021-05-29 17:45:47.550782 (Thread-1): 14:45:47 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 9.2 MB processed) in 5.66s]
2021-05-29 17:45:47.559250 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:45:47.671917 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:45:47.673910 (MainThread): 14:45:47 | 
2021-05-29 17:45:47.675894 (MainThread): 14:45:47 | Finished running 1 table model in 8.53s.
2021-05-29 17:45:47.678890 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:45:47.679890 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:45:47.680884 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:45:47.681880 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:45:47.716648 (MainThread): 
2021-05-29 17:45:47.717652 (MainThread): Completed successfully
2021-05-29 17:45:47.718650 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:45:47.719644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5D6913C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5BAA1E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F56BC6048>]}
2021-05-29 17:45:47.720640 (MainThread): Flushing usage events
2021-05-29 17:46:41.965974 (MainThread): Running with dbt=0.19.1
2021-05-29 17:46:42.768723 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:46:42.769721 (MainThread): Tracking: tracking
2021-05-29 17:46:42.771243 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101094E648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210125E9048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210109B5948>]}
2021-05-29 17:46:42.792190 (MainThread): Partial parsing not enabled
2021-05-29 17:46:42.795182 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:46:42.835166 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:46:42.848293 (MainThread): Parsing macros\etc.sql
2021-05-29 17:46:42.854879 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:46:42.865183 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:46:42.892840 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:46:42.902845 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:46:42.908265 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:46:42.927947 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:46:42.938697 (MainThread): Parsing macros\core.sql
2021-05-29 17:46:42.947065 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:46:43.034698 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:46:43.053701 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:46:43.056631 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:46:43.063400 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:46:43.068391 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:46:43.072771 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:46:43.075766 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:46:43.095478 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:46:43.124004 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:46:43.128755 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:46:43.143336 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:46:43.189323 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:46:43.263777 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:46:43.268615 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:46:43.304301 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:46:43.319497 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:46:43.330615 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:46:43.344316 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:46:43.351130 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:46:43.355134 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:46:43.359792 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:46:43.374296 (MainThread): Partial parsing not enabled
2021-05-29 17:46:43.418721 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:46:43.440977 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:46:43.450089 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:46:43.460067 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:46:43.468812 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:46:43.477208 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:46:43.489986 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:46:43.497974 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:46:43.507370 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:46:43.515794 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:46:43.524479 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:46:43.532355 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:46:43.540602 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:46:43.548777 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:46:43.558807 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:46:43.567785 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:46:43.576647 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:46:43.597765 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:46:43.928284 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf968b57-dcf2-4e3b-b52c-3c738da152e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101404F808>]}
2021-05-29 17:46:43.946236 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf968b57-dcf2-4e3b-b52c-3c738da152e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210109A3A48>]}
2021-05-29 17:46:43.946236 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:46:43.953217 (MainThread): 
2021-05-29 17:46:43.954214 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:46:43.958232 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:46:43.959201 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:46:44.769063 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:46:44.769063 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:46:44.778073 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:46:46.083649 (MainThread): 14:46:46 | Concurrency: 1 threads (target='dev')
2021-05-29 17:46:46.085135 (MainThread): 14:46:46 | 
2021-05-29 17:46:46.095120 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:46:46.096116 (Thread-1): 14:46:46 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:46:46.100123 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:46:46.100123 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:46:46.112074 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:46:46.115065 (Thread-1): finished collecting timing info
2021-05-29 17:46:46.158308 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:46:46.166285 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:46:47.501696 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:46:47.503692 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk
            
            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:46:51.804753 (Thread-1): finished collecting timing info
2021-05-29 17:46:51.805720 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf968b57-dcf2-4e3b-b52c-3c738da152e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021010994388>]}
2021-05-29 17:46:51.805720 (Thread-1): 14:46:51 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 10.5 MB processed) in 5.71s]
2021-05-29 17:46:51.807713 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:46:51.834640 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:46:51.834640 (MainThread): 14:46:51 | 
2021-05-29 17:46:51.835636 (MainThread): 14:46:51 | Finished running 1 table model in 7.88s.
2021-05-29 17:46:51.836635 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:46:51.836635 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:46:51.837632 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:46:51.837632 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:46:51.854587 (MainThread): 
2021-05-29 17:46:51.855588 (MainThread): Completed successfully
2021-05-29 17:46:51.856587 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:46:51.858575 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021010952C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021010952B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210109A6108>]}
2021-05-29 17:46:51.859577 (MainThread): Flushing usage events
2021-05-29 17:47:42.249267 (MainThread): Running with dbt=0.19.1
2021-05-29 17:47:43.158674 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:47:43.159892 (MainThread): Tracking: tracking
2021-05-29 17:47:43.160716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F342723C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F34217288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F342177C8>]}
2021-05-29 17:47:43.181666 (MainThread): Partial parsing not enabled
2021-05-29 17:47:43.184646 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:47:43.251481 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:47:43.266433 (MainThread): Parsing macros\etc.sql
2021-05-29 17:47:43.271627 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:47:43.281509 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:47:43.399201 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:47:43.439093 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:47:43.453060 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:47:43.576726 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:47:43.668480 (MainThread): Parsing macros\core.sql
2021-05-29 17:47:43.719345 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:47:43.894953 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:47:43.923086 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:47:43.925780 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:47:43.930772 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:47:43.934762 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:47:43.939748 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:47:43.942270 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:47:43.962031 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:47:43.993950 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:47:43.999933 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:47:44.014894 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:47:44.061112 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:47:44.143895 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:47:44.148881 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:47:44.196753 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:47:44.218694 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:47:44.230662 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:47:44.246619 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:47:44.253601 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:47:44.257590 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:47:44.261579 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:47:44.280529 (MainThread): Partial parsing not enabled
2021-05-29 17:47:44.334384 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:47:44.354331 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:47:44.363307 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:47:44.372283 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:47:44.383254 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:47:44.393227 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:47:44.409185 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:47:44.417163 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:47:44.430130 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:47:44.444092 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:47:44.452070 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:47:44.461046 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:47:44.470022 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:47:44.478998 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:47:44.488971 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:47:44.497950 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:47:44.507920 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:47:44.531856 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:47:44.930281 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5349ffe-08d1-452f-acd6-6b9b830afb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F341C4148>]}
2021-05-29 17:47:44.946241 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5349ffe-08d1-452f-acd6-6b9b830afb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F341E7248>]}
2021-05-29 17:47:44.946241 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:47:44.954477 (MainThread): 
2021-05-29 17:47:44.956473 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:47:44.962459 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:47:44.963453 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:47:45.793136 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:47:45.794132 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:47:45.805140 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:47:47.122499 (MainThread): 14:47:47 | Concurrency: 1 threads (target='dev')
2021-05-29 17:47:47.123496 (MainThread): 14:47:47 | 
2021-05-29 17:47:47.130481 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:47:47.131476 (Thread-1): 14:47:47 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:47:47.136463 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:47:47.136463 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:47:47.148430 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:47:47.152425 (Thread-1): finished collecting timing info
2021-05-29 17:47:47.195340 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:47:47.203319 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:47:48.634355 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:47:48.636350 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:47:53.757140 (Thread-1): finished collecting timing info
2021-05-29 17:47:53.757140 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5349ffe-08d1-452f-acd6-6b9b830afb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3424CD08>]}
2021-05-29 17:47:53.758139 (Thread-1): 14:47:53 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 11.0 MB processed) in 6.62s]
2021-05-29 17:47:53.760100 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:47:53.856004 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:47:53.857035 (MainThread): 14:47:53 | 
2021-05-29 17:47:53.857735 (MainThread): 14:47:53 | Finished running 1 table model in 8.90s.
2021-05-29 17:47:53.858761 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:47:53.858761 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:47:53.858761 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:47:53.859794 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:47:53.876710 (MainThread): 
2021-05-29 17:47:53.876710 (MainThread): Completed successfully
2021-05-29 17:47:53.878724 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:47:53.879727 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3429B388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F341EB048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3791BDC8>]}
2021-05-29 17:47:53.880725 (MainThread): Flushing usage events
2021-05-29 17:48:41.456075 (MainThread): Running with dbt=0.19.1
2021-05-29 17:48:42.114191 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:48:42.115188 (MainThread): Tracking: tracking
2021-05-29 17:48:42.116187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157885C7308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157886224C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157885C6F48>]}
2021-05-29 17:48:42.135409 (MainThread): Partial parsing not enabled
2021-05-29 17:48:42.138300 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:48:42.181836 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:48:42.198623 (MainThread): Parsing macros\etc.sql
2021-05-29 17:48:42.203614 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:48:42.214887 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:48:42.243641 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:48:42.249628 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:48:42.254982 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:48:42.274776 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:48:42.285750 (MainThread): Parsing macros\core.sql
2021-05-29 17:48:42.294761 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:48:42.380535 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:48:42.397486 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:48:42.400445 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:48:42.404434 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:48:42.408457 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:48:42.412449 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:48:42.415403 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:48:42.435352 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:48:42.464274 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:48:42.468264 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:48:42.481264 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:48:42.522153 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:48:42.587979 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:48:42.592930 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:48:42.633919 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:48:42.649115 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:48:42.660090 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:48:42.672762 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:48:42.679001 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:48:42.682758 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:48:42.686751 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:48:42.701089 (MainThread): Partial parsing not enabled
2021-05-29 17:48:42.746008 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:48:42.766954 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:48:42.774933 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:48:42.782914 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:48:42.790891 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:48:42.798868 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:48:42.810838 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:48:42.818818 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:48:42.827791 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:48:42.834775 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:48:42.842753 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:48:42.851728 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:48:42.858710 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:48:42.866689 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:48:42.874670 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:48:42.882608 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:48:42.890587 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:48:42.911530 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:48:43.230214 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030090a8-21e9-4380-b47f-092792c67ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015788575708>]}
2021-05-29 17:48:43.244144 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030090a8-21e9-4380-b47f-092792c67ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015788598208>]}
2021-05-29 17:48:43.245178 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:48:43.252155 (MainThread): 
2021-05-29 17:48:43.253121 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:48:43.255464 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:48:43.256461 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:48:44.006510 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:48:44.006510 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:48:44.014419 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:48:45.299230 (MainThread): 14:48:45 | Concurrency: 1 threads (target='dev')
2021-05-29 17:48:45.300231 (MainThread): 14:48:45 | 
2021-05-29 17:48:45.305222 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:48:45.305222 (Thread-1): 14:48:45 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:48:45.307218 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:48:45.308216 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:48:45.321211 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:48:45.322176 (Thread-1): finished collecting timing info
2021-05-29 17:48:45.371082 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:48:45.379060 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:48:46.704947 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:48:46.706943 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid


    )

select * from final
  );
    
2021-05-29 17:48:53.116424 (Thread-1): finished collecting timing info
2021-05-29 17:48:53.117390 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '030090a8-21e9-4380-b47f-092792c67ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157885C9908>]}
2021-05-29 17:48:53.119380 (Thread-1): 14:48:53 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 7.81s]
2021-05-29 17:48:53.121376 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:48:53.159596 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:48:53.161616 (MainThread): 14:48:53 | 
2021-05-29 17:48:53.163322 (MainThread): 14:48:53 | Finished running 1 table model in 9.91s.
2021-05-29 17:48:53.164395 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:48:53.165318 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:48:53.165318 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:48:53.165318 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:48:53.183305 (MainThread): 
2021-05-29 17:48:53.184264 (MainThread): Completed successfully
2021-05-29 17:48:53.187259 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:48:53.189253 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157885C9C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578859B6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015788596C48>]}
2021-05-29 17:48:53.190263 (MainThread): Flushing usage events
2021-05-29 17:51:16.642973 (MainThread): Running with dbt=0.19.1
2021-05-29 17:51:17.552646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:51:17.555032 (MainThread): Tracking: tracking
2021-05-29 17:51:17.557667 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E83FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E85588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E85908>]}
2021-05-29 17:51:17.582878 (MainThread): Partial parsing not enabled
2021-05-29 17:51:17.587724 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:51:17.681241 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:51:17.694452 (MainThread): Parsing macros\etc.sql
2021-05-29 17:51:17.699955 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:51:17.710930 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:51:17.736723 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:51:17.744299 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:51:17.749129 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:51:17.775068 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:51:17.786837 (MainThread): Parsing macros\core.sql
2021-05-29 17:51:17.796864 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:51:17.886177 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:51:17.905038 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:51:17.908629 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:51:17.912929 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:51:17.917625 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:51:17.921617 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:51:17.925395 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:51:17.944687 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:51:17.975607 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:51:17.979596 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:51:17.994287 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:51:18.039177 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:51:18.106005 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:51:18.111175 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:51:18.148356 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:51:18.164461 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:51:18.176376 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:51:18.190388 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:51:18.196633 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:51:18.200363 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:51:18.204393 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:51:18.218320 (MainThread): Partial parsing not enabled
2021-05-29 17:51:18.268079 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:51:18.291012 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:51:18.299157 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:51:18.311090 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:51:18.319107 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:51:18.328948 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:51:18.342948 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:51:18.351808 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:51:18.362691 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:51:18.371826 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:51:18.381755 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:51:18.391769 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:51:18.401029 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:51:18.410006 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:51:18.423970 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:51:18.451895 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:51:18.471840 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:51:18.513678 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:51:18.966383 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd37b79c5-e11c-4815-ba9a-2daf63cf2f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E33508>]}
2021-05-29 17:51:18.995966 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd37b79c5-e11c-4815-ba9a-2daf63cf2f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E56448>]}
2021-05-29 17:51:18.996964 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:51:19.002956 (MainThread): 
2021-05-29 17:51:19.004950 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:51:19.006948 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:51:19.008182 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:51:20.652267 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:51:20.652267 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:51:20.664266 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:51:21.393494 (MainThread): 14:51:21 | Concurrency: 1 threads (target='dev')
2021-05-29 17:51:21.395496 (MainThread): 14:51:21 | 
2021-05-29 17:51:21.403381 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:51:21.403381 (Thread-1): 14:51:21 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:51:21.406375 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:51:21.406375 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:51:21.420337 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:51:21.421335 (Thread-1): finished collecting timing info
2021-05-29 17:51:21.457277 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:51:21.465216 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:51:22.837148 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:51:22.839142 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
        left join reason_with_sk on order_details.salesorderid = reason_with_sk.salesorderid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid


    )

select * from final
  );
    
2021-05-29 17:51:29.677398 (Thread-1): finished collecting timing info
2021-05-29 17:51:29.678395 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37b79c5-e11c-4815-ba9a-2daf63cf2f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310E37208>]}
2021-05-29 17:51:29.678395 (Thread-1): 14:51:29 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 8.27s]
2021-05-29 17:51:29.680184 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:51:29.796787 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:51:29.798782 (MainThread): 14:51:29 | 
2021-05-29 17:51:29.801762 (MainThread): 14:51:29 | Finished running 1 table model in 10.79s.
2021-05-29 17:51:29.804757 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:51:29.806752 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:51:29.807750 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:51:29.808746 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:51:29.833675 (MainThread): 
2021-05-29 17:51:29.834671 (MainThread): Completed successfully
2021-05-29 17:51:29.835667 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:51:29.837662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31491C808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31491C948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31491C4C8>]}
2021-05-29 17:51:29.838659 (MainThread): Flushing usage events
2021-05-29 17:58:04.087254 (MainThread): Running with dbt=0.19.1
2021-05-29 17:58:04.989534 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:58:04.991610 (MainThread): Tracking: tracking
2021-05-29 17:58:04.992726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84D00508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84E042C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84E04308>]}
2021-05-29 17:58:05.014385 (MainThread): Partial parsing not enabled
2021-05-29 17:58:05.018781 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:58:05.060551 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:58:05.074982 (MainThread): Parsing macros\etc.sql
2021-05-29 17:58:05.080545 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:58:05.090701 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:58:05.114675 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:58:05.121397 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:58:05.126334 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:58:05.156258 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:58:05.178198 (MainThread): Parsing macros\core.sql
2021-05-29 17:58:05.193160 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:58:05.341761 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:58:05.365094 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:58:05.367786 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:58:05.371781 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:58:05.377247 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:58:05.381992 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:58:05.384988 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:58:05.406148 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:58:05.434078 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:58:05.440230 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:58:05.455725 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:58:05.498228 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:58:05.568417 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:58:05.573397 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:58:05.609304 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:58:05.625529 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:58:05.637505 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:58:05.651877 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:58:05.660862 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:58:05.664861 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:58:05.669853 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:58:05.688236 (MainThread): Partial parsing not enabled
2021-05-29 17:58:05.751079 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:58:05.788297 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:58:05.801260 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:58:05.815188 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:58:05.828166 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:58:05.839160 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:58:05.865054 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:58:05.880015 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:58:05.894997 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:58:05.905944 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:58:05.917912 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:58:05.929882 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:58:05.939961 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:58:05.951678 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:58:05.962661 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:58:05.972731 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:58:05.984150 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:58:06.013074 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:58:07.059249 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eeb5c49-aebf-4f0e-a189-4ef65615ebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84DB3948>]}
2021-05-29 17:58:07.120191 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eeb5c49-aebf-4f0e-a189-4ef65615ebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84DD63C8>]}
2021-05-29 17:58:07.121191 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:58:07.156095 (MainThread): 
2021-05-29 17:58:07.163078 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:58:07.168063 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:58:07.169061 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:58:08.975482 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:58:08.976480 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:58:09.014754 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:58:09.743196 (MainThread): 14:58:09 | Concurrency: 1 threads (target='dev')
2021-05-29 17:58:09.744198 (MainThread): 14:58:09 | 
2021-05-29 17:58:09.753171 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:58:09.754170 (Thread-1): 14:58:09 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:58:09.755165 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:58:09.756166 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:58:09.774115 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:58:09.779102 (Thread-1): finished collecting timing info
2021-05-29 17:58:09.844927 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:58:09.856892 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:58:10.618292 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:58:10.623606 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid

    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
            inner join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:58:16.203404 (Thread-1): finished collecting timing info
2021-05-29 17:58:16.203404 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eeb5c49-aebf-4f0e-a189-4ef65615ebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84DEDF08>]}
2021-05-29 17:58:16.204402 (Thread-1): 14:58:16 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (64.5k rows, 17.8 MB processed) in 6.45s]
2021-05-29 17:58:16.206360 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:58:16.210350 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:58:16.211350 (MainThread): 14:58:16 | 
2021-05-29 17:58:16.212345 (MainThread): 14:58:16 | Finished running 1 table model in 9.05s.
2021-05-29 17:58:16.213342 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:58:16.213342 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:58:16.213342 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:58:16.213342 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:58:16.237248 (MainThread): 
2021-05-29 17:58:16.238250 (MainThread): Completed successfully
2021-05-29 17:58:16.239318 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:58:16.243339 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B86D73A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B88AA9B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B84DD9BC8>]}
2021-05-29 17:58:16.244312 (MainThread): Flushing usage events
2021-05-29 17:59:42.843727 (MainThread): Running with dbt=0.19.1
2021-05-29 17:59:43.749094 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 17:59:43.750094 (MainThread): Tracking: tracking
2021-05-29 17:59:43.751091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F7330C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F735608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F735908>]}
2021-05-29 17:59:43.778016 (MainThread): Partial parsing not enabled
2021-05-29 17:59:43.784003 (MainThread): Parsing macros\adapters.sql
2021-05-29 17:59:43.841848 (MainThread): Parsing macros\catalog.sql
2021-05-29 17:59:43.859800 (MainThread): Parsing macros\etc.sql
2021-05-29 17:59:43.863789 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 17:59:43.874757 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 17:59:43.899693 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 17:59:43.905676 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 17:59:43.910271 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 17:59:43.934147 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 17:59:43.944765 (MainThread): Parsing macros\core.sql
2021-05-29 17:59:43.953918 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 17:59:44.117634 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 17:59:44.143516 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 17:59:44.146511 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 17:59:44.152022 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 17:59:44.161003 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 17:59:44.165989 (MainThread): Parsing macros\etc\query.sql
2021-05-29 17:59:44.168980 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 17:59:44.196906 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 17:59:44.235802 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 17:59:44.242794 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 17:59:44.261747 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 17:59:44.337872 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 17:59:44.429632 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 17:59:44.434030 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 17:59:44.484898 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 17:59:44.503768 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 17:59:44.520797 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 17:59:44.538752 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 17:59:44.549723 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 17:59:44.553712 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 17:59:44.561699 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 17:59:44.581641 (MainThread): Partial parsing not enabled
2021-05-29 17:59:44.654444 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 17:59:44.688353 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 17:59:44.710296 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 17:59:44.731240 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 17:59:44.760191 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 17:59:44.778115 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:59:44.798059 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 17:59:44.810029 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 17:59:44.819004 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 17:59:44.827982 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 17:59:44.838327 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 17:59:44.848617 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 17:59:44.857593 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 17:59:44.866574 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 17:59:44.875546 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 17:59:44.883525 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 17:59:44.892360 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 17:59:44.913304 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 17:59:45.261371 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43aa80f7-298d-419d-8199-b6edc3481663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F6E3788>]}
2021-05-29 17:59:45.280323 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43aa80f7-298d-419d-8199-b6edc3481663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F706408>]}
2021-05-29 17:59:45.281323 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 17:59:45.287300 (MainThread): 
2021-05-29 17:59:45.287300 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:59:45.291291 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 17:59:45.291291 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 17:59:46.624231 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 17:59:46.624691 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 17:59:46.632382 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:59:47.356244 (MainThread): 14:59:47 | Concurrency: 1 threads (target='dev')
2021-05-29 17:59:47.359229 (MainThread): 14:59:47 | 
2021-05-29 17:59:47.368202 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 17:59:47.369202 (Thread-1): 14:59:47 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 17:59:47.371195 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 17:59:47.374207 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 17:59:47.386154 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:59:47.388147 (Thread-1): finished collecting timing info
2021-05-29 17:59:47.439012 (Thread-1): Opening a new connection, currently in state init
2021-05-29 17:59:47.446989 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 17:59:48.797684 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 17:59:48.798684 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid

    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
            left join reason_with_sk on order_detail_with_sk.salesorderid = reason_with_sk.salesorderid

    )

select * from final
  );
    
2021-05-29 17:59:55.317976 (Thread-1): finished collecting timing info
2021-05-29 17:59:55.319970 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43aa80f7-298d-419d-8199-b6edc3481663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821F6F5548>]}
2021-05-29 17:59:55.320960 (Thread-1): 14:59:55 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.95s]
2021-05-29 17:59:55.327451 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 17:59:55.363542 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 17:59:55.364582 (MainThread): 14:59:55 | 
2021-05-29 17:59:55.365757 (MainThread): 14:59:55 | Finished running 1 table model in 10.08s.
2021-05-29 17:59:55.366763 (MainThread): Connection 'master' was properly closed.
2021-05-29 17:59:55.367761 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 17:59:55.367761 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 17:59:55.368762 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 17:59:55.386709 (MainThread): 
2021-05-29 17:59:55.387707 (MainThread): Completed successfully
2021-05-29 17:59:55.390718 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 17:59:55.391695 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018221697E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018223273548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018223273208>]}
2021-05-29 17:59:55.392692 (MainThread): Flushing usage events
2021-05-29 18:01:24.890044 (MainThread): Running with dbt=0.19.1
2021-05-29 18:01:25.670054 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:01:25.671058 (MainThread): Tracking: tracking
2021-05-29 18:01:25.672051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB74C7808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB7525708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB74C30C8>]}
2021-05-29 18:01:25.690803 (MainThread): Partial parsing not enabled
2021-05-29 18:01:25.694887 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:01:25.738310 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:01:25.751278 (MainThread): Parsing macros\etc.sql
2021-05-29 18:01:25.757359 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:01:25.767958 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:01:25.792853 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:01:25.798840 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:01:25.803829 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:01:25.823239 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:01:25.834753 (MainThread): Parsing macros\core.sql
2021-05-29 18:01:25.843144 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:01:25.928166 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:01:25.946169 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:01:25.949066 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:01:25.953060 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:01:25.958048 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:01:25.962035 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:01:25.965417 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:01:25.983410 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:01:26.017282 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:01:26.023299 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:01:26.038171 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:01:26.085049 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:01:26.159866 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:01:26.164210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:01:26.204107 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:01:26.223330 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:01:26.234132 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:01:26.247917 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:01:26.253906 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:01:26.258461 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:01:26.262923 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:01:26.277705 (MainThread): Partial parsing not enabled
2021-05-29 18:01:26.322922 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:01:26.342869 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:01:26.351845 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:01:26.359823 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:01:26.368800 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:01:26.376778 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:01:26.388726 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:01:26.396705 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:01:26.405856 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:01:26.414150 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:01:26.422176 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:01:26.430747 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:01:26.439026 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:01:26.448002 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:01:26.456979 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:01:26.467193 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:01:26.477167 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:01:26.500106 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:01:26.822942 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8c26868-4016-49b6-9326-e90fe040008f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB7461848>]}
2021-05-29 18:01:26.839899 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8c26868-4016-49b6-9326-e90fe040008f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB74ACC08>]}
2021-05-29 18:01:26.840897 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:01:26.848369 (MainThread): 
2021-05-29 18:01:26.849364 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:01:26.851359 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:01:26.852357 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:01:28.187335 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:01:28.188371 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:01:28.196157 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:01:29.511763 (MainThread): 15:01:29 | Concurrency: 1 threads (target='dev')
2021-05-29 18:01:29.512766 (MainThread): 15:01:29 | 
2021-05-29 18:01:29.518756 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 18:01:29.519753 (Thread-1): 15:01:29 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 18:01:29.522745 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:01:29.524759 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 18:01:29.533714 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:01:29.534711 (Thread-1): finished collecting timing info
2021-05-29 18:01:29.584577 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:01:29.593590 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:01:30.387912 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:01:30.388874 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , ft_orders as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )

    , final as (
        select
        *
        from ft_orders
    
        left join reason_with_sk on ft_orders.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 18:01:31.597711 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/1d10d6c0-bb84-4b3d-b08c-bf8f955610b5?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name salesorderid at [8:6]')
2021-05-29 18:01:33.949721 (Thread-1): finished collecting timing info
2021-05-29 18:01:33.952663 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE TABLE has columns with duplicate name salesorderid at [8:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/9f754c66-d4a2-42e1-b033-eccda74796ab?maxResults=0&location=US&prettyPrint=false: CREATE TABLE has columns with duplicate name salesorderid at [8:6]

(job ID: 9f754c66-d4a2-42e1-b033-eccda74796ab)

                                                                  -----Query Job SQL Follows-----                                                                   

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    customer as (
  11:        select *
  12:        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
  13:    )
  14:    , creditcard as (
  15:        select *
  16:        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
  17:    )
  18:    , product as (
  19:        select *
  20:        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
  21:    )
  22:    , address as (
  23:        select *
  24:        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
  25:    )
  26:
  27:    , reason as (
  28:        select *
  29:        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  30:    )
  31:
  32:    , orders_with_sk as (
  33:            select
  34:            orders.salesorderid
  35:            , customer.customer_sk as customer_fk
  36:            , creditcard.creditcard_sk as creditcard_fk
  37:            , address.address_sk as address_fk
  38:            , orders.shipmethodid
  39:            , orders.billtoaddressid
  40:            , orders.salespersonid
  41:            , orders.currencyrateid
  42:            , orders.territoryid
  43:            , orders.purchaseordernumber
  44:            , orders.modifieddate
  45:            , orders.rowguid
  46:            , orders.taxamt
  47:            , orders.onlineorderflag
  48:            , orders.status
  49:            , orders.orderdate
  50:            , orders.creditcardapprovalcode
  51:            , orders.subtotal
  52:            , orders.revisionnumber
  53:            , orders.freight
  54:            , orders.duedate
  55:            , orders.totaldue
  56:            , orders.shipdate
  57:            , orders.accountnumber
  58:        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders
  59:
  60:        left join customer on orders.customerid = customer.customerid
  61:        left join creditcard on orders.creditcardid = creditcard.creditcardid
  62:        left join address on orders.shiptoaddressid = address.addressid
  63:
  64:    )
  65:
  66:    , reason_with_sk as (
  67:        select
  68:            reason.salesreason_sk as salesreason_fk
  69:            , order_reason.salesorderid
  70:            , order_reason.modifieddate
  71:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
  72:        left join reason on order_reason.salesreasonid = reason.salesreasonid
  73:    )
  74:
  75:   , order_detail_with_sk as (
  76:        select
  77:            order_details.salesorderid
  78:            , order_details.specialofferid
  79:            , order_details.salesorderdetailid
  80:            , order_details.unitpricediscount
  81:            , order_details.unitprice
  82:            , order_details.rowguid
  83:            , order_details.orderqty
  84:            , order_details.saleprice
  85:            , order_details.modifieddate
  86:            , order_details.carriertrackingnumber
  87:            , product.product_sk as product_fk
  88:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
  89:        left join product on order_details.productid = product.productid
  90:    )
  91:
  92:    , ft_orders as (
  93:        select
  94:            order_detail_with_sk.salesorderid
  95:            , order_detail_with_sk.specialofferid
  96:            , order_detail_with_sk.salesorderdetailid
  97:            , order_detail_with_sk.unitpricediscount
  98:            , order_detail_with_sk.unitprice
  99:            , order_detail_with_sk.orderqty
 100:            , order_detail_with_sk.saleprice
 101:            , order_detail_with_sk.carriertrackingnumber
 102:            , order_detail_with_sk.product_fk
 103:            , orders_with_sk.customer_fk
 104:            , orders_with_sk.creditcard_fk
 105:            , orders_with_sk.address_fk
 106:            , orders_with_sk.shipmethodid
 107:            , orders_with_sk.billtoaddressid
 108:            , orders_with_sk.salespersonid
 109:            , orders_with_sk.currencyrateid
 110:            , orders_with_sk.territoryid
 111:            , orders_with_sk.purchaseordernumber
 112:            , orders_with_sk.modifieddate
 113:            , orders_with_sk.rowguid
 114:            , orders_with_sk.taxamt
 115:            , orders_with_sk.onlineorderflag
 116:            , orders_with_sk.status
 117:            , orders_with_sk.orderdate
 118:            , orders_with_sk.creditcardapprovalcode
 119:            , orders_with_sk.subtotal
 120:            , orders_with_sk.revisionnumber
 121:            , orders_with_sk.freight
 122:            , orders_with_sk.duedate
 123:            , orders_with_sk.totaldue
 124:            , orders_with_sk.shipdate
 125:            , orders_with_sk.accountnumber
 126:            from order_detail_with_sk
 127:
 128:            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid
 129:
 130:    )
 131:
 132:    , final as (
 133:        select
 134:        *
 135:        from ft_orders
 136:    
 137:        left join reason_with_sk on ft_orders.salesorderid = reason_with_sk.salesorderid
 138:    )
 139:
 140:select * from final
 141:  );
 142:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  CREATE TABLE has columns with duplicate name salesorderid at [8:6]
  compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 18:01:34.021655 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8c26868-4016-49b6-9326-e90fe040008f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB74B60C8>]}
2021-05-29 18:01:34.022659 (Thread-1): 15:01:34 | 1 of 1 ERROR creating table model dw_adventure_works.fact_order_details [ERROR in 4.50s]
2021-05-29 18:01:34.025468 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 18:01:34.029456 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:01:34.030460 (MainThread): 15:01:34 | 
2021-05-29 18:01:34.031374 (MainThread): 15:01:34 | Finished running 1 table model in 7.18s.
2021-05-29 18:01:34.032381 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:01:34.032381 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:01:34.033381 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:01:34.033381 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 18:01:34.051328 (MainThread): 
2021-05-29 18:01:34.052329 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 18:01:34.054090 (MainThread): 
2021-05-29 18:01:34.055092 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-05-29 18:01:34.056090 (MainThread):   CREATE TABLE has columns with duplicate name salesorderid at [8:6]
2021-05-29 18:01:34.057086 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\fact_order_details.sql
2021-05-29 18:01:34.058084 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 18:01:34.060082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BBAFD2B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BBAFD2CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BBAFD2388>]}
2021-05-29 18:01:34.061076 (MainThread): Flushing usage events
2021-05-29 18:02:55.820014 (MainThread): Running with dbt=0.19.1
2021-05-29 18:02:58.472918 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:02:58.475917 (MainThread): Tracking: tracking
2021-05-29 18:02:58.476908 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05C3A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05C49C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05C4388>]}
2021-05-29 18:02:58.555696 (MainThread): Partial parsing not enabled
2021-05-29 18:02:58.572651 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:02:58.736215 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:02:58.782091 (MainThread): Parsing macros\etc.sql
2021-05-29 18:02:58.796052 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:02:58.822983 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:02:58.896786 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:02:58.909750 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:02:58.919723 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:02:58.982553 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:02:59.009482 (MainThread): Parsing macros\core.sql
2021-05-29 18:02:59.028431 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:02:59.229892 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:02:59.277767 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:02:59.283749 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:02:59.296714 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:02:59.311674 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:02:59.323642 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:02:59.336607 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:02:59.498175 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:02:59.584944 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:02:59.590927 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:02:59.617857 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:02:59.694651 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:02:59.814330 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:02:59.821311 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:02:59.873173 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:02:59.904089 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:02:59.934018 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:02:59.949966 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:02:59.958946 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:02:59.962934 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:02:59.969915 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:02:59.987867 (MainThread): Partial parsing not enabled
2021-05-29 18:03:00.080617 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:03:00.118516 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:03:00.130484 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:03:00.144446 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:03:00.153422 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:03:00.167072 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:03:00.186023 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:03:00.194599 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:03:00.206567 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:03:00.215543 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:03:00.224519 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:03:00.237974 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:03:00.246946 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:03:00.255923 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:03:00.264898 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:03:00.276038 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:03:00.292126 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:03:00.316058 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:03:00.780612 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2734dea-45bf-4ef0-a810-8ac017a6912b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB3CC0688>]}
2021-05-29 18:03:00.802555 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2734dea-45bf-4ef0-a810-8ac017a6912b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05F98C8>]}
2021-05-29 18:03:00.803557 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:03:00.815550 (MainThread): 
2021-05-29 18:03:00.816518 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:03:00.822502 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:03:00.823498 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:03:01.620612 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:03:01.621635 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:03:01.638591 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:03:02.985281 (MainThread): 15:03:02 | Concurrency: 1 threads (target='dev')
2021-05-29 18:03:02.988262 (MainThread): 15:03:02 | 
2021-05-29 18:03:03.006210 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 18:03:03.006210 (Thread-1): 15:03:03 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 18:03:03.009212 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:03:03.009212 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 18:03:03.024162 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:03:03.026194 (Thread-1): finished collecting timing info
2021-05-29 18:03:03.073032 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:03:03.081008 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:03:03.904372 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:03:03.905369 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

    , reason_with_sk as (
        select
            reason.salesreason_sk as salesreason_fk
            , order_reason.salesorderid
            , order_reason.modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason` as order_reason
        left join reason on order_reason.salesreasonid = reason.salesreasonid
    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , ft_orders as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )

    , final as (
        select
            ft_orders.salesorderid
            , ft_orders.specialofferid
            , ft_orders.salesorderdetailid
            , ft_orders.unitpricediscount
            , ft_orders.unitprice
            , ft_orders.orderqty
            , ft_orders.saleprice
            , ft_orders.carriertrackingnumber
            , ft_orders.product_fk
            , ft_orders.customer_fk
            , ft_orders.creditcard_fk
            , ft_orders.address_fk
            , ft_orders.shipmethodid
            , ft_orders.billtoaddressid
            , ft_orders.salespersonid
            , ft_orders.currencyrateid
            , ft_orders.territoryid
            , ft_orders.purchaseordernumber
            , ft_orders.modifieddate
            , ft_orders.rowguid
            , ft_orders.taxamt
            , ft_orders.onlineorderflag
            , ft_orders.status
            , ft_orders.orderdate
            , ft_orders.creditcardapprovalcode
            , ft_orders.subtotal
            , ft_orders.revisionnumber
            , ft_orders.freight
            , ft_orders.duedate
            , ft_orders.totaldue
            , ft_orders.shipdate
            , ft_orders.accountnumber
        from ft_orders
    
        left join reason_with_sk on ft_orders.salesorderid = reason_with_sk.salesorderid
    )

select * from final
  );
    
2021-05-29 18:03:10.935914 (Thread-1): finished collecting timing info
2021-05-29 18:03:10.936914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2734dea-45bf-4ef0-a810-8ac017a6912b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB05FBB48>]}
2021-05-29 18:03:10.936914 (Thread-1): 15:03:10 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.8 MB processed) in 7.93s]
2021-05-29 18:03:10.938869 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 18:03:11.006371 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:03:11.007365 (MainThread): 15:03:11 | 
2021-05-29 18:03:11.007974 (MainThread): 15:03:11 | Finished running 1 table model in 10.19s.
2021-05-29 18:03:11.008977 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:03:11.008977 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:03:11.008977 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:03:11.008977 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 18:03:11.023937 (MainThread): 
2021-05-29 18:03:11.024936 (MainThread): Completed successfully
2021-05-29 18:03:11.025938 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 18:03:11.026939 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB0597C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB255D1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB258C448>]}
2021-05-29 18:03:11.027930 (MainThread): Flushing usage events
2021-05-29 18:09:45.718879 (MainThread): Running with dbt=0.19.1
2021-05-29 18:09:46.831123 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:09:46.833527 (MainThread): Tracking: tracking
2021-05-29 18:09:46.834463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F5042148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F5033788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F509DA48>]}
2021-05-29 18:09:46.858475 (MainThread): Partial parsing not enabled
2021-05-29 18:09:46.863880 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:09:46.905045 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:09:46.918706 (MainThread): Parsing macros\etc.sql
2021-05-29 18:09:46.924696 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:09:46.934549 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:09:46.959523 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:09:46.966469 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:09:46.970749 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:09:46.990330 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:09:47.018724 (MainThread): Parsing macros\core.sql
2021-05-29 18:09:47.027110 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:09:47.112978 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:09:47.131932 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:09:47.134978 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:09:47.140228 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:09:47.146343 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:09:47.150337 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:09:47.155440 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:09:47.174393 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:09:47.203079 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:09:47.208115 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:09:47.228895 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:09:47.287408 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:09:47.356235 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:09:47.362520 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:09:47.400933 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:09:47.415206 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:09:47.425981 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:09:47.440399 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:09:47.446387 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:09:47.450377 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:09:47.455165 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:09:47.469149 (MainThread): Partial parsing not enabled
2021-05-29 18:09:47.514016 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:09:47.535990 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:09:47.544138 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:09:47.553424 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:09:47.561402 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:09:47.570855 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:09:47.582609 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:09:47.591639 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:09:47.601278 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:09:47.610042 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:09:47.618565 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:09:47.627568 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:09:47.635511 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:09:47.646483 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:09:47.655458 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:09:47.665432 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:09:47.673410 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:09:47.701335 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:09:48.037120 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e41cdd1a-9a13-4708-865c-cd972f1fbc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F4FF3748>]}
2021-05-29 18:09:48.053908 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e41cdd1a-9a13-4708-865c-cd972f1fbc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F5018348>]}
2021-05-29 18:09:48.054911 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:09:48.066881 (MainThread): 
2021-05-29 18:09:48.067875 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:09:48.070272 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:09:48.070272 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:09:49.564385 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:09:49.565309 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:09:49.578065 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:09:50.862659 (MainThread): 15:09:50 | Concurrency: 1 threads (target='dev')
2021-05-29 18:09:50.863659 (MainThread): 15:09:50 | 
2021-05-29 18:09:50.869642 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 18:09:50.870639 (Thread-1): 15:09:50 | 1 of 1 START table model dw_adventure_works.dim_reason............... [RUN]
2021-05-29 18:09:50.872634 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:09:50.876621 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 18:09:50.884633 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 18:09:50.891595 (Thread-1): finished collecting timing info
2021-05-29 18:09:50.934469 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:09:50.942488 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:09:52.294936 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 18:09:52.298987 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    ,    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesreasonid) as salesreason_sk
            , reasonorder.salesreasonid
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 18:09:53.710920 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/0b6983c4-cfda-4f96-8ed9-57beb124b2b1?maxResults=0&location=US&prettyPrint=false: Column name salesreasonid is ambiguous at [37:37]')
2021-05-29 18:09:55.242608 (Thread-1): finished collecting timing info
2021-05-29 18:09:55.242608 (Thread-1): Database Error in model dim_reason (models\marts\dim_reason.sql)
  Column name salesreasonid is ambiguous at [37:37]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/7fac51e2-4a79-4ff9-b909-ec43c67d13ad?maxResults=0&location=US&prettyPrint=false: Column name salesreasonid is ambiguous at [37:37]

(job ID: 7fac51e2-4a79-4ff9-b909-ec43c67d13ad)

                                                              -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    reason as (
  11:        select
  12:            /*Primary Key*/
  13:            salesreasonid
  14:
  15:           /*Other Columns*/
  16:            , name
  17:            , modifieddate
  18:            , reasontype
  19:        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  20:    )
  21:
  22:    ,    reasonorder as (
  23:        select
  24:            /*Primary Key*/
  25:            salesreasonid
  26:
  27:            /*Foreign Keys*/
  28:            , salesorderid
  29:
  30:           /*Other Columns*/
  31:            , modifieddate
  32:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  33:    )
  34:
  35:    , transformed as (
  36:        select
  37:        row_number() over (order by salesreasonid) as salesreason_sk
  38:            , reasonorder.salesreasonid
  39:            , reason.name
  40:            , reason.modifieddate
  41:            , reason.reasontype
  42:        from reasonorder
  43:        left join reason on reasonorder.salesreasonid = reason.salesreasonid
  44:    )
  45:    select * from transformed
  46:  );
  47:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_reason (models\marts\dim_reason.sql)
  Column name salesreasonid is ambiguous at [37:37]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 18:09:55.281614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e41cdd1a-9a13-4708-865c-cd972f1fbc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F5029D48>]}
2021-05-29 18:09:55.281614 (Thread-1): 15:09:55 | 1 of 1 ERROR creating table model dw_adventure_works.dim_reason...... [ERROR in 4.41s]
2021-05-29 18:09:55.283607 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 18:09:55.300561 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:09:55.300561 (MainThread): 15:09:55 | 
2021-05-29 18:09:55.301564 (MainThread): 15:09:55 | Finished running 1 table model in 7.23s.
2021-05-29 18:09:55.302567 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:09:55.302567 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:09:55.303554 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:09:55.303554 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 18:09:55.308543 (MainThread): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64004), raddr=('142.250.218.74', 443)>
2021-05-29 18:09:55.309556 (MainThread): unclosed <socket.socket fd=724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64005), raddr=('142.250.219.42', 443)>
2021-05-29 18:09:55.309556 (MainThread): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64007), raddr=('142.250.219.42', 443)>
2021-05-29 18:09:55.309556 (MainThread): unclosed <socket.socket fd=884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64006), raddr=('142.250.218.74', 443)>
2021-05-29 18:09:55.310538 (MainThread): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64008), raddr=('142.250.218.74', 443)>
2021-05-29 18:09:55.310538 (MainThread): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64009), raddr=('142.250.219.42', 443)>
2021-05-29 18:09:55.325496 (MainThread): 
2021-05-29 18:09:55.326492 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 18:09:55.329613 (MainThread): 
2021-05-29 18:09:55.330617 (MainThread): Database Error in model dim_reason (models\marts\dim_reason.sql)
2021-05-29 18:09:55.331612 (MainThread):   Column name salesreasonid is ambiguous at [37:37]
2021-05-29 18:09:55.332614 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 18:09:55.333610 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 18:09:55.334606 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F508A248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F8CFEEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8F5019B08>]}
2021-05-29 18:09:55.335606 (MainThread): Flushing usage events
2021-05-29 18:11:33.917149 (MainThread): Running with dbt=0.19.1
2021-05-29 18:11:34.645812 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:11:34.647548 (MainThread): Tracking: tracking
2021-05-29 18:11:34.648586 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E2B4088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E2B5448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E2B54C8>]}
2021-05-29 18:11:34.669493 (MainThread): Partial parsing not enabled
2021-05-29 18:11:34.672913 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:11:34.711447 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:11:34.724417 (MainThread): Parsing macros\etc.sql
2021-05-29 18:11:34.729077 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:11:34.738701 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:11:34.771619 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:11:34.779596 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:11:34.784777 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:11:34.806761 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:11:34.818742 (MainThread): Parsing macros\core.sql
2021-05-29 18:11:34.827722 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:11:34.920192 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:11:34.938149 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:11:34.941232 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:11:34.945388 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:11:34.950414 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:11:34.954405 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:11:34.957643 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:11:34.976385 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:11:35.004316 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:11:35.008339 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:11:35.022298 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:11:35.064239 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:11:35.129590 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:11:35.134203 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:11:35.170186 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:11:35.185044 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:11:35.196019 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:11:35.208892 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:11:35.214882 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:11:35.218870 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:11:35.222893 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:11:35.235823 (MainThread): Partial parsing not enabled
2021-05-29 18:11:35.282406 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:11:35.302598 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:11:35.309580 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:11:35.318786 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:11:35.326765 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:11:35.335409 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:11:35.347283 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:11:35.355608 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:11:35.366610 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:11:35.375493 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:11:35.384428 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:11:35.393393 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:11:35.401750 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:11:35.409943 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:11:35.417921 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:11:35.426364 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:11:35.435306 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:11:35.461235 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:11:35.814758 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70207818-ae95-46be-b98f-c77d4e6f16c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255119AF708>]}
2021-05-29 18:11:35.829720 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70207818-ae95-46be-b98f-c77d4e6f16c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E29ABC8>]}
2021-05-29 18:11:35.829720 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:11:35.838228 (MainThread): 
2021-05-29 18:11:35.839228 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:11:35.844214 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:11:35.844214 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:11:37.232590 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:11:37.232590 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:11:37.240989 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:11:37.998416 (MainThread): 15:11:37 | Concurrency: 1 threads (target='dev')
2021-05-29 18:11:38.000413 (MainThread): 15:11:38 | 
2021-05-29 18:11:38.012678 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 18:11:38.012678 (Thread-1): 15:11:38 | 1 of 1 START table model dw_adventure_works.dim_reason............... [RUN]
2021-05-29 18:11:38.013856 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:11:38.014858 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 18:11:38.020845 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 18:11:38.024830 (Thread-1): finished collecting timing info
2021-05-29 18:11:38.070748 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:11:38.079368 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:11:39.421499 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 18:11:39.422495 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    ,    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    , transformed as (
        select
        row_number() over (order by salesorderid) as salesorder_sk
            , reasonorder.salesreasonid
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 18:11:43.105042 (Thread-1): finished collecting timing info
2021-05-29 18:11:43.106040 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70207818-ae95-46be-b98f-c77d4e6f16c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E29D848>]}
2021-05-29 18:11:43.107039 (Thread-1): 15:11:43 | 1 of 1 OK created table model dw_adventure_works.dim_reason.......... [CREATE TABLE (27.6k rows, 432.4 KB processed) in 5.09s]
2021-05-29 18:11:43.108000 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 18:11:43.198723 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:11:43.199766 (MainThread): 15:11:43 | 
2021-05-29 18:11:43.200640 (MainThread): 15:11:43 | Finished running 1 table model in 7.36s.
2021-05-29 18:11:43.201645 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:11:43.201645 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:11:43.202642 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:11:43.202642 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 18:11:43.226577 (MainThread): 
2021-05-29 18:11:43.226577 (MainThread): Completed successfully
2021-05-29 18:11:43.228571 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 18:11:43.229572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025510286D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E2E0048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550E286848>]}
2021-05-29 18:11:43.229572 (MainThread): Flushing usage events
2021-05-29 18:14:26.014321 (MainThread): Running with dbt=0.19.1
2021-05-29 18:14:26.814738 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_orde_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:14:26.826702 (MainThread): Tracking: tracking
2021-05-29 18:14:26.827700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F82893FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F828975C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F82897708>]}
2021-05-29 18:14:26.857954 (MainThread): Partial parsing not enabled
2021-05-29 18:14:26.861960 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:14:26.900855 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:14:26.913825 (MainThread): Parsing macros\etc.sql
2021-05-29 18:14:26.918787 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:14:26.927802 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:14:26.952702 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:14:26.958685 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:14:26.963628 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:14:26.983505 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:14:26.995231 (MainThread): Parsing macros\core.sql
2021-05-29 18:14:27.004212 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:14:27.100248 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:14:27.118204 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:14:27.121568 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:14:27.125848 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:14:27.130460 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:14:27.134454 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:14:27.137801 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:14:27.158785 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:14:27.187608 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:14:27.192323 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:14:27.206744 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:14:27.250605 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:14:27.326623 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:14:27.331487 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:14:27.370402 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:14:27.384309 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:14:27.396589 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:14:27.410070 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:14:27.416078 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:14:27.419087 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:14:27.424035 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:14:27.438997 (MainThread): Partial parsing not enabled
2021-05-29 18:14:27.486210 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:14:27.506065 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:14:27.514044 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:14:27.522642 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:14:27.530842 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:14:27.539826 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:14:27.560770 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:14:27.568546 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:14:27.577967 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:14:27.586118 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:14:27.602832 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:14:27.612802 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:14:27.621776 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:14:27.629754 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:14:27.637698 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:14:27.645711 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:14:27.653657 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:14:27.675631 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:14:28.008275 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6175774-8207-4ce4-ba0a-8f065ba4bf99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F8259F6C8>]}
2021-05-29 18:14:28.026227 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6175774-8207-4ce4-ba0a-8f065ba4bf99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F828C0308>]}
2021-05-29 18:14:28.027227 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:14:28.028220 (MainThread): The selector 'fact_orde_details' does not match any nodes and will be ignored
2021-05-29 18:14:28.045187 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-05-29 18:14:28.046172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F828C0308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F828C07C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F828C02C8>]}
2021-05-29 18:14:28.046172 (MainThread): Flushing usage events
2021-05-29 18:14:29.158614 (MainThread): Connection 'test.dw_adventure_works.test' was properly closed.
2021-05-29 18:14:41.745459 (MainThread): Running with dbt=0.19.1
2021-05-29 18:14:42.414861 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:14:42.415859 (MainThread): Tracking: tracking
2021-05-29 18:14:42.416858 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082C53F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082C54C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082C546C8>]}
2021-05-29 18:14:42.435640 (MainThread): Partial parsing not enabled
2021-05-29 18:14:42.438666 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:14:42.479521 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:14:42.492486 (MainThread): Parsing macros\etc.sql
2021-05-29 18:14:42.496476 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:14:42.506388 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:14:42.531395 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:14:42.537665 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:14:42.542074 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:14:42.563313 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:14:42.574306 (MainThread): Parsing macros\core.sql
2021-05-29 18:14:42.583051 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:14:42.673323 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:14:42.691932 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:14:42.694496 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:14:42.698490 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:14:42.703351 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:14:42.707335 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:14:42.710058 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:14:42.729011 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:14:42.759928 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:14:42.764912 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:14:42.778916 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:14:42.832736 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:14:42.898594 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:14:42.903581 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:14:42.942442 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:14:42.957403 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:14:42.967412 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:14:42.981376 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:14:42.987323 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:14:42.990351 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:14:42.995338 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:14:43.008303 (MainThread): Partial parsing not enabled
2021-05-29 18:14:43.054180 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:14:43.073130 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:14:43.082107 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:14:43.091079 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:14:43.099058 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:14:43.107038 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:14:43.118007 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:14:43.125986 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:14:43.133964 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:14:43.141943 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:14:43.149922 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:14:43.157900 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:14:43.165879 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:14:43.173823 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:14:43.181802 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:14:43.189781 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:14:43.197760 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:14:43.218742 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:14:43.574930 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26b68f0a-78e3-4147-b31b-116e58c56315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001908634F708>]}
2021-05-29 18:14:43.589890 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26b68f0a-78e3-4147-b31b-116e58c56315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082CA3148>]}
2021-05-29 18:14:43.590854 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:14:43.601459 (MainThread): 
2021-05-29 18:14:43.602470 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:14:43.605429 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:14:43.605429 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:14:44.956983 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:14:44.958329 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:14:44.977861 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:14:46.271462 (MainThread): 15:14:46 | Concurrency: 1 threads (target='dev')
2021-05-29 18:14:46.272458 (MainThread): 15:14:46 | 
2021-05-29 18:14:46.278443 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 18:14:46.279439 (Thread-1): 15:14:46 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 18:14:46.280441 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:14:46.280441 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 18:14:46.292410 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:14:46.296177 (Thread-1): finished collecting timing info
2021-05-29 18:14:46.353028 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:14:46.362000 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:14:47.802305 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:14:47.806291 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-29 18:14:55.016517 (Thread-1): finished collecting timing info
2021-05-29 18:14:55.016517 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26b68f0a-78e3-4147-b31b-116e58c56315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082C16AC8>]}
2021-05-29 18:14:55.017514 (Thread-1): 15:14:55 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 8.74s]
2021-05-29 18:14:55.019236 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 18:14:55.101348 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:14:55.102350 (MainThread): 15:14:55 | 
2021-05-29 18:14:55.103382 (MainThread): 15:14:55 | Finished running 1 table model in 11.50s.
2021-05-29 18:14:55.104342 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:14:55.104342 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:14:55.105338 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:14:55.105338 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 18:14:55.121294 (MainThread): 
2021-05-29 18:14:55.122293 (MainThread): Completed successfully
2021-05-29 18:14:55.123289 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 18:14:55.125287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019082CDEC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190867542C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019086754788>]}
2021-05-29 18:14:55.125287 (MainThread): Flushing usage events
2021-05-29 18:16:53.786952 (MainThread): Running with dbt=0.19.1
2021-05-29 18:16:54.635815 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 18:16:54.637777 (MainThread): Tracking: tracking
2021-05-29 18:16:54.639772 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B397A048C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B397A62908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B397A042C8>]}
2021-05-29 18:16:54.660713 (MainThread): Partial parsing not enabled
2021-05-29 18:16:54.664936 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:16:54.707780 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:16:54.720754 (MainThread): Parsing macros\etc.sql
2021-05-29 18:16:54.726208 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:16:54.736406 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:16:54.762696 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:16:54.769101 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:16:54.773968 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:16:54.798238 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:16:54.810011 (MainThread): Parsing macros\core.sql
2021-05-29 18:16:54.818825 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:16:54.925544 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:16:54.948484 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:16:54.951474 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:16:54.958456 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:16:54.966433 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:16:54.973415 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:16:54.978404 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:16:55.009319 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:16:55.043228 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:16:55.050209 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:16:55.071154 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:16:55.146950 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:16:55.263640 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:16:55.270620 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:16:55.323478 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:16:55.354395 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:16:55.370353 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:16:55.387309 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:16:55.394293 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:16:55.398278 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:16:55.403267 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:16:55.433185 (MainThread): Partial parsing not enabled
2021-05-29 18:16:55.501005 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:16:55.530925 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:16:55.542894 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:16:55.554862 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:16:55.567829 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:16:55.582788 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:16:55.599741 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:16:55.610330 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:16:55.619480 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:16:55.627460 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:16:55.636437 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:16:55.644719 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:16:55.652894 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:16:55.661871 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:16:55.669604 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:16:55.677584 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:16:55.685851 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:16:55.706794 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:16:56.037130 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb36cab-e575-4764-925e-d4e6596f42fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3979B7448>]}
2021-05-29 18:16:56.052052 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb36cab-e575-4764-925e-d4e6596f42fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3979D9248>]}
2021-05-29 18:16:56.053050 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:16:56.063840 (MainThread): 
2021-05-29 18:16:56.064830 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:16:56.069815 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 18:16:56.070814 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:16:56.995994 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:16:56.995994 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:16:57.004368 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:16:58.326515 (MainThread): 15:16:58 | Concurrency: 1 threads (target='dev')
2021-05-29 18:16:58.328493 (MainThread): 15:16:58 | 
2021-05-29 18:16:58.339452 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 18:16:58.341473 (Thread-1): 15:16:58 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-29 18:16:58.345451 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:16:58.346433 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 18:16:58.361394 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:16:58.362394 (Thread-1): finished collecting timing info
2021-05-29 18:16:58.452150 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:16:58.467109 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:16:59.380859 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:16:59.381858 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-29 18:17:05.686919 (Thread-1): finished collecting timing info
2021-05-29 18:17:05.688914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb36cab-e575-4764-925e-d4e6596f42fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B394C16048>]}
2021-05-29 18:17:05.688914 (Thread-1): 15:17:05 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 7.34s]
2021-05-29 18:17:05.690911 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 18:17:05.800617 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:17:05.801615 (MainThread): 15:17:05 | 
2021-05-29 18:17:05.801615 (MainThread): 15:17:05 | Finished running 1 table model in 9.74s.
2021-05-29 18:17:05.802612 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:17:05.803610 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 18:17:05.803610 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:17:05.803610 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-29 18:17:05.826548 (MainThread): 
2021-05-29 18:17:05.827546 (MainThread): Completed successfully
2021-05-29 18:17:05.828542 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 18:17:05.830538 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B39B69CF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3994DB4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B397A573C8>]}
2021-05-29 18:17:05.830538 (MainThread): Flushing usage events
2021-05-29 18:21:23.190854 (MainThread): Running with dbt=0.19.1
2021-05-29 18:21:24.722650 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 18:21:24.726204 (MainThread): Tracking: tracking
2021-05-29 18:21:24.727205 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE3044648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE3043148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE3048888>]}
2021-05-29 18:21:24.765016 (MainThread): Partial parsing not enabled
2021-05-29 18:21:24.771992 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:21:24.849784 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:21:24.870987 (MainThread): Parsing macros\etc.sql
2021-05-29 18:21:24.876258 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:21:24.887991 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:21:24.915920 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:21:24.923899 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:21:24.929841 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:21:24.949790 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:21:24.966206 (MainThread): Parsing macros\core.sql
2021-05-29 18:21:24.976362 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:21:25.081084 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:21:25.099037 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:21:25.102327 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:21:25.106988 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:21:25.110980 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:21:25.114970 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:21:25.118332 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:21:25.140291 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:21:25.169251 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:21:25.174361 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:21:25.188154 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:21:25.232006 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:21:25.311053 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:21:25.315383 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:21:25.353285 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:21:25.376150 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:21:25.388952 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:21:25.405929 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:21:25.413908 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:21:25.417897 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:21:25.429865 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:21:25.452806 (MainThread): Partial parsing not enabled
2021-05-29 18:21:25.529736 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:21:25.570626 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:21:25.580599 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:21:25.592726 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:21:25.602633 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:21:25.615722 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:21:25.631411 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:21:25.648760 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:21:25.663480 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:21:25.676023 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:21:25.687819 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:21:25.698785 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:21:25.711529 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:21:25.722385 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:21:25.732323 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:21:25.743581 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:21:25.754923 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:21:25.789286 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:21:26.132348 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd3c04c-65a3-47c5-9cda-89e88b52a646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE674E8C8>]}
2021-05-29 18:21:26.147673 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd3c04c-65a3-47c5-9cda-89e88b52a646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE30182C8>]}
2021-05-29 18:21:26.148678 (MainThread): Found 17 models, 19 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:21:26.156652 (MainThread): 
2021-05-29 18:21:26.157651 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:21:26.162673 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:21:26.163671 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:21:26.181301 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:21:27.024043 (MainThread): 15:21:27 | Concurrency: 1 threads (target='dev')
2021-05-29 18:21:27.072930 (MainThread): 15:21:27 | 
2021-05-29 18:21:27.183615 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:21:27.184614 (Thread-1): 15:21:27 | 1 of 19 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 18:21:27.186608 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 18:21:27.187614 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:21:27.217526 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 18:21:27.226502 (Thread-1): finished collecting timing info
2021-05-29 18:21:27.226502 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:21:27.241461 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 18:21:30.068602 (Thread-1): finished collecting timing info
2021-05-29 18:21:30.069598 (Thread-1): 15:21:30 | 1 of 19 PASS not_null_dim_address_address_sk......................... [PASS in 2.88s]
2021-05-29 18:21:30.071594 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:21:30.071594 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:21:30.072592 (Thread-1): 15:21:30 | 2 of 19 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 18:21:30.073588 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 18:21:30.073588 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:21:30.081569 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 18:21:30.084557 (Thread-1): finished collecting timing info
2021-05-29 18:21:30.084557 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:30.095527 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 18:21:32.789907 (Thread-1): finished collecting timing info
2021-05-29 18:21:32.790904 (Thread-1): 15:21:32 | 2 of 19 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.72s]
2021-05-29 18:21:32.791902 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:21:32.791902 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:21:32.792901 (Thread-1): 15:21:32 | 3 of 19 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 18:21:32.793896 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 18:21:32.793896 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:21:32.796890 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64156), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:32.797896 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64157), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:32.797896 (Thread-1): unclosed <socket.socket fd=444, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64158), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:32.798882 (Thread-1): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64159), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:32.803804 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 18:21:32.805800 (Thread-1): finished collecting timing info
2021-05-29 18:21:32.806798 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:32.814810 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 18:21:35.852210 (Thread-1): finished collecting timing info
2021-05-29 18:21:35.854204 (Thread-1): 15:21:35 | 3 of 19 PASS not_null_dim_customer_customer_sk....................... [PASS in 3.06s]
2021-05-29 18:21:35.855204 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:21:35.855204 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:21:35.856200 (Thread-1): 15:21:35 | 4 of 19 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 18:21:35.857197 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 18:21:35.858194 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:21:35.869164 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 18:21:35.871158 (Thread-1): finished collecting timing info
2021-05-29 18:21:35.871158 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:35.883128 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 18:21:38.674798 (Thread-1): finished collecting timing info
2021-05-29 18:21:38.675795 (Thread-1): 15:21:38 | 4 of 19 PASS not_null_dim_product_product_sk......................... [PASS in 2.82s]
2021-05-29 18:21:38.678788 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:21:38.678788 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 18:21:38.679786 (Thread-1): 15:21:38 | 5 of 19 START test not_null_dim_reason_reason_sk..................... [RUN]
2021-05-29 18:21:38.681780 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_reason_sk".
2021-05-29 18:21:38.682793 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 18:21:38.692749 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_reason_sk"
2021-05-29 18:21:38.695741 (Thread-1): finished collecting timing info
2021-05-29 18:21:38.696740 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:38.713694 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where reason_sk is null



2021-05-29 18:21:40.051929 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/a414290c-11d5-4bc6-89f2-323128082a89?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_sk at [10:7]')
2021-05-29 18:21:41.913970 (Thread-1): finished collecting timing info
2021-05-29 18:21:41.915955 (Thread-1): Database Error in test not_null_dim_reason_reason_sk (models\marts\dim_reason.yml)
  Unrecognized name: reason_sk at [10:7]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reason_sk.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/1fd2435d-d835-43ac-a8ff-37dbf9b9dbd3?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_sk at [10:7]

(job ID: 1fd2435d-d835-43ac-a8ff-37dbf9b9dbd3)

                                                                       -----Query Job SQL Follows-----                                                                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_reason_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  10:where reason_sk is null
  11:
  12:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test not_null_dim_reason_reason_sk (models\marts\dim_reason.yml)
  Unrecognized name: reason_sk at [10:7]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reason_sk.sql
2021-05-29 18:21:42.040614 (Thread-1): 15:21:42 | 5 of 19 ERROR not_null_dim_reason_reason_sk.......................... [ERROR in 3.36s]
2021-05-29 18:21:42.045601 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_reason_sk
2021-05-29 18:21:42.045601 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:21:42.047596 (Thread-1): 15:21:42 | 6 of 19 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 18:21:42.049590 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 18:21:42.049590 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:21:42.064551 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 18:21:42.111425 (Thread-1): finished collecting timing info
2021-05-29 18:21:42.112422 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:42.129377 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 18:21:44.952313 (Thread-1): finished collecting timing info
2021-05-29 18:21:44.953315 (Thread-1): 15:21:44 | 6 of 19 PASS not_null_fact_order_details_salesorderid................ [PASS in 2.90s]
2021-05-29 18:21:44.954308 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:21:44.955307 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:21:44.956302 (Thread-1): 15:21:44 | 7 of 19 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 18:21:44.958297 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 18:21:44.958297 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:21:45.003177 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 18:21:45.009164 (Thread-1): finished collecting timing info
2021-05-29 18:21:45.009164 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:45.030106 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:21:48.184110 (Thread-1): finished collecting timing info
2021-05-29 18:21:48.186117 (Thread-1): 15:21:48 | 7 of 19 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 3.23s]
2021-05-29 18:21:48.188099 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:21:48.188099 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:21:48.189096 (Thread-1): 15:21:48 | 8 of 19 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 18:21:48.190093 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 18:21:48.191090 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:21:48.209044 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 18:21:48.211038 (Thread-1): finished collecting timing info
2021-05-29 18:21:48.212035 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:48.227990 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:21:51.291796 (Thread-1): finished collecting timing info
2021-05-29 18:21:51.292795 (Thread-1): 15:21:51 | 8 of 19 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 3.10s]
2021-05-29 18:21:51.295787 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:21:51.296801 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:21:51.298785 (Thread-1): 15:21:51 | 9 of 19 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 18:21:51.300772 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 18:21:51.300772 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:21:51.304762 (Thread-1): unclosed <socket.socket fd=1496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64194), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:51.305760 (Thread-1): unclosed <socket.socket fd=1372, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64195), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:51.320722 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 18:21:51.322713 (Thread-1): finished collecting timing info
2021-05-29 18:21:51.323713 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:51.337673 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:21:53.740879 (Thread-1): finished collecting timing info
2021-05-29 18:21:53.741876 (Thread-1): 15:21:53 | 9 of 19 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.44s]
2021-05-29 18:21:53.742877 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:21:53.743871 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:21:53.744867 (Thread-1): 15:21:53 | 10 of 19 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 18:21:53.745864 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 18:21:53.746864 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:21:53.760825 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 18:21:53.763817 (Thread-1): finished collecting timing info
2021-05-29 18:21:53.763817 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:53.779775 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:21:56.870508 (Thread-1): finished collecting timing info
2021-05-29 18:21:56.871505 (Thread-1): 15:21:56 | 10 of 19 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 3.13s]
2021-05-29 18:21:56.875495 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:21:56.876495 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 18:21:56.876495 (Thread-1): 15:21:56 | 11 of 19 START test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [RUN]
2021-05-29 18:21:56.881479 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_".
2021-05-29 18:21:56.882492 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 18:21:56.889457 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64161), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.890457 (Thread-1): unclosed <socket.socket fd=1404, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64162), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.891451 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64165), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.892450 (Thread-1): unclosed <socket.socket fd=688, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64164), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.892450 (Thread-1): unclosed <socket.socket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64172), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.897449 (Thread-1): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64171), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.899432 (Thread-1): unclosed <socket.socket fd=1384, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64180), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.900429 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64179), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.900429 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64186), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.901427 (Thread-1): unclosed <socket.socket fd=1504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64187), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.907412 (Thread-1): unclosed <socket.socket fd=1376, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64200), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.908408 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64201), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.909404 (Thread-1): unclosed <socket.socket fd=1572, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64203), raddr=('216.58.202.202', 443)>
2021-05-29 18:21:56.913393 (Thread-1): unclosed <socket.socket fd=1588, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64204), raddr=('142.250.218.10', 443)>
2021-05-29 18:21:56.943314 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"
2021-05-29 18:21:56.950303 (Thread-1): finished collecting timing info
2021-05-29 18:21:56.951294 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:21:56.990187 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"} */

    
    




select count(*) as validation_errors
from (
    select reason_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select reason_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:21:59.336044 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/9e3e954c-2c33-4359-a715-e5c9ebb02971?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_fk at [11:12]')
2021-05-29 18:22:01.196158 (Thread-1): finished collecting timing info
2021-05-29 18:22:01.197155 (Thread-1): Database Error in test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ (models\marts\fact_order_details.yml)
  Unrecognized name: reason_fk at [11:12]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\fact_order_details.yml\schema_test\relationships_fact_order_details_36c4d6813c3496d6bc9f1c6f5d938656.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/084d161b-cb9a-4e29-aec7-1653c8cdb355?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_fk at [11:12]

(job ID: 084d161b-cb9a-4e29-aec7-1653c8cdb355)

                                                                                            -----Query Job SQL Follows-----                                                                                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:
   9:select count(*) as validation_errors
  10:from (
  11:    select reason_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  12:) as child
  13:left join (
  14:    select reason_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  15:) as parent on parent.id = child.id
  16:where child.id is not null
  17:  and parent.id is null
  18:
  19:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ (models\marts\fact_order_details.yml)
  Unrecognized name: reason_fk at [11:12]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\fact_order_details.yml\schema_test\relationships_fact_order_details_36c4d6813c3496d6bc9f1c6f5d938656.sql
2021-05-29 18:22:01.200147 (Thread-1): 15:22:01 | 11 of 19 ERROR relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ [ERROR in 4.32s]
2021-05-29 18:22:01.202140 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_
2021-05-29 18:22:01.203137 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:01.203137 (Thread-1): 15:22:01 | 12 of 19 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:22:01.204134 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:22:01.205132 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:01.280451 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:22:01.304386 (Thread-1): finished collecting timing info
2021-05-29 18:22:01.306382 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:01.330317 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 18:22:04.055642 (Thread-1): finished collecting timing info
2021-05-29 18:22:04.057637 (Thread-1): 15:22:04 | 12 of 19 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.85s]
2021-05-29 18:22:04.090130 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:04.091128 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:04.091128 (Thread-1): 15:22:04 | 13 of 19 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:22:04.103095 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:22:04.104094 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:04.106087 (Thread-1): unclosed <socket.socket fd=676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64211), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:04.106087 (Thread-1): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64213), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:04.167921 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:22:04.169916 (Thread-1): finished collecting timing info
2021-05-29 18:22:04.169916 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:04.201831 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 18:22:07.020305 (Thread-1): finished collecting timing info
2021-05-29 18:22:07.021304 (Thread-1): 15:22:07 | 13 of 19 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 2.92s]
2021-05-29 18:22:07.024297 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:22:07.025292 (Thread-1): Began running node test.dw_adventure_works.test
2021-05-29 18:22:07.031276 (Thread-1): 15:22:07 | 14 of 19 START test test............................................. [RUN]
2021-05-29 18:22:07.034270 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:22:07.034270 (Thread-1): Compiling test.dw_adventure_works.test
2021-05-29 18:22:07.164919 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.test"
2021-05-29 18:22:07.169906 (Thread-1): finished collecting timing info
2021-05-29 18:22:07.173901 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:07.220770 (Thread-1): On test.dw_adventure_works.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation_id as (
        select count(distinct salesorderid) as ord_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )
  
    ,    validation_qt as (
        select sum(orderqty) as sum_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    ,    validation_price as (
        select sum(saleprice) as sum_price
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    select * from validation_id where ord_qty != 31465
    select * from validation_od where sum_qty != 274914
    select * from validation_ct where sum_price != 109846381.399888
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-29 18:22:08.940252 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/e490d101-01c1-42a5-a409-dd1f7fd7d37f?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]')
2021-05-29 18:22:10.797704 (Thread-1): finished collecting timing info
2021-05-29 18:22:10.798701 (Thread-1): Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/1412a566-b3c1-4643-8cdb-5f81391695dc?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]

(job ID: 1412a566-b3c1-4643-8cdb-5f81391695dc)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */
   2:
   3:with dbt__CTE__INTERNAL_test as (
   4:with   
   5:    validation_id as (
   6:        select count(distinct salesorderid) as ord_qty
   7:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   8:    )
   9:  
  10:    ,    validation_qt as (
  11:        select sum(orderqty) as sum_qty
  12:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  13:    )
  14:
  15:    ,    validation_price as (
  16:        select sum(saleprice) as sum_price
  17:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  18:    )
  19:
  20:    select * from validation_id where ord_qty != 31465
  21:    select * from validation_od where sum_qty != 274914
  22:    select * from validation_ct where sum_price != 109846381.399888
  23:)select count(*) from dbt__CTE__INTERNAL_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 46, in execute_data_test
    test.compiled_sql, auto_begin=True, fetch=True
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:22:10.802691 (Thread-1): 15:22:10 | 14 of 19 ERROR test.................................................. [ERROR in 3.77s]
2021-05-29 18:22:10.804685 (Thread-1): Finished running node test.dw_adventure_works.test
2021-05-29 18:22:10.804685 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:22:10.805685 (Thread-1): 15:22:10 | 15 of 19 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 18:22:10.807677 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 18:22:10.809674 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:22:10.824632 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 18:22:10.829808 (Thread-1): finished collecting timing info
2021-05-29 18:22:10.829808 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:10.845760 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:22:14.043568 (Thread-1): finished collecting timing info
2021-05-29 18:22:14.044567 (Thread-1): 15:22:14 | 15 of 19 PASS unique_dim_address_address_sk.......................... [PASS in 3.24s]
2021-05-29 18:22:14.046560 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:22:14.046560 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:22:14.047562 (Thread-1): 15:22:14 | 16 of 19 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 18:22:14.048555 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 18:22:14.049084 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:22:14.063718 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 18:22:14.066712 (Thread-1): finished collecting timing info
2021-05-29 18:22:14.067719 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:14.083664 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:22:16.320283 (Thread-1): finished collecting timing info
2021-05-29 18:22:16.322277 (Thread-1): 15:22:16 | 16 of 19 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.27s]
2021-05-29 18:22:16.326285 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:22:16.329282 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:22:16.331255 (Thread-1): 15:22:16 | 17 of 19 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 18:22:16.333251 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 18:22:16.333251 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:22:16.336238 (Thread-1): unclosed <socket.socket fd=1764, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64225), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:16.337237 (Thread-1): unclosed <socket.socket fd=1808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64226), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:16.354191 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 18:22:16.363793 (Thread-1): finished collecting timing info
2021-05-29 18:22:16.365766 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:16.381238 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:22:19.837585 (Thread-1): finished collecting timing info
2021-05-29 18:22:19.838590 (Thread-1): 15:22:19 | 17 of 19 PASS unique_dim_customer_customer_sk........................ [PASS in 3.51s]
2021-05-29 18:22:19.846562 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:22:19.847558 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:22:19.848555 (Thread-1): 15:22:19 | 18 of 19 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 18:22:19.849553 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 18:22:19.850550 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:22:19.867039 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 18:22:19.893981 (Thread-1): finished collecting timing info
2021-05-29 18:22:19.895988 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:19.917902 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:22:22.854288 (Thread-1): finished collecting timing info
2021-05-29 18:22:22.855286 (Thread-1): 15:22:22 | 18 of 19 PASS unique_dim_product_product_sk.......................... [PASS in 3.01s]
2021-05-29 18:22:22.866256 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:22:22.867254 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 18:22:22.868251 (Thread-1): 15:22:22 | 19 of 19 START test unique_dim_reason_reason_sk...................... [RUN]
2021-05-29 18:22:22.869248 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_reason_sk".
2021-05-29 18:22:22.869248 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 18:22:22.882213 (Thread-1): unclosed <socket.socket fd=836, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64208), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.883211 (Thread-1): unclosed <socket.socket fd=1504, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64210), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.894245 (Thread-1): unclosed <socket.socket fd=1336, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64215), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.896178 (Thread-1): unclosed <socket.socket fd=1676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64216), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.896178 (Thread-1): unclosed <socket.socket fd=1624, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64220), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.897173 (Thread-1): unclosed <socket.socket fd=1692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64219), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.897173 (Thread-1): unclosed <socket.socket fd=1612, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64221), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.898174 (Thread-1): unclosed <socket.socket fd=1744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64222), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.904159 (Thread-1): unclosed <socket.socket fd=1856, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64231), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.905152 (Thread-1): unclosed <socket.socket fd=1832, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64232), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.906151 (Thread-1): unclosed <socket.socket fd=1884, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64234), raddr=('216.58.202.202', 443)>
2021-05-29 18:22:22.907148 (Thread-1): unclosed <socket.socket fd=1896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64236), raddr=('142.250.218.10', 443)>
2021-05-29 18:22:22.922111 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_reason_sk"
2021-05-29 18:22:22.930087 (Thread-1): finished collecting timing info
2021-05-29 18:22:22.931094 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:22:22.948038 (Thread-1): On test.dw_adventure_works.unique_dim_reason_reason_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reason_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        reason_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where reason_sk is not null
    group by reason_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:22:24.299462 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/4f6d6230-635f-45f9-b561-31070002ac78?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_sk at [15:11]')
2021-05-29 18:22:26.182331 (Thread-1): finished collecting timing info
2021-05-29 18:22:26.183329 (Thread-1): Database Error in test unique_dim_reason_reason_sk (models\marts\dim_reason.yml)
  Unrecognized name: reason_sk at [15:11]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reason_sk.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/765db2d6-3ab9-4a5e-9099-a4bf6efb12cd?maxResults=0&location=US&prettyPrint=false: Unrecognized name: reason_sk at [15:11]

(job ID: 765db2d6-3ab9-4a5e-9099-a4bf6efb12cd)

                                                                      -----Query Job SQL Follows-----                                                                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_reason_sk"} */
   2:
   3:    
   4:    
   5:
   6:
   7:
   8:select count(*) as validation_errors
   9:from (
  10:
  11:    select
  12:        reason_sk
  13:
  14:    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  15:    where reason_sk is not null
  16:    group by reason_sk
  17:    having count(*) > 1
  18:
  19:) validation_errors
  20:
  21:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 85, in execute
    failed_rows = self.execute_schema_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 65, in execute_schema_test
    fetch=True,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test unique_dim_reason_reason_sk (models\marts\dim_reason.yml)
  Unrecognized name: reason_sk at [15:11]
  compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reason_sk.sql
2021-05-29 18:22:26.186321 (Thread-1): 15:22:26 | 19 of 19 ERROR unique_dim_reason_reason_sk........................... [ERROR in 3.32s]
2021-05-29 18:22:26.194314 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_reason_sk
2021-05-29 18:22:26.319966 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:22:26.323957 (MainThread): 15:22:26 | 
2021-05-29 18:22:26.325954 (MainThread): 15:22:26 | Finished running 19 tests in 60.17s.
2021-05-29 18:22:26.326948 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:22:26.327944 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:22:26.327944 (MainThread): Connection 'test.dw_adventure_works.unique_dim_reason_reason_sk' was properly closed.
2021-05-29 18:22:26.414711 (MainThread): 
2021-05-29 18:22:26.414711 (MainThread): Completed with 4 errors and 0 warnings:
2021-05-29 18:22:26.416706 (MainThread): 
2021-05-29 18:22:26.417703 (MainThread): Database Error in test not_null_dim_reason_reason_sk (models\marts\dim_reason.yml)
2021-05-29 18:22:26.419703 (MainThread):   Unrecognized name: reason_sk at [10:7]
2021-05-29 18:22:26.420696 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\not_null_dim_reason_reason_sk.sql
2021-05-29 18:22:26.422691 (MainThread): 
2021-05-29 18:22:26.426679 (MainThread): Database Error in test relationships_fact_order_details_reason_fk__reason_sk__ref_dim_reason_ (models\marts\fact_order_details.yml)
2021-05-29 18:22:26.429671 (MainThread):   Unrecognized name: reason_fk at [11:12]
2021-05-29 18:22:26.431666 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\fact_order_details.yml\schema_test\relationships_fact_order_details_36c4d6813c3496d6bc9f1c6f5d938656.sql
2021-05-29 18:22:26.433669 (MainThread): 
2021-05-29 18:22:26.434658 (MainThread): Database Error in test test (tests\test.sql)
2021-05-29 18:22:26.437649 (MainThread):   Syntax error: Expected ")" but got keyword SELECT at [21:5]
2021-05-29 18:22:26.444630 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:22:26.446628 (MainThread): 
2021-05-29 18:22:26.447629 (MainThread): Database Error in test unique_dim_reason_reason_sk (models\marts\dim_reason.yml)
2021-05-29 18:22:26.448622 (MainThread):   Unrecognized name: reason_sk at [15:11]
2021-05-29 18:22:26.451131 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\models\marts\dim_reason.yml\schema_test\unique_dim_reason_reason_sk.sql
2021-05-29 18:22:26.453125 (MainThread): 
Done. PASS=15 WARN=0 ERROR=4 SKIP=0 TOTAL=19
2021-05-29 18:22:26.473087 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE3084D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7DB35C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7D36108>]}
2021-05-29 18:22:26.476063 (MainThread): Flushing usage events
2021-05-29 18:28:32.742630 (MainThread): Running with dbt=0.19.1
2021-05-29 18:28:34.041334 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 18:28:34.043481 (MainThread): Tracking: tracking
2021-05-29 18:28:34.044481 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028523EAAB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028523EA4088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028523EA4208>]}
2021-05-29 18:28:34.071709 (MainThread): Partial parsing not enabled
2021-05-29 18:28:34.075215 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:28:34.134582 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:28:34.157519 (MainThread): Parsing macros\etc.sql
2021-05-29 18:28:34.162505 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:28:34.182453 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:28:34.226334 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:28:34.236308 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:28:34.241294 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:28:34.268241 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:28:34.288063 (MainThread): Parsing macros\core.sql
2021-05-29 18:28:34.296896 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:28:34.409846 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:28:34.448228 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:28:34.454220 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:28:34.458795 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:28:34.466246 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:28:34.472228 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:28:34.475253 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:28:34.498161 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:28:34.534065 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:28:34.540736 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:28:34.560333 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:28:34.610716 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:28:34.717648 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:28:34.724245 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:28:34.769673 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:28:34.793609 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:28:34.807571 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:28:34.828526 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:28:34.838492 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:28:34.842480 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:28:34.848060 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:28:34.864021 (MainThread): Partial parsing not enabled
2021-05-29 18:28:34.928623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:28:34.960538 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:28:34.972058 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:28:34.987980 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:28:34.998948 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:28:35.010831 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:28:35.024796 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:28:35.036728 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:28:35.047699 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:28:35.059716 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:28:35.069685 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:28:35.079060 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:28:35.091630 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:28:35.102984 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:28:35.112704 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:28:35.124635 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:28:35.137599 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:28:35.172507 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:28:35.557979 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac26d1a0-c554-4bd0-a136-15a155584a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002852792C448>]}
2021-05-29 18:28:35.632012 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac26d1a0-c554-4bd0-a136-15a155584a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028523E74308>]}
2021-05-29 18:28:35.635022 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:28:35.645621 (MainThread): 
2021-05-29 18:28:35.646902 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:28:35.653890 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:28:35.654886 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:28:35.680107 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:28:37.121215 (MainThread): 15:28:37 | Concurrency: 1 threads (target='dev')
2021-05-29 18:28:37.122225 (MainThread): 15:28:37 | 
2021-05-29 18:28:37.130190 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:28:37.130190 (Thread-1): 15:28:37 | 1 of 18 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 18:28:37.132191 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 18:28:37.132191 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:28:37.147151 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 18:28:37.153133 (Thread-1): finished collecting timing info
2021-05-29 18:28:37.154169 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:28:37.161770 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 18:28:39.969758 (Thread-1): finished collecting timing info
2021-05-29 18:28:39.971752 (Thread-1): 15:28:39 | 1 of 18 PASS not_null_dim_address_address_sk......................... [PASS in 2.84s]
2021-05-29 18:28:39.974743 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:28:39.975744 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:28:39.976743 (Thread-1): 15:28:39 | 2 of 18 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 18:28:39.979737 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 18:28:39.979737 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:28:39.991699 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 18:28:39.995699 (Thread-1): finished collecting timing info
2021-05-29 18:28:39.996684 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:40.006607 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 18:28:42.746974 (Thread-1): finished collecting timing info
2021-05-29 18:28:42.751956 (Thread-1): 15:28:42 | 2 of 18 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.77s]
2021-05-29 18:28:42.755943 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:28:42.756943 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:28:42.756943 (Thread-1): 15:28:42 | 3 of 18 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 18:28:42.758945 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 18:28:42.759936 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:28:42.764921 (Thread-1): unclosed <socket.socket fd=1368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64312), raddr=('172.217.28.10', 443)>
2021-05-29 18:28:42.767917 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64313), raddr=('142.250.218.10', 443)>
2021-05-29 18:28:42.774930 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 18:28:42.777748 (Thread-1): finished collecting timing info
2021-05-29 18:28:42.778771 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:42.786745 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 18:28:42.946288 (Thread-1): unclosed <socket.socket fd=796, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64310), raddr=('172.217.28.10', 443)>
2021-05-29 18:28:42.947288 (Thread-1): unclosed <socket.socket fd=1364, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64311), raddr=('142.250.218.10', 443)>
2021-05-29 18:28:45.491113 (Thread-1): finished collecting timing info
2021-05-29 18:28:45.491113 (Thread-1): 15:28:45 | 3 of 18 PASS not_null_dim_customer_customer_sk....................... [PASS in 2.73s]
2021-05-29 18:28:45.493074 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:28:45.493074 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:28:45.494067 (Thread-1): 15:28:45 | 4 of 18 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 18:28:45.495063 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 18:28:45.495063 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:28:45.504041 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 18:28:45.506036 (Thread-1): finished collecting timing info
2021-05-29 18:28:45.507032 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:45.517004 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 18:28:48.185889 (Thread-1): finished collecting timing info
2021-05-29 18:28:48.185889 (Thread-1): 15:28:48 | 4 of 18 PASS not_null_dim_product_product_sk......................... [PASS in 2.69s]
2021-05-29 18:28:48.187883 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:28:48.188881 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:28:48.188881 (Thread-1): 15:28:48 | 5 of 18 START test not_null_dim_reason_salesorder_sk................. [RUN]
2021-05-29 18:28:48.190876 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_salesorder_sk".
2021-05-29 18:28:48.190876 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:28:48.192871 (Thread-1): unclosed <socket.socket fd=1344, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64316), raddr=('172.217.28.10', 443)>
2021-05-29 18:28:48.192871 (Thread-1): unclosed <socket.socket fd=1408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64317), raddr=('142.250.218.10', 443)>
2021-05-29 18:28:48.203841 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_salesorder_sk"
2021-05-29 18:28:48.205835 (Thread-1): finished collecting timing info
2021-05-29 18:28:48.206833 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:48.219797 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_salesorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_salesorder_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where salesorder_sk is null



2021-05-29 18:28:50.559349 (Thread-1): finished collecting timing info
2021-05-29 18:28:50.561340 (Thread-1): 15:28:50 | 5 of 18 PASS not_null_dim_reason_salesorder_sk....................... [PASS in 2.37s]
2021-05-29 18:28:50.565328 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:28:50.566325 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:28:50.568327 (Thread-1): 15:28:50 | 6 of 18 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 18:28:50.571314 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 18:28:50.572309 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:28:50.593254 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 18:28:50.821927 (Thread-1): finished collecting timing info
2021-05-29 18:28:50.822922 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:50.834887 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 18:28:53.553669 (Thread-1): finished collecting timing info
2021-05-29 18:28:53.554666 (Thread-1): 15:28:53 | 6 of 18 PASS not_null_fact_order_details_salesorderid................ [PASS in 2.99s]
2021-05-29 18:28:53.559653 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:28:53.560651 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:28:53.560651 (Thread-1): 15:28:53 | 7 of 18 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 18:28:53.563645 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 18:28:53.563645 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:28:53.566636 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64320), raddr=('172.217.28.10', 443)>
2021-05-29 18:28:53.566636 (Thread-1): unclosed <socket.socket fd=1428, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64321), raddr=('142.250.218.10', 443)>
2021-05-29 18:28:53.592567 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 18:28:53.595560 (Thread-1): finished collecting timing info
2021-05-29 18:28:53.596556 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:53.608523 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:28:56.409682 (Thread-1): finished collecting timing info
2021-05-29 18:28:56.411678 (Thread-1): 15:28:56 | 7 of 18 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 2.85s]
2021-05-29 18:28:56.421650 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:28:56.421650 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:28:56.422647 (Thread-1): 15:28:56 | 8 of 18 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 18:28:56.424645 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 18:28:56.425643 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:28:56.453565 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 18:28:56.456556 (Thread-1): finished collecting timing info
2021-05-29 18:28:56.457554 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:56.472514 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:28:59.243474 (Thread-1): finished collecting timing info
2021-05-29 18:28:59.245487 (Thread-1): 15:28:59 | 8 of 18 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.82s]
2021-05-29 18:28:59.255444 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:28:59.255444 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:28:59.256443 (Thread-1): 15:28:59 | 9 of 18 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 18:28:59.257438 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 18:28:59.257438 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:28:59.259432 (Thread-1): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64324), raddr=('172.217.28.10', 443)>
2021-05-29 18:28:59.260431 (Thread-1): unclosed <socket.socket fd=1480, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64325), raddr=('142.250.218.10', 443)>
2021-05-29 18:28:59.270405 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 18:28:59.277428 (Thread-1): finished collecting timing info
2021-05-29 18:28:59.278431 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:28:59.289394 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:29:02.072542 (Thread-1): finished collecting timing info
2021-05-29 18:29:02.073539 (Thread-1): 15:29:02 | 9 of 18 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.82s]
2021-05-29 18:29:02.075536 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:29:02.075536 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:29:02.076534 (Thread-1): 15:29:02 | 10 of 18 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 18:29:02.079554 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 18:29:02.081538 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:29:02.100469 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 18:29:02.105453 (Thread-1): finished collecting timing info
2021-05-29 18:29:02.106454 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:02.121411 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:29:04.870126 (Thread-1): finished collecting timing info
2021-05-29 18:29:04.871124 (Thread-1): 15:29:04 | 10 of 18 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 2.79s]
2021-05-29 18:29:04.874116 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:29:04.875115 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:04.877107 (Thread-1): 15:29:04 | 11 of 18 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:29:04.880117 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:29:04.881095 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:04.886083 (Thread-1): unclosed <socket.socket fd=1548, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64328), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:04.888078 (Thread-1): unclosed <socket.socket fd=684, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64329), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:04.901041 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:29:04.974167 (Thread-1): finished collecting timing info
2021-05-29 18:29:04.975166 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:05.002090 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 18:29:05.489898 (Thread-1): unclosed <socket.socket fd=1368, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64318), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:05.490896 (Thread-1): unclosed <socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64319), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:05.498911 (Thread-1): unclosed <socket.socket fd=1472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64322), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:05.499910 (Thread-1): unclosed <socket.socket fd=1420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64323), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:05.505853 (Thread-1): unclosed <socket.socket fd=1488, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64326), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:05.506889 (Thread-1): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64327), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:07.385969 (Thread-1): finished collecting timing info
2021-05-29 18:29:07.385969 (Thread-1): 15:29:07 | 11 of 18 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.51s]
2021-05-29 18:29:07.387966 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:07.387966 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:07.388962 (Thread-1): 15:29:07 | 12 of 18 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:29:07.389958 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:29:07.390958 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:07.406911 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:29:07.407911 (Thread-1): finished collecting timing info
2021-05-29 18:29:07.408908 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:07.417882 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 18:29:10.249026 (Thread-1): finished collecting timing info
2021-05-29 18:29:10.251021 (Thread-1): 15:29:10 | 12 of 18 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 2.86s]
2021-05-29 18:29:10.252018 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:29:10.253016 (Thread-1): Began running node test.dw_adventure_works.test
2021-05-29 18:29:10.254015 (Thread-1): 15:29:10 | 13 of 18 START test test............................................. [RUN]
2021-05-29 18:29:10.255010 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:29:10.255010 (Thread-1): Compiling test.dw_adventure_works.test
2021-05-29 18:29:10.289916 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.test"
2021-05-29 18:29:10.291931 (Thread-1): finished collecting timing info
2021-05-29 18:29:10.294933 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:10.308886 (Thread-1): On test.dw_adventure_works.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation_id as (
        select count(distinct salesorderid) as ord_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )
  
    ,    validation_qt as (
        select sum(orderqty) as sum_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    ,    validation_price as (
        select sum(saleprice) as sum_price
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    select * from validation_id where ord_qty != 31465
    select * from validation_od where sum_qty != 274914
    select * from validation_ct where sum_price != 109846381.399888
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-29 18:29:11.957021 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/ecda3b01-e587-46e0-b4f3-d5d7dc3200ef?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]')
2021-05-29 18:29:13.808737 (Thread-1): finished collecting timing info
2021-05-29 18:29:13.810753 (Thread-1): Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/b024b5ba-c92c-4b6f-8b3d-b6b9b21cfb08?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]

(job ID: b024b5ba-c92c-4b6f-8b3d-b6b9b21cfb08)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */
   2:
   3:with dbt__CTE__INTERNAL_test as (
   4:with   
   5:    validation_id as (
   6:        select count(distinct salesorderid) as ord_qty
   7:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   8:    )
   9:  
  10:    ,    validation_qt as (
  11:        select sum(orderqty) as sum_qty
  12:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  13:    )
  14:
  15:    ,    validation_price as (
  16:        select sum(saleprice) as sum_price
  17:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  18:    )
  19:
  20:    select * from validation_id where ord_qty != 31465
  21:    select * from validation_od where sum_qty != 274914
  22:    select * from validation_ct where sum_price != 109846381.399888
  23:)select count(*) from dbt__CTE__INTERNAL_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 46, in execute_data_test
    test.compiled_sql, auto_begin=True, fetch=True
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:29:13.840033 (Thread-1): 15:29:13 | 13 of 18 ERROR test.................................................. [ERROR in 3.59s]
2021-05-29 18:29:13.841029 (Thread-1): Finished running node test.dw_adventure_works.test
2021-05-29 18:29:13.842031 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:29:13.842031 (Thread-1): 15:29:13 | 14 of 18 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 18:29:13.849011 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 18:29:13.849011 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:29:13.863994 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 18:29:13.866959 (Thread-1): finished collecting timing info
2021-05-29 18:29:13.866959 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:13.877949 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:29:16.597585 (Thread-1): finished collecting timing info
2021-05-29 18:29:16.600623 (Thread-1): 15:29:16 | 14 of 18 PASS unique_dim_address_address_sk.......................... [PASS in 2.75s]
2021-05-29 18:29:16.603567 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:29:16.603567 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:29:16.604564 (Thread-1): 15:29:16 | 15 of 18 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 18:29:16.605561 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 18:29:16.606558 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:29:16.625508 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 18:29:16.626505 (Thread-1): finished collecting timing info
2021-05-29 18:29:16.630514 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:16.710282 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:29:19.613988 (Thread-1): finished collecting timing info
2021-05-29 18:29:19.615981 (Thread-1): 15:29:19 | 15 of 18 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 3.01s]
2021-05-29 18:29:19.618974 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:29:19.619972 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:29:19.620970 (Thread-1): 15:29:19 | 16 of 18 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 18:29:19.621966 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 18:29:19.621966 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:29:19.625954 (Thread-1): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64338), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:19.625954 (Thread-1): unclosed <socket.socket fd=1704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64339), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:19.638921 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 18:29:19.644905 (Thread-1): finished collecting timing info
2021-05-29 18:29:19.644905 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:19.658867 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:29:21.945258 (Thread-1): finished collecting timing info
2021-05-29 18:29:21.947253 (Thread-1): 15:29:21 | 16 of 18 PASS unique_dim_customer_customer_sk........................ [PASS in 2.33s]
2021-05-29 18:29:21.949249 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:29:21.950247 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:29:21.950247 (Thread-1): 15:29:21 | 17 of 18 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 18:29:21.952246 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 18:29:21.953238 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:29:21.980165 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 18:29:21.984174 (Thread-1): finished collecting timing info
2021-05-29 18:29:21.985151 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:22.006201 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:29:24.876771 (Thread-1): finished collecting timing info
2021-05-29 18:29:24.878768 (Thread-1): 15:29:24 | 17 of 18 PASS unique_dim_product_product_sk.......................... [PASS in 2.93s]
2021-05-29 18:29:24.880760 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:29:24.881758 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:29:24.882754 (Thread-1): 15:29:24 | 18 of 18 START test unique_dim_reason_salesorder_sk.................. [RUN]
2021-05-29 18:29:24.883752 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_salesorder_sk".
2021-05-29 18:29:24.884748 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:29:24.899709 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_salesorder_sk"
2021-05-29 18:29:24.901703 (Thread-1): finished collecting timing info
2021-05-29 18:29:24.902701 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:29:24.915688 (Thread-1): On test.dw_adventure_works.unique_dim_reason_salesorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_salesorder_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorder_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where salesorder_sk is not null
    group by salesorder_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:29:27.956025 (Thread-1): finished collecting timing info
2021-05-29 18:29:27.957022 (Thread-1): 15:29:27 | 18 of 18 PASS unique_dim_reason_salesorder_sk........................ [PASS in 3.07s]
2021-05-29 18:29:27.959018 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:29:28.003896 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:29:28.005891 (MainThread): 15:29:28 | 
2021-05-29 18:29:28.007887 (MainThread): 15:29:28 | Finished running 18 tests in 52.36s.
2021-05-29 18:29:28.008884 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:29:28.009881 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:29:28.009881 (MainThread): Connection 'test.dw_adventure_works.unique_dim_reason_salesorder_sk' was properly closed.
2021-05-29 18:29:28.025840 (MainThread): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64333), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:28.026836 (MainThread): unclosed <socket.socket fd=1588, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64332), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:28.027833 (MainThread): unclosed <socket.socket fd=1636, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64335), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:28.027833 (MainThread): unclosed <socket.socket fd=1624, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64334), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:28.028839 (MainThread): unclosed <socket.socket fd=1660, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64337), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:28.029827 (MainThread): unclosed <socket.socket fd=1684, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64336), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:28.036809 (MainThread): unclosed <socket.socket fd=912, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64341), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:28.037807 (MainThread): unclosed <socket.socket fd=1692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64340), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:28.037807 (MainThread): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64345), raddr=('172.217.28.10', 443)>
2021-05-29 18:29:28.038803 (MainThread): unclosed <socket.socket fd=1724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64347), raddr=('142.250.218.10', 443)>
2021-05-29 18:29:28.092658 (MainThread): 
2021-05-29 18:29:28.093665 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 18:29:28.094654 (MainThread): 
2021-05-29 18:29:28.095654 (MainThread): Database Error in test test (tests\test.sql)
2021-05-29 18:29:28.096651 (MainThread):   Syntax error: Expected ")" but got keyword SELECT at [21:5]
2021-05-29 18:29:28.097647 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:29:28.098644 (MainThread): 
Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
2021-05-29 18:29:28.104627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028527BBDF48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028527893A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285275A0448>]}
2021-05-29 18:29:28.105638 (MainThread): Flushing usage events
2021-05-29 18:31:05.616322 (MainThread): Running with dbt=0.19.1
2021-05-29 18:31:07.268391 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-05-29 18:31:07.274373 (MainThread): Tracking: tracking
2021-05-29 18:31:07.276368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257200C0648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257201C42C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257201C4408>]}
2021-05-29 18:31:07.316261 (MainThread): Partial parsing not enabled
2021-05-29 18:31:07.331222 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:31:07.425033 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:31:07.441962 (MainThread): Parsing macros\etc.sql
2021-05-29 18:31:07.446950 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:31:07.460914 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:31:07.490832 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:31:07.504794 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:31:07.511777 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:31:07.541244 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:31:07.553801 (MainThread): Parsing macros\core.sql
2021-05-29 18:31:07.596880 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:31:07.734511 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:31:07.754455 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:31:07.759045 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:31:07.763038 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:31:07.768026 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:31:07.773011 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:31:07.776004 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:31:07.806922 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:31:07.854793 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:31:07.861775 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:31:07.882718 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:31:07.935583 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:31:08.003346 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:31:08.008350 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:31:08.044256 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:31:08.059252 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:31:08.070188 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:31:08.084343 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:31:08.090369 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:31:08.094322 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:31:08.098348 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:31:08.112274 (MainThread): Partial parsing not enabled
2021-05-29 18:31:08.164136 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:31:08.187075 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:31:08.195565 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:31:08.204813 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:31:08.213744 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:31:08.222723 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:31:08.235476 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:31:08.243857 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:31:08.253811 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:31:08.262502 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:31:08.270834 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:31:08.279119 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:31:08.287099 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:31:08.295965 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:31:08.303943 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:31:08.313136 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:31:08.321005 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:31:08.347027 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:31:08.673672 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c1cc516-0167-4290-9d24-d70c14dc419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257238BF1C8>]}
2021-05-29 18:31:08.687602 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c1cc516-0167-4290-9d24-d70c14dc419c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025720195208>]}
2021-05-29 18:31:08.688600 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:31:08.696443 (MainThread): 
2021-05-29 18:31:08.697283 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:31:08.703707 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:31:08.704709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:31:08.713686 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:31:10.096990 (MainThread): 15:31:10 | Concurrency: 1 threads (target='dev')
2021-05-29 18:31:10.098986 (MainThread): 15:31:10 | 
2021-05-29 18:31:10.115876 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:31:10.116884 (Thread-1): 15:31:10 | 1 of 18 START test not_null_dim_address_address_sk................... [RUN]
2021-05-29 18:31:10.120821 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 18:31:10.121827 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:31:10.162704 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 18:31:10.165695 (Thread-1): finished collecting timing info
2021-05-29 18:31:10.166694 (Thread-1): Opening a new connection, currently in state init
2021-05-29 18:31:10.179660 (Thread-1): On test.dw_adventure_works.not_null_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_address`
where address_sk is null



2021-05-29 18:31:12.956556 (Thread-1): finished collecting timing info
2021-05-29 18:31:12.957548 (Thread-1): 15:31:12 | 1 of 18 PASS not_null_dim_address_address_sk......................... [PASS in 2.84s]
2021-05-29 18:31:12.958545 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:31:12.959544 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:31:12.959544 (Thread-1): 15:31:12 | 2 of 18 START test not_null_dim_creditcard_creditcard_sk............. [RUN]
2021-05-29 18:31:12.960539 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 18:31:12.961537 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:31:12.968521 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 18:31:12.969514 (Thread-1): finished collecting timing info
2021-05-29 18:31:12.970513 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:12.978494 (Thread-1): On test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
where creditcard_sk is null



2021-05-29 18:31:15.818066 (Thread-1): finished collecting timing info
2021-05-29 18:31:15.822078 (Thread-1): 15:31:15 | 2 of 18 PASS not_null_dim_creditcard_creditcard_sk................... [PASS in 2.86s]
2021-05-29 18:31:15.825046 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:31:15.826046 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:31:15.826046 (Thread-1): 15:31:15 | 3 of 18 START test not_null_dim_customer_customer_sk................. [RUN]
2021-05-29 18:31:15.827569 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 18:31:15.827569 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:31:15.830546 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64378), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:15.832542 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64379), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:15.848499 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 18:31:15.859470 (Thread-1): finished collecting timing info
2021-05-29 18:31:15.859470 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:15.881411 (Thread-1): On test.dw_adventure_works.not_null_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
where customer_sk is null



2021-05-29 18:31:16.362275 (Thread-1): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64376), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:16.363272 (Thread-1): unclosed <socket.socket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64377), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:19.294045 (Thread-1): finished collecting timing info
2021-05-29 18:31:19.295043 (Thread-1): 15:31:19 | 3 of 18 PASS not_null_dim_customer_customer_sk....................... [PASS in 3.47s]
2021-05-29 18:31:19.297037 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:31:19.297037 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:31:19.298039 (Thread-1): 15:31:19 | 4 of 18 START test not_null_dim_product_product_sk................... [RUN]
2021-05-29 18:31:19.306036 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 18:31:19.307009 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:31:19.315986 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 18:31:19.321980 (Thread-1): finished collecting timing info
2021-05-29 18:31:19.323964 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:19.336944 (Thread-1): On test.dw_adventure_works.not_null_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_product`
where product_sk is null



2021-05-29 18:31:22.164075 (Thread-1): finished collecting timing info
2021-05-29 18:31:22.165071 (Thread-1): 15:31:22 | 4 of 18 PASS not_null_dim_product_product_sk......................... [PASS in 2.86s]
2021-05-29 18:31:22.167070 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:31:22.167070 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:31:22.168065 (Thread-1): 15:31:22 | 5 of 18 START test not_null_dim_reason_salesorder_sk................. [RUN]
2021-05-29 18:31:22.169061 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_salesorder_sk".
2021-05-29 18:31:22.170062 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:31:22.171060 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64384), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:22.171060 (Thread-1): unclosed <socket.socket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64385), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:22.178070 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_salesorder_sk"
2021-05-29 18:31:22.180032 (Thread-1): finished collecting timing info
2021-05-29 18:31:22.180032 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:22.191002 (Thread-1): On test.dw_adventure_works.not_null_dim_reason_salesorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_dim_reason_salesorder_sk"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
where salesorder_sk is null



2021-05-29 18:31:25.068719 (Thread-1): finished collecting timing info
2021-05-29 18:31:25.069755 (Thread-1): 15:31:25 | 5 of 18 PASS not_null_dim_reason_salesorder_sk....................... [PASS in 2.90s]
2021-05-29 18:31:25.070712 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:31:25.071710 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:31:25.071710 (Thread-1): 15:31:25 | 6 of 18 START test not_null_fact_order_details_salesorderid.......... [RUN]
2021-05-29 18:31:25.072707 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 18:31:25.073705 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:31:25.079691 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 18:31:25.082682 (Thread-1): finished collecting timing info
2021-05-29 18:31:25.083679 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:25.090695 (Thread-1): On test.dw_adventure_works.not_null_fact_order_details_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.not_null_fact_order_details_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
where salesorderid is null



2021-05-29 18:31:27.921133 (Thread-1): finished collecting timing info
2021-05-29 18:31:27.923128 (Thread-1): 15:31:27 | 6 of 18 PASS not_null_fact_order_details_salesorderid................ [PASS in 2.85s]
2021-05-29 18:31:27.928112 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:31:27.930101 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:31:27.934093 (Thread-1): 15:31:27 | 7 of 18 START test relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [RUN]
2021-05-29 18:31:27.938103 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 18:31:27.939075 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:31:27.945057 (Thread-1): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64389), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:27.946055 (Thread-1): unclosed <socket.socket fd=1196, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64390), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:27.962045 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 18:31:27.967480 (Thread-1): finished collecting timing info
2021-05-29 18:31:27.968488 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:27.976463 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"} */

    
    




select count(*) as validation_errors
from (
    select address_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select address_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_address`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:31:30.807245 (Thread-1): finished collecting timing info
2021-05-29 18:31:30.809241 (Thread-1): 15:31:30 | 7 of 18 PASS relationships_fact_order_details_address_fk__address_sk__ref_dim_address_ [PASS in 2.87s]
2021-05-29 18:31:30.814791 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:31:30.815788 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:31:30.817785 (Thread-1): 15:31:30 | 8 of 18 START test relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [RUN]
2021-05-29 18:31:30.821769 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 18:31:30.822769 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:31:30.843710 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 18:31:30.918141 (Thread-1): finished collecting timing info
2021-05-29 18:31:30.920135 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:30.952050 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"} */

    
    




select count(*) as validation_errors
from (
    select creditcard_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select creditcard_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:31:33.253297 (Thread-1): finished collecting timing info
2021-05-29 18:31:33.255289 (Thread-1): 15:31:33 | 8 of 18 PASS relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_ [PASS in 2.43s]
2021-05-29 18:31:33.260268 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:31:33.262272 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:31:33.263260 (Thread-1): 15:31:33 | 9 of 18 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [RUN]
2021-05-29 18:31:33.268257 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 18:31:33.269253 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:31:33.275275 (Thread-1): unclosed <socket.socket fd=1348, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64393), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:33.276272 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64394), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:33.290220 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 18:31:33.292193 (Thread-1): finished collecting timing info
2021-05-29 18:31:33.293177 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:33.301150 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:31:36.002092 (Thread-1): finished collecting timing info
2021-05-29 18:31:36.004074 (Thread-1): 15:31:36 | 9 of 18 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_ [PASS in 2.74s]
2021-05-29 18:31:36.009066 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:31:36.010059 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:31:36.012066 (Thread-1): 15:31:36 | 10 of 18 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [RUN]
2021-05-29 18:31:36.017042 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 18:31:36.018040 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:31:36.045963 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 18:31:36.126510 (Thread-1): finished collecting timing info
2021-05-29 18:31:36.127486 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:36.161404 (Thread-1): On test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
) as child
left join (
    select product_sk as id from `desafio-indicium`.`dw_adventure_works`.`dim_product`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-05-29 18:31:38.929386 (Thread-1): finished collecting timing info
2021-05-29 18:31:38.933376 (Thread-1): 15:31:38 | 10 of 18 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_product_ [PASS in 2.92s]
2021-05-29 18:31:38.938363 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:31:38.940358 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:38.942353 (Thread-1): 15:31:38 | 11 of 18 START test source_not_null_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:31:38.946342 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:31:38.948339 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:38.962292 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:31:38.964287 (Thread-1): finished collecting timing info
2021-05-29 18:31:38.965289 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:38.973264 (Thread-1): On test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from `desafio-indicium`.`adventure_works`.`salesorderheader`
where salesorderid is null



2021-05-29 18:31:41.273570 (Thread-1): finished collecting timing info
2021-05-29 18:31:41.275513 (Thread-1): 15:31:41 | 11 of 18 PASS source_not_null_adventure_works_salesorderheader_salesorderid [PASS in 2.33s]
2021-05-29 18:31:41.280503 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:41.282507 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:41.283492 (Thread-1): 15:31:41 | 12 of 18 START test source_unique_adventure_works_salesorderheader_salesorderid [RUN]
2021-05-29 18:31:41.286673 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:31:41.287709 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:41.294684 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64387), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:41.294684 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64388), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:41.298670 (Thread-1): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64391), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:41.299633 (Thread-1): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64392), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:41.301657 (Thread-1): unclosed <socket.socket fd=1404, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64396), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:41.302658 (Thread-1): unclosed <socket.socket fd=1392, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64395), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:41.302658 (Thread-1): unclosed <socket.socket fd=1424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64398), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:41.303653 (Thread-1): unclosed <socket.socket fd=1416, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64397), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:41.303653 (Thread-1): unclosed <socket.socket fd=1468, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64399), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:41.303653 (Thread-1): unclosed <socket.socket fd=1460, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64400), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:41.317582 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:31:41.320577 (Thread-1): finished collecting timing info
2021-05-29 18:31:41.320577 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:41.328711 (Thread-1): On test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorderid

    from `desafio-indicium`.`adventure_works`.`salesorderheader`
    where salesorderid is not null
    group by salesorderid
    having count(*) > 1

) validation_errors



2021-05-29 18:31:43.608732 (Thread-1): finished collecting timing info
2021-05-29 18:31:43.610727 (Thread-1): 15:31:43 | 12 of 18 PASS source_unique_adventure_works_salesorderheader_salesorderid [PASS in 2.32s]
2021-05-29 18:31:43.615709 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:31:43.616704 (Thread-1): Began running node test.dw_adventure_works.test
2021-05-29 18:31:43.618694 (Thread-1): 15:31:43 | 13 of 18 START test test............................................. [RUN]
2021-05-29 18:31:43.623693 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:31:43.624681 (Thread-1): Compiling test.dw_adventure_works.test
2021-05-29 18:31:43.632667 (Thread-1): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64401), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:43.633666 (Thread-1): unclosed <socket.socket fd=1492, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64402), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:43.669556 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.test"
2021-05-29 18:31:43.671552 (Thread-1): finished collecting timing info
2021-05-29 18:31:43.671552 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:43.680830 (Thread-1): On test.dw_adventure_works.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation_id as (
        select count(distinct salesorderid) as ord_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )
  
    ,    validation_qt as (
        select sum(orderqty) as sum_qty
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    ,    validation_price as (
        select sum(saleprice) as sum_price
        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
    )

    select * from validation_id where ord_qty != 31465
    select * from validation_qt where sum_qty != 274914
    select * from validation_price where sum_price != 109846381.399888
)select count(*) from dbt__CTE__INTERNAL_test
2021-05-29 18:31:45.391027 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/62416023-5d60-493e-9c7e-65a23a862759?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]')
2021-05-29 18:31:47.247450 (Thread-1): finished collecting timing info
2021-05-29 18:31:47.250451 (Thread-1): Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/872a2c7a-4328-4135-8b9c-a27049b2f44d?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got keyword SELECT at [21:5]

(job ID: 872a2c7a-4328-4135-8b9c-a27049b2f44d)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.test"} */
   2:
   3:with dbt__CTE__INTERNAL_test as (
   4:with   
   5:    validation_id as (
   6:        select count(distinct salesorderid) as ord_qty
   7:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
   8:    )
   9:  
  10:    ,    validation_qt as (
  11:        select sum(orderqty) as sum_qty
  12:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  13:    )
  14:
  15:    ,    validation_price as (
  16:        select sum(saleprice) as sum_price
  17:        from `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  18:    )
  19:
  20:    select * from validation_id where ord_qty != 31465
  21:    select * from validation_qt where sum_qty != 274914
  22:    select * from validation_price where sum_price != 109846381.399888
  23:)select count(*) from dbt__CTE__INTERNAL_test
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\test.py", line 46, in execute_data_test
    test.compiled_sql, auto_begin=True, fetch=True
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in test test (tests\test.sql)
  Syntax error: Expected ")" but got keyword SELECT at [21:5]
  compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:31:47.287512 (Thread-1): 15:31:47 | 13 of 18 ERROR test.................................................. [ERROR in 3.66s]
2021-05-29 18:31:47.289776 (Thread-1): Finished running node test.dw_adventure_works.test
2021-05-29 18:31:47.289776 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:31:47.290772 (Thread-1): 15:31:47 | 14 of 18 START test unique_dim_address_address_sk.................... [RUN]
2021-05-29 18:31:47.291770 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 18:31:47.292770 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:31:47.298786 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 18:31:47.300747 (Thread-1): finished collecting timing info
2021-05-29 18:31:47.300747 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:47.308537 (Thread-1): On test.dw_adventure_works.unique_dim_address_address_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_address_address_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        address_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    where address_sk is not null
    group by address_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:31:50.042618 (Thread-1): finished collecting timing info
2021-05-29 18:31:50.043673 (Thread-1): 15:31:50 | 14 of 18 PASS unique_dim_address_address_sk.......................... [PASS in 2.75s]
2021-05-29 18:31:50.045615 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:31:50.045615 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:31:50.046611 (Thread-1): 15:31:50 | 15 of 18 START test unique_dim_creditcard_creditcard_sk.............. [RUN]
2021-05-29 18:31:50.047609 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 18:31:50.047609 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:31:50.049603 (Thread-1): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64405), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:50.049603 (Thread-1): unclosed <socket.socket fd=1476, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64406), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:50.054624 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 18:31:50.055624 (Thread-1): finished collecting timing info
2021-05-29 18:31:50.056586 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:50.064505 (Thread-1): On test.dw_adventure_works.unique_dim_creditcard_creditcard_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        creditcard_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    where creditcard_sk is not null
    group by creditcard_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:31:52.753658 (Thread-1): finished collecting timing info
2021-05-29 18:31:52.755587 (Thread-1): 15:31:52 | 15 of 18 PASS unique_dim_creditcard_creditcard_sk.................... [PASS in 2.71s]
2021-05-29 18:31:52.762573 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:31:52.763571 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:31:52.765576 (Thread-1): 15:31:52 | 16 of 18 START test unique_dim_customer_customer_sk.................. [RUN]
2021-05-29 18:31:52.769553 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 18:31:52.770564 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:31:52.786541 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 18:31:52.787530 (Thread-1): finished collecting timing info
2021-05-29 18:31:52.788499 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:52.797450 (Thread-1): On test.dw_adventure_works.unique_dim_customer_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_customer_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:31:55.576214 (Thread-1): finished collecting timing info
2021-05-29 18:31:55.577213 (Thread-1): 15:31:55 | 16 of 18 PASS unique_dim_customer_customer_sk........................ [PASS in 2.81s]
2021-05-29 18:31:55.578209 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:31:55.578209 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:31:55.579207 (Thread-1): 15:31:55 | 17 of 18 START test unique_dim_product_product_sk.................... [RUN]
2021-05-29 18:31:55.580206 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 18:31:55.580206 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:31:55.588216 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 18:31:55.589181 (Thread-1): finished collecting timing info
2021-05-29 18:31:55.590182 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:55.600188 (Thread-1): On test.dw_adventure_works.unique_dim_product_product_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_product_product_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        product_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    where product_sk is not null
    group by product_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:31:57.853953 (Thread-1): finished collecting timing info
2021-05-29 18:31:57.857949 (Thread-1): 15:31:57 | 17 of 18 PASS unique_dim_product_product_sk.......................... [PASS in 2.28s]
2021-05-29 18:31:57.863930 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:31:57.864927 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:31:57.867919 (Thread-1): 15:31:57 | 18 of 18 START test unique_dim_reason_salesorder_sk.................. [RUN]
2021-05-29 18:31:57.871909 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_salesorder_sk".
2021-05-29 18:31:57.873901 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:31:57.877893 (Thread-1): unclosed <socket.socket fd=1664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64411), raddr=('172.217.28.10', 443)>
2021-05-29 18:31:57.878888 (Thread-1): unclosed <socket.socket fd=1680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64412), raddr=('142.250.218.10', 443)>
2021-05-29 18:31:57.886861 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_salesorder_sk"
2021-05-29 18:31:57.887862 (Thread-1): finished collecting timing info
2021-05-29 18:31:57.888861 (Thread-1): Opening a new connection, currently in state closed
2021-05-29 18:31:57.898550 (Thread-1): On test.dw_adventure_works.unique_dim_reason_salesorder_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.dw_adventure_works.unique_dim_reason_salesorder_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        salesorder_sk

    from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    where salesorder_sk is not null
    group by salesorder_sk
    having count(*) > 1

) validation_errors



2021-05-29 18:32:00.354812 (Thread-1): finished collecting timing info
2021-05-29 18:32:00.357831 (Thread-1): 15:32:00 | 18 of 18 PASS unique_dim_reason_salesorder_sk........................ [PASS in 2.49s]
2021-05-29 18:32:00.363790 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:32:00.416939 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:32:00.417974 (MainThread): 15:32:00 | 
2021-05-29 18:32:00.418829 (MainThread): 15:32:00 | Finished running 18 tests in 51.72s.
2021-05-29 18:32:00.419835 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:32:00.420832 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:32:00.420832 (MainThread): Connection 'test.dw_adventure_works.unique_dim_reason_salesorder_sk' was properly closed.
2021-05-29 18:32:00.432802 (MainThread): unclosed <socket.socket fd=1556, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64403), raddr=('172.217.28.10', 443)>
2021-05-29 18:32:00.433834 (MainThread): unclosed <socket.socket fd=1404, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64404), raddr=('142.250.218.10', 443)>
2021-05-29 18:32:00.437789 (MainThread): unclosed <socket.socket fd=1540, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64407), raddr=('172.217.28.10', 443)>
2021-05-29 18:32:00.438784 (MainThread): unclosed <socket.socket fd=1636, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64408), raddr=('142.250.218.10', 443)>
2021-05-29 18:32:00.438784 (MainThread): unclosed <socket.socket fd=948, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64410), raddr=('142.250.218.10', 443)>
2021-05-29 18:32:00.439785 (MainThread): unclosed <socket.socket fd=1164, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64409), raddr=('172.217.28.10', 443)>
2021-05-29 18:32:00.443774 (MainThread): unclosed <socket.socket fd=1736, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64413), raddr=('216.58.202.138', 443)>
2021-05-29 18:32:00.443774 (MainThread): unclosed <socket.socket fd=1740, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 64414), raddr=('142.250.218.10', 443)>
2021-05-29 18:32:00.455737 (MainThread): 
2021-05-29 18:32:00.456737 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 18:32:00.457733 (MainThread): 
2021-05-29 18:32:00.458731 (MainThread): Database Error in test test (tests\test.sql)
2021-05-29 18:32:00.459729 (MainThread):   Syntax error: Expected ")" but got keyword SELECT at [21:5]
2021-05-29 18:32:00.460725 (MainThread):   compiled SQL at target\compiled\dw_adventure_works\tests\test.sql
2021-05-29 18:32:00.461723 (MainThread): 
Done. PASS=17 WARN=0 ERROR=1 SKIP=0 TOTAL=18
2021-05-29 18:32:00.462719 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025724F2CE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025723BB7C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025723D3BAC8>]}
2021-05-29 18:32:00.463717 (MainThread): Flushing usage events
2021-05-29 18:35:52.989287 (MainThread): Running with dbt=0.19.1
2021-05-29 18:35:54.390521 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-05-29 18:35:54.393513 (MainThread): Tracking: tracking
2021-05-29 18:35:54.394509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163320F46C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163320F4488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163320F4848>]}
2021-05-29 18:35:54.441390 (MainThread): Partial parsing not enabled
2021-05-29 18:35:54.452361 (MainThread): Parsing macros\adapters.sql
2021-05-29 18:35:54.540413 (MainThread): Parsing macros\catalog.sql
2021-05-29 18:35:54.560350 (MainThread): Parsing macros\etc.sql
2021-05-29 18:35:54.577307 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 18:35:54.599297 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 18:35:54.669080 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 18:35:54.678035 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 18:35:54.691002 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 18:35:54.741865 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 18:35:54.774778 (MainThread): Parsing macros\core.sql
2021-05-29 18:35:54.792730 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 18:35:55.002356 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 18:35:55.057760 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 18:35:55.061751 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 18:35:55.074714 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 18:35:55.086684 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 18:35:55.090674 (MainThread): Parsing macros\etc\query.sql
2021-05-29 18:35:55.093663 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 18:35:55.139541 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 18:35:55.210939 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 18:35:55.223907 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 18:35:55.257821 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 18:35:55.355556 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 18:35:55.490194 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 18:35:55.495179 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 18:35:55.578467 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 18:35:55.619362 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 18:35:55.644297 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 18:35:55.674216 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 18:35:55.689176 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 18:35:55.694162 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 18:35:55.710120 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 18:35:55.752010 (MainThread): Partial parsing not enabled
2021-05-29 18:35:55.906594 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:35:55.954471 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:35:55.974417 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:35:55.998363 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:35:56.025279 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:35:56.060696 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:35:56.093621 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:35:56.111561 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:35:56.136498 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:35:56.156442 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:35:56.172915 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:35:56.191865 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:35:56.209815 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:35:56.224776 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:35:56.246717 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:35:56.269887 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:35:56.287329 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:35:56.340189 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:35:57.404055 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f77a965-a2a4-48eb-9e39-8bbf540c3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633208F188>]}
2021-05-29 18:35:57.431949 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f77a965-a2a4-48eb-9e39-8bbf540c3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163320C83C8>]}
2021-05-29 18:35:57.432943 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 18:35:57.442915 (MainThread): 
2021-05-29 18:35:57.443912 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 18:35:57.454882 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 18:35:57.455882 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 18:35:57.502636 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 18:35:59.023465 (MainThread): 15:35:59 | Concurrency: 1 threads (target='dev')
2021-05-29 18:35:59.025468 (MainThread): 15:35:59 | 
2021-05-29 18:35:59.050392 (Thread-1): Began running node model.dw_adventure_works.stg_address
2021-05-29 18:35:59.052387 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 18:35:59.053426 (Thread-1): Compiling model.dw_adventure_works.stg_address
2021-05-29 18:35:59.059366 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_address"
2021-05-29 18:35:59.067403 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.067403 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.068437 (Thread-1): Finished running node model.dw_adventure_works.stg_address
2021-05-29 18:35:59.068437 (Thread-1): Began running node model.dw_adventure_works.stg_creditcard
2021-05-29 18:35:59.069433 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 18:35:59.069433 (Thread-1): Compiling model.dw_adventure_works.stg_creditcard
2021-05-29 18:35:59.073424 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_creditcard"
2021-05-29 18:35:59.075380 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.075380 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.075380 (Thread-1): Finished running node model.dw_adventure_works.stg_creditcard
2021-05-29 18:35:59.076415 (Thread-1): Began running node model.dw_adventure_works.stg_customer
2021-05-29 18:35:59.076415 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 18:35:59.077375 (Thread-1): Compiling model.dw_adventure_works.stg_customer
2021-05-29 18:35:59.084358 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_customer"
2021-05-29 18:35:59.088111 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.089121 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.089121 (Thread-1): Finished running node model.dw_adventure_works.stg_customer
2021-05-29 18:35:59.089121 (Thread-1): Began running node model.dw_adventure_works.stg_person
2021-05-29 18:35:59.090119 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 18:35:59.090119 (Thread-1): Compiling model.dw_adventure_works.stg_person
2021-05-29 18:35:59.094141 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_person"
2021-05-29 18:35:59.098109 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.098109 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.099091 (Thread-1): Finished running node model.dw_adventure_works.stg_person
2021-05-29 18:35:59.099091 (Thread-1): Began running node model.dw_adventure_works.stg_product
2021-05-29 18:35:59.100089 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 18:35:59.100089 (Thread-1): Compiling model.dw_adventure_works.stg_product
2021-05-29 18:35:59.104114 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_product"
2021-05-29 18:35:59.107068 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.108069 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.109065 (Thread-1): Finished running node model.dw_adventure_works.stg_product
2021-05-29 18:35:59.109065 (Thread-1): Began running node model.dw_adventure_works.stg_stateprovince
2021-05-29 18:35:59.110061 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 18:35:59.110061 (Thread-1): Compiling model.dw_adventure_works.stg_stateprovince
2021-05-29 18:35:59.118041 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_stateprovince"
2021-05-29 18:35:59.120039 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.121035 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.122031 (Thread-1): Finished running node model.dw_adventure_works.stg_stateprovince
2021-05-29 18:35:59.122031 (Thread-1): Began running node model.dw_adventure_works.stg_orderdetail
2021-05-29 18:35:59.124028 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 18:35:59.124028 (Thread-1): Compiling model.dw_adventure_works.stg_orderdetail
2021-05-29 18:35:59.133002 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderdetail"
2021-05-29 18:35:59.135992 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.136994 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.139983 (Thread-1): Finished running node model.dw_adventure_works.stg_orderdetail
2021-05-29 18:35:59.139983 (Thread-1): Began running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 18:35:59.140980 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 18:35:59.142982 (Thread-1): Compiling model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 18:35:59.151954 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orderheadersalesreason"
2021-05-29 18:35:59.160925 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.161925 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.168904 (Thread-1): Finished running node model.dw_adventure_works.stg_orderheadersalesreason
2021-05-29 18:35:59.169902 (Thread-1): Began running node model.dw_adventure_works.stg_orders
2021-05-29 18:35:59.170899 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 18:35:59.174915 (Thread-1): Compiling model.dw_adventure_works.stg_orders
2021-05-29 18:35:59.204810 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_orders"
2021-05-29 18:35:59.207799 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.209795 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.210792 (Thread-1): Finished running node model.dw_adventure_works.stg_orders
2021-05-29 18:35:59.211789 (Thread-1): Began running node model.dw_adventure_works.stg_salesreason
2021-05-29 18:35:59.217785 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 18:35:59.219768 (Thread-1): Compiling model.dw_adventure_works.stg_salesreason
2021-05-29 18:35:59.225755 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_salesreason"
2021-05-29 18:35:59.236724 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.237719 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.240712 (Thread-1): Finished running node model.dw_adventure_works.stg_salesreason
2021-05-29 18:35:59.240712 (Thread-1): Began running node model.dw_adventure_works.stg_countryregion
2021-05-29 18:35:59.257666 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 18:35:59.271630 (Thread-1): Compiling model.dw_adventure_works.stg_countryregion
2021-05-29 18:35:59.310865 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.stg_countryregion"
2021-05-29 18:35:59.326822 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.326822 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.334800 (Thread-1): Finished running node model.dw_adventure_works.stg_countryregion
2021-05-29 18:35:59.335797 (Thread-1): Began running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.340784 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:35:59.340784 (Thread-1): Compiling test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.534317 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:35:59.539305 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.539305 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.540302 (Thread-1): Finished running node test.dw_adventure_works.source_not_null_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.541299 (Thread-1): Began running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.543293 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid".
2021-05-29 18:35:59.543293 (Thread-1): Compiling test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.593170 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid"
2021-05-29 18:35:59.595170 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.596164 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.601173 (Thread-1): Finished running node test.dw_adventure_works.source_unique_adventure_works_salesorderheader_salesorderid
2021-05-29 18:35:59.602147 (Thread-1): Began running node model.dw_adventure_works.dim_creditcard
2021-05-29 18:35:59.603146 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 18:35:59.603146 (Thread-1): Compiling model.dw_adventure_works.dim_creditcard
2021-05-29 18:35:59.611126 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_creditcard"
2021-05-29 18:35:59.621104 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.622096 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.623091 (Thread-1): Finished running node model.dw_adventure_works.dim_creditcard
2021-05-29 18:35:59.623091 (Thread-1): Began running node model.dw_adventure_works.dim_customer
2021-05-29 18:35:59.624090 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 18:35:59.625085 (Thread-1): Compiling model.dw_adventure_works.dim_customer
2021-05-29 18:35:59.638052 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_customer"
2021-05-29 18:35:59.641042 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.642050 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.643041 (Thread-1): Finished running node model.dw_adventure_works.dim_customer
2021-05-29 18:35:59.644037 (Thread-1): Began running node model.dw_adventure_works.dim_product
2021-05-29 18:35:59.652014 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 18:35:59.653012 (Thread-1): Compiling model.dw_adventure_works.dim_product
2021-05-29 18:35:59.658995 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_product"
2021-05-29 18:35:59.663162 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.666151 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.668121 (Thread-1): Finished running node model.dw_adventure_works.dim_product
2021-05-29 18:35:59.669120 (Thread-1): Began running node model.dw_adventure_works.dim_address
2021-05-29 18:35:59.671122 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 18:35:59.671122 (Thread-1): Compiling model.dw_adventure_works.dim_address
2021-05-29 18:35:59.686075 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_address"
2021-05-29 18:35:59.687073 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.688068 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.688068 (Thread-1): Finished running node model.dw_adventure_works.dim_address
2021-05-29 18:35:59.689068 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 18:35:59.690065 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 18:35:59.690065 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 18:35:59.702031 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 18:35:59.706020 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.706020 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.707036 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 18:35:59.707036 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.708018 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk".
2021-05-29 18:35:59.709014 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.723973 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk"
2021-05-29 18:35:59.726015 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.727025 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.727025 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.728021 (Thread-1): Began running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.733023 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk".
2021-05-29 18:35:59.734996 (Thread-1): Compiling test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.742974 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_creditcard_creditcard_sk"
2021-05-29 18:35:59.751951 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.752949 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.753947 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_creditcard_creditcard_sk
2021-05-29 18:35:59.753947 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:35:59.754944 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_customer_customer_sk".
2021-05-29 18:35:59.754944 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:35:59.768906 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_customer_customer_sk"
2021-05-29 18:35:59.771899 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.771899 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.772897 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_customer_customer_sk
2021-05-29 18:35:59.772897 (Thread-1): Began running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:35:59.773893 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_customer_customer_sk".
2021-05-29 18:35:59.773893 (Thread-1): Compiling test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:35:59.788851 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_customer_customer_sk"
2021-05-29 18:35:59.790847 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.790847 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.791846 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_customer_customer_sk
2021-05-29 18:35:59.791846 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:35:59.792840 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_product_product_sk".
2021-05-29 18:35:59.792840 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:35:59.805808 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_product_product_sk"
2021-05-29 18:35:59.807805 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.808799 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.809797 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_product_product_sk
2021-05-29 18:35:59.809797 (Thread-1): Began running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:35:59.809797 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_product_product_sk".
2021-05-29 18:35:59.810793 (Thread-1): Compiling test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:35:59.825753 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_product_product_sk"
2021-05-29 18:35:59.827750 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.831756 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.834729 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_product_product_sk
2021-05-29 18:35:59.835728 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-29 18:35:59.836730 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 18:35:59.837761 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-29 18:35:59.854676 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-29 18:35:59.856671 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.856671 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.857668 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-29 18:35:59.857668 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:35:59.860659 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_address_address_sk".
2021-05-29 18:35:59.860659 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:35:59.874626 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_address_address_sk"
2021-05-29 18:35:59.876617 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.876617 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.879609 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_address_address_sk
2021-05-29 18:35:59.883617 (Thread-1): Began running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:35:59.884595 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_address_address_sk".
2021-05-29 18:35:59.885592 (Thread-1): Compiling test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:35:59.893572 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_address_address_sk"
2021-05-29 18:35:59.901550 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.901550 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.903563 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_address_address_sk
2021-05-29 18:35:59.904545 (Thread-1): Began running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:35:59.905541 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_dim_reason_salesorder_sk".
2021-05-29 18:35:59.906538 (Thread-1): Compiling test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:35:59.922494 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_dim_reason_salesorder_sk"
2021-05-29 18:35:59.925486 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.925486 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.926484 (Thread-1): Finished running node test.dw_adventure_works.not_null_dim_reason_salesorder_sk
2021-05-29 18:35:59.926484 (Thread-1): Began running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:35:59.927480 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.unique_dim_reason_salesorder_sk".
2021-05-29 18:35:59.927480 (Thread-1): Compiling test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:35:59.942443 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.unique_dim_reason_salesorder_sk"
2021-05-29 18:35:59.943437 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.950445 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.953412 (Thread-1): Finished running node test.dw_adventure_works.unique_dim_reason_salesorder_sk
2021-05-29 18:35:59.954409 (Thread-1): Began running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:35:59.954409 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.not_null_fact_order_details_salesorderid".
2021-05-29 18:35:59.955409 (Thread-1): Compiling test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:35:59.967398 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.not_null_fact_order_details_salesorderid"
2021-05-29 18:35:59.971364 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.971364 (Thread-1): finished collecting timing info
2021-05-29 18:35:59.972360 (Thread-1): Finished running node test.dw_adventure_works.not_null_fact_order_details_salesorderid
2021-05-29 18:35:59.972360 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:35:59.973359 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_".
2021-05-29 18:35:59.974356 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:36:00.009264 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_"
2021-05-29 18:36:00.010734 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.011738 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.017743 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_address_fk__address_sk__ref_dim_address_
2021-05-29 18:36:00.017743 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:36:00.019717 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_".
2021-05-29 18:36:00.019717 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:36:00.074571 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_"
2021-05-29 18:36:00.076564 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.077561 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.078558 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_creditcard_fk__creditcard_sk__ref_dim_creditcard_
2021-05-29 18:36:00.081567 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:36:00.082557 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_".
2021-05-29 18:36:00.083546 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:36:00.104491 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_"
2021-05-29 18:36:00.106483 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.106483 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.107482 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customer_
2021-05-29 18:36:00.108479 (Thread-1): Began running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:36:00.108479 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_".
2021-05-29 18:36:00.109475 (Thread-1): Compiling test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:36:00.138399 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_"
2021-05-29 18:36:00.140392 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.141391 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.142387 (Thread-1): Finished running node test.dw_adventure_works.relationships_fact_order_details_product_fk__product_sk__ref_dim_product_
2021-05-29 18:36:00.142387 (Thread-1): Began running node test.dw_adventure_works.test
2021-05-29 18:36:00.143385 (Thread-1): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 18:36:00.143385 (Thread-1): Compiling test.dw_adventure_works.test
2021-05-29 18:36:00.222687 (Thread-1): Writing injected SQL for node "test.dw_adventure_works.test"
2021-05-29 18:36:00.224681 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.225681 (Thread-1): finished collecting timing info
2021-05-29 18:36:00.226677 (Thread-1): Finished running node test.dw_adventure_works.test
2021-05-29 18:36:00.335908 (MainThread): Connection 'master' was properly closed.
2021-05-29 18:36:00.335908 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 18:36:00.335908 (MainThread): Connection 'test.dw_adventure_works.test' was properly closed.
2021-05-29 18:36:00.382787 (MainThread): 15:36:00 | Done.
2021-05-29 18:36:00.402730 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-05-29 18:36:00.402730 (MainThread): 15:36:00 | Building catalog
2021-05-29 18:36:00.424672 (MainThread): Opening a new connection, currently in state init
2021-05-29 18:36:01.796459 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "desafio-indicium.information_schema".
2021-05-29 18:36:01.822394 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 18:36:01.831694 (ThreadPoolExecutor-1_0): On desafio-indicium.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "connection_name": "desafio-indicium.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `desafio-indicium`.`dw_adventure_works`.__TABLES__
        where (upper(dataset_id) = upper('dw_adventure_works'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `desafio-indicium`.`dw_adventure_works`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `desafio-indicium`.`dw_adventure_works`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-29 18:36:05.469126 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "desafio-indicium.information_schema".
2021-05-29 18:36:05.472117 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-05-29 18:36:05.480541 (ThreadPoolExecutor-1_0): On desafio-indicium.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "connection_name": "desafio-indicium.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `desafio-indicium`.`adventure_works`.__TABLES__
        where (upper(dataset_id) = upper('adventure_works'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `desafio-indicium`.`adventure_works`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `desafio-indicium`.`adventure_works`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-05-29 18:36:10.659629 (MainThread): 15:36:10 | Catalog written to C:\Users\user\desafio_final\target\catalog.json
2021-05-29 18:36:10.670600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332123388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332123CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016335BF27C8>]}
2021-05-29 18:36:10.671594 (MainThread): Flushing usage events
2021-05-29 18:36:11.712246 (MainThread): Connection 'generate_catalog' was properly closed.
2021-05-29 18:36:11.712246 (MainThread): Connection 'desafio-indicium.information_schema' was properly closed.
2021-05-29 18:36:47.974299 (MainThread): Running with dbt=0.19.1
2021-05-29 18:36:48.763859 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-05-29 18:36:48.764860 (MainThread): Tracking: tracking
2021-05-29 18:36:48.765857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B7145A448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B71C34308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B71C34708>]}
2021-05-29 18:36:48.774599 (MainThread): Serving docs at 0.0.0.0:8080
2021-05-29 18:36:48.775604 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-05-29 18:36:48.776599 (MainThread): Press Ctrl+C to exit.


2021-05-29 20:41:54.327568 (MainThread): Flushing usage events
2021-05-29 20:41:57.599669 (MainThread): ctrl-c
2021-05-29 20:41:57.609717 (MainThread): unclosed <socket.socket fd=1436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58454), raddr=('3.211.96.98', 443)>
2021-05-29 20:42:16.269592 (MainThread): Running with dbt=0.19.1
2021-05-29 20:42:17.850751 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 20:42:17.853339 (MainThread): Tracking: tracking
2021-05-29 20:42:17.855137 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F23A9648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F040E788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F040E8C8>]}
2021-05-29 20:42:17.880669 (MainThread): Partial parsing not enabled
2021-05-29 20:42:17.885761 (MainThread): Parsing macros\adapters.sql
2021-05-29 20:42:17.928388 (MainThread): Parsing macros\catalog.sql
2021-05-29 20:42:17.941487 (MainThread): Parsing macros\etc.sql
2021-05-29 20:42:17.946674 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 20:42:17.958773 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 20:42:17.986186 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 20:42:17.997146 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 20:42:18.003839 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 20:42:18.024289 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 20:42:18.045710 (MainThread): Parsing macros\core.sql
2021-05-29 20:42:18.055836 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 20:42:18.143881 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 20:42:18.163691 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 20:42:18.167135 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 20:42:18.172125 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 20:42:18.177214 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 20:42:18.182086 (MainThread): Parsing macros\etc\query.sql
2021-05-29 20:42:18.185779 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 20:42:18.206110 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 20:42:18.234040 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 20:42:18.238580 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 20:42:18.253905 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 20:42:18.298789 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 20:42:18.365802 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 20:42:18.370462 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 20:42:18.405407 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 20:42:18.419295 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 20:42:18.430904 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 20:42:18.445408 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 20:42:18.451436 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 20:42:18.455386 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 20:42:18.460372 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 20:42:18.474334 (MainThread): Partial parsing not enabled
2021-05-29 20:42:18.522244 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 20:42:18.543156 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 20:42:18.551725 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 20:42:18.561103 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 20:42:18.569678 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 20:42:18.579443 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 20:42:18.590415 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 20:42:18.599299 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 20:42:18.609307 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 20:42:18.618087 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 20:42:18.626924 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 20:42:18.636013 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 20:42:18.644370 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 20:42:18.652645 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 20:42:18.661385 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 20:42:18.669363 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 20:42:18.677918 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 20:42:18.701363 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 20:42:18.972213 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57fd5126-a5bc-44c0-849b-2a622c1e5baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F04ACBC8>]}
2021-05-29 20:42:19.027383 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57fd5126-a5bc-44c0-849b-2a622c1e5baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F0454388>]}
2021-05-29 20:42:19.028386 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 20:42:19.036167 (MainThread): 
2021-05-29 20:42:19.037165 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 20:42:19.040157 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 20:42:19.042164 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 20:42:20.575591 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 20:42:20.575591 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 20:42:20.583974 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 20:42:21.925907 (MainThread): 17:42:21 | Concurrency: 1 threads (target='dev')
2021-05-29 20:42:21.926909 (MainThread): 17:42:21 | 
2021-05-29 20:42:21.936551 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 20:42:21.937545 (Thread-1): 17:42:21 | 1 of 1 START table model dw_adventure_works.dim_reason............... [RUN]
2021-05-29 20:42:21.938543 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 20:42:21.939540 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 20:42:21.946536 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 20:42:21.954148 (Thread-1): finished collecting timing info
2021-05-29 20:42:22.003061 (Thread-1): Opening a new connection, currently in state init
2021-05-29 20:42:22.010669 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 20:42:22.776359 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 20:42:22.786623 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    ,    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    , transformed as (
        select
            , reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 20:42:24.032190 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/b549c9b6-bc59-411a-bd8f-34b2174e4a40?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [37:13]')
2021-05-29 20:42:25.878906 (Thread-1): finished collecting timing info
2021-05-29 20:42:25.880900 (Thread-1): Database Error in model dim_reason (models\marts\dim_reason.sql)
  Syntax error: Unexpected "," at [37:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/desafio-indicium/queries/5b2e56c9-676a-4d3d-aa08-a27b5af11c11?maxResults=0&location=US&prettyPrint=false: Syntax error: Unexpected "," at [37:13]

(job ID: 5b2e56c9-676a-4d3d-aa08-a27b5af11c11)

                                                              -----Query Job SQL Follows-----                                                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */
   2:
   3:
   4:  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with
  10:    reason as (
  11:        select
  12:            /*Primary Key*/
  13:            salesreasonid
  14:
  15:           /*Other Columns*/
  16:            , name
  17:            , modifieddate
  18:            , reasontype
  19:        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
  20:    )
  21:
  22:    ,    reasonorder as (
  23:        select
  24:            /*Primary Key*/
  25:            salesreasonid
  26:
  27:            /*Foreign Keys*/
  28:            , salesorderid
  29:
  30:           /*Other Columns*/
  31:            , modifieddate
  32:        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
  33:    )
  34:
  35:    , transformed as (
  36:        select
  37:            , reasonorder.salesreasonid
  38:            , reasonorder.salesorderid
  39:            , reason.name
  40:            , reason.modifieddate
  41:            , reason.reasontype
  42:        from reasonorder
  43:        left join reason on reasonorder.salesreasonid = reason.salesreasonid
  44:    )
  45:    select * from transformed
  46:  );
  47:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_reason (models\marts\dim_reason.sql)
  Syntax error: Unexpected "," at [37:13]
  compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 20:42:25.924077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57fd5126-a5bc-44c0-849b-2a622c1e5baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F40D68C8>]}
2021-05-29 20:42:25.924077 (Thread-1): 17:42:25 | 1 of 1 ERROR creating table model dw_adventure_works.dim_reason...... [ERROR in 3.99s]
2021-05-29 20:42:25.926056 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 20:42:25.998846 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 20:42:25.998846 (MainThread): 17:42:25 | 
2021-05-29 20:42:26.000220 (MainThread): 17:42:26 | Finished running 1 table model in 6.96s.
2021-05-29 20:42:26.001222 (MainThread): Connection 'master' was properly closed.
2021-05-29 20:42:26.001222 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 20:42:26.001222 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 20:42:26.001222 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 20:42:26.004214 (MainThread): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58460), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:26.005210 (MainThread): unclosed <socket.socket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58461), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:26.005210 (MainThread): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58463), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:26.005210 (MainThread): unclosed <socket.socket fd=380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58462), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:26.005210 (MainThread): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58464), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:26.006206 (MainThread): unclosed <socket.socket fd=1092, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58465), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:26.020192 (MainThread): 
2021-05-29 20:42:26.022165 (MainThread): Completed with 1 error and 0 warnings:
2021-05-29 20:42:26.023074 (MainThread): 
2021-05-29 20:42:26.024076 (MainThread): Database Error in model dim_reason (models\marts\dim_reason.sql)
2021-05-29 20:42:26.025079 (MainThread):   Syntax error: Unexpected "," at [37:13]
2021-05-29 20:42:26.026071 (MainThread):   compiled SQL at target\run\dw_adventure_works\models\marts\dim_reason.sql
2021-05-29 20:42:26.027068 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-05-29 20:42:26.030062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7ED59AB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F25449C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F3972A88>]}
2021-05-29 20:42:26.031080 (MainThread): Flushing usage events
2021-05-29 20:42:46.959977 (MainThread): Running with dbt=0.19.1
2021-05-29 20:42:47.746913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_reason'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-29 20:42:47.748567 (MainThread): Tracking: tracking
2021-05-29 20:42:47.749610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB4E4348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB4D0E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB4D3F48>]}
2021-05-29 20:42:47.771746 (MainThread): Partial parsing not enabled
2021-05-29 20:42:47.775317 (MainThread): Parsing macros\adapters.sql
2021-05-29 20:42:47.815975 (MainThread): Parsing macros\catalog.sql
2021-05-29 20:42:47.828944 (MainThread): Parsing macros\etc.sql
2021-05-29 20:42:47.833931 (MainThread): Parsing macros\materializations\copy.sql
2021-05-29 20:42:47.844144 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-29 20:42:47.869988 (MainThread): Parsing macros\materializations\seed.sql
2021-05-29 20:42:47.879981 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-29 20:42:47.885574 (MainThread): Parsing macros\materializations\table.sql
2021-05-29 20:42:47.904532 (MainThread): Parsing macros\materializations\view.sql
2021-05-29 20:42:47.915498 (MainThread): Parsing macros\core.sql
2021-05-29 20:42:47.923786 (MainThread): Parsing macros\adapters\common.sql
2021-05-29 20:42:48.009629 (MainThread): Parsing macros\etc\datetime.sql
2021-05-29 20:42:48.027622 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-29 20:42:48.030578 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-29 20:42:48.034990 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-29 20:42:48.039664 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-29 20:42:48.043658 (MainThread): Parsing macros\etc\query.sql
2021-05-29 20:42:48.046648 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-29 20:42:48.067174 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-29 20:42:48.106668 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-29 20:42:48.111680 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-29 20:42:48.124644 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-29 20:42:48.170423 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-29 20:42:48.239424 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-29 20:42:48.244849 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-29 20:42:48.286716 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-29 20:42:48.302410 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-29 20:42:48.313398 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-29 20:42:48.326850 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-29 20:42:48.332843 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-29 20:42:48.336828 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-29 20:42:48.340853 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-29 20:42:48.354818 (MainThread): Partial parsing not enabled
2021-05-29 20:42:48.400139 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-29 20:42:48.421078 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-29 20:42:48.429057 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-29 20:42:48.438272 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-29 20:42:48.446719 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 20:42:48.456658 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-29 20:42:48.469623 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-29 20:42:48.479017 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-29 20:42:48.489785 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-29 20:42:48.498125 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-29 20:42:48.507766 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-29 20:42:48.516029 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-29 20:42:48.524169 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-29 20:42:48.532148 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-29 20:42:48.540728 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-29 20:42:48.549667 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-29 20:42:48.557683 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-29 20:42:48.578626 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-29 20:42:48.918577 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefe9dff-d266-4aaf-949f-4b74435526c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEEBD0F88>]}
2021-05-29 20:42:48.932540 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefe9dff-d266-4aaf-949f-4b74435526c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB4B52C8>]}
2021-05-29 20:42:48.933538 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-29 20:42:48.941275 (MainThread): 
2021-05-29 20:42:48.944282 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 20:42:48.949250 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-29 20:42:48.949709 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-29 20:42:49.797830 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-29 20:42:49.797830 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-29 20:42:49.806311 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 20:42:51.118757 (MainThread): 17:42:51 | Concurrency: 1 threads (target='dev')
2021-05-29 20:42:51.119774 (MainThread): 17:42:51 | 
2021-05-29 20:42:51.144065 (Thread-1): Began running node model.dw_adventure_works.dim_reason
2021-05-29 20:42:51.145061 (Thread-1): 17:42:51 | 1 of 1 START table model dw_adventure_works.dim_reason............... [RUN]
2021-05-29 20:42:51.147054 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-29 20:42:51.149057 (Thread-1): Compiling model.dw_adventure_works.dim_reason
2021-05-29 20:42:51.155030 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 20:42:51.156028 (Thread-1): finished collecting timing info
2021-05-29 20:42:51.201906 (Thread-1): Opening a new connection, currently in state init
2021-05-29 20:42:51.209717 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-29 20:42:52.562063 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.dim_reason"
2021-05-29 20:42:52.563065 (Thread-1): On model.dw_adventure_works.dim_reason: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.dim_reason"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`dim_reason`
  
  
  OPTIONS()
  as (
    with
    reason as (
        select
            /*Primary Key*/
            salesreasonid

           /*Other Columns*/
            , name
            , modifieddate
            , reasontype
        from `desafio-indicium`.`dw_adventure_works`.`stg_salesreason`
    )

    ,    reasonorder as (
        select
            /*Primary Key*/
            salesreasonid

            /*Foreign Keys*/
            , salesorderid

           /*Other Columns*/
            , modifieddate
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderheadersalesreason`
    )

    , transformed as (
        select
            reasonorder.salesreasonid
            , reasonorder.salesorderid
            , reason.name
            , reason.modifieddate
            , reason.reasontype
        from reasonorder
        left join reason on reasonorder.salesreasonid = reason.salesreasonid
    )
    select * from transformed
  );
    
2021-05-29 20:42:55.350245 (Thread-1): finished collecting timing info
2021-05-29 20:42:55.351244 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefe9dff-d266-4aaf-949f-4b74435526c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB4BD408>]}
2021-05-29 20:42:55.352241 (Thread-1): 17:42:55 | 1 of 1 OK created table model dw_adventure_works.dim_reason.......... [CREATE TABLE (27.6k rows, 432.4 KB processed) in 4.21s]
2021-05-29 20:42:55.354199 (Thread-1): Finished running node model.dw_adventure_works.dim_reason
2021-05-29 20:42:55.466100 (MainThread): Acquiring new bigquery connection "master".
2021-05-29 20:42:55.468092 (MainThread): 17:42:55 | 
2021-05-29 20:42:55.470076 (MainThread): 17:42:55 | Finished running 1 table model in 6.52s.
2021-05-29 20:42:55.473079 (MainThread): Connection 'master' was properly closed.
2021-05-29 20:42:55.475065 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-29 20:42:55.476062 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-29 20:42:55.477060 (MainThread): Connection 'model.dw_adventure_works.dim_reason' was properly closed.
2021-05-29 20:42:55.488025 (MainThread): unclosed <socket.socket fd=776, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58473), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:55.490042 (MainThread): unclosed <socket.socket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58474), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:55.492042 (MainThread): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58476), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:55.493014 (MainThread): unclosed <socket.socket fd=1012, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58475), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:55.493014 (MainThread): unclosed <socket.socket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58477), raddr=('142.250.218.234', 443)>
2021-05-29 20:42:55.494014 (MainThread): unclosed <socket.socket fd=452, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 58478), raddr=('142.250.219.42', 443)>
2021-05-29 20:42:55.507009 (MainThread): 
2021-05-29 20:42:55.509964 (MainThread): Completed successfully
2021-05-29 20:42:55.510964 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-29 20:42:55.512957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB493788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DEB493E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DED4C8908>]}
2021-05-29 20:42:55.514956 (MainThread): Flushing usage events
2021-05-30 01:01:00.880446 (MainThread): Running with dbt=0.19.1
2021-05-30 01:01:02.167013 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 01:01:02.169891 (MainThread): Tracking: tracking
2021-05-30 01:01:02.171887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19DB4E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19DB5988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19DB5748>]}
2021-05-30 01:01:02.200418 (MainThread): Partial parsing not enabled
2021-05-30 01:01:02.205475 (MainThread): Parsing macros\adapters.sql
2021-05-30 01:01:02.245963 (MainThread): Parsing macros\catalog.sql
2021-05-30 01:01:02.259175 (MainThread): Parsing macros\etc.sql
2021-05-30 01:01:02.263626 (MainThread): Parsing macros\materializations\copy.sql
2021-05-30 01:01:02.277642 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 01:01:02.304970 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 01:01:02.310995 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-30 01:01:02.316248 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 01:01:02.335797 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 01:01:02.351015 (MainThread): Parsing macros\core.sql
2021-05-30 01:01:02.360579 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 01:01:02.454334 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 01:01:02.475329 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 01:01:02.478929 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 01:01:02.484581 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 01:01:02.490058 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 01:01:02.494293 (MainThread): Parsing macros\etc\query.sql
2021-05-30 01:01:02.497767 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 01:01:02.516615 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 01:01:02.548534 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 01:01:02.552892 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 01:01:02.566725 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 01:01:02.608617 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 01:01:02.677450 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 01:01:02.682766 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 01:01:02.718715 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 01:01:02.733023 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 01:01:02.743624 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 01:01:02.757907 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 01:01:02.763910 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 01:01:02.767885 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 01:01:02.771911 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 01:01:02.785871 (MainThread): Partial parsing not enabled
2021-05-30 01:01:02.836410 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-30 01:01:02.857831 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-30 01:01:02.866751 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-30 01:01:02.875609 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-30 01:01:02.884370 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-30 01:01:02.893309 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:01:02.906220 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-30 01:01:02.914772 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-30 01:01:02.924385 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-30 01:01:02.932598 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-30 01:01:02.940723 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-30 01:01:02.949096 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-30 01:01:02.958036 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-30 01:01:02.968525 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-30 01:01:02.978326 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-30 01:01:02.986742 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-30 01:01:02.995016 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-30 01:01:03.016835 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-30 01:01:03.293683 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d72e35a-8555-4981-9472-281380d93289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1D8F6C88>]}
2021-05-30 01:01:03.348410 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d72e35a-8555-4981-9472-281380d93289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19D98408>]}
2021-05-30 01:01:03.348410 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-30 01:01:03.354362 (MainThread): 
2021-05-30 01:01:03.355358 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:01:03.357355 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-30 01:01:03.357355 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 01:01:04.898604 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-30 01:01:04.899611 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 01:01:04.912237 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:01:06.243015 (MainThread): 22:01:06 | Concurrency: 1 threads (target='dev')
2021-05-30 01:01:06.244016 (MainThread): 22:01:06 | 
2021-05-30 01:01:06.252142 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-30 01:01:06.253141 (Thread-1): 22:01:06 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-30 01:01:06.255134 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:01:06.256130 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-30 01:01:06.277077 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:01:06.285054 (Thread-1): finished collecting timing info
2021-05-30 01:01:06.342901 (Thread-1): Opening a new connection, currently in state init
2021-05-30 01:01:06.353869 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:01:07.176603 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:01:07.180593 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )
    , reason as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_reason`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid
        left join reason on orders.salesorderid = reason.salesorderid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-30 01:01:14.680064 (Thread-1): finished collecting timing info
2021-05-30 01:01:14.681063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d72e35a-8555-4981-9472-281380d93289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19DE6DC8>]}
2021-05-30 01:01:14.682061 (Thread-1): 22:01:14 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (131.9k rows, 17.6 MB processed) in 8.43s]
2021-05-30 01:01:14.684055 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-30 01:01:14.792208 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:01:14.792208 (MainThread): 22:01:14 | 
2021-05-30 01:01:14.794689 (MainThread): 22:01:14 | Finished running 1 table model in 11.44s.
2021-05-30 01:01:14.795687 (MainThread): Connection 'master' was properly closed.
2021-05-30 01:01:14.796690 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-30 01:01:14.797682 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-30 01:01:14.797682 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-30 01:01:14.821616 (MainThread): 
2021-05-30 01:01:14.821616 (MainThread): Completed successfully
2021-05-30 01:01:14.823610 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-30 01:01:14.824610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19D6E308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19D6E188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F19D6E508>]}
2021-05-30 01:01:14.824610 (MainThread): Flushing usage events
2021-05-30 01:03:09.394691 (MainThread): Running with dbt=0.19.1
2021-05-30 01:03:10.679819 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 01:03:10.682812 (MainThread): Tracking: tracking
2021-05-30 01:03:10.684806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061E64348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021063EF4D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061E64308>]}
2021-05-30 01:03:10.794515 (MainThread): Partial parsing not enabled
2021-05-30 01:03:10.802493 (MainThread): Parsing macros\adapters.sql
2021-05-30 01:03:10.922171 (MainThread): Parsing macros\catalog.sql
2021-05-30 01:03:10.952092 (MainThread): Parsing macros\etc.sql
2021-05-30 01:03:10.980017 (MainThread): Parsing macros\materializations\copy.sql
2021-05-30 01:03:11.003952 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 01:03:11.144579 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 01:03:11.162538 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-30 01:03:11.168513 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 01:03:11.206411 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 01:03:11.226361 (MainThread): Parsing macros\core.sql
2021-05-30 01:03:11.257280 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 01:03:11.703283 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 01:03:11.781074 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 01:03:11.786061 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 01:03:11.802019 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 01:03:11.820969 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 01:03:11.832936 (MainThread): Parsing macros\etc\query.sql
2021-05-30 01:03:11.842929 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 01:03:11.934663 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 01:03:12.024426 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 01:03:12.037395 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 01:03:12.076836 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 01:03:12.615014 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 01:03:12.877310 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 01:03:12.892287 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 01:03:13.199336 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 01:03:13.245439 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 01:03:13.266383 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 01:03:13.296304 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 01:03:13.315251 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 01:03:13.320238 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 01:03:13.335201 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 01:03:13.374129 (MainThread): Partial parsing not enabled
2021-05-30 01:03:13.481813 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-30 01:03:13.545642 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-30 01:03:13.571584 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-30 01:03:13.586542 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-30 01:03:13.611476 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-30 01:03:13.630426 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:03:13.652885 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-30 01:03:13.673828 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-30 01:03:13.690820 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-30 01:03:13.714718 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-30 01:03:13.736691 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-30 01:03:13.756138 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-30 01:03:13.781070 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-30 01:03:13.806004 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-30 01:03:13.816976 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-30 01:03:13.848891 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-30 01:03:13.866843 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-30 01:03:13.929675 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-30 01:03:14.884642 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e19c1592-c02a-4570-bf33-ce3f345330a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002106591E988>]}
2021-05-30 01:03:15.083108 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e19c1592-c02a-4570-bf33-ce3f345330a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061E1F188>]}
2021-05-30 01:03:15.084107 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-30 01:03:15.113048 (MainThread): 
2021-05-30 01:03:15.115026 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:03:15.118017 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-30 01:03:15.119013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 01:03:16.677732 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-30 01:03:16.679726 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 01:03:16.783529 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:03:18.236535 (MainThread): 22:03:18 | Concurrency: 1 threads (target='dev')
2021-05-30 01:03:18.240504 (MainThread): 22:03:18 | 
2021-05-30 01:03:18.273454 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-30 01:03:18.275436 (Thread-1): 22:03:18 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-30 01:03:18.278202 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:03:18.278202 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-30 01:03:18.293161 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:03:18.294158 (Thread-1): finished collecting timing info
2021-05-30 01:03:18.334086 (Thread-1): Opening a new connection, currently in state init
2021-05-30 01:03:18.343711 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:03:19.700434 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:03:19.702429 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-30 01:03:26.203570 (Thread-1): finished collecting timing info
2021-05-30 01:03:26.205585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e19c1592-c02a-4570-bf33-ce3f345330a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061EAF5C8>]}
2021-05-30 01:03:26.205585 (Thread-1): 22:03:26 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 7.93s]
2021-05-30 01:03:26.207557 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-30 01:03:26.288354 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:03:26.289350 (MainThread): 22:03:26 | 
2021-05-30 01:03:26.289845 (MainThread): 22:03:26 | Finished running 1 table model in 11.17s.
2021-05-30 01:03:26.290847 (MainThread): Connection 'master' was properly closed.
2021-05-30 01:03:26.290847 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-30 01:03:26.290847 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-30 01:03:26.290847 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-30 01:03:26.304811 (MainThread): 
2021-05-30 01:03:26.304811 (MainThread): Completed successfully
2021-05-30 01:03:26.306362 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-30 01:03:26.307369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021061E48CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021063C87088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002105F076048>]}
2021-05-30 01:03:26.308362 (MainThread): Flushing usage events
2021-05-30 01:35:58.526905 (MainThread): Running with dbt=0.19.1
2021-05-30 01:36:00.798236 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 01:36:00.806878 (MainThread): Tracking: tracking
2021-05-30 01:36:00.808092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC544C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC548C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC53608>]}
2021-05-30 01:36:00.835245 (MainThread): Partial parsing not enabled
2021-05-30 01:36:00.842004 (MainThread): Parsing macros\adapters.sql
2021-05-30 01:36:00.884409 (MainThread): Parsing macros\catalog.sql
2021-05-30 01:36:00.897207 (MainThread): Parsing macros\etc.sql
2021-05-30 01:36:00.902615 (MainThread): Parsing macros\materializations\copy.sql
2021-05-30 01:36:00.913725 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 01:36:00.938430 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 01:36:00.944460 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-30 01:36:00.949644 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 01:36:00.974181 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 01:36:00.995243 (MainThread): Parsing macros\core.sql
2021-05-30 01:36:01.004529 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 01:36:01.104359 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 01:36:01.123738 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 01:36:01.131798 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 01:36:01.136442 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 01:36:01.142737 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 01:36:01.146770 (MainThread): Parsing macros\etc\query.sql
2021-05-30 01:36:01.151482 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 01:36:01.172061 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 01:36:01.204499 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 01:36:01.209876 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 01:36:01.224601 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 01:36:01.272362 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 01:36:01.342856 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 01:36:01.347846 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 01:36:01.384166 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 01:36:01.401626 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 01:36:01.412602 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 01:36:01.427750 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 01:36:01.438734 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 01:36:01.442727 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 01:36:01.447703 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 01:36:01.465113 (MainThread): Partial parsing not enabled
2021-05-30 01:36:01.514550 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-30 01:36:01.537036 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-30 01:36:01.545852 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-30 01:36:01.555132 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-30 01:36:01.564618 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-30 01:36:01.573754 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:36:01.585929 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-30 01:36:01.595927 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-30 01:36:01.606536 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-30 01:36:01.616084 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-30 01:36:01.626475 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-30 01:36:01.636080 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-30 01:36:01.645020 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-30 01:36:01.654227 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-30 01:36:01.663981 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-30 01:36:01.674078 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-30 01:36:01.682582 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-30 01:36:01.704841 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-30 01:36:02.055554 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '865fcf7c-73ed-49a4-8d29-22e8e7791a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090E72A208>]}
2021-05-30 01:36:02.073471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '865fcf7c-73ed-49a4-8d29-22e8e7791a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC28148>]}
2021-05-30 01:36:02.074467 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-30 01:36:02.082445 (MainThread): 
2021-05-30 01:36:02.083443 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:36:02.085439 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-30 01:36:02.086435 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 01:36:03.622801 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-30 01:36:03.622801 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 01:36:03.631224 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:36:04.939560 (MainThread): 22:36:04 | Concurrency: 1 threads (target='dev')
2021-05-30 01:36:04.940552 (MainThread): 22:36:04 | 
2021-05-30 01:36:04.948180 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-30 01:36:04.949182 (Thread-1): 22:36:04 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-30 01:36:04.951177 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:36:04.951177 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-30 01:36:04.963182 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:36:04.968132 (Thread-1): finished collecting timing info
2021-05-30 01:36:05.012015 (Thread-1): Opening a new connection, currently in state init
2021-05-30 01:36:05.020438 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:36:06.391476 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:36:06.399772 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
            , product.name
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-30 01:36:13.275523 (Thread-1): finished collecting timing info
2021-05-30 01:36:13.276520 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '865fcf7c-73ed-49a4-8d29-22e8e7791a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC90F08>]}
2021-05-30 01:36:13.276520 (Thread-1): 22:36:13 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 8.33s]
2021-05-30 01:36:13.278482 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-30 01:36:13.386462 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:36:13.387459 (MainThread): 22:36:13 | 
2021-05-30 01:36:13.388456 (MainThread): 22:36:13 | Finished running 1 table model in 11.30s.
2021-05-30 01:36:13.390451 (MainThread): Connection 'master' was properly closed.
2021-05-30 01:36:13.390451 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-30 01:36:13.390451 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-30 01:36:13.391482 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-30 01:36:13.411306 (MainThread): 
2021-05-30 01:36:13.412309 (MainThread): Completed successfully
2021-05-30 01:36:13.414420 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-30 01:36:13.417423 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CCAB788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090CC90F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090EA25108>]}
2021-05-30 01:36:13.417423 (MainThread): Flushing usage events
2021-05-30 01:37:33.770630 (MainThread): Running with dbt=0.19.1
2021-05-30 01:37:34.529601 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 01:37:34.531256 (MainThread): Tracking: tracking
2021-05-30 01:37:34.532085 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC404D56C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC404D5508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC404DABC8>]}
2021-05-30 01:37:34.551946 (MainThread): Partial parsing not enabled
2021-05-30 01:37:34.556177 (MainThread): Parsing macros\adapters.sql
2021-05-30 01:37:34.598070 (MainThread): Parsing macros\catalog.sql
2021-05-30 01:37:34.612033 (MainThread): Parsing macros\etc.sql
2021-05-30 01:37:34.617339 (MainThread): Parsing macros\materializations\copy.sql
2021-05-30 01:37:34.627310 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 01:37:34.652281 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 01:37:34.659230 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-30 01:37:34.663221 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 01:37:34.683163 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 01:37:34.694542 (MainThread): Parsing macros\core.sql
2021-05-30 01:37:34.703500 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 01:37:34.791309 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 01:37:34.810194 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 01:37:34.812953 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 01:37:34.817294 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 01:37:34.822286 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 01:37:34.826275 (MainThread): Parsing macros\etc\query.sql
2021-05-30 01:37:34.828986 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 01:37:34.848410 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 01:37:34.876373 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 01:37:34.881594 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 01:37:34.895764 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 01:37:34.952615 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 01:37:35.018475 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 01:37:35.023833 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 01:37:35.060224 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 01:37:35.074750 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 01:37:35.085610 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 01:37:35.098593 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 01:37:35.104600 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 01:37:35.108553 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 01:37:35.112579 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 01:37:35.126505 (MainThread): Partial parsing not enabled
2021-05-30 01:37:35.174379 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-30 01:37:35.194048 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-30 01:37:35.203612 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-30 01:37:35.212388 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-30 01:37:35.220954 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-30 01:37:35.228933 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:37:35.240287 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-30 01:37:35.248754 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-30 01:37:35.257696 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-30 01:37:35.266454 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-30 01:37:35.275366 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-30 01:37:35.283686 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-30 01:37:35.292335 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-30 01:37:35.300625 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-30 01:37:35.308603 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-30 01:37:35.317231 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-30 01:37:35.325211 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-30 01:37:35.347151 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-30 01:37:35.632354 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aab0cd0-774b-4fdc-a4a8-d30a2f264162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC43FB9C08>]}
2021-05-30 01:37:35.690202 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aab0cd0-774b-4fdc-a4a8-d30a2f264162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC40514208>]}
2021-05-30 01:37:35.691197 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-30 01:37:35.698181 (MainThread): 
2021-05-30 01:37:35.699176 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:37:35.701674 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-30 01:37:35.701674 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 01:37:37.108571 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-30 01:37:37.108571 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 01:37:37.116992 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:37:38.436420 (MainThread): 22:37:38 | Concurrency: 1 threads (target='dev')
2021-05-30 01:37:38.437744 (MainThread): 22:37:38 | 
2021-05-30 01:37:38.443734 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-30 01:37:38.443734 (Thread-1): 22:37:38 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-30 01:37:38.445731 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 01:37:38.446728 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-30 01:37:38.458693 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:37:38.459689 (Thread-1): finished collecting timing info
2021-05-30 01:37:38.506567 (Thread-1): Opening a new connection, currently in state init
2021-05-30 01:37:38.514582 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 01:37:39.859766 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 01:37:39.860728 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
            , product.name as productname
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , order_detail_with_sk.productname
            , orders_with_sk.customer_fk
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-30 01:37:46.672530 (Thread-1): finished collecting timing info
2021-05-30 01:37:46.673528 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aab0cd0-774b-4fdc-a4a8-d30a2f264162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC424173C8>]}
2021-05-30 01:37:46.674523 (Thread-1): 22:37:46 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.4 MB processed) in 8.23s]
2021-05-30 01:37:46.675893 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-30 01:37:46.782072 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 01:37:46.783065 (MainThread): 22:37:46 | 
2021-05-30 01:37:46.784527 (MainThread): 22:37:46 | Finished running 1 table model in 11.08s.
2021-05-30 01:37:46.785533 (MainThread): Connection 'master' was properly closed.
2021-05-30 01:37:46.786531 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-30 01:37:46.786531 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-30 01:37:46.787527 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-30 01:37:46.809470 (MainThread): 
2021-05-30 01:37:46.810491 (MainThread): Completed successfully
2021-05-30 01:37:46.811498 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-30 01:37:46.815518 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC42403988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC4048A848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EC424173C8>]}
2021-05-30 01:37:46.816491 (MainThread): Flushing usage events
2021-05-30 20:00:44.819988 (MainThread): Running with dbt=0.19.1
2021-05-30 20:00:46.662501 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-05-30 20:00:46.668212 (MainThread): Tracking: tracking
2021-05-30 20:00:46.670244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BAF4088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BAF3248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BAF36C8>]}
2021-05-30 20:00:46.701143 (MainThread): Partial parsing not enabled
2021-05-30 20:00:46.709236 (MainThread): Parsing macros\adapters.sql
2021-05-30 20:00:46.755901 (MainThread): Parsing macros\catalog.sql
2021-05-30 20:00:46.770340 (MainThread): Parsing macros\etc.sql
2021-05-30 20:00:46.775527 (MainThread): Parsing macros\materializations\copy.sql
2021-05-30 20:00:46.786755 (MainThread): Parsing macros\materializations\incremental.sql
2021-05-30 20:00:46.825301 (MainThread): Parsing macros\materializations\seed.sql
2021-05-30 20:00:46.835164 (MainThread): Parsing macros\materializations\snapshot.sql
2021-05-30 20:00:46.841086 (MainThread): Parsing macros\materializations\table.sql
2021-05-30 20:00:46.870605 (MainThread): Parsing macros\materializations\view.sql
2021-05-30 20:00:46.893110 (MainThread): Parsing macros\core.sql
2021-05-30 20:00:46.904082 (MainThread): Parsing macros\adapters\common.sql
2021-05-30 20:00:47.005027 (MainThread): Parsing macros\etc\datetime.sql
2021-05-30 20:00:47.037981 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-05-30 20:00:47.042817 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-05-30 20:00:47.048801 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-05-30 20:00:47.054786 (MainThread): Parsing macros\etc\is_incremental.sql
2021-05-30 20:00:47.060773 (MainThread): Parsing macros\etc\query.sql
2021-05-30 20:00:47.063781 (MainThread): Parsing macros\materializations\helpers.sql
2021-05-30 20:00:47.086699 (MainThread): Parsing macros\materializations\common\merge.sql
2021-05-30 20:00:47.124597 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-05-30 20:00:47.131981 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-05-30 20:00:47.148046 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-05-30 20:00:47.210751 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-05-30 20:00:47.304529 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-05-30 20:00:47.311530 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-05-30 20:00:47.360576 (MainThread): Parsing macros\materializations\table\table.sql
2021-05-30 20:00:47.385589 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-05-30 20:00:47.404757 (MainThread): Parsing macros\materializations\view\view.sql
2021-05-30 20:00:47.429476 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-05-30 20:00:47.441360 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-05-30 20:00:47.448341 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-05-30 20:00:47.457668 (MainThread): Parsing macros\schema_tests\unique.sql
2021-05-30 20:00:47.486320 (MainThread): Partial parsing not enabled
2021-05-30 20:00:47.574374 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_address".
2021-05-30 20:00:47.608182 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_creditcard".
2021-05-30 20:00:47.620150 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_customer".
2021-05-30 20:00:47.635139 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_product".
2021-05-30 20:00:47.648105 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.dim_reason".
2021-05-30 20:00:47.665115 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 20:00:47.684168 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_address".
2021-05-30 20:00:47.697951 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_countryregion".
2021-05-30 20:00:47.711895 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_creditcard".
2021-05-30 20:00:47.727203 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_customer".
2021-05-30 20:00:47.743076 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderdetail".
2021-05-30 20:00:47.759016 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orderheadersalesreason".
2021-05-30 20:00:47.769989 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_orders".
2021-05-30 20:00:47.779960 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_person".
2021-05-30 20:00:47.791055 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_product".
2021-05-30 20:00:47.801905 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_salesreason".
2021-05-30 20:00:47.812935 (MainThread): Acquiring new bigquery connection "model.dw_adventure_works.stg_stateprovince".
2021-05-30 20:00:47.868924 (MainThread): Acquiring new bigquery connection "test.dw_adventure_works.test".
2021-05-30 20:00:48.415999 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee85a423-5d77-4116-a5cf-75870ce45a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248F59EC48>]}
2021-05-30 20:00:48.520829 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee85a423-5d77-4116-a5cf-75870ce45a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BB35388>]}
2021-05-30 20:00:48.521827 (MainThread): Found 17 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 11 sources, 0 exposures
2021-05-30 20:00:48.531800 (MainThread): 
2021-05-30 20:00:48.532798 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 20:00:48.534790 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_desafio-indicium".
2021-05-30 20:00:48.535791 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-05-30 20:00:50.081817 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_desafio-indicium_dw_adventure_works".
2021-05-30 20:00:50.082821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-05-30 20:00:50.105212 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 20:00:51.535442 (MainThread): 17:00:51 | Concurrency: 1 threads (target='dev')
2021-05-30 20:00:51.540629 (MainThread): 17:00:51 | 
2021-05-30 20:00:51.575565 (Thread-1): Began running node model.dw_adventure_works.fact_order_details
2021-05-30 20:00:51.579322 (Thread-1): 17:00:51 | 1 of 1 START table model dw_adventure_works.fact_order_details....... [RUN]
2021-05-30 20:00:51.589299 (Thread-1): Acquiring new bigquery connection "model.dw_adventure_works.fact_order_details".
2021-05-30 20:00:51.590674 (Thread-1): Compiling model.dw_adventure_works.fact_order_details
2021-05-30 20:00:51.626685 (Thread-1): Writing injected SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 20:00:51.630581 (Thread-1): finished collecting timing info
2021-05-30 20:00:51.694295 (Thread-1): Opening a new connection, currently in state init
2021-05-30 20:00:51.705693 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-05-30 20:00:53.275895 (Thread-1): Writing runtime SQL for node "model.dw_adventure_works.fact_order_details"
2021-05-30 20:00:53.280877 (Thread-1): On model.dw_adventure_works.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.dw_adventure_works.fact_order_details"} */


  create or replace table `desafio-indicium`.`dw_adventure_works`.`fact_order_details`
  
  
  OPTIONS()
  as (
    with
    customer as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_customer`
    )
    , creditcard as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_creditcard`
    )
    , product as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_product`
    )
    , address as (
        select *
        from `desafio-indicium`.`dw_adventure_works`.`dim_address`
    )

    , orders_with_sk as (
            select
            orders.salesorderid
            , customer.customer_sk as customer_fk
            , customer.firstname
            , customer.lastname
            , creditcard.creditcard_sk as creditcard_fk
            , address.address_sk as address_fk
            , address.city
            , orders.shipmethodid
            , orders.billtoaddressid
            , orders.salespersonid
            , orders.currencyrateid
            , orders.territoryid
            , orders.purchaseordernumber
            , orders.modifieddate
            , orders.rowguid
            , orders.taxamt
            , orders.onlineorderflag
            , orders.status
            , orders.orderdate
            , orders.creditcardapprovalcode
            , orders.subtotal
            , orders.revisionnumber
            , orders.freight
            , orders.duedate
            , orders.totaldue
            , orders.shipdate
            , orders.accountnumber
        from `desafio-indicium`.`dw_adventure_works`.`stg_orders` as orders

        left join customer on orders.customerid = customer.customerid
        left join creditcard on orders.creditcardid = creditcard.creditcardid
        left join address on orders.shiptoaddressid = address.addressid

    )

   , order_detail_with_sk as (
        select
            order_details.salesorderid
            , order_details.specialofferid
            , order_details.salesorderdetailid
            , order_details.unitpricediscount
            , order_details.unitprice
            , order_details.rowguid
            , order_details.orderqty
            , order_details.saleprice
            , order_details.modifieddate
            , order_details.carriertrackingnumber
            , product.product_sk as product_fk
            , product.name as productname
        from `desafio-indicium`.`dw_adventure_works`.`stg_orderdetail` as order_details
        left join product on order_details.productid = product.productid
    )

    , final as (
        select
            order_detail_with_sk.salesorderid
            , order_detail_with_sk.specialofferid
            , order_detail_with_sk.salesorderdetailid
            , order_detail_with_sk.unitpricediscount
            , order_detail_with_sk.unitprice
            , order_detail_with_sk.orderqty
            , order_detail_with_sk.saleprice
            , order_detail_with_sk.carriertrackingnumber
            , order_detail_with_sk.product_fk
            , order_detail_with_sk.productname
            , orders_with_sk.customer_fk
            , orders_with_sk.firstname
            , orders_with_sk.lastname
            , orders_with_sk.creditcard_fk
            , orders_with_sk.address_fk
            , orders_with_sk.city
            , orders_with_sk.shipmethodid
            , orders_with_sk.billtoaddressid
            , orders_with_sk.salespersonid
            , orders_with_sk.currencyrateid
            , orders_with_sk.territoryid
            , orders_with_sk.purchaseordernumber
            , orders_with_sk.modifieddate
            , orders_with_sk.rowguid
            , orders_with_sk.taxamt
            , orders_with_sk.onlineorderflag
            , orders_with_sk.status
            , orders_with_sk.orderdate
            , orders_with_sk.creditcardapprovalcode
            , orders_with_sk.subtotal
            , orders_with_sk.revisionnumber
            , orders_with_sk.freight
            , orders_with_sk.duedate
            , orders_with_sk.totaldue
            , orders_with_sk.shipdate
            , orders_with_sk.accountnumber
            from order_detail_with_sk

            left join orders_with_sk on order_detail_with_sk.salesorderid = orders_with_sk.salesorderid

    )


select * from final
  );
    
2021-05-30 20:01:00.063337 (Thread-1): finished collecting timing info
2021-05-30 20:01:00.064335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee85a423-5d77-4116-a5cf-75870ce45a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BB3ED48>]}
2021-05-30 20:01:00.065336 (Thread-1): 17:01:00 | 1 of 1 OK created table model dw_adventure_works.fact_order_details.. [CREATE TABLE (121.3k rows, 17.7 MB processed) in 8.48s]
2021-05-30 20:01:00.067325 (Thread-1): Finished running node model.dw_adventure_works.fact_order_details
2021-05-30 20:01:00.165015 (MainThread): Acquiring new bigquery connection "master".
2021-05-30 20:01:00.166016 (MainThread): 17:01:00 | 
2021-05-30 20:01:00.166757 (MainThread): 17:01:00 | Finished running 1 table model in 11.63s.
2021-05-30 20:01:00.167037 (MainThread): Connection 'master' was properly closed.
2021-05-30 20:01:00.168009 (MainThread): Connection 'list_desafio-indicium' was properly closed.
2021-05-30 20:01:00.168009 (MainThread): Connection 'list_desafio-indicium_dw_adventure_works' was properly closed.
2021-05-30 20:01:00.168009 (MainThread): Connection 'model.dw_adventure_works.fact_order_details' was properly closed.
2021-05-30 20:01:00.185959 (MainThread): 
2021-05-30 20:01:00.186958 (MainThread): Completed successfully
2021-05-30 20:01:00.190229 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-05-30 20:01:00.191230 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248F7910C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248F791B08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002248BB3ED48>]}
2021-05-30 20:01:00.192712 (MainThread): Flushing usage events
